<!DOCTYPE html>
<html lang="en-us" xmlns:ns="http://www.w3.org/1999/xhtml" typeof="bibo:Document " about="" property="dcterms:language" content="en">
<head>
    <style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><style>/* HIGHLIGHTS */
code.prettyprint {
    color:  inherit;
}

/* this from google-code-prettify */
.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
</style><style>/* --- Best Practices --- */
div.practice {
    border: solid #bebebe 1px;
    margin: 2em 1em 1em 2em;
}

span.practicelab {
    margin: 1.5em 0.5em 1em 1em;
    font-weight: bold;
    font-style: italic;
    background: #dfffff;
    position: relative;
    padding: 0 0.5em;
    top: -1.5em;
}

p.practicedesc {
    margin: 1.5em 0.5em 1em 1em;
}

@media screen {
    p.practicedesc {
        position: relative;
        top: -2em;
        padding: 0;
        margin: 1.5em 0.5em -1em 1em;
    }
}
</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
}
a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlCtor*/
.idlCtorName {
    color:  #ff4500;
}
.idlCtorName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName, .idlDefaultValue {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlSectionComment*/
.idlSectionComment {
    color: gray;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.constructors, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .constructors dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .constructors dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.constructors dt code {
    background:  #cfc;
}

.attributes dd, .methods dd, .constants dd, .constructors dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link href="getusermedia.css" rel="stylesheet" type="text/css">

    <title>Media Capture and Streams</title>

    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">

    

    
  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #C83500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><link href="https://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>

  <body id="respecDocument" role="document" class="h-entry"><div id="respecHeader" role="contentinfo" class="head">
  <p>
    
      <a href="http://www.w3.org/"><img src="https://www.w3.org/Icons/w3c_home" alt="W3C" height="48" width="72"></a>
    
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">Media Capture and Streams</h1>
  
  <h2 id="w3c-editor-s-draft-09-september-2014" property="dcterms:issued" datatype="xsd:dateTime" content="2014-09-08T22:00:00.000Z"><acronym title="World Wide Web Consortium">W3C</acronym> Editor's Draft <time class="dt-published" datetime="2014-09-09">09 September 2014</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="http://w3c.github.io/mediacapture-main/">http://w3c.github.io/mediacapture-main/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/mediacapture-streams/">http://www.w3.org/TR/mediacapture-streams/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://w3c.github.io/mediacapture-main/">http://w3c.github.io/mediacapture-main/</a></dd>
    
    
    
    
    
      
        <dt>Previous editor's draft:</dt>
        <dd><a href="http://w3c.github.io/mediacapture-main/archives/20140817/getusermedia.html">http://w3c.github.io/mediacapture-main/archives/20140817/getusermedia.html</a></dd>
      
    
    
    
    <dt>Editors:</dt>
    <dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Daniel C. Burnett</span>, Voxeo</span>
</dd>
<dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Adam Bergkvist</span>, Ericsson</span>
</dd>
<dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Cullen Jennings</span>, Cisco</span>
</dd>
<dd class="p-author h-card vcard" rel="bibo:editor" inlist=""><span typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Anant Narayanan</span>, Mozilla (until November 2012)</span>
</dd>

    
    
  </dl>
  
  
  
  
    
      <p class="copyright">Initial Author of this Specification was Ian Hickson, Google Inc., with the following copyright statement:<br> © Copyright 2004-2011 Apple Computer, Inc., Mozilla Foundation, and Opera Software ASA. You are granted a license to use, reproduce and create derivative works of this document.</p> <p class="copyright">All subsequent changes since 26 July 2011 done by the <acronym title="World Wide Web Consortium">W3C</acronym> WebRTC Working Group and the Device APIs Working Group are under the following <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>:<br>© 2011-2014 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), All Rights Reserved. <a href="http://www.w3.org/Consortium/Legal/copyright-documents">Document use</a>  rules apply.</p> <p class="copyright">For the entire publication on the <acronym title="World Wide Web Consortium">W3C</acronym> site the <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a> and <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> rules apply.</p>
    
  
  <hr>
</div>
    <section rel="bibo:Chapter" resource="#abstract" typeof="bibo:Chapter" datatype="" property="dcterms:abstract" class="introductory" id="abstract"><h2 id="h2_abstract" role="heading" aria-level="1">Abstract</h2>
      <p>This document defines a set of JavaScript APIs that allow local
      media, including audio and video, to be requested from a platform.</p>
    </section><section rel="bibo:Chapter" resource="#sotd" typeof="bibo:Chapter" id="sotd" class="introductory"><h2 id="h2_sotd" role="heading" aria-level="1">Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the
          latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym> technical reports index</a> at
          http://www.w3.org/TR/.</em>
        </p>
        
      <p>This document is not complete. It is subject to major changes and,
      while early experimentations are encouraged, it is therefore not
      intended for implementation. The API is based on preliminary work done
      in the WHATWG.</p>
    
        <p>
          This document was published by the <a href="http://www.w3.org/2011/04/webrtc/">Web Real-Time Communication Working Group</a> and <a href="http://www.w3.org/2009/dap">Device APIs Working Group</a> as an Editor's Draft.
          
          
            If you wish to make comments regarding this document, please send them to 
            <a href="mailto:public-media-capture@w3.org">public-media-capture@w3.org</a> 
            (<a href="mailto:public-media-capture-request@w3.org?subject=subscribe">subscribe</a>,
            <a href="http://lists.w3.org/Archives/Public/public-media-capture/">archives</a>).
          
          
          
          
            All comments are welcome.
          
        </p>
        
        
          <p>
            Publication as an Editor's Draft does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym>
            Membership. This is a draft document and may be updated, replaced or obsoleted by other
            documents at any time. It is inappropriate to cite this document as other than work in
            progress.
          </p>
        
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a id="sotd_patent" about="" rel="w3p:patentRules" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <acronym title="World Wide Web Consortium">W3C</acronym> Patent
            Policy</a>.
          
          
          
            
              <acronym title="World Wide Web Consortium">W3C</acronym> maintains a public list of any patent disclosures (<a href="http://www.w3.org/2004/01/pp-impl/47318/status" rel="disclosure">Web Real-Time Communication Working Group</a>, <a href="http://www.w3.org/2004/01/pp-impl/43696/status" rel="disclosure">Device APIs Working Group</a>)
            
            made in connection with the deliverables of the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent
            which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
          
          
        </p>
        
          <p>This document is governed by the <a id="w3c_process_revision" href="http://www.w3.org/2014/Process-20140801/">1 August 2014 <acronym title="World Wide Web Consortium">W3C</acronym> Process Document</a>.
          </p>
        
        
      
    
  
</section><section id="toc"><h2 id="h2_toc" role="heading" aria-level="1" class="introductory">Table of Contents</h2><ul id="respecContents" role="directory" class="toc"><li class="tocline"><a class="tocxref" href="#intro"><span class="secno">1. </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#conformance"><span class="secno">2. </span>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><span class="secno">3. </span>Terminology</a></li><li class="tocline"><a class="tocxref" href="#stream-api"><span class="secno">4. </span>MediaStream API</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><span class="secno">4.1 </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#mediastream"><span class="secno">4.2 </span>MediaStream</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors"><span class="secno">4.2.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes"><span class="secno">4.2.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods"><span class="secno">4.2.3 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamtrack"><span class="secno">4.3 </span>MediaStreamTrack</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#life-cycle-and-media-flow"><span class="secno">4.3.1 </span>Life-cycle and Media Flow</a></li><li class="tocline"><a class="tocxref" href="#tracks-and-constraints"><span class="secno">4.3.2 </span>Tracks and Constraints</a></li><li class="tocline"><a class="tocxref" href="#media-stream-track-interface-definition"><span class="secno">4.3.3 </span>Interface Definition</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-1"><span class="secno">4.3.3.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-1"><span class="secno">4.3.3.2 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#track-source-types"><span class="secno">4.3.4 </span>Track Source Types</a></li><li class="tocline"><a class="tocxref" href="#media-track-constraints"><span class="secno">4.3.5 </span>MediaTrackConstraints</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-mediatrackconstraints-members"><span class="secno">4.3.5.1 </span>Dictionary <span class="formerLink"><code>MediaTrackConstraints</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-mediatrackconstraintset-members"><span class="secno">4.3.5.2 </span>Dictionary <span class="formerLink"><code>MediaTrackConstraintSet</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamtrackevent"><span class="secno">4.4 </span>MediaStreamTrackEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-1"><span class="secno">4.4.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-2"><span class="secno">4.4.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-mediastreamtrackeventinit-members"><span class="secno">4.4.3 </span>Dictionary <span class="formerLink"><code>MediaStreamTrackEventInit</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#the-model-sources-sinks-constraints-and-settings"><span class="secno">5. </span>The model: sources, sinks, constraints, and settings</a></li><li class="tocline"><a class="tocxref" href="#mediastreams-as-media-elements"><span class="secno">6. </span>MediaStreams as Media Elements</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#direct-assignment-to-media-elements"><span class="secno">6.1 </span>Direct Assignment to Media Elements</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-3"><span class="secno">6.1.1 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#loading-and-playing-a-mediastream-in-a-media-element"><span class="secno">6.2 </span>Loading and Playing a MediaStream in a Media Element</a></li><li class="tocline"><a class="tocxref" href="#media-element-attributes-when-playing-a-mediastream"><span class="secno">6.3 </span>Media Element Attributes when Playing a MediaStream</a></li></ul></li><li class="tocline"><a class="tocxref" href="#error-handling"><span class="secno">7. </span>Error Handling</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#mediastreamerror"><span class="secno">7.1 </span>MediaStreamError</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-4"><span class="secno">7.1.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#constructors-2"><span class="secno">7.1.2 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-5"><span class="secno">7.1.3 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-mediastreamerroreventinit-members"><span class="secno">7.1.4 </span>Dictionary <span class="formerLink"><code>MediaStreamErrorEventInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#error-names"><span class="secno">7.2 </span>Error names</a></li></ul></li><li class="tocline"><a class="tocxref" href="#event-summary"><span class="secno">8. </span>Event summary</a></li><li class="tocline"><a class="tocxref" href="#enumerating-devices"><span class="secno">9. </span>Enumerating Local Media Devices</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#navigatorusermedia"><span class="secno">9.1 </span>NavigatorUserMedia</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-6"><span class="secno">9.1.1 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediadevices"><span class="secno">9.2 </span>MediaDevices</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-7"><span class="secno">9.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-2"><span class="secno">9.2.2 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#device-info"><span class="secno">9.3 </span>Device Info</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-mediadeviceinfocallback-parameters"><span class="secno">9.3.1 </span>Callback <span class="formerLink"><code>MediaDeviceInfoCallback</code></span> Parameters</a></li><li class="tocline"><a class="tocxref" href="#dictionary-mediadeviceinfo-members"><span class="secno">9.3.2 </span>Dictionary <span class="formerLink"><code>MediaDeviceInfo</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#local-content"><span class="secno">10. </span>Obtaining local multimedia content</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#navigatorusermedia-interface-extensions"><span class="secno">10.1 </span>NavigatorUserMedia Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-3"><span class="secno">10.1.1 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediadevices-interface-extensions"><span class="secno">10.2 </span>MediaDevices Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-4"><span class="secno">10.2.1 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamconstraints"><span class="secno">10.3 </span>MediaStreamConstraints</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-mediastreamconstraints-members"><span class="secno">10.3.1 </span>Dictionary <span class="formerLink"><code>MediaStreamConstraints</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#navigatorusermediasuccesscallback"><span class="secno">10.4 </span>NavigatorUserMediaSuccessCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-navigatorusermediasuccesscallback-parameters"><span class="secno">10.4.1 </span>Callback <span class="formerLink"><code>NavigatorUserMediaSuccessCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a class="tocxref" href="#navigatorusermediaerrorcallback"><span class="secno">10.5 </span>NavigatorUserMediaErrorCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-navigatorusermediaerrorcallback-parameters"><span class="secno">10.5.1 </span>Callback <span class="formerLink"><code>NavigatorUserMediaErrorCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a class="tocxref" href="#implementation-suggestions"><span class="secno">10.6 </span>Implementation Suggestions</a></li></ul></li><li class="tocline"><a class="tocxref" href="#constrainable-interface"><span class="secno">11. </span>Constrainable Pattern</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#interface-definition"><span class="secno">11.1 </span>Interface Definition</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-8"><span class="secno">11.1.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-5"><span class="secno">11.1.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#applyconstraints-failure-callback"><span class="secno">11.1.3 </span>applyConstraints Failure Callback</a><ul class="toc"></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#registry"><span class="secno">11.2 </span>The Property Registry</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-constraindoublerange-members"><span class="secno">11.2.1 </span>Dictionary <span class="formerLink"><code>ConstrainDoubleRange</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-constrainlongrange-members"><span class="secno">11.2.2 </span>Dictionary <span class="formerLink"><code>ConstrainLongRange</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-constraindomstringparameters-members"><span class="secno">11.2.3 </span>Dictionary <span class="formerLink"><code>ConstrainDOMStringParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-constrainvideofacingmodeparameters-members"><span class="secno">11.2.4 </span>Dictionary <span class="formerLink"><code>ConstrainVideoFacingModeParameters</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#capabilities"><span class="secno">11.3 </span>Capabilities</a></li><li class="tocline"><a class="tocxref" href="#settings"><span class="secno">11.4 </span>
          <span>Settings</span>
        </a></li><li class="tocline"><a class="tocxref" href="#constraints"><span class="secno">11.5 </span>
          <span>Constraints and ConstraintSet</span>
        </a></li></ul></li><li class="tocline"><a class="tocxref" href="#examples"><span class="secno">12. </span>Examples</a></li><li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><span class="secno">13. </span>Privacy and Security Considerations</a></li><li class="tocline"><a class="tocxref" href="#iana-registrations"><span class="secno">14. </span>IANA Registrations</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#track-property-registrations"><span class="secno">14.1 </span>Track Property Registrations</a></li></ul></li><li class="tocline"><a class="tocxref" href="#change-log"><span class="secno">15. </span>Change Log</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><span class="secno">A. </span>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><span class="secno">B. </span>References</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><span class="secno">B.1 </span>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><span class="secno">B.2 </span>Informative references</a></li></ul></li></ul></section>

    

    <section rel="bibo:Chapter" resource="#intro" typeof="bibo:Chapter" class="informative" id="intro">
      <!--OddPage--><h2 id="h2_intro" role="heading" aria-level="1"><span class="secno">1. </span>Introduction</h2><p><em>This section is non-normative.</em></p>

      <p>Access to multimedia streams (video, audio, or both) from local
      devices (video cameras, microphones, Web cams) can have a number of
      uses, such as real-time communication, recording, and surveillance.</p>

      <p>This document defines the APIs used to get access to local devices
      that can generate multimedia stream data. This document also defines the
      MediaStream API by which JavaScript is able to manipulate the stream
      data or otherwise process it.</p>
    </section>

    <section rel="bibo:Chapter" resource="#conformance" typeof="bibo:Chapter" id="conformance"><!--OddPage--><h2 id="h2_conformance" role="heading" aria-level="1"><span class="secno">2. </span>Conformance</h2>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p>
  The key words <em title="MUST" class="rfc2119">MUST</em>, <em title="MUST NOT" class="rfc2119">MUST NOT</em>, <em title="REQUIRED" class="rfc2119">REQUIRED</em>, <em title="SHOULD" class="rfc2119">SHOULD</em>, <em title="SHOULD NOT" class="rfc2119">SHOULD NOT</em>, <em title="RECOMMENDED" class="rfc2119">RECOMMENDED</em>, <em title="MAY" class="rfc2119">MAY</em>,
  and <em title="OPTIONAL" class="rfc2119">OPTIONAL</em> in this specification are to be interpreted as described in [<cite><a href="#bib-RFC2119" class="bibref">RFC2119</a></cite>].
</p>

      <p>This specification defines conformance criteria that apply to a
      single product: the <dfn id="dfn-user-agent">user agent</dfn> that implements the interfaces
      that it contains.</p>

      <p>Conformance requirements phrased as algorithms or specific steps may
      be implemented in any manner, so long as the end result is equivalent.
      (In particular, the algorithms defined in this specification are
      intended to be easy to follow, and not intended to be performant.)</p>

      <p>Implementations that use ECMAScript to implement the APIs defined in
      this specification must implement them in a manner consistent with the
      ECMAScript Bindings defined in the Web IDL specification [<cite><a href="#bib-WEBIDL" class="bibref">WEBIDL</a></cite>], as
      this specification uses that specification and terminology.</p>
    </section>

    <section id="terminology">
      <!--OddPage--><h2 id="h2_terminology" role="heading" aria-level="1"><span class="secno">3. </span>Terminology</h2>

      <dl>
        <dt>
          <i>HTML Terms:</i>
        </dt>

        <dd>
          <p>The <code>
              <a href="http://dev.w3.org/html5/spec/webappapis.html#eventhandler">EventHandler</a>
            </code> interface represents a callback used for event handlers as
          defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

          <p>The concepts <dfn id="dfn-queue-a-task">
              <a href="http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue
              a task</a>
            </dfn> and <dfn id="dfn-fires-a-simple-event">
              <a href="http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">fires
              a simple event</a>
            </dfn> are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

          <p>The terms <dfn id="dfn-event-handlers">
              <a href="http://dev.w3.org/html5/spec/webappapis.html#event-handlers">event
              handlers</a>
            </dfn> and <dfn id="dfn-event-handler-event-types">
              <a href="http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">
              event handler event types</a>
            </dfn> are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>
        </dd>

        <dt>
          <dfn id="dfn-source">source</dfn>
        </dt>

        <dd>
          <p>A source is the "thing" providing the source of a media stream
          track. The source is the broadcaster of the media itself. A source
          can be a physical webcam, microphone, local video or audio file from
          the user's hard drive, network resource, or static image.</p>

          <p>Other than the source identifier (defined in
            <code><a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>.deviceId</code>),
          other bits of source identity are
          <strong>never</strong> directly available to the application until
          the user agent connects a source to a track. Once a source has been
          "released" to the application (either via a permissions UI,
          pre-configured allow-list, or some other release mechanism) the
          application will be able discover additional source-specific
          capabilities.</p>

          <p>Sources <strong>do not</strong> have constraints -- tracks have
          constraints. When a source is connected to a track, it must,
          possibly in combination with UA processing (e.g., downsampling),
          conform to the constraints present on that track (or set of
          tracks).</p>

          <p>Sources are released (un-attached) from a track when the
          track is ended for any reason.</p>

          <p>On the <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object, sources are represented by a <code>
              <a class="internalDFN" href="#dfn-sourcetype">sourceType</a>
            </code> attribute. The behavior of APIs associated with the
          source's capabilities and settings change depending on the source
          type.</p>

          <p>Sources have <code>
              <a class="internalDFN" href="#dfn-capabilities">capabilities</a>
            </code> and <code>
              <a class="internalDFN" href="#dfn-settings">settings</a>
            </code>. The capabilities and settings are "owned" by the source
          and are common to any (multiple) tracks that happen to be using the
          same source (e.g., if two different track objects bound to the same
          source ask for the same capability or setting information, they will
          get back the same answer).</p>
        </dd>

        <dt> <a class="internalDFN" href="#dfn-setting">Setting</a> (Source Setting) </dt>

        <dd>
          <p>A setting refers to the immediate, current value of the source's
          (optionally constrained) capabilities. Settings are always
          read-only.</p>

          <p>A source's settings can change dynamically over time due to
          environmental conditions, sink configurations, or constraint
          changes. A source's settings must always conform to the current set
          of mandatory constraints that all of the tracks it is bound to have
          defined, and should do its best to conform to the set of optional
          constraints specified.</p>

          <p>Although settings are a property of the source, they are only
          exposed to the application through the tracks attached to the
          source. The <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a> interface provides this
          exposure.</p>
        </dd>

        <dt>
          <a class="internalDFN" href="#dfn-capabilities">Capabilities</a>
        </dt>

        <dd>
          <p>Source capabilities are the intrinsic "features" of a source
          object. For each source setting, there is a corresponding capability
          that describes whether it is supported by the source and if so, what
          the range of supported values are. As with settings, capabilities
          are exposed to the application via the <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a>
          interface.</p>

          <p>The values of the supported capabilities must be normalized to
          the ranges and enumerated types defined in this specification.</p>

          <p>A <a class="internalDFN" href="#dfn-getcapabilities">getCapabilities()</a> call on a track returns the same
          underlying per-source capabilities for all tracks connected to the
          source.</p>

          <p>Source capabilities are effectively constant. Applications should
          be able to depend on a specific source having the same capabilities
          for any session.</p>
        </dd>

        <dt>
          <dfn id="dfn-constraints">Constraints</dfn>
        </dt>

        <dd>
          <p>Constraints are an optional track feature for restricting the
          range of allowed variability on a source. Without provided track
          constraints, implementations are free to select a source's settings
          from the full ranges of its supported capabilities, and to adjust
          those settings at any time for any reason.</p>

          <p>Constraints are exposed on tracks via the
          <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a> interface, which includes an API for
          dynamically changing constraints. Note that <a class="internalDFN" href="#dom-mediadevices-getusermedia">getUserMedia()</a>
          also permits an initial set of constraints to be applied when the
          track is first obtained.</p>

          <p>It is possible for two tracks that share a unique source to apply
          contradictory constraints. The <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a> interface
          supports the calling of an error handler when the conflicting
          constraint is requested.</p>

          <p>A correspondingly-named constraint exists for each corresponding
          source setting name and capability name. In general, user agents
          will have more flexibility to optimize the media streaming
          experience the fewer constraints are applied, so application authors
          are strongly encouraged to use mandatory constraints sparingly.</p>
        </dd>

        <dt>
          <code>RTCPeerConnection</code>
        </dt>

        <dd><dfn id="dfn-rtcpeerconnection">
            <code>RTCPeerConnection</code>
          </dfn> is defined in [<cite><a href="#bib-WEBRTC10" class="bibref">WEBRTC10</a></cite>].</dd>
      </dl>
    </section>

    <section rel="bibo:Chapter" resource="#stream-api" typeof="bibo:Chapter" id="stream-api">
      <!--OddPage--><h2 id="h2_stream-api" role="heading" aria-level="1"><span class="secno">4. </span>MediaStream API</h2>

      <section id="introduction">
        <h3 id="h3_introduction" role="heading" aria-level="2"><span class="secno">4.1 </span>Introduction</h3>

        <p>The two main components in the MediaStream API are the <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> and the <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> interfaces. The <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> object represents media originating from a single media
        source in the user agent, e.g. video from a web camera. A <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> is used group several <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects into one unit that can be rendered in a media
        element or recorded.</p>

        <p>Each <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> can contain zero or more <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects. All tracks in a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> are intended to be synchronized when rendered. Different
        <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> objects do not need to be synchronized.</p>

        <div class="note"><div id="h_note_1" role="heading" aria-level="3" class="note-title"><span>Note</span></div><p class="">While the intent is to synchronize tracks, it could be
        better in some circumstances to permit tracks to lose
        synchronization.In particular, when tracks are remotely sourced and
        real-time [<cite><a href="#bib-WEBRTC10" class="bibref">WEBRTC10</a></cite>], it can be better to allow loss of
        synchronization than to accumulate delays or risk glitches and other
        artifacts. Implementations are expected to understand the implications
        of choices regarding synchronization of playback and the effect that
        these have on user perception.</p></div>

        <p>A <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> represents content comprising one or more channels, where
        the channels have a defined well known relationship to each other
        (such as a stereo or 5.1 audio signal). A channel is the smallest unit
        considered in this API specification.</p>

        <p>
          <img alt="A MediaStream" src="images/media-stream.png" width="418">
        </p>

        <p>A <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> object has an input and an output that represent the
        combined input and output of all the object's tracks. The output of
        the <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> controls how the object is rendered, e.g., what is saved if
        the object is recorded to a file or what is displayed if the object is
        used in a <code>video</code> element.</p>

        <p>A new <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> object can be created from accessible media sources (that
        does not require any additional permissions) using the <code>
            <a href="#dom-mediastream">MediaStream()</a>
          </code> constructor. The constructor argument can either be an
        existing <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> object, in which case all the tracks of the given stream are
        added to the new <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> object, or an array of <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects. The latter form makes it possible to compose a
        stream from different source streams.</p>

        <p>Both <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> and <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects can be cloned. This allows for greater control since
        the separate instances can be manipulated and <a class="internalDFN" href="#dfn-consumer" title="consumer">consumed</a> individually. A cloned <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> contains clones of all member tracks from the original
        stream.</p>

        <p>When a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> object is being generated from a local file (as opposed to a
        live audio/video source), the user agent <em title="SHOULD" class="rfc2119">SHOULD</em> stream the data from
        the file in real time, not all at once. The <code>MediaStream</code>
        object is also used in contexts outside <code>getUserMedia</code>,
        such as [<cite><a href="#bib-WEBRTC10" class="bibref">WEBRTC10</a></cite>]. In both cases, ensuring a realtime stream
        reduces the ease with which pages can distinguish live video from
        pre-recorded video, which can help protect the user's privacy.</p>
      </section>

      <section id="mediastream">
        <h3 id="h3_mediastream" role="heading" aria-level="2"><span class="secno">4.2 </span>MediaStream</h3>

        <p>The <dfn id="dom-mediastream">
            <code>MediaStream()</code>
          </dfn> constructor composes a new stream out of existing tracks. It
        takes an optional argument of type <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> or an array of <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects. <dfn id="mediastream-constructor">When the
        constructor is invoked</dfn>, the UA must run the following steps:</p>

        <ol>
          <li>
            <p>Let <var>stream</var> be a newly constructed <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> object.</p>
          </li>

          <li>
            <p>Initialize <var>stream's</var> <code>
                <a href="#dom-mediastream-id">id</a>
              </code> attribute to a newly generated value.</p>
          </li>

          <li>
            <p>If the constructor's argument is present, run the sub steps
            that corresponds to the argument type.</p>

            <ul>
              <li>
                <p><code>Array</code> of <code>
                    <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                  </code> objects:</p>

                <p>Run the following sub steps for each <code>
                    <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                  </code> in the array:</p>

                <ol>
                  <li>
                    <p><em>Add track</em>: Let <var>track</var> be the <code>
                        <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                      </code> about to be processed.</p>
                  </li>

                  <li>
                    <p>Add <var>track</var> to <var>stream</var>'s <a href="#track-set">track set</a>.</p>
                  </li>
                </ol>
              </li>

              <li>
                <p><code>
                    <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                  </code>:</p>

                <p>Run the sub steps labeled <em>Add track</em> (above) for
                every <code>
                    <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                  </code> in the argument stream's <a href="#track-set">track
                set</a>.</p>
              </li>
            </ul>
          </li>

          <li>
            <p>If <var>stream</var>'s <a href="#track-set">track set</a> is
            empty or only contains ended tracks, set <var>stream</var>'s <code>
                <a href="#dom-mediastream-active">active</a>
              </code> attribute to <code>false</code>, otherwise set it to
            <code>true</code>.</p>
          </li>

          <li>
            <p>Return <var>stream</var>.</p>
          </li>
        </ol>

        <p>The tracks of a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> are stored in a <dfn id="track-set">track set</dfn>. The
        track set <em title="MUST" class="rfc2119">MUST</em> contain the <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects that correspond to the tracks of the stream. The
        relative order of the tracks in the set is user agent defined and the
        API will never put any requirements on the order. The proper way to
        find a specific <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> object in the set is to look it up by its <code>
            <a href="#dom-mediastreamtrack-id">id</a>
          </code>.</p>

        <p>An object that reads data from the output of a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> is referred to as a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> <dfn id="dfn-consumer">consumer</dfn>. The list of <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> consumers currently include the media elements [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>],
        <code>RTCPeerConnection</code> [<cite><a href="#bib-WEBRTC10" class="bibref">WEBRTC10</a></cite>],
        <code>MediaRecorder</code> [<cite><a href="#bib-mediastream-recording" class="bibref">mediastream-recording</a></cite>] and
        <code>ImageCapture</code> [<cite><a href="#bib-image-capture" class="bibref">image-capture</a></cite>].</p>

        <div class="note"><div id="h_note_2" role="heading" aria-level="3" class="note-title"><span>Note</span></div><p class=""><code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> consumers must be able to handle tracks being added and
        removed. This behavior is specified per consumer.</p></div>

        <p>A <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> object is said to be <dfn id="stream-inactive">MediaStream.inactive</dfn> when it does not have
        any tracks or all tracks belonging to the stream have <a href="#track-ended">ended</a>. Otherwise the stream is active. A <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> can start its life as inactive if it is constructed without
        any tracks.</p>

        <p>When a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> goes from being active to inactive, the user agent <em title="MUST" class="rfc2119">MUST</em>
        queue a task that sets the object's <code>
            <a href="#dom-mediastream-active">active</a>
          </code> attribute to <code>false</code> and fire a simple event
        named <code>
            <a href="#event-mediastream-inactive">inactive</a>
          </code> at the object. When a <code>
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
          </code> goes from being inactive to active, the user agent <em title="MUST" class="rfc2119">MUST</em>
        queue a task that sets the object's <code>
            <a href="#dom-mediastream-active">active</a>
          </code> attribute to <code>true</code> and fire a simple event named
        <code>
            <a href="#event-mediastream-active">active</a>
          </code> at the object.</p>

        <p>If the stream's activity status changed due to a user request, the
        task source for this <span title="concept-task">task</span> is the
        user interaction task source. Otherwise the task source for this <span title="concept-task">task</span> is the networking task source.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaStream">[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-MediaStream">Constructor</a></span></span>,
<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-MediaStream--MediaStream-stream">Constructor</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></span> <span class="idlParamName">stream</span></span>)</span>,
<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-MediaStream--sequence-MediaStreamTrack--tracks">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</span> <span class="idlParamName">tracks</span></span>)</span>]
interface <span class="idlInterfaceID">MediaStream</span> : <span class="idlSuperclass">EventTarget</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>    <span class="idlAttrName"><a href="#widl-MediaStream-id">id</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-MediaStream-getAudioTracks-sequence-MediaStreamTrack">getAudioTracks</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-MediaStream-getVideoTracks-sequence-MediaStreamTrack">getVideoTracks</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-MediaStream-getTracks-sequence-MediaStreamTrack">getTracks</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>?</span>          <span class="idlMethName"><a href="#widl-MediaStream-getTrackById-MediaStreamTrack-DOMString-trackId">getTrackById</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">trackId</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                       <span class="idlMethName"><a href="#widl-MediaStream-addTrack-void-MediaStreamTrack-track">addTrack</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span> <span class="idlParamName">track</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                       <span class="idlMethName"><a href="#widl-MediaStream-removeTrack-void-MediaStreamTrack-track">removeTrack</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span> <span class="idlParamName">track</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></span>                <span class="idlMethName"><a href="#widl-MediaStream-clone-MediaStream">clone</a></span> ();</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">boolean</span>      <span class="idlAttrName"><a href="#widl-MediaStream-active">active</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-MediaStream-onactive">onactive</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-MediaStream-oninactive">oninactive</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-MediaStream-onaddtrack">onaddtrack</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-MediaStream-onremovetrack">onremovetrack</a></span>;</span>
};</span></pre><section id="constructors"><h4 id="h4_constructors" role="heading" aria-level="3"><span class="secno">4.2.1 </span>Constructors</h4><dl class="constructors"><dt id="widl-ctor-MediaStream"><code>MediaStream</code></dt><dd> See the <a href="#mediastream-constructor">MediaStream
          constructor algorithm</a> <div><em>No parameters.</em></div></dd><dt id="widl-ctor-MediaStream--MediaStream-stream"><code>MediaStream</code></dt><dd> See the <a href="#mediastream-constructor">MediaStream
          constructor algorithm</a> <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">stream</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table></dd><dt id="widl-ctor-MediaStream--sequence-MediaStreamTrack--tracks"><code>MediaStream</code></dt><dd> See the <a href="#mediastream-constructor">MediaStream
          constructor algorithm</a> <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">tracks</td><td class="prmType"><code>sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section id="attributes"><h4 id="h4_attributes" role="heading" aria-level="3"><span class="secno">4.2.2 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaStream-active"><code>active</code> of type <span class="idlAttrType">boolean</span>, readonly   </dt><dd>
            <p>The <dfn id="dom-mediastream-active">
                <code>MediaStream.active</code>
              </dfn> attribute returns true if the <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> is active (see <a href="#stream-inactive">inactive</a>),
            and false otherwise.</p>

            <p>When a <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> object is created, its <code>
                <a href="#dom-mediastream-active">active</a>
              </code> attribute <em title="MUST" class="rfc2119">MUST</em> be set to true, unless stated otherwise
            (for example by the <code>
                <a href="#dom-mediastream">MediaStream()</a>
              </code> constructor algorithm).</p>
          </dd><dt id="widl-MediaStream-id"><code>id</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
            <p>When a <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> object is created, the user agent <em title="MUST" class="rfc2119">MUST</em> generate an
            identifier string, and <em title="MUST" class="rfc2119">MUST</em> initialize the object's <code>
                <a href="#dom-mediastream-id">id</a>
              </code> attribute to that string. A good practice is to use an
            UUID, which is 36 characters long in its canonical form.</p>

            <p>The <dfn id="dom-mediastream-id">
                <code>id</code>
              </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the value to which it was
            initialized when the object was created.</p>
          </dd><dt id="widl-MediaStream-onactive"><code>onactive</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
              <a href="#event-mediastream-active">active</a>
            </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
              <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
            </code> interface.</dd><dt id="widl-MediaStream-onaddtrack"><code>onaddtrack</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
              <a href="#event-mediastream-addtrack">addtrack</a>
            </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
              <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
            </code> interface.</dd><dt id="widl-MediaStream-oninactive"><code>oninactive</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
              <a href="#event-mediastream-inactive">inactive</a>
            </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
              <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
            </code> interface.</dd><dt id="widl-MediaStream-onremovetrack"><code>onremovetrack</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
              <a href="#event-mediastream-removetrack">removetrack</a>
            </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
              <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
            </code> interface.</dd></dl></section><section id="methods"><h4 id="h4_methods" role="heading" aria-level="3"><span class="secno">4.2.3 </span>Methods</h4><dl class="methods"><dt id="widl-MediaStream-addTrack-void-MediaStreamTrack-track"><code>addTrack</code></dt><dd>
            <p>Adds the given <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> to this <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>.</p>

            <p>When the <dfn id="dom-mediastream-addtrack">
                <code>addTrack()</code>
              </dfn> method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following
            steps:</p>

            <ol>
              <li>
                <p>Let <var>track</var> be the <code>
                    <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                  </code> argument and <var>stream</var> this <code>
                    <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                  </code> object.</p>
              </li>

              <li>
                <p>If <var>track</var> is already in <var>stream's</var> <a href="#track-set">track set</a>, then abort these steps.</p>
              </li>

              <li>
                <p>Add <var>track</var> to <var>stream</var>'s <a href="#track-set">track set</a>.</p>
              </li>
            </ol>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">track</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-MediaStream-clone-MediaStream"><code>clone</code></dt><dd>
            <p>Clones the given <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> and all its tracks.</p>

            <p>When the <dfn id="dom-mediastream-clone">
                <code>MediaStream.clone()</code>
              </dfn> method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following
            steps:</p>

            <ol>
              <li>
                <p>Let <var>streamClone</var> be a newly constructed <code>
                    <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                  </code> object.</p>
              </li>

              <li>
                <p>Initialize <var>streamClone</var>'s <code>
                    <a href="#dom-mediastream-id">id</a>
                  </code> attribute to a newly generated value.</p>
              </li>

              <li>
                <p>Let <var>clonedTracks</var> be a list that contains the
                result of running <code>
                    <a href="#dom-mediastreamtrack-clone">MediaStreamTrack.clone()</a>
                  </code> on all the tracks in the stream on which this method
                was called. </p>
              </li>

              <li>
                <p>Let <var>clonedTracks</var> be <var>streamClone</var>'s <a href="#track-set">track set</a>.</p>
              </li>

              <li>Return <var>streamClone</var>.</li>
            </ol>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></code></div></dd><dt id="widl-MediaStream-getAudioTracks-sequence-MediaStreamTrack"><code>getAudioTracks</code></dt><dd>
            <p>Returns a sequence of <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> objects representing the audio tracks in this
            stream.</p>

            <p>The <dfn id="dom-mediastream-getaudiotracks">
                <code>getAudioTracks()</code>
              </dfn> method <em title="MUST" class="rfc2119">MUST</em> return a sequence that represents a snapshot
            of all the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> objects in this stream's <a href="#track-set">track
            set</a> whose <code>
                <a href="#dom-mediastreamtrack-kind">kind</a>
              </code> is equal to "<code>audio</code>". The conversion from
            the <a href="#track-set">track set</a> to the sequence is user
            agent defined and the order does not have to stable between
            calls.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</code></div></dd><dt id="widl-MediaStream-getTrackById-MediaStreamTrack-DOMString-trackId"><code>getTrackById</code></dt><dd>
            <p>The <dfn id="dom-mediastream-gettrackbyid">
                <code>getTrackById()</code>
              </dfn> method <em title="MUST" class="rfc2119">MUST</em> return the first <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> object in this stream's <a href="#track-set">track
            set</a> whose <code>
                <a href="#dom-mediastreamtrack-id">id</a>
              </code> is equal to <var>trackId</var>. The method <em title="MUST" class="rfc2119">MUST</em> return
            null if no track matches the <var>trackId</var> argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">trackId</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code>, nullable</div></dd><dt id="widl-MediaStream-getTracks-sequence-MediaStreamTrack"><code>getTracks</code></dt><dd>
            <p>Returns a sequence of <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> objects representing all the tracks in this stream.</p>

            <p>The <dfn id="dom-mediastream-gettracks">
                <code>getTracks()</code>
              </dfn> method <em title="MUST" class="rfc2119">MUST</em> return a sequence that represents a snapshot
            of all the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> objects in this stream's <a href="#track-set">track
            set</a>, regardless of kind. The conversion from the <a href="#track-set">track set</a> to the sequence is user agent
            defined and the order does not have to stable between calls.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</code></div></dd><dt id="widl-MediaStream-getVideoTracks-sequence-MediaStreamTrack"><code>getVideoTracks</code></dt><dd>
            <p>Returns a sequence of <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> objects representing the video tracks in this
            stream.</p>

            <p>The <dfn id="dom-mediastream-getvideotracks">
                <code>getVideoTracks()</code>
              </dfn> method <em title="MUST" class="rfc2119">MUST</em> return a sequence that represents a snapshot
            of all the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> objects in this stream's <a href="#track-set">track
            set</a> whose <code>
                <a href="#dom-mediastreamtrack-kind">kind</a>
              </code> is equal to "<code>video</code>". The conversion from
            the <a href="#track-set">track set</a> to the sequence is user
            agent defined and the order does not have to stable between
            calls.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>&gt;</code></div></dd><dt id="widl-MediaStream-removeTrack-void-MediaStreamTrack-track"><code>removeTrack</code></dt><dd>
            <p>Removes the given <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> from this <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>.</p>

            <p>When the <dfn id="dom-mediastream-removetrack">
                <code>removeTrack()</code>
              </dfn> method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> remove the track,
            indicated by the method's argument, from the stream's <a href="#track-set">track set</a>, if present.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">track</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
      </section>

      <section id="mediastreamtrack">
        <h3 id="h3_mediastreamtrack" role="heading" aria-level="2"><span class="secno">4.3 </span>MediaStreamTrack</h3>

        <p>A <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> object represents a media source in the user agent. Several
        <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects can represent the same media source, e.g., when the
        user chooses the same camera in the UI shown by two consecutive calls
        to <code>
            <a href="#dom-mediadevices-getusermedia">getUserMedia()</a>
          </code> .</p>

        <p>The data from a <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> object does not necessarily have a canonical binary form;
        for example, it could just be "the video currently coming from the
        user's video camera". This allows user agents to manipulate media in
        whatever fashion is most suitable on the user's platform.</p>

        <p>A script can indicate that a track no longer needs its source with
        the <code>
            <a href="#dom-mediastreamtrack-stop">MediaStreamTrack.stop()</a>
          </code> method. When all tracks using a source have been stopped,
        the given permission for that source is revoked and the source is <dfn id="source-stopped">stopped</dfn>. If the data is being generated from
        a live source (e.g., a microphone or camera), then the user agent
        <em title="SHOULD" class="rfc2119">SHOULD</em> remove any active "on-air" indicator for that source. If the
        data is being generated from a prerecorded source (e.g. a video file),
        any remaining content in the file is ignored. An implementation may
        use a per source reference count to keep track of source usage, but
        the specifics are out of scope for this specification.</p>

        <p>If there is no stored permission to use that source, the UA <em title="SHOULD" class="rfc2119">SHOULD</em>
        also remove the "permission granted" indicator for the source.</p>

        <section id="life-cycle-and-media-flow">
          <h4 id="h4_life-cycle-and-media-flow" role="heading" aria-level="3"><span class="secno">4.3.1 </span>Life-cycle and Media Flow</h4>

          <h4 id="life-cycle">Life-cycle</h4>

          <p>A <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> has two stages in its life-cycle: <code>live</code> and
          <code>ended</code>. A newly created <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> can be in any stage depending on how it was created. For
          example, cloning an ended track results in a new ended track. The
          current stage is reflected by the object's <code>
              <a href="#dom-mediastreamtrack-readystate">readyState</a>
            </code> attribute.</p>

          <p>In the <code>live</code> state, the track is active and media is
          available for use by consumers (but may be replaced by
          zero-information-content if the <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> is <a href="#track-muted">muted</a> or <a href="#track-enabled">enabled</a>, see below).</p>

          <p>A muted or disabled <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> renders either silence (audio), black frames (video), or a
          zero-information-content equivalent. For example, a video element
          sourced by a muted or disabled <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> (contained within a <code>
              <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
            </code>), is playing but the rendered content is the muted output.
          When all tracks connected to a source are muted or disabled, the
          "on-air" or "recording" indicator for that source can be turned off;
          when the track is no longer muted or disabled, it <em title="MUST" class="rfc2119">MUST</em> be turned
          back on.</p>

          <p>The muted/unmuted state of a track reflects if the source
          provides any media at this moment. The enabled/disabled state is
          under application control and determines if the track outputs media
          (to its consumers). Hence, media from the source only flows when a
          <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object is both unmuted and enabled.</p>

          <p>A <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> is <a href="#track-muted">muted</a> when the source is
          temporarily unable to provide the track with data. A track can be
          muted by a user. Often this action is outside the control of the
          application. This could be as a result of the user hitting a
          hardware switch, or toggling a control in the operating system or
          browser chrome. A track can also be muted by the user agent.</p>

          <p>Applications are able to <a href="#track-enabled">enable</a> or
          disable a <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> to prevent it from rendering media from the source. A
          muted track will however, regardless of the enabled state, render
          silence and blackness. A disabled track is logically equivalent to a
          muted track, from a consumer point of view.</p>

          <p>For a newly created <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object, the following applies. The track is always enabled
          unless stated otherwise (for example when cloned) and the muted
          state reflects the state of the source at the time the track is
          created.</p>

          <p>A <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object is said to <em>end</em> when the source of the
          track is disconnected or exhausted.</p>

          <p>A <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> can be <dfn id="track-detached">detached</dfn> from its
          source. It means that the track is no longer dependent on the source
          for media data. If no other <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> is using the same source, the source will be <a href="#source-stopped">stopped</a>. <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> attributes such as <code>
              <a href="#dom-mediastreamtrack-kind">kind</a>
            </code> and <code>
              <a href="#dom-mediastreamtrack-label">label</a>
            </code> <em title="MUST" class="rfc2119">MUST</em> not change values when the source is detached.</p>

          <p>When a <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object ends for any reason (e.g., because the user
          rescinds the permission for the page to use the local camera, or
          because the data comes from a finite file and the file's end has
          been reached and the user has not requested that it be looped, or
          because the application invoked the <code>
              <a href="#dom-mediastreamtrack-stop">stop()</a>
            </code> method on the <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object, or because the UA has instructed the track to end
          for any reason) it is said to be <dfn id="track-ended">ended</dfn>.</p>

          <p>When a <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> <var>track</var> ends for any reason other than the <code>
              <a href="#dom-mediastreamtrack-stop">stop()</a>
            </code> method being invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> queue a task
          that runs the following steps:</p>

          <ol>
            <li>
              <p>If the <var>track's</var> <code>
                  <a href="#dom-mediastreamtrack-readystate">readyState</a>
                </code> attribute has the value <code>ended</code> already,
              then abort these steps.</p>
            </li>

            <li>
              <p>Set <var>track's</var> <code>
                  <a href="#dom-mediastreamtrack-readystate">readyState</a>
                </code> attribute to <code>ended</code>.</p>
            </li>

            <li>
              <p><a href="#track-detached">Detach</a> <var>track's</var>
              source.</p>
            </li>

            <li>
              <p>Fire a simple event named <code>
                  <a href="#event-mediastreamtrack-ended">ended</a>
                </code> at the object.</p>
            </li>
          </ol>

          <p>If the end of the stream was reached due to a user request, the
          event source for this event is the user interaction event
          source.</p>

          <h4 id="media-flow">Media Flow</h4>

          <p>There are two concepts related to the media flow for a
          <code>live</code> <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code>: muted or not, and enabled or disabled.</p>

          <p><dfn id="track-muted">Muted</dfn> refers to the input to the
          <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code>. If live samples are not made available to the <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> it is muted.</p>

          <p>Muted is out of control for the application, but can be observed
          by the application by reading the <code>
              <a href="#dom-mediastreamtrack-muted">muted</a>
            </code> attribute and listening to the associated events <code>
              <a href="#event-mediastreamtrack-mute">mute</a>
            </code> and <code>
              <a href="#event-mediastreamtrack-unmute">unmute</a>
            </code>.There can be several reasons for a <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> to be muted: the user pushing a physical mute button on
          the microphone, the user toggling a control in the operating system,
          the user clicking a mute button in the browser chrome, the UA (on
          behalf of the user) mutes, etc.</p>

          <p><dfn id="track-enabled">Enabled/disabled</dfn> on the other hand
          is available to application to control (and observe) via the <code>
              <a href="#dom-mediastreamtrack-enabled">enabled</a>
            </code> attribute.</p>

          <p>The result for the consumer is the same in the meaning that
          whenever <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> is muted or disabled (or both) the consumer gets
          zero-information-content, which means silence for audio and black
          frames for video. In other words, media from the source only flows
          when a <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object is both unmuted and enabled. For example, a video
          element sourced by a muted or disabled <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> (contained in a <code>
              <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
            </code>), is playing but rendering blackness.</p>

          <p>For a newly created <code>
              <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
            </code> object, the following applies: the track is always enabled
          unless stated otherwise (for example when cloned) and the muted
          state reflects the state of the source at the time the track is
          created.</p>
        </section>

        <section id="tracks-and-constraints">
          <h4 id="h4_tracks-and-constraints" role="heading" aria-level="3"><span class="secno">4.3.2 </span>Tracks and Constraints</h4>

          <p>Constraints are set on tracks and may affect sources.</p>

          <p>Whether <code>
              <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a>
            </code> were provided at track initialization time or need to be
          established later at runtime, the APIs defined in the
          <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a> Interface allow the retrieval and
          manipulation of the constraints currently established on a
          track.</p>

          <p>Each track maintains an internal version of the <code>
              <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a>
            </code> structure, namely a mandatory set of constraints (no
          duplicates), and an optional ordered list of individual constraint
          objects (may contain duplicates). The internal stored constraint
          structure is exposed to the application by the <code>
              <a class="internalDFN" href="#dfn-constraints">constraints</a>
            </code> attribute, and may be modified by the <code>
              <a class="internalDFN" href="#dfn-applyconstraints">applyConstraints()</a>
            </code> method.</p>

          <p>When <code>
              <a class="internalDFN" href="#dfn-applyconstraints">applyConstraints()</a>
            </code> is called, a user agent <em title="MUST" class="rfc2119">MUST</em> queue a task to evaluate
          those changes when the task queue is next serviced. Similarly, if
          the <a class="internalDFN" href="#dfn-sourcetype">
              <code>sourceType</code>
            </a> changes, then the user agent <em title="MUST" class="rfc2119">MUST</em> perform the same actions to
          re-evaluate the constraints of each track affected by that source
          change.</p>

          <p>If the <code>
              <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
            </code> event named <code><a class="internalDFN" href="#event-mediastreamtrack-overconstrained">overconstrained</a></code> is thrown, the track <em title="MUST" class="rfc2119">MUST</em> be
          muted until either new satisfiable constraints are applied or the
          existing constraints become satisfiable.</p>
        </section>

        <section rel="bibo:Chapter" resource="#media-stream-track-interface-definition" typeof="bibo:Chapter" id="media-stream-track-interface-definition">
          <h4 id="h4_media-stream-track-interface-definition" role="heading" aria-level="3"><span class="secno">4.3.3 </span>Interface Definition</h4>

          <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamTrack">interface <span class="idlInterfaceID">MediaStreamTrack</span> : <span class="idlSuperclass">EventTarget</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>             <span class="idlAttrName"><a href="#widl-MediaStreamTrack-kind">kind</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>             <span class="idlAttrName"><a href="#widl-MediaStreamTrack-id">id</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>             <span class="idlAttrName"><a href="#widl-MediaStreamTrack-label">label</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">boolean</span>               <span class="idlAttrName"><a href="#widl-MediaStreamTrack-enabled">enabled</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">boolean</span>               <span class="idlAttrName"><a href="#widl-MediaStreamTrack-muted">muted</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-MediaStreamTrack-onmute">onmute</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-MediaStreamTrack-onunmute">onunmute</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">boolean</span>               <span class="idlAttrName"><a href="#widl-MediaStreamTrack-_readonly">_readonly</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">boolean</span>               <span class="idlAttrName"><a href="#widl-MediaStreamTrack-remote">remote</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrackState"><code>MediaStreamTrackState</code></a></span> <span class="idlAttrName"><a href="#widl-MediaStreamTrack-readyState">readyState</a></span>;</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-MediaStreamTrack-onended">onended</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>      <span class="idlMethName"><a href="#widl-MediaStreamTrack-clone-MediaStreamTrack">clone</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                  <span class="idlMethName"><a href="#widl-MediaStreamTrack-stop-void">stop</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="internalDFN" href="#dfn-capabilities">Capabilities</a></span>          <span class="idlMethName"><a href="#widl-MediaStreamTrack-getCapabilities-Capabilities">getCapabilities</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-MediaTrackConstraints"><code>MediaTrackConstraints</code></a></span> <span class="idlMethName"><a href="#widl-MediaStreamTrack-getConstraints-MediaTrackConstraints">getConstraints</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="internalDFN" href="#dfn-settings">Settings</a></span>              <span class="idlMethName"><a href="#widl-MediaStreamTrack-getSettings-Settings">getSettings</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                  <span class="idlMethName"><a href="#widl-MediaStreamTrack-applyConstraints-void-MediaTrackConstraints-constraints-VoidFunction-successCallback-ConstraintErrorCallback-errorCallback">applyConstraints</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaTrackConstraints"><code>MediaTrackConstraints</code></a></span> <span class="idlParamName">constraints</span></span>, <span class="idlParam"><span class="idlParamType">VoidFunction</span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-ConstraintErrorCallback"><code>ConstraintErrorCallback</code></a></span> <span class="idlParamName">errorCallback</span></span>);</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-MediaStreamTrack-onoverconstrained">onoverconstrained</a></span>;</span>
};</span></pre><section id="attributes-1"><h5 id="h5_attributes-1" role="heading" aria-level="4"><span class="secno">4.3.3.1 </span>Attributes</h5><dl class="attributes"><dt id="widl-MediaStreamTrack-enabled"><code>enabled</code> of type <span class="idlAttrType">boolean</span>,            </dt><dd>
              <p>The <dfn id="dom-mediastreamtrack-enabled">
                  <code>MediaStreamTrack.enabled</code>
                </dfn> attribute controls the <code>
                  <a href="#track-enabled">enabled</a>
                </code> state for the object.</p>

              <p>On getting, the attribute <em title="MUST" class="rfc2119">MUST</em> return the last value to which
              it was set. On setting, it <em title="MUST" class="rfc2119">MUST</em> be set to the new value,
              regardless if the <code>
                  <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                </code> object has been <a href="#track-detached">detached</a>
              from its source or not.</p>

              <div class="note"><div id="h_note_3" role="heading" aria-level="5" class="note-title"><span>Note</span></div><p class="">Thus, after a <code>
                  <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                </code> is detached from its source, its <code>
                  <a href="#dom-mediastreamtrack-enabled">enabled</a>
                </code> attribute still changes value when set; it just
              doesn't do anything with that new value.</p></div>
            </dd><dt id="widl-MediaStreamTrack-id"><code>id</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
              <p>Unless a <code>
                  <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                </code> object is created as a part a of special purpose
              algorithm that specifies how the track id must be initialized,
              the user agent <em title="MUST" class="rfc2119">MUST</em> generate an identifier string and initialize
              the object's <code>
                  <a href="#dom-mediastreamtrack-id">id</a>
                </code> attribute to that string. See <code>
                  <a href="#dom-mediastream-id">MediaStream.id</a>
                </code> for guidelines on how to generate such an
              identifier.</p>

              <p>An example of an algorithm that specifies how the track id
              must be initialized is the algorithm to represent an incoming
              network component with a <code>
                  <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                </code> object. [<cite><a href="#bib-WEBRTC10" class="bibref">WEBRTC10</a></cite>]</p>

              <p><dfn id="dom-mediastreamtrack-id">
                  <code>MediaStreamTrack.id</code>
                </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the value to which it was
              initialized when the object was created.</p>
            </dd><dt id="widl-MediaStreamTrack-kind"><code>kind</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
              <p>The <dfn id="dom-mediastreamtrack-kind">
                  <code>MediaStreamTrack.kind</code>
                </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the string "<code>audio</code>"
              if the object represents an audio track or "<code>video</code>"
              if object represents a video track.</p>
            </dd><dt id="widl-MediaStreamTrack-label"><code>label</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
              <p>User agents <em title="MAY" class="rfc2119">MAY</em> label audio and video sources (e.g.,
              "Internal microphone" or "External USB Webcam"). The <dfn id="dom-mediastreamtrack-label">
                  <code>MediaStreamTrack.label</code>
                </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the label of the object's
              corresponding source, if any. If the corresponding source has or
              had no label, the attribute <em title="MUST" class="rfc2119">MUST</em> instead return the empty
              string.</p>
            </dd><dt id="widl-MediaStreamTrack-muted"><code>muted</code> of type <span class="idlAttrType">boolean</span>, readonly   </dt><dd>
              <p>The <dfn id="dom-mediastreamtrack-muted">
                  <code>MediaStreamTrack.muted</code>
                </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return <code>true</code> if the track is
              <a href="#track-muted">muted</a>, and <code>false</code>
              otherwise.</p>
            </dd><dt id="widl-MediaStreamTrack-onended"><code>onended</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
                <a href="#event-mediastreamtrack-ended">ended</a>
              </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> interface.</dd><dt id="widl-MediaStreamTrack-onmute"><code>onmute</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
                <a href="#event-mediastreamtrack-mute">mute</a>
              </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> interface.</dd><dt id="widl-MediaStreamTrack-onoverconstrained"><code>onoverconstrained</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>
              <p>See <a href="#constrainable-interface">ConstrainablePattern
              Interface</a> for the definition of this event handler.</p>
            </dd><dt id="widl-MediaStreamTrack-onunmute"><code>onunmute</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
                <a href="#event-mediastreamtrack-unmute">unmute</a>
              </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> interface.</dd><dt id="widl-MediaStreamTrack-_readonly"><code>readonly</code> of type <span class="idlAttrType">boolean</span>, readonly   </dt><dd>If the track (audio or video) is backed by a read-only source
            such as a file, or the track source is a local microphone or
            camera, but is shared so that constraints applied to the track
            cannot modify the source's settings, the <dfn id="dom-mediastreamtrack-readonly">
                <code>readonly</code>
              </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the value <code>true</code>.
            Otherwise, it must return the value <code>false</code>.</dd><dt id="widl-MediaStreamTrack-readyState"><code>readyState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrackState"><code>MediaStreamTrackState</code></a></span>, readonly   </dt><dd>
              <p>The <dfn id="dom-mediastreamtrack-readystate">
                  <code>readyState</code>
                </dfn> attribute represents the state of the track. It <em title="MUST" class="rfc2119">MUST</em>
              return the value to which the user agent last set it.</p>
            </dd><dt id="widl-MediaStreamTrack-remote"><code>remote</code> of type <span class="idlAttrType">boolean</span>, readonly   </dt><dd>If the track is sourced by a non-local source, the <dfn id="dom-mediastreamtrack-remote">
                <code>remote</code>
              </dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the value <code>true</code>.
            Otherwise, it must return the value <code>false</code>.</dd></dl></section><section id="methods-1"><h5 id="h5_methods-1" role="heading" aria-level="4"><span class="secno">4.3.3.2 </span>Methods</h5><dl class="methods"><dt id="widl-MediaStreamTrack-applyConstraints-void-MediaTrackConstraints-constraints-VoidFunction-successCallback-ConstraintErrorCallback-errorCallback"><code>applyConstraints</code></dt><dd>  See <a href="#constrainable-interface">ConstrainablePattern Interface</a>
            for the definition of this method.<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">constraints</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaTrackConstraints"><code>MediaTrackConstraints</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">A new constraint structure to apply to this object.</td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code>VoidFunction</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">Called if the required constraints can be satisfied.</td></tr><tr><td class="prmName">errorCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-ConstraintErrorCallback"><code>ConstraintErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">Called if the required constraints cannot be
                satisfied.</td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-MediaStreamTrack-clone-MediaStreamTrack"><code>clone</code></dt><dd>
              <p>Clones the given <code>
                  <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                </code>.</p>

              <p>When the <dfn id="dom-mediastreamtrack-clone">
                  <code>MediaStreamTrack.clone()</code>
                </dfn> method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the
              following steps:</p>

              <ol>
                <li>
                  <p>Let <var>trackClone</var> be a newly constructed <code>
                      <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                    </code> object.</p>
                </li>

                <li>
                  <p>Initialize <var>trackClone</var>'s <code>
                      <a href="#dom-mediastreamtrack-id">id</a>
                    </code> attribute to a newly generated value.</p>
                </li>

                <li>
                  <p>Let <var>trackClone</var> inherit this track's underlying
                  source, <code>
                      <a href="#dom-mediastreamtrack-kind">kind</a>
                    </code>, <code>
                      <a href="#dom-mediastreamtrack-label">label</a>
                    </code>, <code>
                      <a href="#dom-mediastreamtrack-readystate">readyState</a>
                    </code>, and <code>
                      <a href="#dom-mediastreamtrack-enabled">enabled</a>
                    </code> attributes, as well as its currently active
                  constraints.</p>
                </li>

                <li>
                  <p>Return <var>trackClone</var>.</p>
                </li>
              </ol>
            <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code></div></dd><dt id="widl-MediaStreamTrack-getCapabilities-Capabilities"><code>getCapabilities</code></dt><dd>
              <p>See <a href="#constrainable-interface">ConstrainablePattern
              Interface</a> for the definition of this method.</p>
            <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="internalDFN" href="#dfn-capabilities">Capabilities</a></code></div></dd><dt id="widl-MediaStreamTrack-getConstraints-MediaTrackConstraints"><code>getConstraints</code></dt><dd>See <a href="#constrainable-interface">ConstrainablePattern
            Interface</a> for the definition of this method. <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-MediaTrackConstraints"><code>MediaTrackConstraints</code></a></code></div></dd><dt id="widl-MediaStreamTrack-getSettings-Settings"><code>getSettings</code></dt><dd>See <a href="#constrainable-interface">ConstrainablePattern
            Interface</a> for the definition of this method. <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="internalDFN" href="#dfn-settings">Settings</a></code></div></dd><dt id="widl-MediaStreamTrack-stop-void"><code>stop</code></dt><dd>
              <p>When a <code>
                  <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                </code> object's <dfn id="dom-mediastreamtrack-stop">
                  <code>stop()</code>
                </dfn> method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run following
              steps:</p>

              <ol>
                <li>
                  <p>Let <var>track</var> be the current <code>
                      <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                    </code> object.</p>
                </li>

                <li>
                  <p>If <var>track</var> is sourced by a non-local source,
                  then abort these steps.</p>
                </li>

                <li>
                  <p>Set <var>track's</var> <code>
                      <a href="#dom-mediastreamtrack-readystate">readyState</a>
                    </code> attribute to <code>ended</code>.</p>
                </li>

                <li>
                  <p><a href="#track-detached">Detach</a> <var>track's</var>
                  source.</p>
                </li>
              </ol>

              <p>The task source for the <span title="concept-task">tasks</span> queued for the <code>
                  <a href="#dom-mediastreamtrack-stop">stop()</a>
                </code> method is the DOM manipulation task source.</p>
            <div><em>No parameters.</em></div><div><em>Return type: </em><code>void</code></div></dd></dl></section>

          <pre class="idl"><span class="idlEnum" id="idl-def-MediaStreamTrackState">enum <span class="idlEnumID">MediaStreamTrackState</span> {
    "<a href="#idl-def-MediaStreamTrackState.live" class="idlEnumItem">live</a>",
    "<a href="#idl-def-MediaStreamTrackState.ended" class="idlEnumItem">ended</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-MediaStreamTrackState.live">live</code></td><td>
              <p>The track is active (the track's underlying media source is
              making a best-effort attempt to provide data in real time).</p>

              <p>The output of a track in the <code>live</code> state can be
              switched on and off with the <code>
                  <a href="#dom-mediastreamtrack-enabled">enabled</a>
                </code> attribute.</p>
            </td></tr><tr><td><code id="idl-def-MediaStreamTrackState.ended">ended</code></td><td>
              <p>The track has <a href="#track-ended">ended</a> (the track's
              underlying media source is no longer providing data, and will
              never provide more data for this track). Once a track enters
              this state, it never exits it.</p>

              <p>For example, a video track in a <code>
                  <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                </code> ends if the user unplugs the USB web camera that acts
              as the track's media source.</p>
            </td></tr></tbody></table>
        </section>

        <section id="track-source-types">
          <h4 id="h4_track-source-types" role="heading" aria-level="3"><span class="secno">4.3.4 </span>Track Source Types</h4>

          <pre class="idl"><span class="idlEnum" id="idl-def-SourceTypeEnum">enum <span class="idlEnumID">SourceTypeEnum</span> {
    "<a href="#idl-def-SourceTypeEnum.camera" class="idlEnumItem">camera</a>",
    "<a href="#idl-def-SourceTypeEnum.microphone" class="idlEnumItem">microphone</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-SourceTypeEnum.camera">camera</code></td><td>A valid source type only for video <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code>s. The source is a local video-producing camera
            source.</td></tr><tr><td><code id="idl-def-SourceTypeEnum.microphone">microphone</code></td><td>A valid source type only for audio <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code>s. The source is a local audio-producing microphone
            source.</td></tr></tbody></table>
        </section>

        <section rel="bibo:Chapter" resource="#media-track-constraints" typeof="bibo:Chapter" id="media-track-constraints">
          <h4 id="h4_media-track-constraints" role="heading" aria-level="3"><span class="secno">4.3.5 </span>MediaTrackConstraints</h4>

          <pre class="idl"><span class="idlDictionary" id="idl-def-MediaTrackConstraints">dictionary <span class="idlDictionaryID">MediaTrackConstraints</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-MediaTrackConstraintSet"><code>MediaTrackConstraintSet</code></a></span> {
<span class="idlMember">    <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-MediaTrackConstraintSet"><code>MediaTrackConstraintSet</code></a>&gt;</span> <span class="idlMemberName"><a href="#widl-MediaTrackConstraints-advanced">advanced</a></span>;</span>
};</span></pre><section id="dictionary-mediatrackconstraints-members"><h5 id="h5_dictionary-mediatrackconstraints-members" role="heading" aria-level="4"><span class="secno">4.3.5.1 </span>Dictionary <a href="#idl-def-MediaTrackConstraints" class="idlType"><code>MediaTrackConstraints</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-MediaTrackConstraints-advanced"><code>advanced</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-MediaTrackConstraintSet"><code>MediaTrackConstraintSet</code></a>&gt;</span></dt><dd>See <a href="#constraints">Constraints and ConstraintSet</a>
            for the definition of this element.</dd></dl></section>

          <pre class="idl"><span class="idlDictionary" id="idl-def-MediaTrackConstraintSet">dictionary <span class="idlDictionaryID">MediaTrackConstraintSet</span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span>            <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-width">width</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span>            <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-height">height</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></span>          <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-aspectRatio">aspectRatio</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></span>          <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-frameRate">frameRate</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainVideoFacingMode"><code>ConstrainVideoFacingMode</code></a></span> <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-facingMode">facingMode</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></span>          <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-volume">volume</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span>            <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-sampleRate">sampleRate</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span>            <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-sampleSize">sampleSize</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">boolean</span>                  <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-echoCancellation">echoCancellation</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDOMString"><code>ConstrainDOMString</code></a></span>       <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-sourceId">sourceId</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span>                <span class="idlMemberName"><a href="#widl-MediaTrackConstraintSet-groupId">groupId</a></span>;</span>
};</span></pre><section id="dictionary-mediatrackconstraintset-members"><h5 id="h5_dictionary-mediatrackconstraintset-members" role="heading" aria-level="4"><span class="secno">4.3.5.2 </span>Dictionary <a href="#idl-def-MediaTrackConstraintSet" class="idlType"><code>MediaTrackConstraintSet</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-MediaTrackConstraintSet-aspectRatio"><code>aspectRatio</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-echoCancellation"><code>echoCancellation</code> of type <span class="idlMemberType">boolean</span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-facingMode"><code>facingMode</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainVideoFacingMode"><code>ConstrainVideoFacingMode</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-frameRate"><code>frameRate</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-groupId"><code>groupId</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
          </dd><dt id="widl-MediaTrackConstraintSet-height"><code>height</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-sampleRate"><code>sampleRate</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-sampleSize"><code>sampleSize</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-sourceId"><code>sourceId</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDOMString"><code>ConstrainDOMString</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-volume"><code>volume</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></span></dt><dd>

            </dd><dt id="widl-MediaTrackConstraintSet-width"><code>width</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></span></dt><dd>

            </dd></dl></section>
        </section>
      </section>

      <section id="mediastreamtrackevent">
        <h3 id="h3_mediastreamtrackevent" role="heading" aria-level="2"><span class="secno">4.4 </span>MediaStreamTrackEvent</h3>

        <p>The <code>
            <a href="#event-mediastream-addtrack">addtrack</a>
          </code> and <code title="event-MediaStreamTracklist-removetrack">
            <a href="#event-mediastream-removetrack">removetrack</a>
          </code> events use the <code>
            <a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a>
          </code> interface.</p>

        <p><dfn id="dfn-fire-a-track-event" title="Fire a track event">Firing a track event named
        <var>e</var></dfn> with a <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> <var>track</var> means that an event with the name
        <var>e</var>, which does not bubble (except where otherwise stated)
        and is not cancelable (except where otherwise stated), and which uses
        the <code>
            <a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a>
          </code> interface with the <code>
            <a href="#dom-mediastreamtrackevent-track">track</a>
          </code> attribute set to <var>track</var>, <em title="MUST" class="rfc2119">MUST</em> be created and
        dispatched at the given target.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamTrackEvent"><span class="idlDictionary" id="idl-def-MediaStreamTrackEventInit">dictionary <span class="idlDictionaryID">MediaStreamTrackEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span> <span class="idlMemberName"><a href="#widl-MediaStreamTrackEventInit-track">track</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-MediaStreamTrackEvent--DOMString-type-MediaStreamTrackEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrackEventInit"><code>MediaStreamTrackEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">MediaStreamTrackEvent</span> : <span class="idlSuperclass">Event</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span> <span class="idlAttrName"><a href="#widl-MediaStreamTrackEvent-track">track</a></span>;</span>
};</span></pre><section id="constructors-1"><h4 id="h4_constructors-1" role="heading" aria-level="3"><span class="secno">4.4.1 </span>Constructors</h4><dl class="constructors"><dt id="widl-ctor-MediaStreamTrackEvent--DOMString-type-MediaStreamTrackEventInit-eventInitDict"><code>MediaStreamTrackEvent</code></dt><dd>
            <p>Constructs a new <code>
                <a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a>
              </code>.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrackEventInit"><code>MediaStreamTrackEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section id="attributes-2"><h4 id="h4_attributes-2" role="heading" aria-level="3"><span class="secno">4.4.2 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaStreamTrackEvent-track"><code>track</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>, readonly   </dt><dd>
            <p>The <dfn id="dom-mediastreamtrackevent-track">
                <code>track</code>
              </dfn> attribute represents the <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> object associated with the event.</p>
          </dd></dl></section>

        <section id="dictionary-mediastreamtrackeventinit-members"><h4 id="h4_dictionary-mediastreamtrackeventinit-members" role="heading" aria-level="3"><span class="secno">4.4.3 </span>Dictionary <a href="#idl-def-MediaStreamTrackEventInit" class="idlType"><code>MediaStreamTrackEventInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-MediaStreamTrackEventInit-track"><code>track</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span></dt><dd></dd></dl></section>
      </section>
    </section>

    <section id="the-model-sources-sinks-constraints-and-settings" class="informative">
      <!--OddPage--><h2 id="h2_the-model-sources-sinks-constraints-and-settings" role="heading" aria-level="1"><span class="secno">5. </span>The model: sources, sinks, constraints, and settings</h2><p><em>This section is non-normative.</em></p>

      <p>Browsers provide a media pipeline from sources to sinks. In a
      browser, sinks are the &lt;img&gt;, &lt;video&gt; and &lt;audio&gt;
      tags. Traditional sources include streamed content, files, and web
      resources. The media produced by these sources typically does not change
      over time - these sources can be considered to be static.</p>

      <p>The sinks that display these sources to the user (the actual tags
      themselves) have a variety of controls for manipulating the source
      content. For example, an &lt;img&gt; tag scales down a huge source image
      of 1600x1200 pixels to fit in a rectangle defined with
      <code>width="400"</code> and <code>height="300"</code>.</p>

      <p>The getUserMedia API adds dynamic sources such as microphones and
      cameras - the characteristics of these sources can change in response to
      application needs. These sources can be considered to be dynamic in
      nature. A &lt;video&gt; element that displays media from a dynamic
      source can either perform scaling or it can feed back information along
      the media pipeline and have the source produce content more suitable for
      display.</p>

      <div class="note"><div id="h_note_4" role="heading" aria-level="2" class="note-title"><span>Note</span></div><div class="">
        <p><strong>Note:</strong> This sort of feedback loop is obviously just
        enabling an "optimization", but it's a non-trivial gain. This
        optimization can save battery, allow for less network congestion,
        etc...</p>
      </div></div>

      <p>Note that <code>MediaStream</code> sinks (such as
      <code>&lt;video&gt;</code>, <code>&lt;audio&gt;</code>, and even
      <code>RTCPeerConnection</code>) will continue to have mechanisms to
      further transform the source stream beyond that which the
      <a class="internalDFN" href="#dfn-settings">Settings</a>, <a class="internalDFN" href="#dfn-capabilities">Capabilities</a>, and <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a> described
      in this specification offer. (The sink transformation options, including
      those of <code>RTCPeerConnection</code>, are outside the scope of this
      specification.)</p>

      <p>The act of changing or applying a track constraint may affect the
      <code>
          <a class="internalDFN" href="#dfn-settings">settings</a>
        </code> of all tracks sharing that source and consequently all
      down-level sinks that are using that source. Many sinks may be able to
      take these changes in stride, such as the <code>&lt;video&gt;</code>
      element or <code>RTCPeerConnection</code>. Others like the Recorder API
      may fail as a result of a source setting change.</p>

      <p>The <code>RTCPeerConnection</code> is an interesting object because
      it acts simultaneously as both a sink <strong>and</strong> a source for
      over-the-network streams. As a sink, it has source transformational
      capabilities (e.g., lowering bit-rates, scaling-up or down resolutions,
      adjusting frame-rates), and as a source it could have its own settings
      changed by a track source (though in this specification sources with the
      <code>
          <a class="internalDFN" href="#dom-mediastreamtrack-remote">remote</a>
        </code> attribute set to true do not consider the current constraints
      applied to a track).</p>

      <p>To illustrate how changes to a given source impact various sinks,
      consider the following example. This example only uses width and height,
      but the same principles apply to any of the <a class="internalDFN" href="#dfn-settings">Settings</a> exposed in
      this specification. In the first figure a home client has obtained a
      video source from its local video camera. The source's width and height
      settings are 800 pixels by 600 pixels, respectively. Three <code>
          <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
        </code> objects on the home client contain tracks that use this same
      <code>
          <a class="internalDFN" href="#dfn-sourceid">sourceId</a>
        </code>. The three media streams are connected to three different
      sinks: a <code>&lt;video&gt;</code> element (A), another
      <code>&lt;video&gt;</code> element (B), and a peer connection (C). The
      peer connection is streaming the source video to an away client. On the
      away client there are two media streams with tracks that use the peer
      connection as a source. These two media streams are connected to two
      <code>&lt;video&gt;</code> element sinks (Y and Z).</p>

      <img alt="Changing media stream source effects: before the requested change" src="images/change_states_before.png">

      <p>Note that at this moment, all of the sinks on the home client must
      apply a transformation to the original source's provided dimension
      settings. A is scaling the video up (resulting in loss of quality), B is
      scaling the video down, and C is also scaling the video up slightly for
      sending over the network. On the away client, sink Y is scaling the
      video way down, while sink Z is not applying any scaling.</p>

      <p>Using the <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a> interface, one of the tracks
      requests a higher resolution (1920 by 1200 pixels) from the home
      client's video source.</p>

      <img alt="Changing media stream source     effects: after the requested change" src="images/change_states_after.png">

      <p>Note that the source change immediately affects all of the tracks and
      sinks on the home client, but does not impact any of the sinks (or
      sources) on the away client. With the increase in the home client source
      video's dimensions, sink A no longer has to perform any scaling, while
      sink B must scale down even further than before. Sink C (the peer
      connection) must now scale down the video in order to keep the
      transmission constant to the away client.</p>

      <p>While not shown, an equally valid settings change request could be
      made of the away client video source (the peer connection on the away
      client's side). This would not only impact sink Y and Z in the same
      manner as before, but could lead to re-negotiation with the peer
      connection on the home client in order to alter the transformation that
      it is applying to the home client's video source. Such a change is <em title="NOT
      REQUIRED" class="rfc2119">NOT
      REQUIRED</em> to change anything related to sink A or B or the home client's
      video source.</p>

      <p>Note that this specification does not define a mechanism by which a
      change to the away client's video source could automatically trigger a
      change to the home client's video source. Implementations may choose to
      make such source-to-sink optimizations as long as they only do so within
      the constraints established by the application, as the next example
      demonstrates.</p>

      <p>It is fairly obvious that changes to a given source will impact sink
      consumers. However, in some situations changes to a given sink may also
      be cause for implementations to adjust a source's settings. This is
      illustrated in the following figures. In the first figure below, the
      home client's video source is sending a video stream sized at 1920 by
      1200 pixels. The video source is also unconstrained, such that the exact
      source dimensions are flexible as far as the application is concerned.
      Two <code>
          <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
        </code> objects contain tracks with the same <code>
          <a class="internalDFN" href="#dfn-sourceid">sourceId</a>
        </code>, and those <code>
          <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
        </code>s are connected to two different <code>&lt;video&gt;</code>
      element sinks A and B. Sink A has been sized to
      <code>width="1920"</code> and <code>height="1200"</code> and is
      displaying the source's video content without any transformations. Sink
      B has been sized smaller and, as a result, is scaling the video down to
      fit its rectangle of 320 pixels across by 200 pixels down.</p>

      <img alt="Changing media stream sinks may affect sources: before the requested change" src="images/change_states_before2.png">

      <p>When the application changes sink A to a smaller dimension (from 1920
      to 1024 pixels wide and from 1200 to 768 pixels tall), the browser's
      media pipeline may recognize that none of its sinks require the higher
      source resolution, and needless work is being done both on the part of
      the source and on sink A. In such a case and without any other
      constraints forcing the source to continue producing the higher
      resolution video, the media pipeline <em title="MAY" class="rfc2119">MAY</em> change the source
      resolution:</p>

      <img alt="Changing media stream sinks may affect sources: after the requested change" src="images/change_states_after2.png">

      <p>In the above figure, the home client's video source resolution was
      changed to the greater of that from sinkA and from sinkB in order to
      optimize playback. While not shown above, the same behavior could apply
      to peer connections and other sinks.</p>

      <p>It is possible that <a class="internalDFN" href="#dfn-constraints">constraints</a> can be applied to a track
      which a source is unable to satisfy, either because the source itself
      cannot satisfy the constraint or because the source is already
      satisfying a conflicting constraint. When this happens, the <code>
          <a class="internalDFN" href="#dfn-applyconstraints">applyConstraints()</a>
        </code> call will fail and call the user-provided
      <a class="idlType" href="#idl-def-ConstraintErrorCallback"><code>ConstraintErrorCallback</code></a>, without applying any of the new
      constraints. Since no change in constraints occurs in this case, there
      is also no required change to the source itself as a result of this
      condition. Here is an example of this behavior.</p>

      <p>In this example, two media streams each have a video track that share
      the same source. The first track initially has no constraints applied.
      It is connected to sink N. Sink N has a width and height of 800 by 600
      pixels and is scaling down the source's resolution of 1024 by 768 to
      fit. The other track has a mandatory constraint forcing off the source's
      fill light; it is connected to sink P. Sink P has a width and height
      equal to that of the source.</p>

      <p>
        <img alt="Overconstrained application" src="images/overconstrained_apply.png">
      </p>

      <p>Now, the first track adds a mandatory constraint that the fill light
      should be forced on. At this point, both mandatory constraints cannot be
      satisfied by the source (the fill light cannot be simultaneously on and
      off at the same time). Since this state was caused by the first track's
      attempt to apply a conflicting constraint, the constraint application
      fails and there is no change in the source's settings or the constraints
      on either track.</p>

      <p>Let's look at a slightly different situation starting from the same
      point. In this case, instead of the first track attempting to apply a
      conflicting constraint, the user physically locks the camera into a mode
      where the fill light is on. At this point the source can no longer
      satisfy the second track's mandatory constraint that the fill light be
      off. The second track is transitioned into the muted state and receives
      an <a class="internalDFN" href="#event-mediastreamtrack-overconstrained">overconstrained</a> event. At the same time, the source notes that
      its remaining active sink only requires a resolution of 800 by 600 and
      so it adjusts its resolution down to match (this is an optional
      optimization that the user agent is allowed to make given the
      situation).</p>

      <p>
        <img alt="Overconstrained occurrence" src="images/overconstrained_occurrence.png">
      </p>

      <p>At this point, it is the responsibility of the application to address
      the problem that led to the overconstrained situation, perhaps by
      removing the fill light mandatory constraint on the second track or by
      closing the second track altogether and informing the user</p>
    </section>

    <section id="mediastreams-as-media-elements">
      <!--OddPage--><h2 id="h2_mediastreams-as-media-elements" role="heading" aria-level="1"><span class="secno">6. </span>MediaStreams as Media Elements</h2>

      <p>A <code>MediaStream</code> may be assigned to media elements as
      defined in <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-elements">HTML5</a>
      [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>] A <code>MediaStream</code> is not preloadable or seekable and
      represents a simple, potentially infinite, linear media timeline. The
      timeline starts at 0 and increments linearly in real time as long as the
      <code>MediaStream</code> is playing. The timeline does not increment
      when the <code>MediaStream</code> is paused.</p>

      <section id="direct-assignment-to-media-elements">
        <h3 id="h3_direct-assignment-to-media-elements" role="heading" aria-level="2"><span class="secno">6.1 </span>Direct Assignment to Media Elements</h3>

        <p>UAs that support this specification <em title="MUST" class="rfc2119">MUST</em> support the following
        partial interface, which allows a MediaStream to be assigned directly
        to a media element.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-HTMLMediaElement">partial interface <span class="idlInterfaceID">HTMLMediaElement</span> {
<span class="idlAttribute">                attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>?</span> <span class="idlAttrName"><a href="#widl-HTMLMediaElement-srcObject">srcObject</a></span>;</span>
};</span></pre><section id="attributes-3"><h4 id="h4_attributes-3" role="heading" aria-level="3"><span class="secno">6.1.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-HTMLMediaElement-srcObject"><code>srcObject</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></span>,            , nullable</dt><dd>
            <p>Holds the MediaStream that provides media for this element.
            This attribute overrides both the <code>src</code> attribute and
            any &lt;source&gt; elements. Specifically, if
            <code>srcObject</code> is specified, the UA <em title="MUST" class="rfc2119">MUST</em> use it as the
            source of media, even if the <code>src</code> attribute is also
            set or &lt;source&gt; children are present. If the value of
            <code>srcObject</code> is replaced or set to null the UA <em title="MUST" class="rfc2119">MUST</em>
            re-run the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
            media element load algorithm</a></p>
          </dd></dl></section>

        <div class="issue"><div id="h_issue_1" role="heading" aria-level="3" class="issue-title"><span>Issue 1</span></div><p class="">We may want to allow direct assignment of other types
        as well</p></div>
      </section>

      <section id="loading-and-playing-a-mediastream-in-a-media-element">
        <h3 id="h3_loading-and-playing-a-mediastream-in-a-media-element" role="heading" aria-level="2"><span class="secno">6.2 </span>Loading and Playing a MediaStream in a Media Element</h3>

        <p>The UA runs the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
        media element load algorithm</a> to obtain media for the media element
        to display. As defined in the [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>] specification, this algorithm
        has two basic phases: <a href="http://www.w3.org/TR/html5/embedded-content-0.html#concept-media-load-algorithm">
        resource selection algorithm</a> chooses the resource to play and
        resolves its URI. Then the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#concept-media-load-resource">
        resource fetch phase</a> loads the resource. Both these phases are
        potentially simplified when using a MediaStream. First of all,
        <code>srcObject</code> takes priority over other means of specifying
        the resource, and it provides the object itself rather than a URI.
        Therefore, there is no need to run the resource selection algorithm.
        Secondly, when the UA reaches the resource fetch algorithm with a
        MediaStream, the MediaStream is a local object so there's nothing to
        fetch. Therefore, the following modifications/restrictions to the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
        media element load algorithm</a> apply:</p>

        <ul>
          <li>
            <p>Whenever the user agent runs the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
            media element load algorithm</a>, if <code>srcObject</code> is
            specified, the UA must immediately go to the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#concept-media-load-resource">
            resource fetch phase</a> of the algorithm.</p>
          </li>

          <li>
            <p>Whenever the user agent runs the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
            media element load algorithm</a>, reaches the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#concept-media-load-resource">
            resource fetch phase</a> of this algorithm, and determines that
            the media resource in question is a MediaStream, it <em title="MUST" class="rfc2119">MUST</em>
            immediately abort the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#concept-media-load-algorithm">
            resource selection algorithm</a>, setting the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-readystate">
                <code>media.readyState</code>
              </a> to HAVE_NOTHING if media is not yet available and to
            HAVE_ENOUGH_DATA once it is.</p>
          </li>

          <li>
            <p>For each <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> in the <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>, including those that are added after the UA enters the
            <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
            media element load algorithm</a>, the UA <em title="MUST" class="rfc2119">MUST</em> create a
            corresponding <code>
                <a href="http://www.w3.org/TR/html5/embedded-content-0.html#audiotrack">AudioTrack</a>
              </code> or <code>
                <a href="http://www.w3.org/TR/html5/embedded-content-0.html#videotrack">VideoTrack</a>
              </code> as defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>]. Since the order in the <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>'s <a href="#track-set">track set</a> is undefined, no
            requirements are put how the <code>
                <a href="http://www.w3.org/TR/html5/embedded-content-0.html#audiotracklist">AudioTrackList</a>
              </code> and <code>
                <a href="http://www.w3.org/TR/html5/embedded-content-0.html#videotracklist">VideoTrackList</a>
              </code> are ordered.</p>

            <p>The properties of the <code>AudioTrack</code> and
            <code>VideoTrack</code> objects <em title="MUST" class="rfc2119">MUST</em> be initialized as follows.
            Let</p>

            <ul>
              <li>
                <p><code>AudioTrack.id</code> and <code>VideoTrack.id</code>
                have the value of the corresponding <code>
                    <a href="#dom-mediastreamtrack-id">MediaStreamTrack.id</a>
                  </code> attribute</p>
              </li>

              <li>
                <p><code>AudioTrack.kind</code> and
                <code>VideoTrack.kind</code> be <code>"main"</code></p>
              </li>

              <li>
                <p><code>AudioTrack.label</code> and
                <code>VideoTrack.label</code> have the value of the
                corresponding <code>
                    <a href="#dom-mediastreamtrack-label">MediaStreamTrack.label</a>
                  </code> attribute</p>
              </li>

              <li>
                <p><code>AudioTrack.language</code> and
                <code>VideoTrack.language</code> be the empty string</p>
              </li>
            </ul>

            <p>Let the media resource, represented by the <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> object, indicate to the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
            media element load algorithm</a> that all audio tracks and all
            live video tracks (represented by a <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> with the <code>
                <a class="internalDFN" href="#dom-mediastreamtrack-readystate">readyState</a>
              </code> attribute set to <code>live</code>) should be enabled.
            This allows the media element load algorithm to set
            <code>AudioTrack.enabled</code>, <code>VideoTrack.selected</code>
            and <code>VideoTrackList.selectedIndex</code> accordingly.</p>

            <p>(Note that since the MediaStream is potentially endless, the UA
            does not exit the <a href="http://www.w3.org/TR/html5/embedded-content-0.html#media-element-load-algorithm">
            media element load algorithm</a> until the MediaStream moves from
            the active to the <a href="#stream-inactive">inactive</a>
            state.)</p>
          </li>

          <li>
            <p>If a <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> is removed from a <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>, played by a media element, the corresponding
            <code>AudioTrack</code> or <code>VideoTrack</code> <em title="MUST" class="rfc2119">MUST</em> be removed
            as well.</p>
          </li>

          <li>
            <p>The UA <em title="MUST NOT" class="rfc2119">MUST NOT</em> buffer data from a MediaStream. When playing,
            the UA <em title="MUST" class="rfc2119">MUST</em> always play the current data from the stream.</p>
          </li>

          <li>
            <p>When the MediaStream is moves from the active to the <a href="#stream-inactive">inactive</a> state, the UA <em title="MUST" class="rfc2119">MUST</em> raise an
            <a href="http://www.w3.org/TR/html5/embedded-content-0.html#event-media-ended">
            ended</a> event on the media element and set its <a href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-ended">ended</a>
            attribute to <code>true</code>. Note that once <a href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-ended">ended</a>
            equals <code>true</code> the media element will not play media
            even if new Tracks are added to the MediaStream (causing it to
            return to the active state) unless <code>autoplay</code> is
            <code>true</code> or the JavaScript restarts the element, e.g., by
            calling <a href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-play">play()</a>.</p>
          </li>
        </ul>
      </section>

      <section id="media-element-attributes-when-playing-a-mediastream">
        <h3 id="h3_media-element-attributes-when-playing-a-mediastream" role="heading" aria-level="2"><span class="secno">6.3 </span>Media Element Attributes when Playing a MediaStream</h3>

        <p>The nature of the <code>MediaStream</code> places certain
        restrictions on the behavior and attribute values of the associated
        media element and on the operations that can be performed on it, as
        shown below:</p>

        <table class="simple">
          <caption> Legal values for the properties of a media element bound
          to a MediaStream </caption>

          <thead>
            <tr>
              <th scope="col">Attribute Name</th>

              <th scope="col">Attribute Type</th>

              <th scope="col">Valid Values When Using a MediaStream</th>

              <th scope="col">Additional considerations</th>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-currentsrc">
                  <code>currentSrc</code>
                </a>
              </td>

              <td>
                <code>DOMString</code>
              </td>

              <td>the empty string</td>

              <td>When <code>srcObject</code> is specified the UA <em title="MUST" class="rfc2119">MUST</em> set
              this to the empty string.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-media-preload">
                  <code>preload</code>
                </a>
              </td>

              <td>
                <code>DOMString</code>
              </td>

              <td>
                <code>none</code>
              </td>

              <td>A MediaStream cannot be preloaded.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-buffered">
                  <code>buffered</code>
                </a>
              </td>

              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#timeranges">
                  <code>TimeRanges</code>
                </a>
              </td>

              <td><code>buffered.length</code> <em title="MUST" class="rfc2119">MUST</em> return
              <code>0</code>.</td>

              <td>A MediaStream cannot be preloaded. Therefore, the amount
              buffered is always an empty TimeRange.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-networkstate">
                  <code>networkState</code>
                </a>
              </td>

              <td>
                <code>unsigned short</code>
              </td>

              <td>NETWORK_IDLE</td>

              <td>The media element does not fetch the MediaStream so there is
              no network traffic.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-readystate">
                  <code>readyState</code>
                </a>
              </td>

              <td>
                <code>unsigned short</code>
              </td>

              <td>HAVE_NOTHING, HAVE_ENOUGH_DATA</td>

              <td>A <code>
                  <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                </code> may be created before there is any data available, for
              example when a stream is received from a remote peer. The value
              of the <code>readyState</code> of the media element <em title="MUST" class="rfc2119">MUST</em> be
              HAVE_NOTHING before the first media arrives and HAVE_ENOUGH_DATA
              once the first media has arrived.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-currenttime">
                  <code>currentTime</code>
                </a>
              </td>

              <td>
                <code>double</code>
              </td>

              <td>Any positive integer. The initial value is 0 and the values
              increments linearly in real time whenever the stream is
              playing.</td>

              <td>The value is the current stream position, in seconds. On any
              attempt to set this attribute, the user agent must throw an
              <code>InvalidStateError</code> exception.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-duration">
                  <code>duration</code>
                </a>
              </td>

              <td>
                <code>unrestricted double</code>
              </td>

              <td>Infinity</td>

              <td>A MediaStream does not have a pre-defined duration.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-seeking">
                  <code>seeking</code>
                </a>
              </td>

              <td>
                <code>boolean</code>
              </td>

              <td>false</td>

              <td>A MediaStream is not seekable. Therefore, this attribute
              <em title="MUST" class="rfc2119">MUST</em> always have the value <code>false</code>.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-defaultplaybackrate">
                  <code>defaultPlaybackRate</code>
                </a>
              </td>

              <td>
                <code>double</code>
              </td>

              <td>1.0</td>

              <td>A MediaStream is not seekable. Therefore, this attribute
              <em title="MUST" class="rfc2119">MUST</em> always have the value <code>1.0</code> and any attempt to
              alter it <em title="MUST" class="rfc2119">MUST</em> fail.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-playbackrate">
                  <code>playbackRate</code>
                </a>
              </td>

              <td>
                <code>double</code>
              </td>

              <td>1.0</td>

              <td>A MediaStream is not seekable. Therefore, this attribute
              <em title="MUST" class="rfc2119">MUST</em> always have the value <code>1.0</code> and any attempt to
              alter it <em title="MUST" class="rfc2119">MUST</em> fail.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-played">
                  <code>played</code>
                </a>
              </td>

              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#timeranges">
                  <code>TimeRanges</code>
                </a>
              </td>

              <td> <code>played.length</code> <em title="MUST" class="rfc2119">MUST</em> return
              <code>1</code>.<br> <code>played.start(0)</code> <em title="MUST" class="rfc2119">MUST</em> return
              <code>0</code>.<br> <code>played.end(0)</code> <em title="MUST" class="rfc2119">MUST</em> return the
              last known <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-currenttime">
                  <code>currentTime</code>
                </a>. </td>

              <td>A MediaStream's timeline always consists of a single range,
              starting at 0 and extending up to the currentTime.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-seekable">
                  <code>seekable</code>
                </a>
              </td>

              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#timeranges">
                  <code>TimeRanges</code>
                </a>
              </td>

              <td> <code>seekable.length</code> <em title="MUST" class="rfc2119">MUST</em> return <code>0</code>.
              </td>

              <td>A MediaStream is not seekable.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-startdate">
                  <code>startDate</code>
                </a>
              </td>

              <td>
                <code>Date</code>
              </td>

              <td>Not-a-Number (NaN)</td>

              <td>A MediaStream does not specify a timeline offset.</td>
            </tr>

            <tr>
              <td>
                <a class="externalDFN" href="http://www.w3.org/TR/html5/embedded-content-0.html#dom-media-loop">
                  <code>loop</code>
                </a>
              </td>

              <td>
                <code>boolean</code>
              </td>

              <td>true, false</td>

              <td>Setting the <code>loop</code> attribute has no effect since
              a <code>
                  <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                </code> has no defined end and therefore cannot be
              looped.</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>

    <section id="error-handling">
      <!--OddPage--><h2 id="h2_error-handling" role="heading" aria-level="1"><span class="secno">7. </span>Error Handling</h2>

      <section id="mediastreamerror">
        <h3 id="h3_mediastreamerror" role="heading" aria-level="2"><span class="secno">7.1 </span>MediaStreamError</h3>
        <p>All errors defined in this specification implement the following
          interface:</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamError">[<span class="extAttr">NoInterfaceObject</span>]
interface <span class="idlInterfaceID">MediaStreamError</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString</span>  <span class="idlAttrName"><a href="#widl-MediaStreamError-name">name</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString?</span> <span class="idlAttrName"><a href="#widl-MediaStreamError-message">message</a></span>;</span>
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType">DOMString?</span> <span class="idlAttrName"><a href="#widl-MediaStreamError-constraintName">constraintName</a></span>;</span>
};</span></pre><section id="attributes-4"><h4 id="h4_attributes-4" role="heading" aria-level="3"><span class="secno">7.1.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaStreamError-constraintName"><code>constraintName</code> of type <span class="idlAttrType">DOMString</span>, readonly   , nullable</dt><dd>
            <p>This attribute is only used for some types of errors. For <code>
                <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
              </code> with a name of <code>ConstraintNotSatisfiedError</code> or of <code>OverconstrainedError</code>,
              this attribute <em title="MUST" class="rfc2119">MUST</em> be set to the name of the constraint that caused
              the error.</p>
          </dd><dt id="widl-MediaStreamError-message"><code>message</code> of type <span class="idlAttrType">DOMString</span>, readonly   , nullable</dt><dd>A UA-dependent string offering extra human-readable information
            about the error.</dd><dt id="widl-MediaStreamError-name"><code>name</code> of type <span class="idlAttrType">DOMString</span>, readonly   </dt><dd>
            <p>The name of the error</p>
          </dd></dl></section>

        <div class="note"><div id="h_note_5" role="heading" aria-level="3" class="note-title"><span>Note</span></div><div class="">We may make MediaStreamError inherit from
          DOMError once the definition of DOMError is stable. </div></div>

        <div class="issue"><div id="h_issue_2" role="heading" aria-level="3" class="issue-title"><span>Issue 2</span></div><div class="">Do we want to allow the constraintName
          attribute to contain multiple constraint names? In many cases the error
          is raised as soon as a single unsatisfied mandatory constraint is found,
          but in others it may be possible to determine that multiple constraints
          are not satisfied. </div></div>

        <p>The following interface is defined for cases when a MediaStreamError
          is raised as an event:</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamErrorEvent"><span class="idlDictionary" id="idl-def-MediaStreamErrorEventInit">dictionary <span class="idlDictionaryID">MediaStreamErrorEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span> <span class="idlMemberName"><a href="#widl-MediaStreamErrorEventInit-error">error</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-MediaStreamErrorEvent--DOMString-type-MediaStreamErrorEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamErrorEventInit"><code>MediaStreamErrorEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">MediaStreamErrorEvent</span> : <span class="idlSuperclass">Event</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span> <span class="idlAttrName"><a href="#widl-MediaStreamErrorEvent-error">error</a></span>;</span>
};</span></pre><section id="constructors-2"><h4 id="h4_constructors-2" role="heading" aria-level="3"><span class="secno">7.1.2 </span>Constructors</h4><dl class="constructors"><dt id="widl-ctor-MediaStreamErrorEvent--DOMString-type-MediaStreamErrorEventInit-eventInitDict"><code>MediaStreamErrorEvent</code></dt><dd>TODO<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamErrorEventInit"><code>MediaStreamErrorEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section id="attributes-5"><h4 id="h4_attributes-5" role="heading" aria-level="3"><span class="secno">7.1.3 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaStreamErrorEvent-error"><code>error</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span>, readonly   </dt><dd>TODO</dd></dl></section>

        <section id="dictionary-mediastreamerroreventinit-members"><h4 id="h4_dictionary-mediastreamerroreventinit-members" role="heading" aria-level="3"><span class="secno">7.1.4 </span>Dictionary <a href="#idl-def-MediaStreamErrorEventInit" class="idlType"><code>MediaStreamErrorEventInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-MediaStreamErrorEventInit-error"><code>error</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span></dt><dd>
            <p>TODO</p>
          </dd></dl></section>
      </section>
      <section id="error-names">
        <h3 id="h3_error-names" role="heading" aria-level="2"><span class="secno">7.2 </span>Error names</h3>
        <p>The table below lists the error names defined in this specification.</p>
        <table>
          <caption><code><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></code> names</caption>
          <thead>
            <tr>
              <th>Name</th>
              <th>Description</th>
              <th>Note</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th><code><dfn id="dfn-notsupportederror">NotSupportedError</dfn></code></th>
              <td>The operation is not supported.</td>
              <td>Same as defined in [<cite><a href="#bib-DOM4" class="bibref">DOM4</a></cite>]</td>
            </tr>
            <tr>
              <th><code><dfn id="dfn-permissiondeniederror">PermissionDeniedError</dfn></code></th>
              <td>The user did not grant permission for the operation.</td>
              <td></td>
            </tr>
            <tr>
              <th><code><dfn id="dfn-constraintnotsatisfiederror">ConstraintNotSatisfiedError</dfn></code></th>
              <td>One of the mandatory <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a> could not be satisfied.</td>
              <td>The <code>constraintName</code> attribute gets set to the name of the constraint that caused the error</td>
            </tr>
            <tr>
              <th><code><dfn id="dfn-overconstrainederror">OverconstrainedError</dfn></code></th>
              <td>Due to changes in the environment, one or more mandatory constraints can no longer be satisfied..</td>
              <td>The <code>constraintName</code> attribute gets set to the name of the constraint that caused the error</td>
            </tr>
            <tr>
              <th><code><dfn id="dfn-notfounderror">NotFoundError</dfn></code></th>
              <td>The object can not be found here.</td>
              <td>Same as defined in [<cite><a href="#bib-DOM4" class="bibref">DOM4</a></cite>]</td>
            </tr>
            <tr>
              <th><code><dfn id="dfn-aborterror">AbortError</dfn></code></th>
              <td>The operation was aborted.</td>
              <td>Same as defined in [<cite><a href="#bib-DOM4" class="bibref">DOM4</a></cite>]</td>
            </tr>
            <tr>
              <th><code><dfn id="dfn-sourceunavailableerror">SourceUnavailableError</dfn></code></th>
              <td>The source of the MediaStream could not be accessed due to a hardware error (e.g. lock from another process).</td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>

    <section id="event-summary" class="informative">
      <!--OddPage--><h2 id="h2_event-summary" role="heading" aria-level="1"><span class="secno">8. </span>Event summary</h2><p><em>This section is non-normative.</em></p>

      <p>The following event fires on <code>
          <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
        </code> objects:</p>

      <table>
        <tbody><tr>
          <th>Event name</th>

          <th>Interface</th>

          <th>Fired when...</th>
        </tr>

        </tbody><tbody>
          <tr>
            <td>
              <dfn id="event-mediastream-active">
                <code>active</code>
              </dfn>
            </td>

            <td>
              <code>Event</code>
            </td>

            <td> The <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> became active (see <a href="#stream-inactive">inactive</a>). </td>
          </tr>

          <tr>
            <td>
              <dfn id="event-mediastream-inactive">
                <code>inactive</code>
              </dfn>
            </td>

            <td>
              <code>Event</code>
            </td>

            <td> The <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> became <a href="#stream-inactive">inactive</a>. </td>
          </tr>

          <tr>
            <td>
              <dfn id="event-mediastream-addtrack">
                <code>addtrack</code>
              </dfn>
            </td>

            <td>
              <code>
                <a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a>
              </code>
            </td>

            <td>A new <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> has been added to this stream. Note that this event is
            not fired when the script directly modifies the tracks of a <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>.</td>
          </tr>

          <tr>
            <td>
              <dfn id="event-mediastream-removetrack">
                <code>removetrack</code>
              </dfn>
            </td>

            <td>
              <code>
                <a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a>
              </code>
            </td>

            <td>A <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> has been removed from this stream. Note that this event
            is not fired when the script directly modifies the tracks of a
            <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code>.</td>
          </tr>
        </tbody>
      </table>

      <p>The following event fires on <code>
          <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
        </code> objects:</p>

      <table>
        <tbody><tr>
          <th>Event name</th>

          <th>Interface</th>

          <th>Fired when...</th>
        </tr>

        </tbody><tbody>
          <tr>
            <td>
              <dfn id="event-mediastreamtrack-mute">
                <code>mute</code>
              </dfn>
            </td>

            <td>
              <code>Event</code>
            </td>

            <td>The <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> object's source is temporarily unable to provide
            data.</td>
          </tr>

          <tr>
            <td>
              <dfn id="event-mediastreamtrack-unmute">
                <code>unmute</code>
              </dfn>
            </td>

            <td>
              <code>Event</code>
            </td>

            <td>The <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> object's source is live again after having been
            temporarily unable to provide data.</td>
          </tr>

          <tr>
            <td>
              <dfn id="event-mediastreamtrack-overconstrained">
                <code>overconstrained</code>
              </dfn>
            </td>

            <td>
              <code>MediaStreamErrorEvent</code>
            </td>

            <td>
              <p>This error event fires asynchronously for each affected track
              (when multiple tracks share the same source) after the user
              agent has evaluated the current constraints against a given
              <code>
                  <a class="internalDFN" href="#dfn-sourceid">sourceId</a>
                </code> and is not able to configure the source within the
              limitations established by the union of imposed constraints.</p>

              <p>Due to being over-constrained, the user agent must mute each
              affected track.</p>

              <p>The affected track(s) will remain <a href="#track-muted">muted</a> until the application adjusts the
              constraints to accommodate the source's capabilities.</p>
            </td>
          </tr>

          <tr>
            <td>
                <code id="event-mediastreamtrack-ended">ended</code>
            </td>

            <td>
              <code>Event</code>
            </td>

            <td>The <code>
                <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
              </code> object's source will no longer provide any data, either
            because the user revoked the permissions, or because the source
            device has been ejected, or because the remote peer permanently
            stopped sending data.</td>
          </tr>
        </tbody>
      </table>

      <p>The following event fires on <code>
          <a class="idlType" href="#idl-def-MediaDevices"><code>MediaDevices</code></a>
        </code> objects:</p>

      <table>
        <tbody><tr>
          <th>Event name</th>

          <th>Interface</th>

          <th>Fired when...</th>
        </tr>

        </tbody><tbody>
          <tr>
            <td>
              <dfn id="event-mediadevices-devicechange">
                <code>devicechange</code>
              </dfn>
            </td>

            <td>
              <code>Event</code>
            </td>

            <td>The set of media devices, available to the user agent, has
            changed. The current list devices can be retrieved with the <code>
                <a href="#dom-mediadevices-enumeratedevices">enumerateDevices()</a>
              </code> method.</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section rel="bibo:Chapter" resource="#enumerating-devices" typeof="bibo:Chapter" id="enumerating-devices">
      <!--OddPage--><h2 id="h2_enumerating-devices" role="heading" aria-level="1"><span class="secno">9. </span>Enumerating Local Media Devices</h2>

      <p>This section describes an API that the script can use to query the
      user agent about connected media input and output devices (for example a
      web camera or a headset).</p>

      <section id="navigatorusermedia">
        <h3 id="h3_navigatorusermedia" role="heading" aria-level="2"><span class="secno">9.1 </span>NavigatorUserMedia</h3>

        <pre class="idl"><span class="idlInterface" id="idl-def-NavigatorUserMedia">[<span class="extAttr">NoInterfaceObject</span>]
interface <span class="idlInterfaceID">NavigatorUserMedia</span> {
<span class="idlAttribute">    readonly    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaDevices"><code>MediaDevices</code></a></span> <span class="idlAttrName"><a href="#widl-NavigatorUserMedia-mediaDevices">mediaDevices</a></span>;</span>
};</span></pre><section id="attributes-6"><h4 id="h4_attributes-6" role="heading" aria-level="3"><span class="secno">9.1.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-NavigatorUserMedia-mediaDevices"><code>mediaDevices</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaDevices"><code>MediaDevices</code></a></span>, readonly   </dt><dd>
            <p>Returns the <code>MediaDevices</code> object associated with
            this <code>Navigator</code> object.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlImplements">Navigator implements <a class="idlType" href="#idl-def-NavigatorUserMedia"><code>NavigatorUserMedia</code></a>;</span></pre><div class="idlImplementsDesc">
      </div></section>

      <section id="mediadevices">
        <h3 id="h3_mediadevices" role="heading" aria-level="2"><span class="secno">9.2 </span>MediaDevices</h3>

        <p>The <code>MediaDevices</code> object which is the entry point to
        the API used to examine and get access to media devices available to
        the user agent.</p>

        <p>When a new media input or output device is made available, the user
        agent <em title="MUST" class="rfc2119">MUST</em> queue a task fires a simple event named <code>
            <a href="#event-mediadevices-devicechange">devicechange</a>
          </code> at the <code>
            <a class="idlType" href="#idl-def-MediaDevices"><code>MediaDevices</code></a>
          </code> object.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaDevices">interface <span class="idlInterfaceID">MediaDevices</span> : <span class="idlSuperclass">EventTarget</span> {
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-MediaDevices-ondevicechange">ondevicechange</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-MediaDevices-enumerateDevices-void-MediaDeviceInfoCallback-resultCallback">enumerateDevices</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaDeviceInfoCallback"><code>MediaDeviceInfoCallback</code></a></span> <span class="idlParamName">resultCallback</span></span>);</span>
};</span></pre><section id="attributes-7"><h4 id="h4_attributes-7" role="heading" aria-level="3"><span class="secno">9.2.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaDevices-ondevicechange"><code>ondevicechange</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
              <a href="#event-mediadevices-devicechange">devicechange</a>
            </code>, <em title="MUST" class="rfc2119">MUST</em> be supported by all objects implementing the <code>
              <a class="idlType" href="#idl-def-MediaDevices"><code>MediaDevices</code></a>
            </code> interface.</dd></dl></section><section id="methods-2"><h4 id="h4_methods-2" role="heading" aria-level="3"><span class="secno">9.2.2 </span>Methods</h4><dl class="methods"><dt id="widl-MediaDevices-enumerateDevices-void-MediaDeviceInfoCallback-resultCallback"><code>enumerateDevices</code></dt><dd>
            <p>Collects information about the user agents available media
            input and output devices. The method <em title="MUST" class="rfc2119">MUST</em> only return information
            that the script is authorized to access (TODO expand
            authorized).</p>

            <p>When the <dfn id="dom-mediadevices-enumeratedevices">
                <code>enumerateDevices()</code>
              </dfn> method is called, the user agent must queue a task that
            runs the following steps:</p>

            <ol>
              <li>
                <p>Let <var>resultCallback</var> be the callback indicated by
                the methods first argument.</p>
              </li>

              <li>
                <p>If this method has been called previously within this
                application session, let <var>oldList</var> be the list of
                <code>
                    <a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>
                  </code> objects that was produced at that call
                (<var>resultList</var>); otherwise, let <var>oldList</var> be
                an empty list.</p>
              </li>

              <li>
                <p>Let <var>resultList</var> be an empty list.</p>
              </li>

              <li>
                <p>Probe the user agent for available media devices, and run
                the following sub steps for each discovered device,
                <var>device</var>:</p>

                <ol>
                  <li>
                    <p>If <var>device</var> is represented by a <code>
                        <a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>
                      </code> object in <var>oldList</var>, append that object
                    to <var>resultList</var>, abort these steps and continue
                    with the next device (if any).</p>
                  </li>

                  <li>
                    <p>Let <var>deviceInfo</var> be a new <code>
                        <a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>
                      </code> object to represent <var>device</var>.</p>
                  </li>

                  <li>
                    <p>If <var>device</var> belongs to the same physical
                    device as a device, already represented in
                    <var>oldList</var> or <var>resultList</var>, initialize
                    <var>deviceInfo</var>'s <code>
                        <a href="#widl-MediaDeviceInfo-groupId">groupId</a>
                      </code> member to the <code>
                        <a href="#widl-MediaDeviceInfo-groupId">groupId</a>
                      </code> value of the existing <code>
                        <a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>
                      </code> object. Otherwise, let <var>deviceInfo</var>'s
                    <code>
                        <a href="#widl-MediaDeviceInfo-groupId">groupId</a>
                      </code> member be a newly generated unique
                    identifier</p>
                  </li>

                  <li>
                    <p>Append <var>deviceInfo</var> to
                    <var>resultList</var>.</p>
                  </li>
                </ol>
              </li>

              <li>
                <p>Invoke <var>resultCallback</var> with <var>resultList</var>
                as its argument.</p>
              </li>
            </ol>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">resultCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaDeviceInfoCallback"><code>MediaDeviceInfoCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
      </section>

      <section id="device-info">
        <h3 id="h3_device-info" role="heading" aria-level="2"><span class="secno">9.3 </span>Device Info</h3>

        <pre class="idl"><span class="idlCallback" id="idl-def-MediaDeviceInfoCallback">callback <span class="idlCallbackID">MediaDeviceInfoCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType">sequence&lt;<a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>&gt;</span> <span class="idlParamName">deviceInfoList</span></span>);</span></pre><section id="callback-mediadeviceinfocallback-parameters"><h4 id="h4_callback-mediadeviceinfocallback-parameters" role="heading" aria-level="3"><span class="secno">9.3.1 </span>Callback <a href="#idl-def-MediaDeviceInfoCallback" class="idlType"><code>MediaDeviceInfoCallback</code></a> Parameters</h4><dl class="callback-members"><dt id="widl-MediaDeviceInfoCallback-deviceInfoList"><code>deviceInfoList</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>&gt;</span></dt><dd>A sequence of <code>
              <a class="idlType" href="#idl-def-MediaDeviceInfo"><code>MediaDeviceInfo</code></a>
            </code> objects representing the result of a call to <code>
              <a href="#dom-mediadevices-enumeratedevices">MediaDevices.enumerateDevices()</a>
            </code> .</dd></dl></section>

        <div class="note"><div id="h_note_6" role="heading" aria-level="3" class="note-title"><span>Note</span></div><div class=""> The old SourceInfo dictionary used to refer to the
        MediaSourceStates dictionary. That dictionary is no longer available
        when Constrainable is introduced. When Constrainable lands, we should
        see if we can align deviceId, kind and label, below, with the new
        definitions of source capabilities. </div></div>

        <pre class="idl"><span class="idlDictionary" id="idl-def-MediaDeviceInfo">dictionary <span class="idlDictionaryID">MediaDeviceInfo</span> {
<span class="idlMember">    <span class="idlMemberType">DOMString</span>       <span class="idlMemberName"><a href="#widl-MediaDeviceInfo-deviceId">deviceId</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaDeviceKind"><code>MediaDeviceKind</code></a></span> <span class="idlMemberName"><a href="#widl-MediaDeviceInfo-kind">kind</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span>       <span class="idlMemberName"><a href="#widl-MediaDeviceInfo-label">label</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">DOMString</span>       <span class="idlMemberName"><a href="#widl-MediaDeviceInfo-groupId">groupId</a></span>;</span>
};</span></pre><section id="dictionary-mediadeviceinfo-members"><h4 id="h4_dictionary-mediadeviceinfo-members" role="heading" aria-level="3"><span class="secno">9.3.2 </span>Dictionary <a href="#idl-def-MediaDeviceInfo" class="idlType"><code>MediaDeviceInfo</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-MediaDeviceInfo-deviceId"><code>deviceId</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>The unique id for the represented device.</p>
            <p>Devices have an identifier which <em class="rfc2119" title="must">must</em> be unique to the application (un-guessable by
          another application) and persistent between application sessions
          (e.g., the identifier for a given source device/application must
          stay the same, but not be guessable by another application). Sources
          that must have an identifier are camera and microphone sources;
          local file sources are not required to have an identifier. Source
          identifiers let the application save, identify the availability of,
          and directly request specific sources.</p>

          </dd><dt id="widl-MediaDeviceInfo-groupId"><code>groupId</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>Returns the group identifier of the represented device. Two
            devices have the same group identifier if they belong to the same
            physical device; for example a headset.</p>
          </dd><dt id="widl-MediaDeviceInfo-kind"><code>kind</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaDeviceKind"><code>MediaDeviceKind</code></a></span></dt><dd>
            <p>Describes the kind of the represented device.</p>
          </dd><dt id="widl-MediaDeviceInfo-label"><code>label</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>A label describing this device (for example "External USB
            Webcam"). If the device has no associated label, then this
            dictionary member <em title="MUST" class="rfc2119">MUST</em> return the empty string.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlEnum" id="idl-def-MediaDeviceKind">enum <span class="idlEnumID">MediaDeviceKind</span> {
    "<a href="#idl-def-MediaDeviceKind.audioinput" class="idlEnumItem">audioinput</a>",
    "<a href="#idl-def-MediaDeviceKind.audiooutput" class="idlEnumItem">audiooutput</a>",
    "<a href="#idl-def-MediaDeviceKind.videoinput" class="idlEnumItem">videoinput</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-MediaDeviceKind.audioinput">audioinput</code></td><td>
            <p>Represents an audio input device; for example a microphone.</p>
          </td></tr><tr><td><code id="idl-def-MediaDeviceKind.audiooutput">audiooutput</code></td><td>
            <p>Represents an audio output device; for example a pair of
            headphones.</p>
          </td></tr><tr><td><code id="idl-def-MediaDeviceKind.videoinput">videoinput</code></td><td>
            <p>Represents a video input device; for example a webcam.</p>
          </td></tr></tbody></table>
      </section>
    </section>

    <section rel="bibo:Chapter" resource="#local-content" typeof="bibo:Chapter" id="local-content">
      <!--OddPage--><h2 id="h2_local-content" role="heading" aria-level="1"><span class="secno">10. </span>Obtaining local multimedia content</h2>

      <p>This section extends <code>
          <a class="idlType" href="#idl-def-NavigatorUserMedia"><code>NavigatorUserMedia</code></a>
        </code> and <code>
          <a class="idlType" href="#idl-def-MediaDevices"><code>MediaDevices</code></a>
        </code> with APIs to request permission to access media input devices
      available to the user agent.</p>

      <section id="navigatorusermedia-interface-extensions">
        <h3 id="h3_navigatorusermedia-interface-extensions" role="heading" aria-level="2"><span class="secno">10.1 </span>NavigatorUserMedia Interface Extensions</h3>

        <div class="note"><div id="h_note_7" role="heading" aria-level="3" class="note-title"><span>Note</span></div><div class="">This method is kept on <code>
            <a class="idlType" href="#idl-def-NavigatorUserMedia"><code>NavigatorUserMedia</code></a>
          </code> for legacy purposes. See <a href="#dom-mediadevices-getusermedia">MediaDevices.getUserMedia()</a>.</div></div>

        <pre class="idl"><span class="idlInterface" id="idl-def-NavigatorUserMedia-1">partial interface <span class="idlInterfaceID">NavigatorUserMedia</span> {
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-NavigatorUserMedia-getUserMedia-void-MediaStreamConstraints-constraints-NavigatorUserMediaSuccessCallback-successCallback-NavigatorUserMediaErrorCallback-errorCallback">getUserMedia</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamConstraints"><code>MediaStreamConstraints</code></a></span> <span class="idlParamName">constraints</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-NavigatorUserMediaSuccessCallback"><code>NavigatorUserMediaSuccessCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-NavigatorUserMediaErrorCallback"><code>NavigatorUserMediaErrorCallback</code></a></span> <span class="idlParamName">errorCallback</span></span>);</span>
};</span></pre><section id="methods-3"><h4 id="h4_methods-3" role="heading" aria-level="3"><span class="secno">10.1.1 </span>Methods</h4><dl class="methods"><dt id="widl-NavigatorUserMedia-getUserMedia-void-MediaStreamConstraints-constraints-NavigatorUserMediaSuccessCallback-successCallback-NavigatorUserMediaErrorCallback-errorCallback"><code>getUserMedia</code></dt><dd>
            <p>See <a href="#dom-mediadevices-getusermedia">MediaDevices.getUserMedia()</a>.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">constraints</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamConstraints"><code>MediaStreamConstraints</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-NavigatorUserMediaSuccessCallback"><code>NavigatorUserMediaSuccessCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">errorCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-NavigatorUserMediaErrorCallback"><code>NavigatorUserMediaErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
      </section>

      <section id="mediadevices-interface-extensions">
        <h3 id="h3_mediadevices-interface-extensions" role="heading" aria-level="2"><span class="secno">10.2 </span>MediaDevices Interface Extensions</h3>

        <p>The <code>getSupportedConstraints</code> method is provided to
        allow the application to determine which constraints the User Agent
        recognizes.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaDevices-1">partial interface <span class="idlInterfaceID">MediaDevices</span> {
<span class="idlMethod">    static <span class="idlMethType">Dictionary</span> <span class="idlMethName"><a href="#widl-MediaDevices-getSupportedConstraints-Dictionary-DOMString-kind">getSupportedConstraints</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">kind</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span>              <span class="idlMethName"><a href="#widl-MediaDevices-getUserMedia-void-MediaStreamConstraints-constraints-NavigatorUserMediaSuccessCallback-successCallback-NavigatorUserMediaErrorCallback-errorCallback">getUserMedia</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamConstraints"><code>MediaStreamConstraints</code></a></span> <span class="idlParamName">constraints</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-NavigatorUserMediaSuccessCallback"><code>NavigatorUserMediaSuccessCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-NavigatorUserMediaErrorCallback"><code>NavigatorUserMediaErrorCallback</code></a></span> <span class="idlParamName">errorCallback</span></span>);</span>
};</span></pre><section id="methods-4"><h4 id="h4_methods-4" role="heading" aria-level="3"><span class="secno">10.2.1 </span>Methods</h4><dl class="methods"><dt id="widl-MediaDevices-getSupportedConstraints-Dictionary-DOMString-kind"><code>getSupportedConstraints</code>, static</dt><dd>
            <p>Returns a dictionary whose members are the constraint keys
            known to the User Agent for the kind given as argument. A
            supported constraint <em title="MUST" class="rfc2119">MUST</em> be represented by a member whose name is
            the constraint name and whose value is <code>true</code>. Any
            constraint names not supported by the User Agent <em title="MUST" class="rfc2119">MUST</em> not be
            present in the returned dictionary.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">kind</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Dictionary</code></div></dd><dt id="widl-MediaDevices-getUserMedia-void-MediaStreamConstraints-constraints-NavigatorUserMediaSuccessCallback-successCallback-NavigatorUserMediaErrorCallback-errorCallback"><code>getUserMedia</code></dt><dd>
            <p>Prompts the user for permission to use their Web cam or other
            video or audio input.</p>

            <div class="issue"><div id="h_issue_3" role="heading" aria-level="4" class="issue-title"><span>Issue 3</span></div><p class="">(Remove when other issues are removed. This is
            only here to keep the issues from being renumbered)</p></div>

            <p>The <var>constraints</var> argument is an object of type <code>
                <a class="idlType" href="#idl-def-MediaStreamConstraints"><code>MediaStreamConstraints</code></a>
              </code>.</p>

            <p>The <var>successCallback</var> will be invoked with a suitable
            <code>
                <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
              </code> object as its argument if the user accepts valid tracks
            as described below.</p>

            <p>The <var>errorCallback</var> will be invoked if there is a
            failure in finding valid tracks or if the user denies permission,
            both as described below.</p>

            <p>When the <dfn id="dom-mediadevices-getusermedia">
                <code>getUserMedia()</code>
              </dfn> method is called, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following
            steps:</p>

            <ol>
              <li>
                <p>Let <var>constraints</var> be the method's first
                argument.</p>
              </li>

              <li>
                <p>Let <var>successCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>

              <li>
                <p>Let <var>errorCallback</var> be the callback indicated by
                the method's third argument.</p>
              </li>

              <li>
                <p>Let <var>requestedMediaTypes</var> be the set of media
                types in <var>constraints</var> with either a dictionary value
                or a value of "true".</p>
              </li>

              <li>
                <p>If <var>requestedMediaTypes</var> is the empty set, let
                <var>error</var> be a new <code>
                    <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
                  </code> object whose <code>
                    name
                  </code> attribute has the value
                <code>NotSupportedError</code> and jump to the step labeled
                <em>Error Task</em> below.</p>
              </li>

              <li>
                <p>Let <var>finalSet</var> be an (initially) empty set.</p>
              </li>

              <li>
                <p>If <var>successCallback</var> is null, abort these
                steps.</p>
              </li>

              <!-- we could throw an exception instead (that's
   why the method doesn't return until later: so that we can add an
   exception here, or for /options/ below, without changing the
   algorithm) -->

              <!--
            <li>
              <p>For each member of the <code><a>MediaStreamOptions</a></code>
              dictionary create a local representation and set it to false.</p>
            </li>

            <li>
              <p>For each property in <var>options</var> that is present and
              set to true, let the corresponding local representation be
              true.</p>
            </li>

            <li>
              <p>If none of the local representations of the
              <code><a>MediaStreamOptions</a></code> dictionary members is set
              to true, then throw a <code>NOT_SUPPORTED_ERR</code> exception
              and abort these steps.</p>
            </li>
-->

              <li>
                <p>For each media type <var>T</var> in
                <var>requestedMediaTypes</var>,</p>

                <ol>
                  <li>
                    <p>Let <var>candidateSet</var> be all possible tracks of
                    media type <var>T</var> that the browser could return.</p>
                  </li>

                  <li>
                   <p>If <var>candidateSet</var> is the empty set,
                   let <var>error</var> be a
                   new <code><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a> </code> object
                   whose <code>name</code> attribute has the
                   value <code>NotFoundError</code> and jump to the
                   step labeled <em>Error Task</em> below.</p>
                  </li>

                  <li>If the value of the <var>T</var> entry of
                  <var>constraints</var> is "true", jump to the step labeled
                  <em>final</em> below. Otherwise, continue with <var>CS</var>
                  set to the value of the <var>T</var> entry of
                  <var>constraints</var>.</li>

                  <li>
                    <p>For each required ('min', 'max', or 'exact') constraint
                    provided for a constraint name in <var>CS</var>,</p>

                    <ol>
                      <li>
                        <p>If the constraint is not supported by the browser,
                        jump to the step labeled <em>Constraint Failure</em>
                        below.</p>
                      </li>

                      <li>
                        <p>Remove from the <var>candidateSet</var> any track
                        that cannot satisfy the value given for the constraint
                        in <var>CS</var>, if any.</p>
                      </li>

                      <li>
                        <p>If the <var>candidateSet</var> no longer contains
                        at least one track, jump to the step labeled
                        <em>Constraint Failure</em> below. Otherwise, continue
                        with the next required constraint.</p>
                      </li>
                    </ol>
                  </li>

                  <li>
                    <p>Let the <var>secondPassSet</var> be the current
                    contents of the <var>candidateSet</var>. Note that unknown
                    properties are discarded by WebIDL, which means that
                    unknown/unsupported required constraints will silently
                    disappear. To avoid this being a surprise, application
                    authors are expected to first use the
                    <code>getSupportedConstraints()</code> method as shown in
                    the Examples.</p>
                  </li>

                  <li>
                    <p>For each constraint key-value pair in the "advanced"
                    sequence of <var>CS</var>, in order,</p>

                    <ol>
                      <li>
                        <p>If the constraint is not supported by the browser,
                        skip it and continue with the next constraint.</p>
                      </li>

                      <li>
                        <p>Remove from the <var>secondPassSet</var> any tracks
                        that cannot satisfy the value given for the
                        constraint.</p>
                      </li>

                      <li>
                        <p>If the <var>secondPassSet</var> is now empty, let
                        the <var>secondPassSet</var> be the current contents
                        of the <var>candidateSet</var>. Otherwise, let the
                        <var>candidateSet</var> be the current contents of the
                        <var>secondPassSet</var>.</p>
                      </li>
                    </ol>
                  </li>

                  <li>
                    <p>Let the <var>thirdPassSet</var> be the current contents
                    of the <var>candidateSet</var>.</p>
                  </li>

                  <li>
                    <p>For all non-required ('ideal' or bare-value)
                    constraints in <var>CS</var>, identify the maximum number
                    of such constraint pairs that could be satisfied by at
                    least one track in <var>thirdPassSet</var>.</p>
                  </li>

                  <li>
                    <p>The decision of which of these non-required constraints
                    to satisfy is completely up to the user agent, as long as
                    the number of constraints satisfied matches the number in
                    the previous step.</p>
                  </li>

                  <li>
                    <p>For the non-required constraints the user agent has
                    decided to satisfy, remove from the
                    <var>thirdPassSet</var> any tracks that cannot satisfy
                    those constraints.</p>
                  </li>

                  <li>
                    <p>If the <var>thirdPassSet</var> is now empty, let the
                    <var>thirdPassSet</var> be the current contents of the
                    <var>candidateSet</var>. Otherwise, let the
                    <var>candidateSet</var> be the current contents of the
                    <var>thirdPassSet</var>.</p>
                  </li>

                  <li>
                    <p><em>Final:</em> Add the tracks in the
                    <var>candidateSet</var> to the <var>finalSet</var>.</p>
                  </li>
                </ol>
              </li>

              <li>
                <p>Return, and run the remaining steps asynchronously.</p>
              </li>

              <li>
                <p>Optionally, e.g., based on a previously-established user
                preference, for security reasons, or due to platform
                limitations, jump to the step labeled <em>Permission
                Failure</em> below.</p>
              </li>

              <li>
                <p>Prompt the user in a user agent specific manner for
                permission to provide the entry script's origin with a <code>
                    <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                  </code> object representing a media stream.</p>

                <p>The provided media <em title="MUST" class="rfc2119">MUST</em> include precisely one track of each
                media type in requestedMediaTypes from the
                <var>finalSet</var>. The decision of which tracks to choose
                from the <var>finalSet</var> is completely up to the user
                agent and may be determined by asking the user. Once selected,
                the source of a <code>
                    <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
                  </code> <em title="MUST" class="rfc2119">MUST</em> not change.</p>

                <div class="issue"><div id="h_issue_4" role="heading" aria-level="4" class="issue-title"><span>Issue 4</span></div><p class="">Define the event that should be raised when
                the user agent changes its choice of track.</p></div>

                <p>User agents are encouraged to default to using the user's
                primary or system default camera and/or microphone (when
                possible) to generate the media stream. User agents <em title="MAY" class="rfc2119">MAY</em> allow
                users to use any media source, including pre-recorded media
                files.</p>

                <p>If the user grants permission to use local recording
                devices, user agents are encouraged to include a prominent
                indicator that the devices are "hot" (i.e. an "on-air" or
                "recording" indicator), as well as a "device accessible"
                indicator indicating that the page has been granted access to
                the source.</p>

                <p>If the user denies permission, jump to the step labeled
                <em>Permission Failure</em> below. If the user never responds,
                this algorithm stalls on this step.</p>

		<p>If the user grants permission but a hardware error
		such as an OS/program/webpage lock prevents access,
		jump to the step labeled <em>Unavailable Failure</em>
		below.</p>

		<p>If the user grants permission but device access
		fails for any reason other than those listed above,
		jump to the step labeled <em>General Failure</em>
		below.</p>
              </li>

              <li>
                <p>Let <var>stream</var> be the <code>
                    <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a>
                  </code> object for which the user granted permission.</p>
              </li>

              <li>
                <p>Queue a task to invoke <var>successCallback</var> with
                <var>stream</var> as its argument.</p>
              </li>

              <li>
                <p>Abort these steps.</p>
              </li>

              <li>
                <p><em>Permission Failure</em>: Let <var>error</var> be a new
                <code>
                    <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
                  </code> object whose <code>
                    name
                  </code> attribute has the value
                <code>PermissionDeniedError</code> and jump to the step
                labeled <em>Error Task</em> below.</p>
              </li>

              <li>
                <p><em>Constraint Failure</em>: Let <var>error</var> be a new
                <code>
                    <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
                  </code> object whose <code>
                    name
                  </code> attribute has the value
                <code>ConstraintNotSatisfiedError</code> and whose <code>
                    <a href="#widl-MediaStreamError-constraintName">constraintName</a>
                  </code> attribute is set to the name of the constraint that
                caused the error.</p>
              </li>

              <li>
                <p><em>Unavailable Failure</em>: Let <var>error</var> be a new
                <code>
                    <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
                  </code> object whose <code>
                    name
                  </code> attribute has the value
                <code>SourceUnavailableError</code> and jump to the step
                labeled <em>Error Task</em> below.</p>
              </li>

              <li>
                <p><em>General Failure</em>: Let <var>error</var> be a new
                <code>
                    <a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a>
                  </code> object whose <code>
                    name
                  </code> attribute has the value
                <code>AbortError</code> and jump to the step
                labeled <em>Error Task</em> below.</p>
              </li>

              <li>
                <p><em>Error Task:</em> Queue a task to invoke
                <var>errorCallback</var> with <var>error</var> as its
                argument.</p>
              </li>

              <li style="list-style: none; display: inline">
                <p>The task source for these <span title="concept-task">tasks</span> is the user interaction task
                source.</p>
              </li>
            </ol>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">constraints</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamConstraints"><code>MediaStreamConstraints</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-NavigatorUserMediaSuccessCallback"><code>NavigatorUserMediaSuccessCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">errorCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-NavigatorUserMediaErrorCallback"><code>NavigatorUserMediaErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
      </section>

      <section id="mediastreamconstraints">
        <h3 id="h3_mediastreamconstraints" role="heading" aria-level="2"><span class="secno">10.3 </span>MediaStreamConstraints</h3>

        <p>The <code>MediaStreamConstraints</code> dictionary is used to
        instruct the UA what sort of <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>s to include in
        the <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a> returned by <a class="internalDFN" href="#dom-mediadevices-getusermedia">getUserMedia()</a>.</p>

        <pre class="idl"><span class="idlDictionary" id="idl-def-MediaStreamConstraints">dictionary <span class="idlDictionaryID">MediaStreamConstraints</span> {
<span class="idlMember">    <span class="idlMemberType">(boolean or <a class="idlType" href="#idl-def-MediaTrackConstraints"><code>MediaTrackConstraints</code></a>)</span> <span class="idlMemberName"><a href="#widl-MediaStreamConstraints-video">video</a></span> = <span class="idlMemberValue">false</span>;</span>
<span class="idlMember">    <span class="idlMemberType">(boolean or <a class="idlType" href="#idl-def-MediaTrackConstraints"><code>MediaTrackConstraints</code></a>)</span> <span class="idlMemberName"><a href="#widl-MediaStreamConstraints-audio">audio</a></span> = <span class="idlMemberValue">false</span>;</span>
};</span></pre><section id="dictionary-mediastreamconstraints-members"><h4 id="h4_dictionary-mediastreamconstraints-members" role="heading" aria-level="3"><span class="secno">10.3.1 </span>Dictionary <a href="#idl-def-MediaStreamConstraints" class="idlType"><code>MediaStreamConstraints</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-MediaStreamConstraints-audio"><code>audio</code> of type <span class="idlMemberType">(boolean or MediaTrackConstraints)</span>, defaulting to <code>false</code></dt><dd>
            <p>If <code>true</code>, it requests that the returned
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a> contain an audio track. If a <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a>
            structure is provided, it further specifies the nature and
            settings of the audio Track. If <code>false</code>, the
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a> <em title="MUST" class="rfc2119">MUST</em> not contain an audio Track.</p>
          </dd><dt id="widl-MediaStreamConstraints-video"><code>video</code> of type <span class="idlMemberType">(boolean or MediaTrackConstraints)</span>, defaulting to <code>false</code></dt><dd>
            <p>If <code>true</code>, it requests that the returned
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a> contain a video track. If a <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a>
            structure is provided, it further specifies the nature and
            settings of the video Track. If <code>false</code>, the
            <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a> <em title="MUST" class="rfc2119">MUST</em> not contain a video Track.</p>
          </dd></dl></section>
      </section>

      <section id="navigatorusermediasuccesscallback">
        <h3 id="h3_navigatorusermediasuccesscallback" role="heading" aria-level="2"><span class="secno">10.4 </span>NavigatorUserMediaSuccessCallback</h3>

        <pre class="idl"><span class="idlCallback" id="idl-def-NavigatorUserMediaSuccessCallback">callback <span class="idlCallbackID">NavigatorUserMediaSuccessCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></span> <span class="idlParamName">stream</span></span>);</span></pre><section id="callback-navigatorusermediasuccesscallback-parameters"><h4 id="h4_callback-navigatorusermediasuccesscallback-parameters" role="heading" aria-level="3"><span class="secno">10.4.1 </span>Callback <a href="#idl-def-NavigatorUserMediaSuccessCallback" class="idlType"><code>NavigatorUserMediaSuccessCallback</code></a> Parameters</h4><dl class="callback-members"><dt id="widl-NavigatorUserMediaSuccessCallback-stream"><code>stream</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a></span></dt><dd>
            <div class="issue"><div id="h_issue_5" role="heading" aria-level="4" class="issue-title"><span>Issue 5</span></div><p class="">Add explanation of handleEvent</p></div>
          </dd></dl></section>
      </section>

      <section id="navigatorusermediaerrorcallback">
        <h3 id="h3_navigatorusermediaerrorcallback" role="heading" aria-level="2"><span class="secno">10.5 </span>NavigatorUserMediaErrorCallback</h3>

        <pre class="idl"><span class="idlCallback" id="idl-def-NavigatorUserMediaErrorCallback">callback <span class="idlCallbackID">NavigatorUserMediaErrorCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span> <span class="idlParamName">error</span></span>);</span></pre><section id="callback-navigatorusermediaerrorcallback-parameters"><h4 id="h4_callback-navigatorusermediaerrorcallback-parameters" role="heading" aria-level="3"><span class="secno">10.5.1 </span>Callback <a href="#idl-def-NavigatorUserMediaErrorCallback" class="idlType"><code>NavigatorUserMediaErrorCallback</code></a> Parameters</h4><dl class="callback-members"><dt id="widl-NavigatorUserMediaErrorCallback-error"><code>error</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span></dt><dd>
            <div class="issue"><div id="h_issue_6" role="heading" aria-level="4" class="issue-title"><span>Issue 6</span></div><p class="">Add explanation of handleEvent</p></div>
          </dd></dl></section>
      </section>

      <section id="implementation-suggestions" class="informative">
        <h3 id="h3_implementation-suggestions" role="heading" aria-level="2"><span class="secno">10.6 </span>Implementation Suggestions</h3><p><em>This section is non-normative.</em></p>

        <div class="practice">
          <span class="practicelab" id="resource-reservation">Best Practice 1: Resource
          reservation</span>

          <p class="practicedesc">The user agent is encouraged to reserve
          resources when it has determined that a given call to <a href="#dom-mediadevices-getusermedia">getUserMedia()</a> will
          succeed. It is preferable to reserve the resource prior to invoking
          the success callback provided by the web page. Subsequent calls to
          <a href="#dom-mediadevices-getusermedia">getUserMedia()</a> (in this
          page or any other) should treat the resource that was previously
          allocated, as well as resources held by other applications, as busy.
          Resources marked as busy should not be provided as sources to the
          current web page, unless specified by the user. Optionally, the user
          agent may choose to provide a stream sourced from a busy source but
          only to a page whose origin matches the owner of the original stream
          that is keeping the source busy.</p>

          <p class="practicedesc">This document recommends that in the
          permission grant dialog or device selection interace (if one
          is present), the user be allowed to select any available
          hardware as a source for the stream requested by the page
          (provided the resource is able to fulfill mandatory
          constraints, if any were specified).  Although not
          specifically recommended as best practice, note that some
          user agents may support the ability to substitute a video or
          audio source with local files and other media. A file picker
          may be used to provide this functionality to the user.</p>

          <p class="practicedesc">This document also recommends that the user
          be shown all resources that are currently busy as a result of prior
          calls to <a href="#dom-mediadevices-getusermedia">getUserMedia()</a>
          (in this page or any other page that is still alive) and be allowed
          to terminate that stream and utilize the resource for the current
          page instead. If possible in the current operating environment, it
          is also suggested that resources currently held by other
          applications be presented and treated in the same manner. If the
          user chooses this option, the track corresponding to the resource
          that was provided to the page whose stream was affected must be
          removed.</p>
        </div>

        <div class="practice">
          <span class="practicelab" id="handling-devices">Best Practice 2: Handling multiple
          devices</span>

          <p class="practicedesc">A <a class="idlType" href="#idl-def-MediaStream"><code>MediaStream</code></a> may contain more than
          one video and audio track. This makes it possible to include video
          from two or more webcams in a single stream object, for example.
          However, the current API does not allow a page to express a need for
          multiple video streams from independent sources.</p>

          <p class="practicedesc">It is recommended for multiple calls to <a href="#dom-mediadevices-getusermedia">getUserMedia()</a> from the
          same page be allowed as a way for pages to request multiple,
          discrete, video or audio streams.</p>

          <p class="practicedesc">A single call to <a href="#dom-mediadevices-getusermedia">getUserMedia()</a> will always
          return a stream with either zero or one audio tracks, and either
          zero or one video tracks. If a script calls <a href="#dom-mediadevices-getusermedia">getUserMedia()</a> multiple
          times before reaching a stable state, this document advises the UI
          designer that the permission dialogs should be merged, so that the
          user can give permission for the use of multiple cameras and/or
          media sources in one dialog interaction. The constraints on each
          getUserMedia call can be used to decide which stream gets which
          media sources.</p>
        </div>
      </section>
    </section>

    <section rel="bibo:Chapter" resource="#constrainable-interface" typeof="bibo:Chapter" id="constrainable-interface">
      <!--OddPage--><h2 id="h2_constrainable-interface" role="heading" aria-level="1"><span class="secno">11. </span>Constrainable Pattern</h2>

      <p>The Constrainable pattern allows its consumers to inspect and adjust
      the properties of the object that implements it. It is broken out as a
      separate set of definitions so that it can be referred to by other
      specifications. The core concept is that of a Capability, which consists
      of a property or feature of an object and the set of its possible
      values, which may be specified either as a range or as an enumeration.
      For example, a camera might be capable of framerates (a property)
      between 20 and 50 frames per second (a range) and may be able to be
      positioned (a property) facing towards the user, away from the user, or
      to the left or right of the user (an enumerated set.) The application
      can examine a ConstrainablePattern object's set of Capabilities via the
      <code>getCapabilities()</code> accessor.</p>

      <p>The application can select the (range of) values it wants for an
      object's Capabilities by means of basic and/or advanced ConstraintSets
      and the <code>applyConstraints()</code> method. A ConstraintSet consists
      of the names of one or more properties of the object plus the desired
      value (or a range of desired values) for each of them. Each of those
      property/value pairs can be considered to be an individual constraint.
      For example, the application may set a ConstraintSet containing two
      constraints, the first stating that the framerate of a camera be between
      30 and 40 frames per second (a range) and the second that the camera
      should be facing the user (a specific value). How the individual
      constraints interact depends on whether and how they are given in the
      basic Constraint structure, which is a ConstraintSet with an additional
      'advanced' property, or whether they are in a ConstraintSet in the
      advanced list. The behavior is as follows: all 'min', 'max', and 'exact'
      constraints in the basic Constraint structure are together treated as
      the 'required' set, and if it is not possible to satisfy simultaneously
      all of those individual constraints for tho indicated property names,
      the UA <em title="MUST" class="rfc2119">MUST</em> call the <code>errorCallback</code>. Otherwise, it must
      apply the required constraints. Next, it will consider any
      ConstraintSets given in the 'advanced' list, in the order in which they
      are specified, and will try to satisfy/apply each complete ConstraintSet
      (i.e., all constraints in the ConstraintSet together), but will skip a
      ConstraintSet if and only if it cannot satisfy/apply it in its entirety.
      Next, the UA <em title="MUST" class="rfc2119">MUST</em> attempt to apply, individually, any 'ideal' constraint
      or a constraint given as a bare value for the property. Of these
      properties, it <em title="MUST" class="rfc2119">MUST</em> satisfy the largest number that it can, in any
      order. Finally, the UA <em title="MUST" class="rfc2119">MUST</em> call the <code>successCallback</code>.</p>

      <p>Important note: If JavaScript applications using this API want the
      attributes in the constraints to be used by the browser, the JavaScript
      code has to first check, via <code>getSupportedConstraints()</code>,
      that all the named properties that are used are supported by the
      browser. The reason for this is that WebIDL drops any unsupported names
      from the dictionary holding the constraints, so the browser does not see
      them and the unsupported names end up being silently ignored. This will
      cause confusing programming errors as the JavaScript code will be
      setting constraints but the browser will be ignoring them. Browsers that
      support (recognize) the name of a required constraint but cannot satisfy
      it will generate an error, while browsers that do not support the given
      name of the constraint will not generate an error. </p>

      <div class="issue"><div id="h_issue_7" role="heading" aria-level="2" class="issue-title"><span>Issue 7</span></div><p class="">The definition and behavior of 'ideal', along with that
      of bare values in the basic constraint structure (which are assumed to
      mean 'ideal'), have not yet been agreed upon, or even thoroughly
      discussed.</p></div>

      <p>The following examples may help to understand how constraints work.
      The first shows a basic Constraint structure. Three constraints are
      given, each of which the UA will attempt to satisfy individually.
      Depending upon the resolutions available for this camera, it is possible
      that not all three constraints can be satisfied at the same time. If so,
      the user agent will satisfy two if it can, or only one if not even two
      constraints can be satisfied together. Note that if not all three can be
      satisfied simultaneously, it is possible that there is more than one
      combination of two constraints that could be satisfied. If so, the user
      agent will choose.</p>

      <div class="example"><div class="example-title"><span>Example 1</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"aspectRatio"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 </span><span class="kwd">var</span><span class="pln"> constraints </span><span class="pun">=</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
    width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1280</span><span class="pun">,</span><span class="pln">
    height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">720</span><span class="pun">,</span><span class="pln">
    aspectRatio</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.5</span><span class="pln">
  </span><span class="pun">};</span></pre></div>

      <p>This next example adds a small bit of complexity. The ideal values
      are still given for width and height, but this time with minimum
      requirements on each as well that must be satisfied. If it cannot
      satisfy either the width or height minimum it will call the
      <code>errorCallback</code>. Otherwise, it will try to satisfy the width,
      height, and aspectRatio target values as well and then call the
      <code>successCallback</code>.</p>

      <div class="example"><div class="example-title"><span>Example 2</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"aspectRatio"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 </span><span class="kwd">var</span><span class="pln"> constraints </span><span class="pun">=</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
    width</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> </span><span class="lit">640</span><span class="pun">,</span><span class="pln"> ideal</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1280</span><span class="pun">},</span><span class="pln">
    height</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> ideal</span><span class="pun">:</span><span class="pln"> </span><span class="lit">720</span><span class="pun">},</span><span class="pln">
    aspectRatio</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.5</span><span class="pln">
  </span><span class="pun">};</span></pre></div>

      <p>This example illustrates the full control possible with the
      Constraints structure by adding the 'advanced' property. In this case,
      the user agent behaves the same way with respect to the required
      constraints, but before attempting to satisfy the ideal values it will
      process the 'advanced' list. In this example the 'advanced' list
      contains two ConstraintSets. The first specifies width and height
      constraints, and the second specifies an aspectRatio constraint. Note
      that in the advanced list, these bare values are treated as 'exact'
      values. This example represents the following: "I need my video to be at
      least 640 pixels wide and at least 480 pixels high. My preference is for
      precisely 1920x1280, but if you can't give me that, give me an
      aspectRatio of 4x3 if at all possible. If even that is not possible,
      give me a resolution as close to 1280x720 as possieble."</p>

      <div class="example"><div class="example-title"><span>Example 3</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"width"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"height"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
 </span><span class="kwd">var</span><span class="pln"> constraints </span><span class="pun">=</span><span class="pln">
  </span><span class="pun">{</span><span class="pln">
    width</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> </span><span class="lit">640</span><span class="pun">,</span><span class="pln"> ideal</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1280</span><span class="pun">},</span><span class="pln">
    height</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">min</span><span class="pun">:</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> ideal</span><span class="pun">:</span><span class="pln"> </span><span class="lit">720</span><span class="pun">},</span><span class="pln">
    advanced</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln">width</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1920</span><span class="pun">,</span><span class="pln"> height</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1280</span><span class="pun">},</span><span class="pln">
               </span><span class="pun">{</span><span class="pln">aspectRatio</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.3333333333</span><span class="pun">}]</span><span class="pln">
  </span><span class="pun">};</span></pre></div>

      <p>The ordering of advanced ConstraintSets is significant. In the
      preceding example it is impossible to satisfy both the 1920x1280
      ConstraintSet and the 4x3 aspect ratio ConstraintSet at the same time.
      Since the 1920x1280 occurs first in the list, the user agent will
      attempt to satisfy it first. Application authors can therefore implement
      a backoff strategy by specifying multiple optional ConstraintSets for
      the same property. For example, an application might specify three
      optional ConstraintSets, the first asking for a framerate greater than
      500, the second asking for a framerate greater than 400, and the third
      asking for one greater than 300. If the UA is capable of setting a
      framerate greater than 500, it will (and the subsequent two
      ConstraintSets will be trivially satisfied.) However, if the UA cannot
      set the framerate above 500, it will skip that ConstraintSet and attempt
      to set the framerate above 400. If that fails, it will then try to set
      it above 300. If the UA cannot satisfy any of the three ConstraintSets,
      it will set the framerate to any value it can get. If the developer
      wanted to insist on 300 as a lower bound, he could provide that as a
      'min' value in the basic ConstraintSet. In that case, the UA would fail
      altogether if it couldn't get a value over 300, but would choose a value
      over 500 if possible, then try for a value over 400.</p>

      <p>Note that, unlike basic constraints, the constraints within a
      ConstraintSet in the advanced list must be satisfied together or skipped
      together. Thus, {width: 1920, height: 1280} is a request for that
      specific resolution, not a request for that width or that height. One
      can think of the basic constraints as requesting an or (non-exclusive)
      of the individual constraints, while each advanced ConstraintSet is
      requesting an and of the individual constraints in the ConstraintSet. An
      application may inspect the full set of Constraints currently in effect
      via the <code>getConstraints()</code> accessor.</p>

      <p>The specific value that the UA chooses for a Capability is referred
      to as a Setting. For example, if the application applies a ConstraintSet
      specifying that the framerate must be at least 30 frames per second, and
      no greater than 40, the Setting can be any intermediate value, e.g., 32,
      35, or 37 frames per second. The application can query the current
      settings of the object's Capabilities via the <code>
          <a class="internalDFN" href="#dfn-getsettings">getSettings()</a>
        </code> accessor.</p>

      <section id="interface-definition">
        <h3 id="h3_interface-definition" role="heading" aria-level="2"><span class="secno">11.1 </span>Interface Definition</h3>

        <p>Due to the limitations of the interface definition language used in
        this specification, it is not possible for other interfaces to inherit
        or implement ConstrainablePattern. Therefore the WebIDL definitions
        given are only templates to be copied. Each interface that wishes to
        make use of the functionality defined here will have to provide its
        own copy of the WebIDL for the functions and interfaces given here.
        However it can refer to the semantics defined here, which will not
        change. See <a href="#media-stream-track-interface-definition">MediaStreamTrack
        Interface Definition</a> for an example of this.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-ConstrainablePattern">[<span class="extAttr">NoInterfaceObject</span>]
interface <span class="idlInterfaceID">ConstrainablePattern</span> {
<span class="idlMethod">    <span class="idlMethType"><a class="internalDFN" href="#dfn-capabilities">Capabilities</a></span> <span class="idlMethName"><a href="#widl-ConstrainablePattern-getCapabilities-Capabilities">getCapabilities</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a></span>  <span class="idlMethName"><a href="#widl-ConstrainablePattern-getConstraints-Constraints">getConstraints</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="internalDFN" href="#dfn-settings">Settings</a></span>     <span class="idlMethName"><a href="#widl-ConstrainablePattern-getSettings-Settings">getSettings</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">void</span>         <span class="idlMethName"><a href="#widl-ConstrainablePattern-applyConstraints-void-Constraints-constraints-VoidFunction-successCallback-ConstraintErrorCallback-errorCallback">applyConstraints</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a></span> <span class="idlParamName">constraints</span></span>, <span class="idlParam"><span class="idlParamType">VoidFunction</span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-ConstraintErrorCallback"><code>ConstraintErrorCallback</code></a></span> <span class="idlParamName">errorCallback</span></span>);</span>
<span class="idlAttribute">                attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-ConstrainablePattern-onoverconstrained">onoverconstrained</a></span>;</span>
};</span></pre><section id="attributes-8"><h4 id="h4_attributes-8" role="heading" aria-level="3"><span class="secno">11.1.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-ConstrainablePattern-onoverconstrained"><code>onoverconstrained</code> of type <span class="idlAttrType">EventHandler</span>,            </dt><dd>This event handler, of type <code>
              <a href="#event-constrainable-overconstrained">overconstrained</a>
            </code>, <em class="rfc2119" title="must">must</em> be supported
          by all objects implementing the <code>
              <a class="idlType" href="#idl-def-ConstrainablePattern"><code>ConstrainablePattern</code></a>
            </code> pattern. <p>The UA <em class="rfc2119" title="must">must</em> raise a <code>MediaStreamErrorEvent</code>
          named "overconstrained" if changing circumstances at runtime result
          in it no longer being able to satisfy the
          <var>requiredConstraints</var> from the currently valid Constraints.
          This MediaStreamErrorEvent <em class="rfc2119" title="must">must</em> contain a MediaStreamError whose
          <code>name</code> is <code>OverconstrainedError</code>, and whose
          <code>constraintName</code> attribute is set to one of the
          <var>requiredConstraints</var> that can no longer be satisfied. The
          <code>message</code> attribute of the MediaStreamError <em title="SHOULD" class="rfc2119">SHOULD</em>
          contain a string that is useful for debugging. The conditions under
          which this error might occur are platform and application-specific.
          For example, the user might physically manipulate a camera in a way
          that makes it impossible to provide a resolution that satisfies the
          constraints. The UA <em title="MAY" class="rfc2119">MAY</em> take other actions as a result of the
          overconstrained situation.</p> </dd></dl></section><section id="methods-5"><h4 id="h4_methods-5" role="heading" aria-level="3"><span class="secno">11.1.2 </span>Methods</h4><dl class="methods"><dt id="widl-ConstrainablePattern-applyConstraints-void-Constraints-constraints-VoidFunction-successCallback-ConstraintErrorCallback-errorCallback"><code>applyConstraints</code></dt><dd>
            

            <p>The <dfn id="dfn-applyconstraints">applyConstraints()</dfn> algorithm for applying
            constraints is stated below. Here are some preliminary definitions
            that are used in the statement of the algorithm:</p>

            <ul>
              <li>We refer to each element of a ConstraintSet (other than the
              special term 'advanced') as a 'constraint' since it is intended
              to constrain the corresponding Capability of the
              ConstrainablePattern object to a value that is within the range
              or list of values it specifies.</li>

              <li>We refer to the "effective Capability" C of an object O as
              the possibly proper subset of the possible values of C (as
              returned by getCapabilities) taking into consideration
              environmental limitations and/or restrictions placed by other
              constraints. For example given a ConstraintSet that constrains
              Capabilities aspectRatio, height and width, the values assigned
              to any two of the Capabilities limit the effective Capability of
              the third. The set of effective Capabilities may be platform
              dependent. For example, on a resource-limited device it may not
              be possible to set Capabilities C1 and C2 both to 'high', while
              on another less limited device, this may be possible.</li>

              <li>A set of values for the Capabilities of an object O satisfy
              ConstraintSet CS if each value a) is in the range of the
              corresponding effective Capability of O, and b) is in the range
              or list of values specified by the corresponding constraint in
              CS, if there is one, and c) there is no constraint in CS that
              does not correspond to a Capability of O. (Note that although
              this definition ignores the difference between required and
              optional ConstraintSets, the algorithm below distinguishes
              between them.)</li>

              <li>A set of ConstraintSets CS1...CSn (n &gt;= 1) can be
              satisfied by an object O if it is possible to choose a sequence
              of values for the Capabilities of O that satisfy CS1...CSn
              simultaneously.</li>

              <li>To apply a set of ConstraintSet CS1...CSn to object O is to
              choose such a sequence of values that satisfy CS1...CSn and
              assign them as the settings for the properties of O.</li>
            </ul>

            <p>When <code>applyConstraints</code> is called, the UA <em class="rfc2119" title="must">must</em> queue a task to run the
            following steps:</p>

            <ol>
              <li>let <var>newContraints</var> be the argument to this
              function. Each constraint <em class="rfc2119" title="must">must</em> specify one or more values (or a range of
              values) for its property. A property <em class="rfc2119" title="may">may</em> appear more than once in the list of
              'advanced' ConstraintSets. Let <var>requiredConstraints</var> be
              the set of 'min', 'max', and 'exact' constraints appearing in
              <var>newConstraints</var>. Let <var>unorderedConstraints</var>
              be all the other constraints in <var>newConstraints</var>. Note
              that 'advanced' is not a member of either of these sets since it
              represents meta-information about constraints. In the following
              we treat <var>requiredConstraints</var> and
              <var>unorderedConstraints</var> as ConstraintSets. Note that
              unknown properties are discarded by WebIDL, which means that
              unknown/unsupported required constraints will silently
              disappear. To avoid this being a surprise, application authors
              are expected to first use the
              <code>getSupportedConstraints()</code> method as shown in the
              Examples below.</li>

              <li>Let <var>object</var> be the ConstrainablePattern object on
              which this method was called. Let <var>copy</var> be an
              unconstrained copy of <var>object</var> (i.e., <var>copy</var>
              should behave as if it were <var>object</var> with all
              ConstraintSets removed.)</li>

              <li>If <var>requiredConstraints</var> is non-null and cannot be
              satisfied by <var>copy</var>, call the
              <code>errorCallback</code>, passing it a new
              <code>MediaStreamError</code> with name
              <code>ConstraintNotSatisfied</code> and
              <code>constraintName</code> set to any of the required
              constraints that could not be satisfied, and return.
              <var>existingConstraints</var> remain in effect in this
              case.</li>

              <li>Let <var>successfulConstraints</var> be a list of
              ConstraintSets, initially containing only
              <var>requiredConstraints</var>. Iterate over the 'advanced'
              ConstraintSets in <var>newConstraints</var> in the order in
              which they were specified. For each ConstraintSet, if it and
              <var>successfulConstraints</var> together can be satisfied by
              <var>copy</var>, append it to the rear of
              <var>successfulConstraints</var>. Otherwise, skip it. </li>

              <li>In a single operation, remove <var>existingConstraints</var>
              from <var>object</var>, apply <var>successfulConstraints</var>,
              then apply the largest subset of <var>unorderedConstraints</var>
              that can be satisifed. (If more than one 'largest subset' can be
              satisfied, the UA is free to select which 'largest subset' it
              chooses.) Finally fire the <code>successCallback</code>. From
              this point on until applyConstraints() is called successfully
              again, getConstraints() <em class="rfc2119" title="must">must</em> return the <var>newConstraints</var> that
              were passed as an argument to this call. </li>
            </ol>

            <p>The UA <em class="rfc2119" title="may">may</em> choose new
            settings for the Capabilities of the object at any time. When it
            does so it <em class="rfc2119" title="must">must</em> attempt to
            satisfy the current Constraints, in the manner described in the
            algorithm above. </p>

            <div class="issue"><div id="h_issue_8" role="heading" aria-level="4" class="issue-title"><span>Issue 8</span></div><p class="">The definition of how multiple
            unorderedConstraints are to be satisfied together is still very
            much under discussion. Also, please see issue 6 about 'ideal' not
            yet being defined.</p></div>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">constraints</td><td class="prmType"><code><a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">A new constraint structure to apply to this object.</td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code>VoidFunction</code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">Called if the required constraints can be satisfied.</td></tr><tr><td class="prmName">errorCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-ConstraintErrorCallback"><code>ConstraintErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">✘</span></td><td class="prmOptFalse"><span role="img" aria-label="False">✘</span></td><td class="prmDesc">Called if the required constraints cannot be satisfied.</td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-ConstrainablePattern-getCapabilities-Capabilities"><code>getCapabilities</code></dt><dd>
            <p>The <dfn id="dfn-getcapabilities">getCapabilities()</dfn> method returns the dictionary
            of the capabilities that the object supports.</p>

            <div class="note"><div id="h_note_8" role="heading" aria-level="4" class="note-title"><span>Note</span></div><div class="">
              <p>It is possible that the underlying hardware may not exactly
              map to the range defined in the registry entry. Where this is
              possible, the entry <em class="rfc2119" title="should">should</em> define how to translate and scale the
              hardware's setting onto the values defined in the entry. For
              example, suppose that a registry entry defines a hypothetical
              fluxCapacitance capability that is defined to be the range from
              -10 (min) to 10 (max), but there are common hardware devices
              that support only values of "off" "medium" and "full". The
              registry entry might specify that for such hardware, the user
              agent should map the range value of -10 to "off", 10 to "full",
              and 0 to "medium". It might also indicate that given a
              ConstraintSet imposing a strict value of 3, the user agent
              should attempt to set the value of "medium" on the hardware, and
              and that <code>
                  <a class="internalDFN" href="#dfn-getsettings">getSettings()</a>
                </code> should return a fluxCapacitance of 0, since that is
              the value defined as corresponding to "medium".</p>
            </div></div>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="internalDFN" href="#dfn-capabilities">Capabilities</a></code></div></dd><dt id="widl-ConstrainablePattern-getConstraints-Constraints"><code>getConstraints</code></dt><dd>The <dfn id="dfn-getconstraints">getConstraints</dfn> method returns the Constraints
          that were the argument to the last successful call of
          <code>applyConstraints()</code>, maintaining the order in which they
          were specified. Note that some of the optional ConstraintSets
          returned may not be currently satisfied. To check which
          ConstraintSets are currently in effect, the application should use
          <code>getSettings</code>. <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a></code></div></dd><dt id="widl-ConstrainablePattern-getSettings-Settings"><code>getSettings</code></dt><dd>The <dfn id="dfn-getsettings">getSettings()</dfn> method returns the current settings
          of all the properties of the object, whether they are platform
          defaults or have been set by <code>applyConstraints()</code>. Note
          that the actual setting of a property <em class="rfc2119" title="must">must</em> be a single value. <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="internalDFN" href="#dfn-settings">Settings</a></code></div></dd></dl></section>

        <section id="applyconstraints-failure-callback">
          <h4 id="h4_applyconstraints-failure-callback" role="heading" aria-level="3"><span class="secno">11.1.3 </span>applyConstraints Failure Callback</h4>

          <section>
            <section>
              <h6 role="heading" aria-level="5" id="constrainterrorcallback">ConstraintErrorCallback</h6>

              <pre class="idl"><span class="idlCallback" id="idl-def-ConstraintErrorCallback">callback <span class="idlCallbackID">ConstraintErrorCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span> <span class="idlParamName">error</span></span>);</span></pre><section><h6 role="heading" aria-level="6" id="callback-constrainterrorcallback-parameters">Callback <a href="#idl-def-ConstraintErrorCallback" class="idlType"><code>ConstraintErrorCallback</code></a> Parameters</h6><dl class="callback-members"><dt id="widl-ConstraintErrorCallback-error"><code>error</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamError"><code>MediaStreamError</code></a></span></dt><dd>An <code>MediaStreamError</code> holding a required
                constraint that could not be satisfied.</dd></dl></section>
            </section>
          </section>
        </section>

        <p>An example of Constraints that could be passed into <code>
            <a class="internalDFN" href="#dfn-applyconstraints">applyConstraints()</a>
          </code> or returned as a value of <code>
            <a class="internalDFN" href="#dfn-constraints">constraints</a>
          </code> is below. It uses the properties defined in <a href="#sec-track-properties">the Track property registry</a>.</p>

        <div class="example"><div class="example-title"><span>Example 4</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"facingMode"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> constraints </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">640</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"height"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">480</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"advanced"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln">
      </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">650</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">650</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="str">"frameRate"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">60</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="str">"max"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">800</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="str">"facingMode"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"user"</span><span class="pln">
    </span><span class="pun">}]</span><span class="pln">
</span><span class="pun">};</span></pre></div>

        <p>Here is another example, specifically for a video track where I
        must have a particular camera and have separate preferences for the
        width and height:</p>

        <div class="example"><div class="example-title"><span>Example 5</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"sourceId"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> constraints </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  sourceId</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"exact"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"20983-20o198-109283-098-09812"</span><span class="pun">},</span><span class="pln">
  advanced</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln">
      width</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        min</span><span class="pun">:</span><span class="pln"> </span><span class="lit">800</span><span class="pun">,</span><span class="pln">
        max</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1200</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      height</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        min</span><span class="pun">:</span><span class="pln"> </span><span class="lit">600</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}]</span><span class="pln">
</span><span class="pun">};</span></pre></div>

        <p>And here's one for an audio track:</p>

        <div class="example"><div class="example-title"><span>Example 6</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"audio"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"sourceId"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"gain"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> constraints </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  advanced</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln">
      sourceId</span><span class="pun">:</span><span class="pln"> </span><span class="str">"64815-wi3c89-1839dk-x82-392aa"</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      gain</span><span class="pun">:</span><span class="pln"> </span><span class="lit">0.5</span><span class="pln">
    </span><span class="pun">}]</span><span class="pln">
</span><span class="pun">};</span></pre></div>

        <p>Here's an example of use of ideal:</p>

        <div class="example"><div class="example-title"><span>Example 7</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"aspectRatio"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"facingMode"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln">
  </span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">320</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ideal"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1280</span><span class="pun">,</span><span class="pln"> </span><span class="str">"max"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1920</span><span class="pun">},</span><span class="pln">
    </span><span class="str">"height"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">240</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ideal"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">720</span><span class="pun">,</span><span class="pln"> </span><span class="str">"max"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1080</span><span class="pun">},</span><span class="pln">
    </span><span class="str">"framerate"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">30</span><span class="pun">,</span><span class="pln">     </span><span class="com">// Shorthand for ideal.</span><span class="pln">
    </span><span class="com">// "facingMode": "environment" would be optional.</span><span class="pln">
    </span><span class="str">"facingMode"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"exact"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"environment"</span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}},</span><span class="pln"> </span><span class="pun">...);</span></pre></div>

        <p>Here's an example of "I want 720p, but I can accept up to 1080p and
        down to VGA.":</p>

        <div class="example"><div class="example-title"><span>Example 8</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"width"</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> </span><span class="pun">!</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"height"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// Treat like an error.</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">640</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ideal"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1280</span><span class="pun">,</span><span class="pln"> </span><span class="str">"max"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1920</span><span class="pun">},</span><span class="pln">
  </span><span class="str">"height"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">480</span><span class="pun">,</span><span class="pln"> </span><span class="str">"ideal"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">720</span><span class="pun">,</span><span class="pln"> </span><span class="str">"max"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1080</span><span class="pun">},</span><span class="pln">
</span><span class="pun">}},</span><span class="pln"> </span><span class="pun">...);</span></pre></div>

        <p>Here's an example of "I want a front-facing camera and it must be
        VGA.":</p>

        <div class="example"><div class="example-title"><span>Example 9</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="kwd">var</span><span class="pln"> supports </span><span class="pun">=</span><span class="pln"> navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getSupportedConstraints</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">supports</span><span class="pun">[</span><span class="str">"facingMode"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"facingMode"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"exact"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"user"</span><span class="pun">},</span><span class="pln">
    </span><span class="str">"width"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"exact"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">640</span><span class="pun">},</span><span class="pln">
    </span><span class="str">"height"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="str">"exact"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">480</span><span class="pun">}</span><span class="pln">
  </span><span class="pun">}},</span><span class="pln"> </span><span class="pun">...);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </section>

      <section rel="bibo:Chapter" resource="#registry" typeof="bibo:Chapter" id="registry">
        <h3 id="h3_registry" role="heading" aria-level="2"><span class="secno">11.2 </span>The Property Registry</h3>

        <p>There is a single <a href="#sec-iana">IANA registry</a> that
        defines the constrainable properties of all objects that implement the
        Constrainable pattern. The registry entries <em class="rfc2119" title="must">must</em> contain the name of each property along with
        its set of legal values. The registry entries for MediaStreamTrack are
        defined <a href="#sec-constraints">below</a>. The syntax for the
        specification of the set of legal values depends on the type of the
        values. In addition to the standard atomic types (boolean, long,
        double, DOMString), legal values include lists of any of the atomic
        types, plus min-max ranges, as defined below.</p>


        <p>List values <em class="rfc2119" title="must">must</em> be
        interpreted as disjunctions. For example, if a property 'facingMode'
        for a camera is defined as having legal values ["left", "right",
        "user", "environment"], this means that 'facingMode' can have the
        value "left", the value "right", the value "environment" or the value
        "user". Similarly <a class="idlType" href="#idl-def-Constraints"><code>Constraints</code></a> restricting 'facingMode' to
        ["user", "left", "right"] would mean that the UA should select a
        camera (or point the camera, if that is possible) so that "facingMode"
        is either "user", "left", or "right". This Constraint would thus
        request that the camera not be facing away from the user, but would
        allow the UA to choose among the other directions.</p>

        <pre class="idl"><span class="idlDictionary" id="idl-def-ConstrainDoubleRange">dictionary <span class="idlDictionaryID">ConstrainDoubleRange</span> {
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-ConstrainDoubleRange-max">max</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-ConstrainDoubleRange-min">min</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-ConstrainDoubleRange-exact">exact</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-ConstrainDoubleRange-ideal">ideal</a></span>;</span>
};</span></pre><section id="dictionary-constraindoublerange-members"><h4 id="h4_dictionary-constraindoublerange-members" role="heading" aria-level="3"><span class="secno">11.2.1 </span>Dictionary <a href="#idl-def-ConstrainDoubleRange" class="idlType"><code>ConstrainDoubleRange</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-ConstrainDoubleRange-exact"><code>exact</code> of type <span class="idlMemberType">double</span></dt><dd>The exact required value for this property.</dd><dt id="widl-ConstrainDoubleRange-ideal"><code>ideal</code> of type <span class="idlMemberType">double</span></dt><dd>The ideal (target) value for this property.</dd><dt id="widl-ConstrainDoubleRange-max"><code>max</code> of type <span class="idlMemberType">double</span></dt><dd>The maximum legal value of this property.</dd><dt id="widl-ConstrainDoubleRange-min"><code>min</code> of type <span class="idlMemberType">double</span></dt><dd>The minimum value of this Property.</dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-ConstrainLongRange">dictionary <span class="idlDictionaryID">ConstrainLongRange</span> {
<span class="idlMember">    <span class="idlMemberType">long</span> <span class="idlMemberName"><a href="#widl-ConstrainLongRange-max">max</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">long</span> <span class="idlMemberName"><a href="#widl-ConstrainLongRange-min">min</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">long</span> <span class="idlMemberName"><a href="#widl-ConstrainLongRange-exact">exact</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">long</span> <span class="idlMemberName"><a href="#widl-ConstrainLongRange-ideal">ideal</a></span>;</span>
};</span></pre><section id="dictionary-constrainlongrange-members"><h4 id="h4_dictionary-constrainlongrange-members" role="heading" aria-level="3"><span class="secno">11.2.2 </span>Dictionary <a href="#idl-def-ConstrainLongRange" class="idlType"><code>ConstrainLongRange</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-ConstrainLongRange-exact"><code>exact</code> of type <span class="idlMemberType">long</span></dt><dd>The exact required value for this property.</dd><dt id="widl-ConstrainLongRange-ideal"><code>ideal</code> of type <span class="idlMemberType">long</span></dt><dd>The ideal (target) value for this property.</dd><dt id="widl-ConstrainLongRange-max"><code>max</code> of type <span class="idlMemberType">long</span></dt><dd>The maximum legal value of this property.</dd><dt id="widl-ConstrainLongRange-min"><code>min</code> of type <span class="idlMemberType">long</span></dt><dd>The minimum value of this property.</dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-ConstrainDOMStringParameters">dictionary <span class="idlDictionaryID">ConstrainDOMStringParameters</span> {
<span class="idlMember">    <span class="idlMemberType">(DOMString or sequence&lt;DOMString&gt;&gt;)</span> <span class="idlMemberName"><a href="#widl-ConstrainDOMStringParameters-exact">exact</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">(DOMString or sequence&lt;DOMString&gt;&gt;)</span> <span class="idlMemberName"><a href="#widl-ConstrainDOMStringParameters-ideal">ideal</a></span>;</span>
};</span></pre><section id="dictionary-constraindomstringparameters-members"><h4 id="h4_dictionary-constraindomstringparameters-members" role="heading" aria-level="3"><span class="secno">11.2.3 </span>Dictionary <a href="#idl-def-ConstrainDOMStringParameters" class="idlType"><code>ConstrainDOMStringParameters</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-ConstrainDOMStringParameters-exact"><code>exact</code> of type <span class="idlMemberType">(DOMString or sequence&lt;DOMString&gt;&gt;)</span></dt><dd>The exact required value for this property.</dd><dt id="widl-ConstrainDOMStringParameters-ideal"><code>ideal</code> of type <span class="idlMemberType">(DOMString or sequence&lt;DOMString&gt;&gt;)</span></dt><dd>The ideal (target) value for this property.</dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-ConstrainVideoFacingModeParameters">dictionary <span class="idlDictionaryID">ConstrainVideoFacingModeParameters</span> {
<span class="idlMember">    <span class="idlMemberType">(<a class="idlType" href="#idl-def-VideoFacingModeEnum"><code>VideoFacingModeEnum</code></a> or sequence&lt;VideoFacingModeEnum&gt;&gt;)</span> <span class="idlMemberName"><a href="#widl-ConstrainVideoFacingModeParameters-exact">exact</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType">(<a class="idlType" href="#idl-def-VideoFacingModeEnum"><code>VideoFacingModeEnum</code></a> or sequence&lt;<a class="idlType" href="#idl-def-VideoFacingModeEnum"><code>VideoFacingModeEnum</code></a>&gt;)</span>  <span class="idlMemberName"><a href="#widl-ConstrainVideoFacingModeParameters-ideal">ideal</a></span>;</span>
};</span></pre><section id="dictionary-constrainvideofacingmodeparameters-members"><h4 id="h4_dictionary-constrainvideofacingmodeparameters-members" role="heading" aria-level="3"><span class="secno">11.2.4 </span>Dictionary <a href="#idl-def-ConstrainVideoFacingModeParameters" class="idlType"><code>ConstrainVideoFacingModeParameters</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-ConstrainVideoFacingModeParameters-exact"><code>exact</code> of type <span class="idlMemberType">(VideoFacingModeEnum or sequence&lt;VideoFacingModeEnum&gt;&gt;)</span></dt><dd>The exact required value for this property.</dd><dt id="widl-ConstrainVideoFacingModeParameters-ideal"><code>ideal</code> of type <span class="idlMemberType">(VideoFacingModeEnum or sequence&lt;VideoFacingModeEnum&gt;)</span></dt><dd>The ideal (target) value for this property.</dd></dl></section>

        <pre class="idl"><span class="idlTypedef" id="idl-def-ConstrainLong">typedef <span class="idlTypedefType">(Long or <a class="idlType" href="#idl-def-ConstrainLongRange"><code>ConstrainLongRange</code></a>)</span> <span class="idlTypedefID">ConstrainLong</span>;</span></pre><div class="idlTypedefDesc">

        <pre class="idl"><span class="idlTypedef" id="idl-def-ConstrainDouble">typedef <span class="idlTypedefType">(Double or <a class="idlType" href="#idl-def-ConstrainDoubleRange"><code>ConstrainDoubleRange</code></a>)</span> <span class="idlTypedefID">ConstrainDouble</span>;</span></pre><div class="idlTypedefDesc">

        <pre class="idl"><span class="idlTypedef" id="idl-def-ConstrainDOMString">typedef <span class="idlTypedefType">(DOMString or sequence&lt;DOMString&gt; or <a class="idlType" href="#idl-def-ConstrainDOMStringParameters"><code>ConstrainDOMStringParameters</code></a>)</span> <span class="idlTypedefID">ConstrainDOMString</span>;</span></pre><div class="idlTypedefDesc">

        <pre class="idl"><span class="idlTypedef" id="idl-def-ConstrainVideoFacingMode">typedef <span class="idlTypedefType">(<a class="idlType" href="#idl-def-VideoFacingModeEnum"><code>VideoFacingModeEnum</code></a> or sequence&lt;<a class="idlType" href="#idl-def-VideoFacingModeEnum"><code>VideoFacingModeEnum</code></a>&gt; or ConstrainVideoFacingModeEnumParameters)</span> <span class="idlTypedefID">ConstrainVideoFacingMode</span>;</span></pre><div class="idlTypedefDesc">
      </div></div></div></div></section>

      <section rel="bibo:Chapter" resource="#capabilities" typeof="bibo:Chapter" id="capabilities">
        <h3 id="h3_capabilities" role="heading" aria-level="2"><span class="secno">11.3 </span>Capabilities</h3>

        <p><dfn id="dfn-capabilities">Capabilities</dfn> are a dictionary containing one or more
        key-value pairs, where each key <em class="rfc2119" title="must">must</em> be a constrainable property defined in the
        registry, and each value <em class="rfc2119" title="should">must</em>
        be a subset of the set of values defined for that property in the
        registry. The exact syntax of the value expression depends on the type
        of the property, and its type is as defined in the Values column of
        the registry. The Capabilities dictionary specifies the subset of the
        constrainable properties and values from the registry that the UA
        supports. Note that a UA <em class="rfc2119" title="may">may</em>
        support only a subset of the properties that are defined in the
        registry, and <em class="rfc2119" title="may">may</em> support a
        subset of the set values for those properties that it does support.
        Note that Capabilities are returned from the UA to the application,
        and cannot be specified by the application. However, the application
        can control the Settings that the UA chooses for Capabilities by means
        of Constraints.</p>

        <p>An example of a Capabilities dictionary is shown below. This
        example is not very realistic in that a browser would actually be
        required to support more settings that just these.</p>

        <div class="example"><div class="example-title"><span>Example 10</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="pun">{</span><span class="pln">
  </span><span class="str">"frameRate"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="str">"min"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">1.0</span><span class="pun">,</span><span class="pln">
    </span><span class="str">"max"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">60.0</span><span class="pln">
  </span><span class="pun">},</span><span class="pln">
  </span><span class="str">"facingMode"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"user"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"environment"</span><span class="pun">]</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </section>

      <section rel="bibo:Chapter" resource="#settings" typeof="bibo:Chapter" id="settings">
        <h3 id="h3_settings" role="heading" aria-level="2"><span class="secno">11.4 </span>
          <dfn id="dfn-settings">Settings</dfn>
        </h3>

        <p>A <dfn id="dfn-setting">Setting</dfn> is a dictionary containing one or more
        key-value pairs. It <em class="rfc2119" title="must">must</em> contain
        each key returned in <code>getCapabilities()</code>. There <em class="rfc2119" title="must">must</em> be a single value for each key
        and the value <em class="rfc2119" title="must">must</em> a member of
        the set defined for that property by <code>capabilities()</code>. The
        <code>Settings</code> dictionary contains the actual values that the
        UA has chosen for the object's Capabilities. The exact syntax of the
        value depends on the type of the property.</p>

        <p>A conforming user-agent <em class="rfc2119" title="must">must</em> support all the setting names defined in this
        spec.</p>

        <p>An example of a Setting dictionary is shown below. This example is
        not very realistic in that a browser would actually be required to
        support more settings that just these.</p>

        <div class="example"><div class="example-title"><span>Example 11</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="pun">{</span><span class="pln">
  </span><span class="str">"frameRate"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">30.0</span><span class="pun">,</span><span class="pln">
  </span><span class="str">"facingMode"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"user"</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </section>

      <section rel="bibo:Chapter" resource="#constraints" typeof="bibo:Chapter" id="constraints">
        <h3 id="h3_constraints" role="heading" aria-level="2"><span class="secno">11.5 </span>
          <dfn id="dfn-constraints-and-constraintset">Constraints and ConstraintSet</dfn>
        </h3>

        <p>Due to the limitiations of WebIDL, interfaces implementing the
        Constrainable Pattern cannnot simply subclass Constraints and
        ConstraintSet as they are defined here. Instead they must provide
        their own definitions that follow this pattern. See <a href="#media-track-constraints"> MediaTrackConstraints</a> for an
        example of this.</p>

        <pre class="idl"><span class="idlTypedef" id="idl-def-ConstraintSet">typedef <span class="idlTypedefType">Dictionary</span> <span class="idlTypedefID">ConstraintSet</span>;</span></pre><div class="idlTypedefDesc">

        <p>Each member of a ConstraintSet corresponds to a Capability and
        specifies a subset of its legal values. Applying a ConstraintSet
        instructs that UA to restrict the setting of the corresponding
        Capabilities to the specified values or ranges of values. A given
        property <em title="MAY" class="rfc2119">MAY</em> occur both in the basic Constraints set and in the
        advanced ConstraintSets list, and <em title="MAY" class="rfc2119">MAY</em> occur at most once in each
        ConstraintSet in the advanced list.</p>

        <pre class="idl"><span class="idlDictionary" id="idl-def-Constraints">dictionary <span class="idlDictionaryID">Constraints</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-ConstraintSet"><code>ConstraintSet</code></a></span> {
<span class="idlMember">    <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-ConstraintSet"><code>ConstraintSet</code></a>&gt;</span> <span class="idlMemberName"><a href="#widl-Constraints-advanced">advanced</a></span>;</span>
};</span></pre><section><h4 role="heading" aria-level="3" id="dictionary-constraints-members">Dictionary <a href="#idl-def-Constraints" class="idlType"><code>Constraints</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-Constraints-advanced"><code>advanced</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-ConstraintSet"><code>ConstraintSet</code></a>&gt;</span></dt><dd>
            <p>The list of ConstraintSets that the UA <em class="rfc2119" title="should">must</em> attempt to satisfy, in order, skipping
            only those that cannot be satisfied. The order of these
            ConstraintSets is significant. In particular, when they are passed
            as an argument to <code>applyConstraints</code>, the UA <em class="rfc2119" title="must">must</em> try to satisfy them in the
            order that is specified. Thus if optional ConstraintSets C1 and C2
            can be satisfied individually, but not together, then whichever of
            C1 and C2 is first in this list will be satisfied, and the other
            will not. The UA <em class="rfc2119" title="must">must</em>
            attempt to satisfy all optional ConstraintSets in the list, even
            if some cannot be satisfied. Thus, in the preceding example, if
            optional constraint C3 is specified after C1 and C2, the UA will
            attempt to satisfy C3 even though C2 cannot be satisfied. Note
            that a given property name may occur only once in each
            ConstraintSet but may occur in more than one ConstraintSet.</p>
          </dd></dl></section>
      </div></section>
    </section>

    <section id="examples">
      <!--OddPage--><h2 id="h2_examples" role="heading" aria-level="1"><span class="secno">12. </span>Examples</h2>

      <div>
        <p>This sample code exposes a button. When clicked, the button is
        disabled and the user is prompted to offer a stream. The user can
        cause the button to be re-enabled by providing a stream (e.g., giving
        the page access to the local camera) and then disabling the stream
        (e.g., revoking that access).</p>

        <div class="example"><div class="example-title"><span>Example 12</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="tag">&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"button"</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"Start"</span><span class="pln"> </span><span class="atn">onclick</span><span class="pun">=</span><span class="atv">"</span><span class="pln">start</span><span class="pun">()</span><span class="atv">"</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"startBtn"</span><span class="tag">&gt;</span><span class="pln">
</span><span class="tag">&lt;script&gt;</span><span class="pln">
 </span><span class="kwd">var</span><span class="pln"> startBtn </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">'startBtn'</span><span class="pun">);</span><span class="pln">

 </span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln">
         audio</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
         video</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
     </span><span class="pun">},</span><span class="pln"> gotStream</span><span class="pun">,</span><span class="pln"> logError</span><span class="pun">);</span><span class="pln">
     startBtn</span><span class="pun">.</span><span class="pln">disabled </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">function</span><span class="pln"> gotStream</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     stream</span><span class="pun">.</span><span class="pln">oninactive </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
         startBtn</span><span class="pun">.</span><span class="pln">disabled </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
     </span><span class="pun">};</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">function</span><span class="pln"> logError</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">
</span><span class="tag">&lt;/script&gt;</span></pre></div>
      </div>

      <!-- Put back when we define MediaStreamRecorder
    <div>

      <p>This example allows people to record a short audio message and upload
      it to the server. This example even shows rudimentary error handling.</p>

      <pre xml:space="preserve" class="example highlight">
&lt;input type="button" value="Start" onclick="msgRecord()" id="recBtn"&gt;
&lt;input type="button" value="Stop" onclick="msgStop()" id="stopBtn" disabled&gt;
&lt;p id="status"&gt;To start recording, press the Start button.&lt;/p&gt;
&lt;script&gt;
 var recBtn = document.getElementById('recBtn');
 var stopBtn = document.getElementById('stopBtn');

 function report(s) {
     document.getElementById('status').textContent = s;
 }

 function msgRecord() {
     report('Attempting to access microphone...');
     navigator.getUserMedia({
         audio: true
     }, gotStream, noStream);
     recBtn.disabled = true;
 }
 var msgStream, msgStreamRecorder;

 function gotStream(stream) {
     report('Recording... To stop, press the Stop button.');
     msgStream = stream;
     msgStreamRecorder = stream.record();
     stopBtn.disabled = false;
     stream.oninactive = function () {
         msgStop();
     }
 }

 function msgStop() {
     report('Creating file...');
     stopBtn.disabled = true;
     msgStream.oninactive = null;
     msgStream.stop();
     msgStreamRecorder.getRecordedData(msgSave);
 }

 function msgSave(blob) {
     report('Uploading file...');
     var x = new XMLHttpRequest();
     x.open('POST', 'uploadMessage');
     x.send(blob);
     x.onload = function () {
         report('Done! To record a new message, press the Start button.');
         recBtn.disabled = false;
     };
     x.onerror = function () {
         report('Failed to upload message. To try recording a message again, press the Start button.');
         recBtn.disabled = false;
     };
 }

 function noStream() {
     report('Could not obtain access to your microphone. To try again, press the Start button.');
     recBtn.disabled = false;
 }
&lt;/script&gt;
</pre>
    </div>-->

      <div>
        <p>This example allows people to take photos of themselves from the
        local video camera. Note that the Image Capture
        specification [<cite><a href="#bib-image-capture" class="bibref">image-capture</a></cite>] provides a simpler way to accomplish this.</p>

        <div class="example"><div class="example-title"><span>Example 13</span></div><pre style="" class="example highlight prettyprint prettyprinted" xml:space="preserve"><span class="tag">&lt;article&gt;</span><span class="pln">
 </span><span class="tag">&lt;style</span><span class="pln"> </span><span class="atn">scoped</span><span class="tag">&gt;</span><span class="pln">
  video </span><span class="pun">{</span><span class="pln"> transform</span><span class="pun">:</span><span class="pln"> scaleX</span><span class="pun">(-</span><span class="lit">1</span><span class="pun">);</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
  p </span><span class="pun">{</span><span class="pln"> text</span><span class="pun">-</span><span class="pln">align</span><span class="pun">:</span><span class="pln"> center</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
 </span><span class="tag">&lt;/style&gt;</span><span class="pln">
 </span><span class="tag">&lt;h1&gt;</span><span class="pln">Snapshot Kiosk</span><span class="tag">&lt;/h1&gt;</span><span class="pln">
 </span><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"splash"</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"errorMessage"</span><span class="tag">&gt;</span><span class="pln">Loading...</span><span class="tag">&lt;/p&gt;</span><span class="pln">
 </span><span class="tag">&lt;/section&gt;</span><span class="pln">
 </span><span class="tag">&lt;section</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"app"</span><span class="pln"> </span><span class="atn">hidden</span><span class="tag">&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;&lt;video</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"monitor"</span><span class="pln"> </span><span class="atn">autoplay</span><span class="tag">&gt;&lt;/video&gt;</span><span class="pln"> </span><span class="tag">&lt;canvas</span><span class="pln"> </span><span class="atn">id</span><span class="pun">=</span><span class="atv">"photo"</span><span class="tag">&gt;&lt;/canvas&gt;</span><span class="pln">
  </span><span class="tag">&lt;p&gt;&lt;input</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">button</span><span class="pln"> </span><span class="atn">value</span><span class="pun">=</span><span class="atv">"&amp;#x1F4F7;"</span><span class="pln"> </span><span class="atn">onclick</span><span class="pun">=</span><span class="atv">"</span><span class="pln">snapshot</span><span class="pun">()</span><span class="atv">"</span><span class="tag">&gt;</span><span class="pln">
 </span><span class="tag">&lt;/section&gt;</span><span class="pln">
 </span><span class="tag">&lt;script&gt;</span><span class="pln">
 navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln">
     video</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln">
 </span><span class="pun">},</span><span class="pln"> gotStream</span><span class="pun">,</span><span class="pln"> noStream</span><span class="pun">);</span><span class="pln">
 </span><span class="kwd">var</span><span class="pln"> video </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">'monitor'</span><span class="pun">);</span><span class="pln">
 </span><span class="kwd">var</span><span class="pln"> canvas </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">'photo'</span><span class="pun">);</span><span class="pln">

 </span><span class="kwd">function</span><span class="pln"> gotStream</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     video</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
     stream</span><span class="pun">.</span><span class="pln">oninactive </span><span class="pun">=</span><span class="pln"> noStream</span><span class="pun">;</span><span class="pln">
     video</span><span class="pun">.</span><span class="pln">onloadedmetadata </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
         canvas</span><span class="pun">.</span><span class="pln">width </span><span class="pun">=</span><span class="pln"> video</span><span class="pun">.</span><span class="pln">videoWidth</span><span class="pun">;</span><span class="pln">
         canvas</span><span class="pun">.</span><span class="pln">height </span><span class="pun">=</span><span class="pln"> video</span><span class="pun">.</span><span class="pln">videoHeight</span><span class="pun">;</span><span class="pln">
         document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">'splash'</span><span class="pun">).</span><span class="pln">hidden </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
         document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">'app'</span><span class="pun">).</span><span class="pln">hidden </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
     </span><span class="pun">};</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">function</span><span class="pln"> noStream</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">'errorMessage'</span><span class="pun">).</span><span class="pln">textContent </span><span class="pun">=</span><span class="pln"> </span><span class="str">'No camera available.'</span><span class="pun">;</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">

 </span><span class="kwd">function</span><span class="pln"> snapshot</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
     canvas</span><span class="pun">.</span><span class="pln">getContext</span><span class="pun">(</span><span class="str">'2d'</span><span class="pun">).</span><span class="pln">drawImage</span><span class="pun">(</span><span class="pln">video</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">
 </span><span class="pun">}</span><span class="pln">
 </span><span class="tag">&lt;/script&gt;</span><span class="pln">
</span><span class="tag">&lt;/article&gt;</span></pre></div>
      </div>
    </section>

    <section id="privacy-and-security-considerations">
      <!--OddPage--><h2 id="h2_privacy-and-security-considerations" role="heading" aria-level="1"><span class="secno">13. </span>Privacy and Security Considerations</h2>

      <p>This section is non-normative; it specifies no new behaviour, but
      instead summarizes information already present in other parts of the
      specification.</p>

      <p>This document extends the Web platform with the ability to manage
      input devices for media - in this iteration, microphones and cameras. It
      also allows the manipulation of audio output devices (speakers and
      headphones).</p>

      <p>Without authorization (to the “drive-by web”), it offers the ability
      to tell how many devices there are of each class. The identifiers for
      the devices are designed to not be useful for a fingerprint that can
      track the user between origins, but the number of devices adds to the
      fingerprint surface.</p>

      <p>When authorization is given, this document describes how to get
      access to, and use, media data from the devices mentioned. This data may
      be sensitive; advice is given that indicators should be supplied to
      indicate that devices are in use, but both the nature of authorization
      and the indicators of in-use devices are platform decisions.</p>

      <p>Authorization may be given on a case-by-case basis, or be persistent.
      In the case of a case-by-case authorization, it is important that the
      user be able to say “no” in a way that prevents the UI from blocking
      user interaction until permission is given - either by offering a way to
      say a “persistent NO” or by not using a modal permissions dialog.</p>

      <p>It is possible to use constraints so that the failure of a
      getUserMedia call will return information about devices on the system
      without prompting the user, which increases the surface available for
      fingerprinting. The UA should consider limiting the rate at which failed
      getUserMedia calls are allowed in order to limit this additional
      surface.</p>

      <p>In the case of persistent authorization, it is important that it’s
      easy to find the list of granted permissions and revoke permissions that
      the user wishes to revoke.</p>

      <p>Once permission has been granted, the UA should make two things
      readily apparent to the user: </p><ul>
          <li>That the page has access to the devices for which permission is
          given</li>

          <li>Whether or not any of the devices are presently recording ("on
          air") indicator</li>
        </ul> <p></p>
    </section>

    <section id="iana-registrations" rel="bibo:Chapter" resource="#sec-iana" typeof="bibo:Chapter">
      <!--OddPage--><h2 role="heading" aria-level="1" id="sec-iana"><span class="secno">14. </span>IANA Registrations</h2>

      <section id="track-property-registrations" rel="bibo:Chapter" resource="#sec-track-properties" typeof="bibo:Chapter">
        <h3 role="heading" aria-level="2" id="sec-track-properties"><span class="secno">14.1 </span>Track Property Registrations</h3>

        <p>IANA is requested to register the following properties as specified
        in [<cite><a href="#bib-RTCWEB-CONSTRAINTS" class="bibref">RTCWEB-CONSTRAINTS</a></cite>]:</p>

        <p>The following constraint names are defined to apply to both video
        and audio <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects:</p>

        <table class="simple">
          <thead>
            <tr>
              <th>Property Name</th>

              <th>Values</th>

              <th>Notes</th>
            </tr>
          </thead>

          <tbody>
            <tr id="def-constraint-sourceType">
              <td>
                <dfn id="dfn-sourcetype">sourceType</dfn>
              </td>

              <td>
                
                  <code>SourceTypeEnum</code>
                
              </td>

              <td> The type of the source of the <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>. Note
              that the setting of this property is uniquely determined by the
              source that is attached to the Track. In particular,
              getCapabilities() will return only a single value for
              sourceID/Type. This property can therefore be used for initial
              media selection with getUserMedia(). However is not useful for
              subsequent media control with applyConstraints, since any
              attempt to set a different value will result in an unsatisfiable
              ConstraintSet. </td>
            </tr>

            <tr id="def-constraint-sourceId">
              <td>
                <dfn id="dfn-sourceid">sourceId</dfn>
              </td>

              <td>DOMString</td>

              <td>The application-unique identifier for this source. The same
              identifier <em title="MUST" class="rfc2119">MUST</em> be valid between sessions of this application,
              but <em title="MUST" class="rfc2119">MUST</em> also be different for other applications. Some sort of
              GUID is recommended for the identifier. Note that the setting of
              this property is uniquely determined by the source that is
              attached to the Track. In particular, getCapabilities() will
              return only a single value for sourceID/Type. This property can
              therefore be used for initial media selection with
              getUserMedia(). However is not useful for subsequent media
              control with applyConstraints, since any attempt to set a
              different value will result in an unsatisfiable ConstraintSet.
              </td>
            </tr>

            <tr id="def-constraint-groupId">
              <td>
                <dfn id="dfn-groupid">groupId</dfn>
              </td>

              <td>DOMString</td>

              <td>The group identifier for this source. Two devices have the
              same group identifier if they belong to the same physical
              device; for example the audio input and output devices of a
              headset.</td>
            </tr>
          </tbody>
        </table>

        <p>The following properties are defined to apply only to video <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects:</p>

        <table class="simple">
          <thead>
            <tr>
              <th>Property Name</th>

              <th>Values</th>

              <th>Notes</th>
            </tr>
          </thead>

          <tbody>
            <tr id="def-constraint-width">
              <td>
                <dfn id="dfn-width">width</dfn>
              </td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></code>
              </td>

              <td>The width or width range, in pixels, of the video source. As
              a capability, the range should span the video source's pre-set
              width values with min being the smallest width and max being the
              largest width.</td>
            </tr>

            <tr id="def-constraint-height">
              <td>
                <dfn id="dfn-height">height</dfn>
              </td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></code>
              </td>

              <td>The height or height range, in pixels, of the video source.
              As a capability, the range should span the video source's
              pre-set height values with min being the smallest height and max
              being the largest height.</td>
            </tr>

            <tr id="def-constraint-frameRate">
              <td>
                <dfn id="dfn-framerate">frameRate</dfn>
              </td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></code>
              </td>

              <td>The exact desired frame rate (frames per second) or
              frameRate range of the video source. If the source does not
              natively provide a frameRate, or the frameRate cannot be
              determined from the source stream, then this value <em title="MUST" class="rfc2119">MUST</em> refer to
              the user agent's vsync display rate.</td>
            </tr>

            <tr id="def-constraint-aspect">
              <td>
                <dfn id="dfn-aspectratio">aspectRatio</dfn>
              </td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></code>
              </td>

              <td>The exact aspect ratio (width in pixels divided by height in
              pixels), represented as a double rounded to the tenth decimal
              place.</td>
            </tr>

            <tr id="def-constraint-facingMode">
              <td>
                <dfn id="dfn-facingmode">facingMode</dfn>
              </td>

              <td>
                <code>
                  <a class="idlType" href="#idl-def-ConstrainDOMString"><code>ConstrainDOMString</code></a>
                </code>
              </td>

              <td>The members of the enum describe the directions that the
              camera can face, as seen from the user's perspective. Valid
              values for the strings in the ConstrainDOMString are the values
              of <code>enum VideoFacingModeEnum</code>.</td>
            </tr>
          </tbody>
        </table>

        <pre class="idl"><span class="idlEnum" id="idl-def-VideoFacingModeEnum">enum <span class="idlEnumID">VideoFacingModeEnum</span> {
    "<a href="#idl-def-VideoFacingModeEnum.user" class="idlEnumItem">user</a>",
    "<a href="#idl-def-VideoFacingModeEnum.environment" class="idlEnumItem">environment</a>",
    "<a href="#idl-def-VideoFacingModeEnum.left" class="idlEnumItem">left</a>",
    "<a href="#idl-def-VideoFacingModeEnum.right" class="idlEnumItem">right</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-VideoFacingModeEnum.user">user</code></td><td>The source is facing toward the user (a self-view camera).</td></tr><tr><td><code id="idl-def-VideoFacingModeEnum.environment">environment</code></td><td>The source is facing away from the user (viewing the
          environment).</td></tr><tr><td><code id="idl-def-VideoFacingModeEnum.left">left</code></td><td>The source is facing to the left of the user.</td></tr><tr><td><code id="idl-def-VideoFacingModeEnum.right">right</code></td><td>The source is facing to the right of the user.</td></tr></tbody></table>

        <p>Below is an illustration of the video facing modes in relation to
        the user.<br> <img alt="Illustration of video facing modes in relation to user" src="images/camera-names-exp.svg" style="width:40%"></p>

        <p>The following properties are defined to apply only to audio <code>
            <a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
          </code> objects:</p>

        <table class="simple">
          <thead>
            <tr>
              <th>Property Name</th>

              <th>Values</th>

              <th>Notes</th>
            </tr>
          </thead>

          <tbody>
            <tr id="def-constraint-volume">
              <td>volume</td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainDouble"><code>ConstrainDouble</code></a></code>
              </td>

              <td>The volume or volume range of the audio source, as a
              percentage. A volume of 0.0 is silence, while a volume of 1.0 is
              the maximum supported volume. Note that any ConstraintSet that
              specifies values outside of this range can never be
              satisfied.</td>
            </tr>

            <tr id="def-constraint-sampleRate">
              <td>sampleRate</td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></code>
              </td>

              <td>The sample rate in samples per second for the audio
              data.</td>
            </tr>

            <tr id="def-constraint-sampleSize">
              <td>sampleSize</td>

              <td>
                <code><a class="idlType" href="#idl-def-ConstrainLong"><code>ConstrainLong</code></a></code>
              </td>

              <td>The linear sample size in bits. This constraint can only be
              satisfied for audio devices that produce linear samples. </td>
            </tr>

            <tr id="def-constraint-echoCancellation">
              <td> echoCancellation </td>

              <td>
                <code>boolean</code>
              </td>

              <td> When one or more audio streams is being played in the
              processes of various microphones, it is often desirable to attempt
              to remove the sound being played from the input signals recorded
              by the microphones. This is referred to echo cancellation. There
              are cases where it is not needed and it is desirable to turn it
              off so that no audio artifacts are introduced. This allows
              applications to control this behavior. </td>
            </tr>
          </tbody>
        </table>

        <div class="note"><div id="h_note_9" role="heading" aria-level="3" class="note-title"><span>Note</span></div><div class=""> Open Issue: volume seems like better as double, or
        even better as double in dB. what value is it set at if one wants it
        half as loud? </div></div>

        <dl>
      </dl></section>
    </section>

    <section id="change-log">
      <!--OddPage--><h2 id="h2_change-log" role="heading" aria-level="1"><span class="secno">15. </span>Change Log</h2>

      <p>This section will be removed before publication.</p>

      <h2 id="changes-since-august-17-2014">Changes since August 17, 2014</h2>
      <ol>
        <li>Bug 25988: Need a list of MediaStreamError "name" values</li>

        <li>Bug 26623: Use commonest spelling of "cancellation"</li>

        <li>Bug 25767: Missing Ref to Image Capture spec</li>

        <li>Bug 22271: Terminology section should not have conformance
        requirements</li>
      </ol>

      <h2 id="changes-since-july-4-2014">Changes since July 4, 2014</h2>

      <ol>
        <li>Bug 22251: Added new NotFoundError, AbortError,
        SourceUnavailable errors to gUM call.</li>
        <li>Bug 25786: User agent allowance of files to be substituted
        for any input device is now permitted but not listed as best
        practice, i.e., no longer specifically recommended.</li>
      </ol>

      <h2 id="changes-since-june-19-2014">Changes since June 19, 2014</h2>

      <ol>
        <li>Bug 22354: Added privacy and security section.</li>

        <li>Bug 25784: "on air" indication is underspecified - separated
        "access granted" and "on air" indicators.</li>

        <li>Bug 26192: add onoverconstrained to MediaStreamTrack</li>

        <li>Bug 25776: add groupID to MediaTrackConstraintSet</li>

        <li>Bug 25780: Clarify step 3 of MediaStream.clone</li>

        <li>Bug 25804: Change 'remote' attribute definition</li>

        <li>Bug 25650: In getUserMedia algorithm if user denies permission
        spec is wrongly redirecting to Constraint Failure.</li>

        <li>Bug 25605: Definition of MediaStreamTrackEvent is not
        complete</li>

        <li>Bug 25651: All the links in spec should redirect to specified
        contents without failure.</li>

        <li>Bug 25725: getUserMedia constraints should be non-nullable</li>

        <li>Bug 25763: does the ID really have to be exaclty 36 char
        long?</li>

        <li>Bug 24934: invalid definition for the “seekable” attribute when
        MediaStream is set to srcObject.</li>

        <li>Removed MediaStreamTrack new state (sourceType none removed as a
        consequence) (as discussed in bug 25787).</li>

        <li>Bug 25801: Remove getNativeSettings()</li>
      </ol>

      <h2 id="changes-since-may-7-2014">Changes since May 7, 2014</h2>

      <ol>
        <li>Clarified that skipping of optional/advanced ConstraintSets is
        only permitted if they cannot be satisfied, not merely because the
        user agent wishes to.</li>

        <li>Bug 25855: Clarification about conformance requirements phrased as
        algorithms</li>

        <li>Bug 25803: Mark section entitled "The model: sources, sinks,
        constraints, and settings" as non-normative</li>

        <li>Bug 24015: Add callback to indicate when available media devices
        change (introduced Navigator.mediaDevices)</li>

        <li>Bug 25860: make sure we have a bug to have a getTracks that gives
        you all the tracks</li>

        <li>Bug 25884: applied constraint syntax consensus as realized in June
        9 WG email from Peter Thatcher.</li>

        <li>Moved getSupportedConstraints() method to MediaDevices
        object.</li>

        <li>Added stricter requirements on the getSupportedConstraints()
        return value.</li>

        <li>Added issue note in Constrainable Pattern section that ideal is
        not yet defined.</li>

        <li>Added issue note for applyConstraints that how multiple
        unorderedConstraints are to be satisfied together is not yet
        defined.</li>

        <li>Added informative notes that WebIDL discards unknown required
        properties and that application authors need to use the
        <code>getSupportedConstraints()</code> method.</li>

        <li>Cleaned up the MediaStream API intro section (mainly MediaStream
        behavior that have moved to MediaStreamTrack).</li>

        <li>The concept of MediaStreamTrack with a detachable source is now
        used throughout the spec (removed language saying that a MST could be
        disassociated from its track).</li>

        <li>Moved peerIdentity related text to WebRTC.</li>
      </ol>

      <h2 id="changes-since-march-21-2014">Changes since March 21, 2014</h2>

      <ol>
        <li>New webIDL for Constrainable and Constraints.</li>

        <li>Bug 24931: changed MediaError to MediaStreamError.</li>

        <li>Bug 23817: Redundant TOC headers 8.1 &amp; 9.1</li>

        <li>Bug 25230: readyState attribute must be inherited while cloning a
        MediaStreamTrack</li>

        <li>Bug 25249: Source should be detached when a MediaStreamTrack stops
        for any reason other than stop</li>

        <li>Updated Event Summary section to match the spec regarding
        MediaStreamTrack.stop() (as discussed in bug 25248)</li>

        <li>Made the MediaStream() constructor behave like addTrack() WRT
        adding ended tracks (as discussed in bug 25250).</li>

        <li>Bug 25262: MediaStream Constructor algorithm must also check for
        MediaStreamTracks "ended" state while initializing "active"
        state.</li>

        <li>Bug 25276: Initialization for VideoTrack.selected attribute is
        missing while specifying steps for "Loading and Playing a MediaStream
        in a Media Element"</li>

        <li>Changed syntax of constraints to use 'require' and 'advanced' and
        support non-required, non-advanced constraints.</li>

        <li>Bug 25360: MediaStreamTrack should not be considered as ended just
        because remote peer stopped sending data.</li>

        <li>Bug 25275: VideoTrackList.selectedIndex initialization conflicts
        with HTML5 spec, "if no track is selected".</li>

        <li>Removed mentioning of MediaStream received from other peer (as
        discussed in bug 25361).</li>

        <li>Bug 22263: Clarify synchronization of tracks in a MediaStream</li>

        <li>Bug 25441: Overconstrained muted state should not link with
        MediaStreamTrack.readyState</li>
      </ol>

      <h2 id="changes-since-february-18-2014">Changes since February 18, 2014</h2>

      <ol>
        <li>Bug 24928: Remove MediaStream state check from addTrack()
        algorithm. </li>

        <li>Bug 24930: Remove MediaStream state check from the removeTrack()
        algorithm.</li>

        <li>Added native settings to tracks.</li>

        <li>Removed videoMediaStreamTrack and audioMediaStreamTrack since they
        are no longer necessary.</li>
      </ol>

      <h2 id="changes-since-december-25-2013">Changes since December 25, 2013</h2>

      <ol>
        <li>Make optional constraints a list of ConstraintSets. Make
        ConstraintSet an object.</li>

        <li>Remove noaccess, move peerIdentity</li>

        <li>Add constraints for sampleRate, sampleSize, and
        echoCancellation.</li>

        <li>Aligned text in remainder of document with Constrainable
        changes.</li>

        <li>Removed statements that constraints are not applied to read-only
        sources</li>
      </ol>

      <h2 id="changes-since-november-5-2013">Changes since November 5, 2013</h2>

      <ol>
        <li>ACTION-25: Switch mediastream.inactive to mediastream.active.</li>

        <li>ACTION-26: Rewrite stop to only detach the track's source.</li>

        <li>Bug 22338: Arbitrary changing of tracks.</li>

        <li>Bug 23125: Use double rather than float.</li>

        <li>Bug 22712: VideoFacingMode enum needs an illustration.</li>

        <li>Moved constraints into a separate Constrainable interface.</li>

        <li>Created a separate section on error handling.</li>
      </ol>

      <h2 id="changes-since-october-17-2013">Changes since October 17, 2013</h2>

      <ol>
        <li>Bug 23263: Add output device enumeration to GetSources</li>

        <li>Introduced the Constrainable interface.</li>

        <li>Change consensus note on constraints in IANA section.</li>

        <li>Removed createObjectURL.</li>

        <li>Bug 22209: Should not use <em title="MUST" class="rfc2119">MUST</em> requirements on values provided by
        the developer.</li>
      </ol>

      <h2 id="changes-since-august-24-2013">Changes since August 24, 2013</h2>

      <ol>
        <li>Bug 22269: Renamed getSourceInfos() to getSources() and made the
        result async.</li>

        <li>Bug 22229: Editorial input</li>

        <li>Bug 22243: Clarify readonly track</li>

        <li>Bug 22259: Disabled mediastreamtrack and state of media
        element</li>

        <li>Bug 22226: Remove check of same source from MediaStream
        constructor algorithm</li>

        <li>Replaced ended with inactive for MediaStream (resolves bug
        21618).</li>

        <li>Bug 22264: MediaStream.ended set to true on creation</li>

        <li>Bug 22272: Permission revocation via MediaStreamTrack.stop()</li>

        <li>Bug 22248: Relationship between MediaStreamTrack and HTML5
        VideoTrack/AudioTrack after MediaStream assignment</li>

        <li>Bug 22247: Setting loop attribute on a media element reading from
        a MediaStream</li>
      </ol>

      <h2 id="changes-since-july-4-2013">Changes since July 4, 2013</h2>

      <ol>
        <li>Bug 21967: Added paragraph on MediaStreamTrack enabled state and
        updated cloning algorithm.</li>

        <li>Bug 22210: Make getUserMedia() algorithm use all numbered
        items.</li>

        <li>Bug 22250: Fixed accidentally overridden error.</li>

        <li>Bug 22211: Added async error when no valid media type is
        requested.</li>

        <li>Bug 22216: Made NavigatorUserMediaError extend DOMError.</li>

        <li>Bug 22249: Throw on attempts to set currentTime on media elements
        playing MediaStream objects.</li>

        <li>Bug 22246: Made media.buffered have length 0.</li>

        <li>Bug 22692: Updated media element to use HAVE_NOTHING state before
        media arrives on the played MediaStream and HAVE_ENOUGH_DATA as soon
        as media arrives.</li>
      </ol>

      <h2 id="may-29-2013">May 29, 2013</h2>

      <ol>
        <li>Bug 22252: fixed usage of <em title="MUST" class="rfc2119">MUST</em> in MediaStream() constructor
        description.</li>

        <li>Bug 22215: made MediaStream.ended readonly.</li>

        <li>Bug 21967: clarified MediaStreamTrack.enabled state initial
        value.</li>

        <li>Added aspectRatio constraint, capability, and state.</li>

        <li>Updated usage of MediaStreams in media elements.</li>
      </ol>

      <h2 id="may-15-2013">May 15, 2013</h2>

      <ol>
        <li>Added explanatory section for constraints, capabilities, and
        states.</li>

        <li>Added VideoFacingModeEnum (including left and right options).</li>

        <li>Added getSourceInfos() and SourceInfo dictionary.</li>

        <li>Added isolated streams.</li>
      </ol>

      <h2 id="april-29-2013">April 29, 2013</h2>

      <ol>
        <li>Removed remaining photo APIs and references (since we have a
        separate Image Capture Spec).</li>
      </ol>

      <h2 id="march-20-2013">March 20, 2013</h2>

      <ol>
        <li>Added readonly and remote attributes to MediaStreamTrack</li>

        <li>Removed getConstraint(), setConstraint(), appendConstraint(), and
        prependConstraint().</li>

        <li>Added source states. Added states() method on tracks. Moved
        sourceType and sourceId to be states.</li>

        <li>Added source capabilities. Added capabilities() method on
        tracks.</li>

        <li>Added clarifying text about MediaStreamTrack lifecycle and
        mediaflow.</li>

        <li>Made MediaStreamTrack cloning explicit.</li>

        <li>Removed takePhoto() and friends from VideoStreamTrack (we have a
        separate Image Capture Spec).</li>

        <li>Made getUserMedia() error callback mandatory.</li>
      </ol>

      <h2 id="december-12-2012">December 12, 2012</h2>

      <ol>
        <li>Changed error code to be string instead of number.</li>

        <li>Added core of settings proposal allowing for constraint changes
        after stream/track creation.</li>
      </ol>

      <h2 id="november-15-2012">November 15 2012</h2>

      <ol>
        <li>Introduced new representation of tracks in a stream (removed
        MediaStreamTrackList).</li>

        <li>Updated MediaStreamTrack.readyState to use an enum type (instad of
        unsigned short constants).</li>

        <li>Renamed MediaStream.label to MediaStream.id (the definition needs
        some more work).</li>
      </ol>

      <h2 id="october-1-2012">October 1 2012</h2>

      <ol>
        <li>Limited the track kind values to "audio" and "video" only (could
        previously be user defined as well).</li>

        <li>Made MediaStream extend EventTarget.</li>

        <li>Simplified the MediaStream constructor.</li>
      </ol>

      <h2 id="june-23-2012">June 23 2012</h2>

      <ol>
        <li>Rename title to "Media Capture and Streams".</li>

        <li>Update document to comply with HTML5.</li>

        <li>Update image describing a MediaStream.</li>

        <li>Add known issues and various other editorial changes.</li>
      </ol>

      <h2 id="june-22-2012">June 22 2012</h2>

      <ol>
        <li>Update wording for constraints algorithm.</li>
      </ol>

      <h2 id="june-19-2012">June 19 2012</h2>

      <ol>
        <li>Added "Media Streams as Media Elements section".</li>
      </ol>

      <h2 id="june-12-2012">June 12 2012</h2>

      <ol>
        <li>Switch to respec v3.</li>
      </ol>

      <h2 id="june-5-2012">June 5 2012</h2>

      <ol>
        <li>Added non-normative section "Implementation Suggestions".</li>

        <li>Removed stray whitespace.</li>
      </ol>

      <h2 id="june-1-2012">June 1 2012</h2>

      <ol>
        <li>Added media constraint algorithm.</li>
      </ol>

      <h2 id="apr-23-2012">Apr 23 2012</h2>

      <ol>
        <li>Remove MediaStreamRecorder.</li>
      </ol>

      <h2 id="apr-20-2012">Apr 20 2012</h2>

      <ol>
        <li>Add definitions of MediaStreams and related objects.</li>
      </ol>

      <h2 id="dec-21-2011">Dec 21 2011</h2>

      <ol>
        <li>Changed to make wanted media opt in (rather than opt out). Minor
        edits.</li>
      </ol>

      <h2 id="nov-29-2011">Nov 29 2011</h2>

      <ol>
        <li>Changed examples to use MediaStreamOptions objects rather than
        strings. Minor edits.</li>
      </ol>

      <h2 id="nov-15-2011">Nov 15 2011</h2>

      <ol>
        <li>Removed MediaStream stuff. Refers to webrtc 1.0 spec for that part
        instead.</li>
      </ol>

      <h2 id="nov-9-2011">Nov 9 2011</h2>

      <ol>
        <li>Created first version by copying the webrtc spec and ripping out
        stuff. Put it on github.</li>
      </ol>
    </section>

    <section id="acknowledgements" class="appendix">
      <!--OddPage--><h2 id="h2_acknowledgements" role="heading" aria-level="1"><span class="secno">A. </span>Acknowledgements</h2>

      <p>The editors wish to thank the Working Group chairs and Team Contact,
      Harald Alvestrand, Stefan Håkansson and Dominique Hazaël-Massieux, for
      their support. Substantial text in this specification was provided by
      many people including <!-- tag 1 to reduce merge conflicts when adding names to list  -->
      Jim Barnett, <!-- tag 2 --> Harald Alvestrand, <!-- tag 3 --> Travis
      Leithead, <!-- tag 4 --> <!-- tag 5 --> <!-- tag 6 --> <!-- tag 7 -->
      <!-- tag 8 --> <!-- tag 9 --> and Stefan Håkansson.</p>
    </section>
  

<section rel="bibo:Chapter" resource="#references" typeof="bibo:Chapter" id="references" class="appendix"><!--OddPage--><h2 id="h2_references" role="heading" aria-level="1"><span class="secno">B. </span>References</h2><section rel="bibo:Chapter" resource="#normative-references" typeof="bibo:Chapter" id="normative-references"><h3 id="h3_normative-references" role="heading" aria-level="2"><span class="secno">B.1 </span>Normative references</h3><dl about="" class="bibliography"><dt id="bib-HTML5">[HTML5]</dt><dd rel="dcterms:requires">Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Edward O'Connor; Silvia Pfeiffer. <a href="http://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. 31 July 2014. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd rel="dcterms:requires">S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>
</dd><dt id="bib-RTCWEB-CONSTRAINTS">[RTCWEB-CONSTRAINTS]</dt><dd rel="dcterms:requires">Dan Burnett. <a href="http://datatracker.ietf.org/doc/draft-burnett-rtcweb-constraints-registry/"><cite>IANA Registry for RTCWeb Constrainable Properties</cite></a>. 21 October 2013. Active Internet-Draft. URL: <a href="http://datatracker.ietf.org/doc/draft-burnett-rtcweb-constraints-registry/">http://datatracker.ietf.org/doc/draft-burnett-rtcweb-constraints-registry/</a>
</dd><dt id="bib-WEBIDL">[WEBIDL]</dt><dd rel="dcterms:requires">Cameron McCormack. <a href="http://www.w3.org/TR/WebIDL/"><cite>Web IDL</cite></a>. 19 April 2012. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/WebIDL/">http://www.w3.org/TR/WebIDL/</a>
</dd><dt id="bib-WEBRTC10">[WEBRTC10]</dt><dd rel="dcterms:requires">Adam Bergkvist; Daniel Burnett; Cullen Jennings; Anant Narayanan. <a href="http://www.w3.org/TR/webrtc/"><cite>WebRTC 1.0: Real-time Communication Between Browsers</cite></a>. 10 September 2013. W3C Working Draft. URL: <a href="http://www.w3.org/TR/webrtc/">http://www.w3.org/TR/webrtc/</a>
</dd></dl></section><section rel="bibo:Chapter" resource="#informative-references" typeof="bibo:Chapter" id="informative-references"><h3 id="h3_informative-references" role="heading" aria-level="2"><span class="secno">B.2 </span>Informative references</h3><dl about="" class="bibliography"><dt id="bib-DOM4">[DOM4]</dt><dd rel="dcterms:references">Anne van Kesteren; Aryeh Gregor; Ms2ger; Alex Russell; Robin Berjon. <a href="http://www.w3.org/TR/dom/"><cite>W3C DOM4</cite></a>. 10 July 2014. W3C Last Call Working Draft. URL: <a href="http://www.w3.org/TR/dom/">http://www.w3.org/TR/dom/</a>
</dd><dt id="bib-image-capture">[image-capture]</dt><dd rel="dcterms:references">Giridhar Mandyam. <a href="http://www.w3.org/TR/image-capture/"><cite>Mediastream Image Capture</cite></a>. 9 July 2013. W3C Working Draft. URL: <a href="http://www.w3.org/TR/image-capture/">http://www.w3.org/TR/image-capture/</a>
</dd><dt id="bib-mediastream-recording">[mediastream-recording]</dt><dd rel="dcterms:references">Travis Leithead. <a href="http://www.w3.org/TR/mediastream-recording/"><cite>MediaStream Recording</cite></a>. 5 February 2013. W3C Working Draft. URL: <a href="http://www.w3.org/TR/mediastream-recording/">http://www.w3.org/TR/mediastream-recording/</a>
</dd></dl></section></section></body></html>