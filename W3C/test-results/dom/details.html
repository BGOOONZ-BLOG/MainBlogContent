<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <title>DOM: Analysis of failed tests</title>
    <link rel='stylesheet' href='bootstrap.min.css'>
    <link rel='stylesheet' href='analysis.css'>
  </head>
  <body>
    <div class='container'>
      <header>
        <h1>DOM: Analysis of failed tests</h1>
      </header>
      <section>
        <p>Nearby: <a href="less-than-2.html">less-than-2</a>, <a href="complete-fails.html">complete-fails</a>, <a href="all.html">all results</a>,
      </section>
      <section>
        <h2>Introduction</h2>
        <p>
          Historically, W3C test suites have altogether too often been subpar in their coverage,
          barely scraping the surface of interoperability. In such a context, with only a few
          hundred simple tests, it is naturally expected that one would expect to hit the 100%
          pass mark.
        </p>
        <p>
          With the increased focus on testing however, notably through the <a
          href='https://github.com/w3c/web-platform-tests/'>Web Platform Tests</a> and <a
          href='http://testthewebforward.org/'>Test The Web Forward</a> projects the quality of test
          suites has improved massively. And since we don't live in a perfect world, if one looks
          for trouble hard enough one will find it.
        </p>
        <p>
          <a href="https://github.com/w3c/web-platform-tests/tree/master/dom">The DOM test
          suite</a>, which is over 52,000 tests (and growing), certainly did set out to look for
          trouble. Given that, it seems useful to accompany the test results with this this note
          explaining where the failures come from.
        </p>
        <p>
          In total, 743 tests fail to pass in two implementations, which amounts to 1.43% of the
          total. The sections below provide context in which to appraise these failures. This is an
          increase compared to the last time the DOM test results were reported upon; it is due to
          the test suite expanding in scope, counteracting actual improvements in implementations.
        </p>
      </section>
      <section>
        <h2><code>createNodeIterator()</code></h2>
        <p>
          555 of the failures (75%) come from this single method. This method is actually already in
          DOM Level 2, but its interoperability in browsers has only recently started improving.
        </p>
        <p>
          Given that this is existing functionality, already Recommended, that mostly needs to be
          improved upon, the volume of failures is not particularly worrying.
        </p>
      </section>
      <section>
        <h2><code>createDocument()</code></h2>
        <p>
          81 of the failures (11%) come from this method. The failures are actually mostly for
          fields that need to be set or not to specific values on the created <code>Document</code>
          object.
        </p>
        <p>
          While it would be useful to sort these problems out, the interoperability issues around
          this topic are well-known and there has been little interest from implementers in
          resolving them. The specification features explicit warnings about these.
        </p>
      </section>
      <section>
        <h2>WebIDL</h2>
        <p>
          43 of the failures (6%) or less are linked to WebIDL-related problems. Essentially, they
          are attributes being present on instances instead of prototypes, wrong exception types,
          and other similar issues.
        </p>
        <p>
          This is marked improvement on previous reports in which WebIDL heavily dominated the
          interoperability landscape. While still not perfect, this area is moving in the right
          direction, and the failures are unlikely to impact regular development much.
        </p>
      </section>
      <section>
        <h2>Miscellaneous</h2>
        <p>
          The remaining 64 failing test cases do not appear to subject themselves
          to easy categorisation. Many of these are corner cases that have little impact on everyday
          development, if any.
        </p>
      </section>
      <section>
        <h2>Conclusion</h2>
        <p>
          Considering that:
        </p>
        <ol>
          <li>
            the volume of failures is really low to start with (we have over 98% success over
            52,000 tests);
          </li>
          <li>
            the vast majority of failures are circumscribed to limited areas with well-known issues;
          </li>
          <li>
            the percentage of issues that point to problems that could affect developers is
            so vanishingly small as to be negligible and none of the remaining tests indicates
            a failure in interoperability;
          </li>
        </ol>
        <p>
          We contend that the specification being proposed for advancement through the process has
          demonstrated interoperability.
        </p>
      </section>
    </div>
  </body>
</html>
