<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:WD" prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">
<head><meta lang="" property="dc:language" content="en">
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1" name="viewport">
    <title>Model for Tabular Data and Metadata on the Web</title>
    
    
    <style type="text/css">
      .grammar td { font-family: monospace; vertical-align: top; }
      .grammar-literal { color: gray;}
    </style>
  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #C83500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title , div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.warning-title { color: #f22; }
div.issue-title span, div.note-title span, div.warning-title span {
    text-transform: uppercase;
}
div.note, div.issue, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
.issue, .note, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note , div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue, span.warning { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}

.warning {
    border-color: #f11;
    border-right-width: .2em;
    border-top-width: .2em;
    border-bottom-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
}
</style><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/W3C-WD"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
  <body class="h-entry" role="document" id="respecDocument"><div class="head" role="contentinfo" id="respecHeader">
  <p>
      
        
            <a href="http://www.w3.org/"><img width="72" height="48" src="https://www.w3.org/Icons/w3c_home" alt="W3C"></a>
        
      
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">Model for Tabular Data and Metadata on the Web</h1>
  
  <h2 id="w3c-working-draft-08-january-2015"><abbr title="World Wide Web Consortium">W3C</abbr> Working Draft <time property="dcterms:issued" class="dt-published" datetime="2015-01-08">08 January 2015</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="http://www.w3.org/TR/2015/WD-tabular-data-model-20150108/">http://www.w3.org/TR/2015/WD-tabular-data-model-20150108/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/tabular-data-model/">http://www.w3.org/TR/tabular-data-model/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://w3c.github.io/csvw/syntax/">http://w3c.github.io/csvw/syntax/</a></dd>
    
    
    
    
    
    
      <dt>Previous version:</dt>
      <dd><a rel="dcterms:replaces" href="http://www.w3.org/TR/2014/WD-tabular-data-model-20140710/">http://www.w3.org/TR/2014/WD-tabular-data-model-20140710/</a></dd>
    
    
    <dt>Editors:</dt>
    <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Jeni Tennison</span>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://theodi.org/">Open Data Institute</a></span>
<span property="rdf:rest" resource="_:editor1"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor1"><span property="rdf:first" typeof="foaf:Person"><meta property="foaf:name" content="Gregg Kellogg"><a class="u-url url p-name fn" property="foaf:homepage" href="http://greggkellogg.net/">Gregg Kellogg</a>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://kellogg-assoc.com/">Kellogg Associates</a></span>
<span property="rdf:rest" resource="rdf:nil"></span>
</dd>

    
    
      
        
          <dt>Repository:</dt>
          
             
                
                  <dd>
                    <a href="https://github.com/w3c/csvw">
                      We are on Github
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://github.com/w3c/csvw">
                      File a bug
                    </a>
                  </dd>
                
             
          
        
      
        
          <dt>Changes:</dt>
          
             
                
                  <dd>
                    <a href="diff-20140710.html">
                      Diff to previous version
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://github.com/w3c/csvw/commits/gh-pages">
                      Commit history
                    </a>
                  </dd>
                
             
          
        
      
    
  </dl>
  
  
  
  
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
        2015
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), 
        
        All Rights Reserved.
        
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        
          <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
        
        rules apply.
      </p>
    
  
  <hr>
</div>
    <section id="abstract" class="introductory" property="dc:abstract"><h2 id="h-abstract" resource="#h-abstract"><span property="xhv:role" resource="xhv:heading">Abstract</span></h2>
      <p>
        Tabular data is routinely transferred on the web as "CSV", but the definition of "CSV" in practice is very loose. This document outlines a basic data model or infoset for tabular data and metadata about that tabular data. It also contains some non-normative information about a best practice syntax for tabular data, for mapping into that data model, to contribute to the standardisation of CSV syntax by IETF. Various methods of locating metadata are also provided.
      </p>
    </section><section id="sotd" class="introductory"><h2 id="h-sotd" resource="#h-sotd"><span property="xhv:role" resource="xhv:heading">Status of This Document</span></h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the
          latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
          http://www.w3.org/TR/.</em>
        </p>
        
        
      <p>
        The CSV on the Web Working Group was chartered to produce a Recommendation "Access methods for CSV Metadata" as well as Recommendations for "Metadata vocabulary for CSV data" and "Mapping mechanism to transforming CSV into various Formats (e.g., RDF, JSON, or XML)". This document aims to primarily satisfy the first of those Recommendations (see <a href="#locating-metadata" class="sectionRef sec-ref">section <span class="secno">3.</span> <span class="sec-title">Locating Metadata</span></a>), though it also specifies an underlying model and therefore starting point for the other chartered Recommendations.
      </p>
      <p>
        This document is based on IETF's [<cite><a class="bibref" href="#bib-RFC4180">RFC4180</a></cite>] which is an Informational RFC. The working group's expectation is that future suggestions to refine RFC 4180 will be relayed to the IETF (e.g. around I18N and multi-part packaging) and contribute to its discussions about moving CSV to the Standards track.
      </p>
      <p>
        Many "CSV" files embed metadata, for example in lines before the header row of the CSV document. This specification does not define any formats for embedding metadata within CSV files, aside from the names of columns in the header row.
      </p>
    
        
        <p>
          This document was published by the <a href="http://www.w3.org/2013/csvw/">CSV on the Web Working Group</a> as a Working Draft.
          
            This document is intended to become a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
          
          
            If you wish to make comments regarding this document, please send them to 
            <a href="mailto:public-csv-wg@w3.org">public-csv-wg@w3.org</a> 
            (<a href="mailto:public-csv-wg-request@w3.org?subject=subscribe">subscribe</a>,
            <a href="http://lists.w3.org/Archives/Public/public-csv-wg/">archives</a>).
          
          
          
          
          
            
            All comments are welcome.
            
          
        </p>
        
        
        
          <p>
            Publication as a Working Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr>
            Membership. This is a draft document and may be updated, replaced or obsoleted by other
            documents at any time. It is inappropriate to cite this document as other than work in
            progress.
          </p>
        
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a id="sotd_patent" property="w3p:patentRules" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
            Policy</a>.
          
          
          
            
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/68238/status" rel="disclosure">public list of any patent
              disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent
            which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
        </p>
        
          <p>This document is governed by the <a id="w3c_process_revision" href="http://www.w3.org/2014/Process-20140801/">1 August 2014 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
          </p>
        
        
      
    
  
</section><section id="toc"><h2 class="introductory" id="h-toc" resource="#h-toc"><span property="xhv:role" resource="xhv:heading">Table of Contents</span></h2><ul class="toc" role="directory" id="respecContents"><li class="tocline"><a href="#intro" class="tocxref"><span class="secno">1. </span>Introduction</a></li><li class="tocline"><a href="#model" class="tocxref"><span class="secno">2. </span>Tabular Data Models</a><ul class="toc"><li class="tocline"><a href="#core-tabular-data-model" class="tocxref"><span class="secno">2.1 </span>Core Tabular Data Model</a></li><li class="tocline"><a href="#annotated-tabular-data-model" class="tocxref"><span class="secno">2.2 </span>Annotated Tabular Data Model</a></li><li class="tocline"><a href="#grouped-tabular-data-model" class="tocxref"><span class="secno">2.3 </span>Grouped Tabular Data Model</a></li></ul></li><li class="tocline"><a href="#locating-metadata" class="tocxref"><span class="secno">3. </span>Locating Metadata</a><ul class="toc"><li class="tocline"><a href="#overriding-metadata" class="tocxref"><span class="secno">3.1 </span>Overriding Metadata</a></li><li class="tocline"><a href="#embedded-metadata" class="tocxref"><span class="secno">3.2 </span>Embedded Metadata</a></li><li class="tocline"><a href="#link-header" class="tocxref"><span class="secno">3.3 </span>Link Header</a></li><li class="tocline"><a href="#standard-file-metadata" class="tocxref"><span class="secno">3.4 </span>Standard File Metadata</a></li><li class="tocline"><a href="#standard-directory-metadata" class="tocxref"><span class="secno">3.5 </span>Standard Directory Metadata</a></li></ul></li><li class="tocline"><a href="#syntax" class="tocxref"><span class="secno">4. </span>CSV+ Syntax</a><ul class="toc"><li class="tocline"><a href="#content-type" class="tocxref"><span class="secno">4.1 </span>Content Type</a></li><li class="tocline"><a href="#encoding" class="tocxref"><span class="secno">4.2 </span>Encoding</a></li><li class="tocline"><a href="#line-endings" class="tocxref"><span class="secno">4.3 </span>Line Endings</a></li><li class="tocline"><a href="#lines" class="tocxref"><span class="secno">4.4 </span>Lines</a><ul class="toc"><li class="tocline"><a href="#headers" class="tocxref"><span class="secno">4.4.1 </span>Headers</a></li><li class="tocline"><a href="#bidirectionality-in-csv-files" class="tocxref"><span class="secno">4.4.2 </span>Bidirectionality in CSV+ Files</a></li></ul></li><li class="tocline"><a href="#ebnf" class="tocxref"><span class="secno">4.5 </span>Grammar</a></li></ul></li><li class="tocline"><a href="#parsing" class="tocxref"><span class="secno">5. </span>Parsing Tabular Data</a></li><li class="tocline"><a href="#standards" class="tocxref"><span class="secno">A. </span>Existing Standards</a><ul class="toc"><li class="tocline"><a href="#rfc" class="tocxref"><span class="secno">A.1 </span>RFC 4180</a></li><li class="tocline"><a href="#excel" class="tocxref"><span class="secno">A.2 </span>Excel</a><ul class="toc"><li class="tocline"><a href="#saved-csv" class="tocxref"><span class="secno">A.2.1 </span>Saved CSV</a></li><li class="tocline"><a href="#opened-csv" class="tocxref"><span class="secno">A.2.2 </span>Opened CSV</a></li><li class="tocline"><a href="#imported-csv" class="tocxref"><span class="secno">A.2.3 </span>Imported CSV</a></li><li class="tocline"><a href="#copied-tabular-data" class="tocxref"><span class="secno">A.2.4 </span>Copied Tabular Data</a></li></ul></li><li class="tocline"><a href="#google" class="tocxref"><span class="secno">A.3 </span>Google Spreadsheets</a><ul class="toc"><li class="tocline"><a href="#downloading-csv" class="tocxref"><span class="secno">A.3.1 </span>Downloading CSV</a></li><li class="tocline"><a href="#importing-csv" class="tocxref"><span class="secno">A.3.2 </span>Importing CSV</a></li></ul></li><li class="tocline"><a href="#csv-files-in-a-tabular-data-package" class="tocxref"><span class="secno">A.4 </span>CSV Files in a Tabular Data Package</a></li></ul></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">B. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">B.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">B.2 </span>Informative references</a></li></ul></li></ul></section>
    
    <section id="intro" typeof="bibo:Chapter" resource="#intro" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-intro" resource="#h-intro"><span property="xhv:role" resource="xhv:heading"><span class="secno">1. </span>Introduction</span></h2>
      <p>
        <dfn title="tabular data" id="dfn-tabular-data">Tabular data</dfn> is data that is structured into rows, each of which contains information about some thing. Each row contains the same number of cells (although some of these cells may be empty), which provide values of properties of the thing described by the row. In tabular data, cells within the same column provide values for the same property of the thing described by the particular row. This is what differentiates tabular data from other line-oriented formats. 
      </p>
    	<p>
        Tabular data is routinely transferred on the web in a textual format called "CSV", but the definition of "CSV" in practice is very loose. Some people use the term to mean any delimited text file. Others stick more closely to the most standard definition of CSV that there is, [<cite><a class="bibref" href="#bib-RFC4180">RFC4180</a></cite>]. <a href="#standards" class="sectionRef">Appendix A</a> describes the various ways in which CSV is defined.
      </p>
    </section>
    <section id="model" typeof="bibo:Chapter" resource="#model" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-model" resource="#h-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">2. </span>Tabular Data Models</span></h2>
      <p>
        There are different levels of data models for tabular data:
      </p>
      <ul>
        <li>The <dfn id="dfn-core-tabular-data-model">core tabular data model</dfn> described in <a href="#core-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.1</span> <span class="sec-title">Core Tabular Data Model</span></a> defines the core model for a single table of basic data.</li>
        <li>The <dfn id="dfn-annotated-tabular-data-model">annotated tabular data model</dfn> described in <a href="#annotated-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.2</span> <span class="sec-title">Annotated Tabular Data Model</span></a> defines a model for tables that are annotated with metadata.</li>
        <li>The <dfn id="dfn-grouped-tabular-data-model">grouped tabular data model</dfn> described in <a href="#grouped-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.3</span> <span class="sec-title">Grouped Tabular Data Model</span></a> defines a model for tables that are related to each other in some way.</li>
      </ul>
      <section id="core-tabular-data-model" typeof="bibo:Chapter" resource="#core-tabular-data-model" property="bibo:hasPart">
        <h3 id="h-core-tabular-data-model" resource="#h-core-tabular-data-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">2.1 </span>Core Tabular Data Model</span></h3>
        <p>
          The core tabular data model can be used to describe a table that lacks any annotations, whether those annotations are embedded within a CSV file or arise from a separate metadata document.
        </p>
        <p>
          Data is held in a <dfn id="dfn-table">table</dfn>. The properties of a table are:
        </p>
        <ul>
          <li><dfn title="table columns" id="dfn-table-columns">columns</dfn> — the list of <a title="column" href="#dfn-column" class="internalDFN">columns</a> in the table. A table <em class="rfc2119" title="MUST">MUST</em> have one or more columns and the order of the columns within the list is significant and <em class="rfc2119" title="MUST">MUST</em> be preserved by applications</li>
          <li><dfn title="table rows" id="dfn-table-rows">rows</dfn> — the list of rows in the table</li>
        </ul>
        <p>
          A <dfn id="dfn-column">column</dfn> represents a vertical arrangement of <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> within a <a href="#dfn-table" class="internalDFN">table</a>. The properties of a column are:
        </p>
        <ul>
          <li><dfn title="column table" id="dfn-column-table">table</dfn> — the <a href="#dfn-table" class="internalDFN">table</a> that the column appears in</li>
          <li><dfn title="column number" id="dfn-column-number">number</dfn> — the position of the column amongst the <a title="table columns" href="#dfn-table-columns" class="internalDFN">columns</a> for the associated <a title="column table" href="#dfn-column-table" class="internalDFN">table</a>, starting from 1</li>
          <li><dfn title="column cells" id="dfn-column-cells">cells</dfn> — the list of <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> in the column. A column <em class="rfc2119" title="MUST">MUST</em> contain one cell from each <a href="#dfn-row" class="internalDFN">row</a> in the table. The order of the cells in the list <em class="rfc2119" title="MUST">MUST</em> match the order of the rows in which they appear within the <a title="table rows" href="#dfn-table-rows" class="internalDFN">rows</a> for the associated <a title="column table" href="#dfn-column-table" class="internalDFN">table</a>.</li>
        </ul>
        <p>
          A <dfn id="dfn-row">row</dfn> represents a horizontal arrangement of <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> within a <a href="#dfn-table" class="internalDFN">table</a>. The properties of a row are:
        </p>
        <ul>
          <li><dfn title="row table" id="dfn-row-table">table</dfn> — the <a href="#dfn-table" class="internalDFN">table</a> that the row appears in</li>
          <li><dfn title="row number" id="dfn-row-number">number</dfn> — the position of the row amongst the <a title="table rows" href="#dfn-table-rows" class="internalDFN">rows</a> for the <a title="row table" href="#dfn-row-table" class="internalDFN">table</a>, starting from 1</li>
          <li><dfn title="row cells" id="dfn-row-cells">cells</dfn> — the list of <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> in the row. A row <em class="rfc2119" title="MUST">MUST</em> contain one cell from each <a href="#dfn-column" class="internalDFN">column</a> in the table. The order of the cells in the list <em class="rfc2119" title="MUST">MUST</em> match the order of the columns in which they appear within the <a href="#dfn-table-columns" class="internalDFN">table columns</a> for the row's table.</li>
        </ul>
        <p>
          A <dfn id="dfn-cell">cell</dfn> represents a cell at the intersection of a <a href="#dfn-row" class="internalDFN">row</a> and a <a href="#dfn-column" class="internalDFN">column</a> within a <a href="#dfn-table" class="internalDFN">table</a>. The properties of a cell are:
        </p>
        <ul>
          <li><dfn title="cell table" id="dfn-cell-table">table</dfn> — the <a href="#dfn-table" class="internalDFN">table</a> that the cell appears in</li>
          <li><dfn title="cell column" id="dfn-cell-column">column</dfn> — the <a href="#dfn-column" class="internalDFN">column</a> that the cell appears in; the cell <em class="rfc2119" title="MUST">MUST</em> be in the <a title="column cells" href="#dfn-column-cells" class="internalDFN">cells</a> for that column</li>
          <li><dfn title="cell row" id="dfn-cell-row">row</dfn> — the <a href="#dfn-row" class="internalDFN">row</a> that the cell appears in; the cell <em class="rfc2119" title="MUST">MUST</em> be in the <a title="row cells" href="#dfn-row-cells" class="internalDFN">cells</a> for that row</li>
          <li><dfn id="dfn-string-value">string value</dfn> — a string that is the original syntactic representation of the value of the cell, ie how the cell appears within a CSV file; this may be an empty string</li>
          <li><dfn title="cell value" id="dfn-cell-value">value</dfn> — the semantic value of the cell; within the core tabular data model (with no other metadata available) this is either a string which is the same as the <a href="#dfn-string-value" class="internalDFN">string value</a> of the cell, or <code>null</code>, if the <a href="#dfn-string-value" class="internalDFN">string value</a> is an empty string</li>
        </ul>
        <div class="issue"><div class="issue-title" aria-level="4" role="heading" id="h-issue1"><a href="https://github.com/w3c/csvw/issues/40"><span>Issue 40</span></a></div><p class="">
          Should an empty string value always count as a <code>null</code> semantic value within the core data model (ie when there is no other metadata telling the processor how to interpret that value), or should the semantic value be an empty string?
        </p></div>
        <div class="note"><div class="note-title" aria-level="4" role="heading" id="h-note1"><span>Note</span></div><p class="">
          There presence or absence of quotes around a value within a CSV file is a syntactic detail that is not reflected in the tabular data model. In other words, there is no distinction in the model between the second value in <code>a,,z</code> and the second value in <code>a,"",z</code>.
        </p></div>
      </section>
      <section id="annotated-tabular-data-model" typeof="bibo:Chapter" resource="#annotated-tabular-data-model" property="bibo:hasPart">
        <h3 id="h-annotated-tabular-data-model" resource="#h-annotated-tabular-data-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">2.2 </span>Annotated Tabular Data Model</span></h3>
        <p>
          An <dfn id="dfn-annotated-table">annotated table</dfn> is a <a href="#dfn-table" class="internalDFN">table</a> that is annotated with additional metadata. The table <em class="rfc2119" title="MAY">MAY</em> have any number of <dfn title="property" id="dfn-property">properties</dfn> in addition to those provided in the core tabular data model described in <a href="#core-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.1</span> <span class="sec-title">Core Tabular Data Model</span></a> which provide information about the table as a whole. The <dfn title="value" id="dfn-value">values</dfn> of these properties may be lists, structured objects, or atomic values. Annotations on a table may include:
        </p>
        <ul>
          <li>titles or descriptions of the table</li>
          <li>information about the source or provenance of the data in the table</li>
          <li>links to other tables (eg to indicate tables that include related information)</li>
        </ul>
        <p>
          The <a title="column" href="#dfn-column" class="internalDFN">columns</a> within an <a href="#dfn-annotated-table" class="internalDFN">annotated table</a> are all <dfn title="annotated column" id="dfn-annotated-column">annotated columns</dfn>: columns which <em class="rfc2119" title="MAY">MAY</em> have any number of <a title="property" href="#dfn-property" class="internalDFN">properties</a> in addition to those provided in the core tabular data model described in <a href="#core-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.1</span> <span class="sec-title">Core Tabular Data Model</span></a>. The annotations on a column might provide information about how to interpret the <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> in the column or information about the column as a whole. Examples of annotations might be:
        </p>
        <ul>
          <li>a name or label for the column</li>
          <li>the expected type of values in that column</li>
          <li>an indication of whether the column contains unique values</li>
        </ul>
        <p>
          The <a title="row" href="#dfn-row" class="internalDFN">rows</a> within an <a href="#dfn-annotated-table" class="internalDFN">annotated table</a> are all <dfn title="annotated row" id="dfn-annotated-row">annotated rows</dfn>: rows which <em class="rfc2119" title="MAY">MAY</em> have any number of <a title="property" href="#dfn-property" class="internalDFN">properties</a> in addition to those provided in the core tabular data model described in <a href="#core-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.1</span> <span class="sec-title">Core Tabular Data Model</span></a>. The annotations on a row provide additional metadata about the information held in the row, such as:
        </p>
        <ul>
          <li>the certainty of the information in that row</li>
          <li>information about the source or provenance of the data in that row</li>
        </ul>
        <p>
          The <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> within an <a href="#dfn-annotated-row" class="internalDFN">annotated row</a> are all <dfn title="annotated cell" id="dfn-annotated-cell">annotated cells</dfn>: cells which <em class="rfc2119" title="MAY">MAY</em> have any number of <a title="property" href="#dfn-property" class="internalDFN">properties</a> in addition to those provided in the core tabular data model described in <a href="#core-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.1</span> <span class="sec-title">Core Tabular Data Model</span></a>. The annotations on a cell provide metadata about the value held in the cell, particularly when this overrides the information provided for the <a href="#dfn-annotated-column" class="internalDFN">annotated column</a> and <a href="#dfn-annotated-row" class="internalDFN">annotated row</a> that the cell falls within. Annotations on a cell might be:
        </p>
        <ul>
          <li>notes to aid the interpretation of the value</li>
          <li>type annotations for the value</li>
          <li>a flag that indicates the value is a null value</li>
        </ul>
        <p>
          The <a title="cell value" href="#dfn-cell-value" class="internalDFN">value</a> of an <a href="#dfn-annotated-cell" class="internalDFN">annotated cell</a> <em class="rfc2119" title="MAY">MAY</em> be of a datatype other than a string. For example, annotations might enable a processor to understand the <a href="#dfn-string-value" class="internalDFN">string value</a> of the cell as representing a number or a date.
        </p>
        <div class="issue"><div class="issue-title" aria-level="4" role="heading" id="h-issue2"><a href="https://github.com/w3c/csvw/issues/41"><span>Issue 41</span></a></div><p class="">
          The permitted types of names and values of annotations need to be spelled out here.
        </p></div>
      </section>
      <section id="grouped-tabular-data-model" typeof="bibo:Chapter" resource="#grouped-tabular-data-model" property="bibo:hasPart">
        <h3 id="h-grouped-tabular-data-model" resource="#h-grouped-tabular-data-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">2.3 </span>Grouped Tabular Data Model</span></h3>
        <p>
          A <dfn id="dfn-group-of-tables">group of tables</dfn> comprises a set of <a title="table" href="#dfn-table" class="internalDFN">tables</a> (which may be <a title="annotated table" href="#dfn-annotated-table" class="internalDFN">annotated tables</a>) and a set of annotations (<a title="property" href="#dfn-property" class="internalDFN">properties</a> and <a title="value" href="#dfn-value" class="internalDFN">values</a>) that relate to the set.
        </p>
        <div class="note"><div class="note-title" aria-level="4" role="heading" id="h-note2"><span>Note</span></div><p class="">
          Tables can be loosely related to each other simply through annotations; not all tables that are related to each other need to grouped together. Groups of tables are useful because they can be annotated with metadata that applies to all the tables in the group.
        </p></div>
      </section>
    </section>
    <section id="locating-metadata" typeof="bibo:Chapter" resource="#locating-metadata" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-locating-metadata" resource="#h-locating-metadata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3. </span>Locating Metadata</span></h2>
      <p>
        As described in <a href="#annotated-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.2</span> <span class="sec-title">Annotated Tabular Data Model</span></a>, tabular data may have a number of annotations associated with it. Here we describe the different methods that can be used to locate those annotations given a link to a CSV file.
      </p>
      <p>
        In most methods of locating metadata described here, metadata is provided within a separate document. The syntax of this document is defined in the <a href="http://w3c.github.io/csvw/metadata/">Metadata Vocabulary for Tabular Data</a> specification. These documents can include things like:
      </p>
      <ul>
        <li>metadata about the table, such as titles, descriptions, provenance, and links to other tables</li>
        <li>metadata about columns in the table, such as labels, data types and other constraints, or flags to indicate values in the column are unique</li>
        <li>metadata about rows in the table, such as certainty or provenance</li>
        <li>metadata about values in the table, such as notes or type annotations</li>
      </ul>
      <p>
        When creating a set of annotations from metadata, if the same property is specified in two locations then information "closer" to the end user or interpreter of the document should override other information, and information "closer" to the document itself should override information "further" from the document. Explicitly, the order of preference is:
      </p>
      <ol>
        <li>metadata supplied by the user of the implementation that is processing the tabular data, see <a href="#overriding-metadata" class="sectionRef sec-ref">section <span class="secno">3.1</span> <span class="sec-title">Overriding Metadata</span></a></li>
        <li>metadata embedded within the tabular data file itself, see <a href="#embedded-metadata" class="sectionRef sec-ref">section <span class="secno">3.2</span> <span class="sec-title">Embedded Metadata</span></a></li>
        <li>metadata in a document linked to using a <code>Link</code> header associated with the tabular data file, see <a href="#link-header" class="sectionRef sec-ref">section <span class="secno">3.3</span> <span class="sec-title">Link Header</span></a></li>
        <li>file-specific metadata in a document located based on the location of the tabular data file, see <a href="#standard-file-metadata" class="sectionRef sec-ref">section <span class="secno">3.4</span> <span class="sec-title">Standard File Metadata</span></a></li>
        <li>directory-specific metadata in a document located based on the location of the tabular data file, see <a href="#standard-directory-metadata" class="sectionRef sec-ref">section <span class="secno">3.5</span> <span class="sec-title">Standard Directory Metadata</span></a></li>
      </ol>
      <p>
        Processors <em class="rfc2119" title="MUST">MUST</em> attempt to locate a metadata document based on each of these locations in order, and use first metadata document that is successfully located in this way.
      </p>
      <div class="issue"><div class="issue-title" aria-level="3" role="heading" id="h-issue3"><a href="https://github.com/w3c/csvw/issues/42"><span>Issue 42</span></a></div><p class="">
        What should processors do if they have been passed a metadata file and located a CSV file from that metadata file. Should they still check for metadata files related specifically to the CSV file itself? For example, say that an application has been pointed at a metadata file at <code>http://example.org/metadata.json</code> which references <code>http://example.org/toilets.csv</code> but there is also a metadata file at <code>http://example.org/toilets.csv-metadata.json</code>. If the processor had been originally pointed to <code>http://example.org/toilets.csv</code> then it would have located the file-specific metadata at <code>http://example.org/toilets.csv-metadata.json</code>, but coming via <code>http://example.org/metadata.json</code> means that file-specific metadata is skipped.
      </p></div>
      <section id="overriding-metadata" typeof="bibo:Chapter" resource="#overriding-metadata" property="bibo:hasPart">
        <h3 id="h-overriding-metadata" resource="#h-overriding-metadata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.1 </span>Overriding Metadata</span></h3>
        <p>
          Processors <em class="rfc2119" title="SHOULD">SHOULD</em> provide users with the facility to provide their own metadata for tabular data files that they process.
        </p>
      </section>
      <section id="embedded-metadata" typeof="bibo:Chapter" resource="#embedded-metadata" property="bibo:hasPart">
        <h3 id="h-embedded-metadata" resource="#h-embedded-metadata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.2 </span>Embedded Metadata</span></h3>
        <p>
          Most syntaxes for tabular data provide a facility for embedding some metadata within the tabular data file itself. The definition of a syntax for tabular data <em class="rfc2119" title="SHOULD">SHOULD</em> include a description of how the syntax maps to an annotated data model. See <a href="#parsing" class="sectionRef sec-ref">section <span class="secno">5.</span> <span class="sec-title">Parsing Tabular Data</span></a> for a description of this for CSV files.
        </p>
      </section>
      <section id="link-header" typeof="bibo:Chapter" resource="#link-header" property="bibo:hasPart">
        <h3 id="h-link-header" resource="#h-link-header"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.3 </span>Link Header</span></h3>
        <p>
          When retrieving a tabular data file via HTTP, the response <em class="rfc2119" title="MAY">MAY</em> include a <code>Link</code> header with <code>rel=describedby</code> and <code>type=application/csv-metadata+json</code> that points to a metadata file that describes the tabular data file. If, by inspection, the referenced file is not a valid metadata file then it <em class="rfc2119" title="MUST">MUST</em> be ignored. If there is more than one valid metadata file linked to through multiple <code>Link</code> headers, then the metadata referenced by <code>Link</code> headers that appear later in the response are used in preference to those referenced by earlier <code>Link</code> headers.
        </p>
        <div class="issue"><div class="issue-title" aria-level="4" role="heading" id="h-issue4"><a href="https://github.com/w3c/csvw/issues/43"><span>Issue 43</span></a></div><p class="">
          Suggest that we drop the requirement to ignore invalid metadata files, given that the correct metadata file should be identified through the type of the link.
        </p></div>
      </section>
      <section id="standard-file-metadata" typeof="bibo:Chapter" resource="#standard-file-metadata" property="bibo:hasPart">
        <h3 id="h-standard-file-metadata" resource="#h-standard-file-metadata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.4 </span>Standard File Metadata</span></h3>
        <p>
          If no metadata document has been located through higher-priority mechanisms, processors <em class="rfc2119" title="MUST">MUST</em> attempt to locate a file-specific metadata document. This method is only used if the URL of the tabular data file does not contain a query component.
        </p>
        <p>
          In this case, the file-specific metadata document should be located at <code><var>location</var>-metadata.json</code>, where <var>location</var> is the base URL of the tabular data file with the fragment component of the URL removed, if applicable. For example, if the tabular data file is at <code>http://example.org/south-west/devon.csv</code> then processors should attempt to locate a metadata document at <code>http://example.org/south-west/devon.csv-metadata.json</code>. If the metadata file found at this location does not explicitly point to the relevant tabular data file then it <em class="rfc2119" title="MUST">MUST</em> be ignored.
        </p>
      </section>
      <section id="standard-directory-metadata" typeof="bibo:Chapter" resource="#standard-directory-metadata" property="bibo:hasPart">
        <h3 id="h-standard-directory-metadata" resource="#h-standard-directory-metadata"><span property="xhv:role" resource="xhv:heading"><span class="secno">3.5 </span>Standard Directory Metadata</span></h3>
        <p>
          If no metadata document has been located through higher-priority mechanisms, processors <em class="rfc2119" title="MUST">MUST</em> attempt to locate a directory-level metadata document. This method is only used if the URL of the tabular data file does not contain a query component.
        </p>
        <p>
          The common metadata document for a directory can be located by resolving the relative URL <code>metadata.json</code> against the base URL of the tabular data file. For example, if the tabular data file is at <code>http://example.org/south-west/devon.csv</code> then processors should attempt to locate a metadata file at <code>http://example.org/south-west/metadata.json</code>. If the metadata file found at this location does not explicitly point to the relevant tabular data file then it <em class="rfc2119" title="MUST">MUST</em> be ignored.
        </p>
      </section>
    </section>
    <section id="syntax" class="informative" typeof="bibo:Chapter" resource="#syntax" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-syntax" resource="#h-syntax"><span property="xhv:role" resource="xhv:heading"><span class="secno">4. </span>CSV+ Syntax</span></h2><p><em>This section is non-normative.</em></p>
      <p>
        There is no standard for CSV, and there are many variants of CSV used on the web today. This section defines a method for outputting tabular data adhering to the <a href="#dfn-core-tabular-data-model" class="internalDFN">core tabular data model</a> described in <a href="#core-tabular-data-model" class="sectionRef sec-ref">section <span class="secno">2.1</span> <span class="sec-title">Core Tabular Data Model</span></a> into a standard, CSV-based, syntax. Compliant applications that output this format must meet each of the constraints.
      </p>
      <div class="note"><div class="note-title" aria-level="3" role="heading" id="h-note3"><span>Note</span></div><p class="">
        We are actively working with the IETF to develop a standard for CSV, which is outside the scope of the Working Group. The details here aim to help shape that standard based on our requirements.
      </p></div>
      <p>
        This section does not seek to describe how applications that <em>input</em> textual tabular data should interpret it, except that any data that is in the format defined here should be understood as defined here.
      </p>
      <div class="note"><div class="note-title" aria-level="3" role="heading" id="h-note4"><span>Note</span></div><div class="">
        <p>
          This syntax is not compliant with <code>text/csv</code> as defined in [<cite><a class="bibref" href="#bib-RFC4180">RFC4180</a></cite>] in that it permits line endings other than <code>CRLF</code>. Supporting <code>LF</code> line endings are important characteristics for data formats that are used on non-Windows platforms. However, all files that adhere to [<cite><a class="bibref" href="#bib-RFC4180">RFC4180</a></cite>]'s definition of CSV are compliant CSV+ files.
        </p>
      </div></div>
      <section id="content-type" typeof="bibo:Chapter" resource="#content-type" property="bibo:hasPart">
        <h3 id="h-content-type" resource="#h-content-type"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.1 </span>Content Type</span></h3>
        <p>
          The appropriate content type for a CSV+ file is <code>text/csv</code>. For example, when a CSV+ file is transmitted via HTTP, the HTTP response <em class="rfc2119" title="MUST">MUST</em> include a <code>Content-Type</code> header with the value <code>text/csv</code>:
        </p>
        <pre>Content-Type: text/csv
        </pre>
        <div class="issue"><div class="issue-title" aria-level="4" role="heading" id="h-issue5"><span>Issue</span></div><p class="">
          See below for issues relating to whether we should instead define a different content type.
        </p></div>
      </section>
      <section id="encoding" typeof="bibo:Chapter" resource="#encoding" property="bibo:hasPart">
        <h3 id="h-encoding" resource="#h-encoding"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2 </span>Encoding</span></h3>
        <p>
          CSV+ files <em class="rfc2119" title="SHOULD">SHOULD</em> be encoded using UTF-8. If a CSV+ file is not encoded using UTF-8, the encoding <em class="rfc2119" title="MUST">MUST</em> be specified through the <code>charset</code> parameter in the <code>Content-Type</code> header:
        </p>
        <pre>Content-Type: text/csv;charset=ISO-8859-1
        </pre>
      </section>
      <section id="line-endings" typeof="bibo:Chapter" resource="#line-endings" property="bibo:hasPart">
        <h3 id="h-line-endings" resource="#h-line-endings"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3 </span>Line Endings</span></h3>
        <p>
          The ends of rows in a CSV+ file <em class="rfc2119" title="MUST">MUST</em> be either <code>CRLF</code> (<code>U+000D U+000A</code>) or <code>LF</code> (<code>U+000A</code>). Line endings within escaped <a title="cell" href="#dfn-cell" class="internalDFN">cells</a> are not normalised.
        </p>
        <div class="issue"><div class="issue-title" aria-level="4" role="heading" id="h-issue6"><a href="https://github.com/w3c/csvw/issues/45"><span>Issue 45</span></a></div><div class="">
          <p>
            <a href="http://tools.ietf.org/html/rfc2046#section-4.1.1">Section 4.1.1 of RFC2046</a> specifies that "The canonical form of any MIME "text" subtype <em class="rfc2119" title="MUST">MUST</em> always represent a line break as a CRLF sequence.  Similarly, any occurrence of CRLF in MIME "text" <em class="rfc2119" title="MUST">MUST</em> represent a line break.  Use of CR and LF outside of line break sequences is also forbidden."
          </p>
          <p>
            Should we be defining <code>application/csv</code> instead, to prevent having to adhere to this rule, or should we stick to the <code>CRLF</code> rule?
          </p>
        </div></div>
      </section>
      <section id="lines" typeof="bibo:Chapter" resource="#lines" property="bibo:hasPart">
        <h3 id="h-lines" resource="#h-lines"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4 </span>Lines</span></h3>
        <p>
          Each line of a CSV+ file <em class="rfc2119" title="MUST">MUST</em> contain the same number of comma-separated values.
        </p>
        <p>
          Values that contain commas, line endings or double quotes <em class="rfc2119" title="MUST">MUST</em> be escaped by having the entire value wrapped in double quotes. There <em class="rfc2119" title="MUST NOT">MUST NOT</em> be whitespace before or after the double quotes. Within these escaped cells, any double quotes <em class="rfc2119" title="MUST">MUST</em> be escaped with two double quotes (<code>""</code>).
        </p>
        <section id="headers" typeof="bibo:Chapter" resource="#headers" property="bibo:hasPart">
          <h4 id="h-headers" resource="#h-headers"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4.1 </span>Headers</span></h4>
          <p>
            The first line of a CSV+ file <em class="rfc2119" title="SHOULD">SHOULD</em> contain a comma-separated list of names of <a title="column" href="#dfn-column" class="internalDFN">columns</a>. This is known as the <dfn id="dfn-header-line">header line</dfn> and provides names for the columns. There are no constraints on these names.
          </p>
          <p>
            If a CSV+ file does not include a header line, this <em class="rfc2119" title="MUST">MUST</em> be specified using the <code>header</code> parameter of the media type:
          </p>
          <pre>Content-Type: text/csv;header=absent
          </pre>
        </section>
        <section id="bidirectionality-in-csv-files" typeof="bibo:Chapter" resource="#bidirectionality-in-csv-files" property="bibo:hasPart">
          <h4 id="h-bidirectionality-in-csv-files" resource="#h-bidirectionality-in-csv-files"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4.2 </span>Bidirectionality in CSV+ Files</span></h4>
          <p>
            Bidirectional content does not alter the definition of rows or the assignment of cells to columns. Whether or not a CSV+ file contains right-to-left characters, the first column's content is the first cell of each row, which is the text prior to the first occurrence of a comma within that row.
          </p>
          <div class="example">
            <p>
              For example, <a href="http://referendum2012.elections.eg/results/referendum-results">Egyptian Referendum results</a> are available as a CSV file at <a href="https://egelections-2011.appspot.com/Referendum2012/results/csv/EG.csv">https://egelections-2011.appspot.com/Referendum2012/results/csv/EG.csv</a>. Over the wire and in non-Unicode-aware text editors, the CSV looks like:
            </p>
            <pre>              <bdo dir="ltr">
‌ا‌ل‌م‌ح‌ا‌ف‌ظ‌ة‌,‌ن‌س‌ب‌ة‌ ‌م‌و‌ا‌ف‌ق‌,‌ن‌س‌ب‌ة‌ ‌غ‌ي‌ر‌ ‌م‌و‌ا‌ف‌ق‌,‌ع‌د‌د‌ ‌ا‌ل‌ن‌ا‌خ‌ب‌ي‌ن‌,‌ا‌ل‌أ‌ص‌و‌ا‌ت‌ ‌ا‌ل‌ص‌ح‌ي‌ح‌ة‌,‌ا‌ل‌أ‌ص‌و‌ا‌ت‌ ‌ا‌ل‌ب‌ا‌ط‌ل‌ة‌,‌ن‌س‌ب‌ة‌ ‌ا‌ل‌م‌ش‌ا‌ر‌ك‌ة‌,‌م‌و‌ا‌ف‌ق‌,‌غ‌ي‌ر‌ ‌م‌و‌ا‌ف‌ق‌
‌ا‌ل‌ق‌ل‌ي‌و‌ب‌ي‌ة‌,60.0,40.0,"2,639,808","853,125","15,224",32.9,"512,055","341,070"
‌ا‌ل‌ج‌ي‌ز‌ة‌,66.7,33.3,"4,383,701","1,493,092","24,105",34.6,"995,417","497,675"
‌ا‌ل‌ق‌ا‌ه‌ر‌ة‌,43.2,56.8,"6,580,478","2,254,698","36,342",34.8,"974,371","1,280,327"
‌ق‌ن‌ا‌,84.5,15.5,"1,629,713","364,509","6,743",22.8,"307,839","56,670"
...
              </bdo>
            </pre>
            <p>
              Within this CSV file, the first column appears as the content of each line before the first comma and is named <code>المحافظة</code> (appearing at the start of each row as <code><bdo dir="ltr">‌ا‌ل‌م‌ح‌ا‌ف‌ظ‌ة‌</bdo></code> in the example, which is displaying the relevant characters from left to right in the order they appear "on the wire").
            </p>
            <p>
              The CSV translates to a table model that looks like:
            </p>
            <table style="width: 100%; text-align: right">
              <colgroup><col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              </colgroup><thead>
                <tr style="text-align: center">
                  <th>Column / Row</th>
                  <th>column 1</th>
                  <th>column 2</th>
                  <th>column 3</th>
                  <th>column 4</th>
                  <th>column 5</th>
                  <th>column 6</th>
                  <th>column 7</th>
                  <th>column 8</th>
                  <th>column 9</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th>row 1 (header)</th><th>المحافظة</th><th>نسبة موافق</th><th>نسبة غير موافق</th><th>عدد الناخبين</th><th>الأصوات الصحيحة</th><th>الأصوات الباطلة</th><th>نسبة المشاركة</th><th>موافق</th><th>غير موافق</th>
                </tr>
                <tr>
                  <th>row 2</th><td>القليوبية</td><td>60.0</td><td>40.0</td><td>2,639,808</td><td>853,125</td><td>15,224</td><td>32.9</td><td>512,055</td><td>341,070</td>
                </tr>
                <tr>
                  <th>row 3</th><td>الجيزة</td><td>66.7</td><td>33.3</td><td>4,383,701</td><td>1,493,092</td><td>24,105</td><td>34.6</td><td>995,417</td><td>497,675</td>
                </tr>
                <tr>
                  <th>row 4</th><td>القاهرة</td><td>43.2</td><td>56.8</td><td>6,580,478</td><td>2,254,698</td><td>36,342</td><td>34.8</td><td>974,371</td><td>1,280,327</td>
                </tr>
                <tr>
                  <th>row 5</th><td>قنا</td><td>84.5</td><td>15.5</td><td>1,629,713</td><td>364,509</td><td>6,743</td><td>22.8</td><td>307,839</td><td>56,670</td>
                </tr>
              </tbody>
            </table>
            <p>
              The fragment identifier <code>#col=3</code> identifies the third of the columns, named <code>نسبة غير موافق</code> (appearing as <code><bdo dir="ltr">‌ن‌س‌ب‌ة‌ ‌غ‌ي‌ر‌ ‌م‌و‌ا‌ف‌ق‌</bdo></code> in the example).
            </p>
            <p>
              [<cite><a class="bibref" href="#bib-tabular-metadata">tabular-metadata</a></cite>] defines how this table model should be displayed by compliant applications, and how metadata can affect the display. The default is for the display to be determined by the content of the table. For example, if this CSV were turned into an HTML table for display into a web page, it should be displayed with the first column on the right and the last on the left, as follows:
            </p>
            <table style="width: 100%; text-align: right">
              <thead>
                <tr>
                  <th>غير موافق</th>
                  <th>موافق</th>
                  <th>نسبة المشاركة</th>
                  <th>الأصوات الباطلة</th>
                  <th>الأصوات الصحيحة</th>
                  <th>عدد الناخبين</th>
                  <th>نسبة غير موافق</th>
                  <th>نسبة موافق</th>
                  <th>المحافظة</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>341,070</td>
                  <td>512,055</td>
                  <td>32.9</td>
                  <td>15,224</td>
                  <td>853,125</td>
                  <td>2,639,808</td>
                  <td>40.0</td>
                  <td>60.0</td>
                  <td>القليوبية</td>
                </tr>
                <tr>
                  <td>497,675</td>
                  <td>995,417</td>
                  <td>34.6</td>
                  <td>24,105</td>
                  <td>1,493,092</td>
                  <td>4,383,701</td>
                  <td>33.3</td>
                  <td>66.7</td>
                  <td>الجيزة</td>
                </tr>
                <tr>
                  <td>1,280,327</td>
                  <td>974,371</td>
                  <td>34.8</td>
                  <td>36,342</td>
                  <td>2,254,698</td>
                  <td>6,580,478</td>
                  <td>56.8</td>
                  <td>43.2</td>
                  <td>القاهرة</td>
                </tr>
                <tr>
                  <td>56,670</td>
                  <td>307,839</td>
                  <td>22.8</td>
                  <td>6,743</td>
                  <td>364,509</td>
                  <td>1,629,713</td>
                  <td>15.5</td>
                  <td>84.5</td>
                  <td>قنا</td>
                </tr>
              </tbody>
            </table>
            <p>
              The fragment identifier <code>#col=3</code> still identifies the third of the columns, named <code>نسبة غير موافق</code>, which appears in the HTML display as the third column from the right and is what those who read right-to-left would think of as the third column.
            </p>
            <p>
              Note that this display matches that shown <a href="http://referendum2012.elections.eg/results/referendum-results">on the original website</a>.
            </p>
          </div>
          <div class="issue"><div class="issue-title" aria-level="5" role="heading" id="h-issue7"><a href="https://github.com/w3c/csvw/issues/46"><span>Issue 46</span></a></div><div class="">
            <p>
              An alternative approach is for the CSV to be parsed into a table model in which the columns are numbered in the reverse, for tables which are either marked as or detected to be right-to-left tables. For example, we could introduce a <code>bidi=rtl</code> or similar media type parameter, and use this to determine whether the first column in table generated from the CSV is the text before the first comma in each line or the text after the last comma in the line.
            </p>
            <p>
             In the example above, if the CSV were served with <code>bidi=rtl</code>, or the table was detected as being a right-to-left table, then the column numbering in the model would be reversed:
            </p>
            <table style="width: 100%; text-align: right">
              <colgroup><col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              <col style="width: 10%">
              </colgroup><thead>
                <tr style="text-align: center">
                  <th>Column / Row</th>
                  <th>column 9</th>
                  <th>column 8</th>
                  <th>column 7</th>
                  <th>column 6</th>
                  <th>column 5</th>
                  <th>column 4</th>
                  <th>column 3</th>
                  <th>column 2</th>
                  <th>column 1</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th>row 1 (header)</th><th>المحافظة</th><th>نسبة موافق</th><th>نسبة غير موافق</th><th>عدد الناخبين</th><th>الأصوات الصحيحة</th><th>الأصوات الباطلة</th><th>نسبة المشاركة</th><th>موافق</th><th>غير موافق</th>
                </tr>
                <tr>
                  <th>row 2</th><td>القليوبية</td><td>60.0</td><td>40.0</td><td>2,639,808</td><td>853,125</td><td>15,224</td><td>32.9</td><td>512,055</td><td>341,070</td>
                </tr>
                <tr>
                  <th>row 3</th><td>الجيزة</td><td>66.7</td><td>33.3</td><td>4,383,701</td><td>1,493,092</td><td>24,105</td><td>34.6</td><td>995,417</td><td>497,675</td>
                </tr>
                <tr>
                  <th>row 4</th><td>القاهرة</td><td>43.2</td><td>56.8</td><td>6,580,478</td><td>2,254,698</td><td>36,342</td><td>34.8</td><td>974,371</td><td>1,280,327</td>
                </tr>
                <tr>
                  <th>row 5</th><td>قنا</td><td>84.5</td><td>15.5</td><td>1,629,713</td><td>364,509</td><td>6,743</td><td>22.8</td><td>307,839</td><td>56,670</td>
                </tr>
              </tbody>
            </table>
            <p>
              This would require a change to [<cite><a class="bibref" href="#bib-RFC7111">RFC7111</a></cite>] but that might be required by updates to the definition of <code>text/csv</code> in any case. With the change, the fragment identifier <code>#col=3</code> would then refer to the third column from the right, named <code>نسبة المشاركة</code>.
            </p>
            <p>
              If the model were defined in this way, there would be no need to determine the order of the columns when displayed using a metadata property. Columns would always be displayed with the first column (numbered 1 in the model) on the left. The final display in HTML, for example, would be exactly as above. The only difference would be that <code>#col=3</code> would refer to the third column from the left.
            </p>
            <p>
              We note that using media type parameters is problematic because publishers might not have the ability to set them on their servers, and because they can easily get lost as a file is republished or emailed between people.
            </p>
            <p>
              We invite comment on the best way to approach bidirectionality in CSV files.
            </p>
          </div></div>
        </section>
      </section>

      <section id="ebnf" typeof="bibo:Chapter" resource="#ebnf" property="bibo:hasPart">
        <h3 id="h-ebnf" resource="#h-ebnf"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.5 </span>Grammar</span></h3>
        <p>This grammar is a generalization of that defined in [<cite><a class="bibref" href="#bib-RFC4180">RFC4180</a></cite>] and is included for reference only.</p>
        <p>The <abbr title="Extended Backus–Naur Form">EBNF</abbr> used here is defined in XML 1.0 [<cite><a class="bibref" href="#bib-EBNF-NOTATION">EBNF-NOTATION</a></cite>].</p>
        <div><table class="grammar">
  <tbody id="grammar-productions">
    <tr id="grammar-production-csv">
      <td>[1]</td>
      <td><code>csv</code></td>
      <td>::=</td>
      <td>
        <a href="#grammar-production-header">header</a>
        <a href="#grammar-production-record">record</a><code>+</code>
      </td>
    </tr>
    <tr id="grammar-production-header">
      <td>[2]</td>
      <td><code>header</code></td>
      <td>::=</td>
      <td>
        <a href="#grammar-production-record">record</a>
      </td>
    </tr>
    <tr id="grammar-production-record">
      <td>[3]</td>
      <td><code>record</code></td>
      <td>::=</td>
      <td>
        <a href="#grammar-production-fields">fields</a>
        <code class="grammar-char-escape">#x0D</code><code>?</code> 
        <code class="grammar-char-escape">#x0A</code>
      </td>
    </tr>
    <tr id="grammar-production-fields">
      <td>[4]</td>
      <td><code>fields</code></td>
      <td>::=</td>
      <td>
        <a href="#grammar-production-field">field</a>
        ("<code class="grammar-literal">,</code>" <a href="#grammar-production-fields">fields</a>)<code>*</code>
      </td>
    </tr>
    <tr id="grammar-production-field">
      <td>[5]</td>
      <td><code>field</code></td>
      <td>::=</td>
      <td>
        <a href="#grammar-production-WS">WS</a><code>*</code> 
        <a href="#grammar-production-rawfield">rawfield</a>
        <a href="#grammar-production-WS">WS</a><code>*</code>
      </td>
    </tr>
    <tr id="grammar-production-rawfield">
      <td>[6]</td>
      <td><code>rawfield</code></td>
      <td>::=</td>
      <td>
        '<code class="grammar-literal">"</code>' <a href="#grammar-production-QCHAR">QCHAR</a><code>*</code>  '<code class="grammar-literal">"</code>'
        <code>|</code><a href="#grammar-production-SCHAR">SCHAR</a><code>*</code>
      </td>
    </tr>
    <tr id="grammar-production-QCHAR">
      <td>[7]</td>
      <td><code>QCHAR</code></td>
      <td>::=</td>
      <td>
        <code>[</code><code class="grammar-literal">^"</code><code>]</code> 
        <code>|</code>'<code class="grammar-literal">""</code>'
      </td>
    </tr>
    <tr id="grammar-production-SCHAR">
      <td>[8]</td>
      <td><code>SCHAR</code></td>
      <td>::=</td>
      <td>
        <code>[</code><code class="grammar-literal">^",</code><code class="grammar-char-escape">#x0A</code><code class="grammar-char-escape">#x0D</code><code>]</code>
      </td>
    </tr>
    <tr id="grammar-production-WS">
      <td>[9]</td>
      <td><code>WS</code></td>
      <td>::=</td>
      <td>
        <code>[</code><code class="grammar-char-escape">#x20</code><code class="grammar-char-escape">#x09</code><code>]</code>
      </td>
    </tr>
  </tbody>
</table>
</div>
        <div class="note"><div class="note-title" aria-level="4" role="heading" id="h-note5"><span>Note</span></div><p class="">
          We should probably place further restrictions on QCHAR and SCHAR to avoid control characters. If header weren’t optional, it would be better defined as in RFC4180, but if the syntax allows it to be optional, this would make it not an LL(1) grammar, which isn’t too much of an issue.
        </p></div>
      </section>
    </section>
    <section id="parsing" class="informative" typeof="bibo:Chapter" resource="#parsing" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-parsing" resource="#h-parsing"><span property="xhv:role" resource="xhv:heading"><span class="secno">5. </span>Parsing Tabular Data</span></h2><p><em>This section is non-normative.</em></p>
      <p>
        As described in <a href="#syntax" class="sectionRef sec-ref">section <span class="secno">4.</span> <span class="sec-title">CSV+ Syntax</span></a>, there may be many formats which an application might interpret into the tabular data model described in <a href="#model" class="sectionRef sec-ref">section <span class="secno">2.</span> <span class="sec-title">Tabular Data Models</span></a>, including using different separators or fixed format tables, multiple tables within a single file, or ones that have metadata lines before a table header.
      </p>
      <div class="note"><div class="note-title" aria-level="3" role="heading" id="h-note6"><span>Note</span></div><p class="">
        Standardising the parsing of CSV is outside the chartered scope of the Working Group. This non-normative section is intended to help the creators of parsers handle the wide variety of CSV-based formats that they may encounter due to the current lack of standardisation of the format.
      </p></div>
      <p>
        This section describes an algorithm for parsing formats other than the plain CSV+ format specified in <a href="#syntax" class="sectionRef sec-ref">section <span class="secno">4.</span> <span class="sec-title">CSV+ Syntax</span></a>. It is impossible to do this in a fully automated manner, so this algorithm depends on the following flags being set externally (eg through user input):
      </p>
      <dl>
        <dt><dfn id="dfn-encoding">encoding</dfn></dt>
        <dd>The character encoding for the file, one of the encodings listed in [<cite><a class="bibref" href="#bib-encoding">encoding</a></cite>]. The default is <code>utf-8</code>.</dd>
        <dt><dfn id="dfn-line-terminator">line terminator</dfn></dt>
        <dd>The character that is used at the end of a row. The default is <code>CRLF</code>.</dd>
        <dt><dfn id="dfn-quote-character">quote character</dfn></dt>
        <dd>The character that is used around escaped cells. The default is <code>"</code>.</dd>
        <dt><dfn id="dfn-escape-character">escape character</dfn></dt>
        <dd>The character that is used to escape the <a href="#dfn-quote-character" class="internalDFN">quote character</a> within escaped cells. The default is <code>"</code> (such that <code>""</code> is used to escape <code>"</code> within an escaped cell).</dd>
        <dt><dfn id="dfn-skip-rows">skip rows</dfn></dt>
        <dd>The number of rows to skip at the beginning of the file, before a header row or tabular data. The default is <code>0</code>.</dd>
        <dt><dfn id="dfn-comment-prefix">comment prefix</dfn></dt>
        <dd>A character that, when it appears at the beginning of a skipped row, indicates a comment that should be associated as a comment annotation to the table. The default is <code>#</code>.</dd>
        <dt><dfn id="dfn-header-row-count">header row count</dfn></dt>
        <dd>The number of header rows (following the skipped rows) in the file. The default is <code>1</code>.</dd>
        <dt><dfn id="dfn-delimiter">delimiter</dfn></dt>
        <dd>The separator between cells. The default is <code>,</code>.</dd>
        <dt><dfn id="dfn-skip-columns">skip columns</dfn></dt>
        <dd>The number of columns to skip at the beginning of each row, before any header columns. The default is <code>0</code>.</dd>
        <dt><dfn id="dfn-header-column-count">header column count</dfn></dt>
        <dd>The number of header columns (following the skipped columns) in each row. The default is <code>0</code>.</dd>
        <dt><dfn id="dfn-skip-blank-rows">skip blank rows</dfn></dt>
        <dd>Indicates whether to ignore wholly empty rows (ie rows in which all the cells are empty). The default is <code>false</code>.</dd>
        <dt><dfn id="dfn-trim">trim</dfn></dt>
        <dd>Indicates whether to trim whitespace around cells; may be <code>true</code>, <code>false</code>, <code>start</code> or <code>end</code>. The default is <code>false</code>.</dd>
      </dl>
      <div class="issue"><div class="issue-title" aria-level="3" role="heading" id="h-issue8"><a href="https://github.com/w3c/csvw/issues/47"><span>Issue 47</span></a></div><div class="">
        <p>
          When parsing, should we:
        </p>
        <ul>
          <li>always trim whitespace around cells?</li>
          <li>always create empty cells for missing cells?</li>
        </ul>
      </div></div>
      <p>
        The algorithm for parsing a document containing tabular data is as follows:
      </p>
      <ol>
        <li>Read the file using the specified <a href="#dfn-encoding" class="internalDFN">encoding</a>.</li>
        <li>Find the rows. Each row ends with a <a href="#dfn-line-terminator" class="internalDFN">line terminator</a>, but values that are enclosed within the <a href="#dfn-quote-character" class="internalDFN">quote character</a> may contain the <a href="#dfn-line-terminator" class="internalDFN">line terminator</a> without it indicating the end of the row. The <a href="#dfn-quote-character" class="internalDFN">quote character</a> may be escaped using the <a href="#dfn-escape-character" class="internalDFN">escape character</a> where it appears within cells. If the <a href="#dfn-escape-character" class="internalDFN">escape character</a> is not the same as the <a href="#dfn-quote-character" class="internalDFN">quote character</a> then the <a href="#dfn-escape-character" class="internalDFN">escape character</a> is also used to escape the character that immediately follows it.</li>
        <li>Skip the number of rows indicated by the <a href="#dfn-skip-rows" class="internalDFN">skip rows</a> parameter. These form comment annotations on the table. If a skipped row begins with the <a href="#dfn-comment-prefix" class="internalDFN">comment prefix</a>, strip that prefix from the beginning of the row to create the content of the comment annotation.</li>
        <li>Gather the number of header rows indicated by the <a href="#dfn-header-row-count" class="internalDFN">header row count</a> parameter; the remaining rows are data rows.</li>
        <li>
          <p>
            Split the header and data rows into cells using the <a href="#dfn-delimiter" class="internalDFN">delimiter</a>. Values that are enclosed within the <a href="#dfn-quote-character" class="internalDFN">quote character</a> may contain the <a href="#dfn-delimiter" class="internalDFN">delimiter</a>. The <a href="#dfn-quote-character" class="internalDFN">quote character</a> may be escaped using the <a href="#dfn-escape-character" class="internalDFN">escape character</a> where it appears within cells. If the <a href="#dfn-escape-character" class="internalDFN">escape character</a> is not the same as the <a href="#dfn-quote-character" class="internalDFN">quote character</a> then the <a href="#dfn-escape-character" class="internalDFN">escape character</a> is also used to escape the character that immediately follows it.
          </p>
          <p>
            If <a href="#dfn-trim" class="internalDFN">trim</a> is <code>true</code> or <code>start</code> then whitespace from the start of values that are not enclosed must be removed from the value. If <a href="#dfn-trim" class="internalDFN">trim</a> is <code>true</code> or <code>end</code> then whitespace from the end of values that are not enclosed must be removed from the value.
          </p>
        </li>
        <li>In each row, ignore the number of columns indicated by the <a href="#dfn-skip-columns" class="internalDFN">skip columns</a> parameter. Always start from the first character in the row when counting columns (see <a href="#bidirectionality-in-csv-files" class="sectionRef sec-ref">section <span class="secno">4.4.2</span> <span class="sec-title">Bidirectionality in CSV+ Files</span></a>).</li>
        <li>Gather the number of header columns indicated by the <a href="#dfn-header-column-count" class="internalDFN">header column count</a> parameter. Always start from the first character in the row when counting columns (see <a href="#bidirectionality-in-csv-files" class="sectionRef sec-ref">section <span class="secno">4.4.2</span> <span class="sec-title">Bidirectionality in CSV+ Files</span></a>).</li>
        <li>Each cell within a header row that is not in a skipped or header column is a label annotation on that column.</li>
        <li>Each cell within a header column is an annotation on the row it appears in; if there is a header row then that provides the type of the annotation for the row, otherwise it is a label annotation.</li>
        <li>If <a href="#dfn-skip-blank-rows" class="internalDFN">skip blank rows</a> is <code>true</code> then ignore any rows in which all the cell values are empty strings.</li>
      </ol>
      <!-- alternative, more procedural appraoch would be something like this:
      <p>
        To <dfn>read a row</dfn>:
      </p>
      <ol>
        <li>set <var>cells</var> to an empty list</li>
        <li>set <var>skipped rows</var> to <code>0</code></li>
        <li>set <var>header rows</var> to an empty list</li>
        <li><a>read a cell</a> and add that value to the <var>cells</var> list</li>
        <li>if the next character is whitespace, then if <a>trim</a> is <code>true</code> or <code>end</code> then ignore the next whitespace characters, otherwise raise an error.</li>
        <li>otherwise, if the next character is the <a>delimiter</a> then go back to step 2.</li>
        <li>otherwise, if the next character is the <a>row terminator</a> then return the list of <var>cells</var> as the content of the row.</li>
      </ol>
    -->
    </section>
    <section class="appendix" id="standards" typeof="bibo:Chapter" resource="#standards" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-standards" resource="#h-standards"><span property="xhv:role" resource="xhv:heading"><span class="secno">A. </span>Existing Standards</span></h2>
      <p>
        This appendix outlines various ways in which CSV is defined.
      </p>
      <section id="rfc" typeof="bibo:Chapter" resource="#rfc" property="bibo:hasPart">
        <h3 id="h-rfc" resource="#h-rfc"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.1 </span>RFC 4180</span></h3>
        <p>
          [<cite><a class="bibref" href="#bib-RFC4180">RFC4180</a></cite>] defines CSV with the following ABNF grammar:
        </p>
        <pre>file = [header CRLF] record *(CRLF record) [CRLF]
header = name *(COMMA name)
record = field *(COMMA field)
name = field
field = (escaped / non-escaped)
escaped = DQUOTE *(TEXTDATA / COMMA / CR / LF / 2DQUOTE) DQUOTE
non-escaped = *TEXTDATA
COMMA = %x2C
CR = %x0D
DQUOTE =  %x22
LF = %x0A
CRLF = CR LF
TEXTDATA =  %x20-21 / %x23-2B / %x2D-7E
        </pre>
        <p>
          Of particular note here are:
        </p>
        <ul>
          <li>The production for <code>TEXTDATA</code> indicates that only non-control ASCII characters are permitted within a CSV file. This restriction is routinely ignored in practice, and is impractical on the international web.</li>
          <li>Lines should be ended with <code>CRLF</code>. This makes it harder to produce CSV files on Unix-based systems where the usual line ending is <code>LF</code>.</li>
          <li>The header line is optional; a <code>header</code> parameter on the media type indicates whether the header is present or not.</li>
          <li>Fields may be escaped by wrapping them in double quotes; any double quotes within the field must be escaped with two double quotes (<code>""</code>).</li>
        </ul>
      </section>
      <section id="excel" typeof="bibo:Chapter" resource="#excel" property="bibo:hasPart">
        <h3 id="h-excel" resource="#h-excel"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.2 </span>Excel</span></h3>
        <p>
          Excel is a common tool for both creating and reading CSV documents, and therefore the CSV that it produces is a de facto standard.
        </p>
        <div class="note"><div class="note-title" aria-level="4" role="heading" id="h-note7"><span>Note</span></div><p class="">
          The following describes the behaviour of Microsoft Excel for Mac 2011 with an English locale. Further testing is needed to see the behaviour of Excel in other situations.
        </p></div>
        <section id="saved-csv" typeof="bibo:Chapter" resource="#saved-csv" property="bibo:hasPart">
          <h4 id="h-saved-csv" resource="#h-saved-csv"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.2.1 </span>Saved CSV</span></h4>
          <p>
            Excel generates CSV files encoded using Windows-1252 with <code>LF</code> line endings. Characters that cannot be represented within Windows-1252 are replaced by underscores. Only those cells that need escaping (eg because they contain commas or double quotes) are escaped, and double quotes are escaped with two double quotes.
          </p>
          <p>
            Dates and numbers are formatted as displayed, which means that formatting can lead to information being lost or becoming inconsistent.
          </p>
        </section>
        <section id="opened-csv" typeof="bibo:Chapter" resource="#opened-csv" property="bibo:hasPart">
          <h4 id="h-opened-csv" resource="#h-opened-csv"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.2.2 </span>Opened CSV</span></h4>
          <p>
            When opening CSV files, Excel interprets CSV files saved in UTF-8 as being encoded as Windows-1252 (whether or not a <a href="http://en.wikipedia.org/wiki/Byte_order_mark"><abbr title="Byte Order Mark">BOM</abbr></a> is present). It correctly deals with double quoted cells, except that it converts line breaks within cells into spaces. It understands <code>CRLF</code> as a line break. It detects dates (formatted as <code>YYYY-MM-DD</code>) and formats them in the default date formatting for files.
          </p>
        </section>
        <section id="imported-csv" typeof="bibo:Chapter" resource="#imported-csv" property="bibo:hasPart">
          <h4 id="h-imported-csv" resource="#h-imported-csv"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.2.3 </span>Imported CSV</span></h4>
          <p>
            Excel provides more control when importing CSV files into Excel. However, it does not properly understand UTF-8 (with or without <abbr title="Byte Order Mark">BOM</abbr>). It does however properly understand UTF-16 and can read non-ASCII characters from a UTF-16-encoded file.
          </p>
          <p>
            A particular quirk in the importing of CSV is that if a cell contains a line break, the final double quote that escapes the cell will be included within it.
          </p>
        </section>
        <section id="copied-tabular-data" typeof="bibo:Chapter" resource="#copied-tabular-data" property="bibo:hasPart">
          <h4 id="h-copied-tabular-data" resource="#h-copied-tabular-data"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.2.4 </span>Copied Tabular Data</span></h4>
          <p>
            When tabular data is copied from Excel, it is copied in a tab-delimited format, with <code>LF</code> line breaks.
          </p>
        </section>
      </section>
      <section id="google" typeof="bibo:Chapter" resource="#google" property="bibo:hasPart">
        <h3 id="h-google" resource="#h-google"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.3 </span>Google Spreadsheets</span></h3>
        <section id="downloading-csv" typeof="bibo:Chapter" resource="#downloading-csv" property="bibo:hasPart">
          <h4 id="h-downloading-csv" resource="#h-downloading-csv"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.3.1 </span>Downloading CSV</span></h4>
          <p>
            Downloaded CSV files are encoded in UTF-8, without a <a href="http://en.wikipedia.org/wiki/Byte_order_mark"><abbr title="Byte Order Mark">BOM</abbr></a>, and with <code>LF</code> line endings. Dates and numbers are formatted as they appear within the spreadsheet.
          </p>
        </section>
        <section id="importing-csv" typeof="bibo:Chapter" resource="#importing-csv" property="bibo:hasPart">
          <h4 id="h-importing-csv" resource="#h-importing-csv"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.3.2 </span>Importing CSV</span></h4>
          <p>
            CSV files can be imported as UTF-8 (with or without <abbr title="Byte Order Mark">BOM</abbr>). <code>CRLF</code> line endings are correctly recognised. Dates are reformatted to the default date format on load.
          </p>
        </section>
      </section>
      <section id="csv-files-in-a-tabular-data-package" typeof="bibo:Chapter" resource="#csv-files-in-a-tabular-data-package" property="bibo:hasPart">
        <h3 id="h-csv-files-in-a-tabular-data-package" resource="#h-csv-files-in-a-tabular-data-package"><span property="xhv:role" resource="xhv:heading"><span class="secno">A.4 </span>CSV Files in a Tabular Data Package</span></h3>
        <p>
          <a href="http://dataprotocols.org/tabular-data-package/#csv-files">Tabular Data Packages</a> place the following restrictions on CSV files:
        </p>
        <blockquote>
          <p>As a starting point, CSV files included in a Tabular Data Package package must conform to the RFC for CSV (4180 - Common Format and MIME Type for Comma-Separated Values (CSV) Files). In addition:</p>

          <ul>
            <li>File names <em class="rfc2119" title="MUST">MUST</em> end with <code>.csv</code></li>
            <li>Files <em class="rfc2119" title="MUST">MUST</em> be encoded as UTF-8</li>
            <li>
              <p>Files <em class="rfc2119" title="MUST">MUST</em> have a single header row. This row <em class="rfc2119" title="MUST">MUST</em> be the first row in the
          file.</p>

              <ul>
                <li>Terminology: each column in the CSV file is termed a <em>field</em> and
          its <code>name</code> is the string in that column in the header row.</li>
                <li>The <code>name</code> <em class="rfc2119" title="MUST">MUST</em> be unique amongst fields and <em class="rfc2119" title="MUST">MUST</em> contain at
          least one character</li>
                <li>There are no further restrictions on the form of the <code>name</code> but
          it is <em class="rfc2119" title="RECOMMENDED">RECOMMENDED</em> that it contain only alphanumeric characters
          together with “ .-_”</li>
              </ul>
            </li>
            <li>Rows in the file <em class="rfc2119" title="MUST NOT">MUST NOT</em> contain more fields than are in the header row (though they may
          contain less)</li>
            <li>Each file <em class="rfc2119" title="MUST">MUST</em> have an entry in the <code>resources</code> array in the <code>datapackage.json</code> file</li>
            <li>The resource metadata <em class="rfc2119" title="MUST">MUST</em> include a <code>schema</code> attribute whose value <em class="rfc2119" title="MUST">MUST</em> conform to the JSON
          Table Schema</li>
            <li>All fields in the CSV files <em class="rfc2119" title="MUST">MUST</em> be described in the <code>schema</code></li>
          </ul>

          <p>CSV files generated by different applications often vary in their syntax, e.g. use of quoting characters, delimiters, etc. To encourage conformance, CSV files in a CSV files in a Tabular Data Package <em class="rfc2119" title="SHOULD">SHOULD</em></p>

          <ul>
            <li>Use “,” as field delimiters</li>
            <li>Use “rn” or “n” as line terminators</li>
          </ul>

          <p>If a CSV file does not follow these rules then its specific CSV dialect <em class="rfc2119" title="MUST">MUST</em> be documented. The resource 
          hash for the resource in the <code>datapackage.json</code> descriptor <em class="rfc2119" title="MUST">MUST</em>:</p>

          <ul>
            <li>Include a <code>dialect</code> key that conforms to that described in the <a href="http://dataprotocols.org/csv-dialect/">CSV Dialect Description Format</a></li>
          </ul>

          <p>Applications processing the CSV file <em class="rfc2119" title="SHOULD">SHOULD</em> read use the <code>dialect</code> of the CSV file to guide parsing.</p>
        </blockquote>
      </section>
      <div class="issue"><div class="issue-title" aria-level="3" role="heading" id="h-issue9"><span>Issue</span></div><div class="">
        <p>
          More details of behaviour of other tools should go here. This should include the most popular CSV parsing/generating libraries in common programming languages. Test files which include non-ASCII characters, double quotes and line breaks within cells are:
        </p>
        <ul>
          <li><a href="test-utf8.csv">test-utf8.csv</a></li>
          <li><a href="test-utf8-bom.csv">test-utf8-bom.csv</a></li>
          <li><a href="test-utf16.csv">test-utf16.csv</a></li>
          <li><a href="test-utf16-bom.csv">test-utf16-bom.csv</a></li>
          <li><a href="test.xlsx">test.xslx</a></li>
          <li><a href="test.xls">test.xsl</a></li>
        </ul>
      </div></div>
    </section>
  


<section id="references" class="appendix" typeof="bibo:Chapter" resource="#references" property="bibo:hasPart"><!--OddPage--><h2 id="h-references" resource="#h-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B. </span>References</span></h2><section id="normative-references" typeof="bibo:Chapter" resource="#normative-references" property="bibo:hasPart"><h3 id="h-normative-references" resource="#h-normative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B.1 </span>Normative references</span></h3><dl class="bibliography" resource=""><dt id="bib-RFC4180">[RFC4180]</dt><dd>Y. Shafranovich. <a href="https://tools.ietf.org/html/rfc4180" property="dc:requires"><cite>Common Format and MIME Type for Comma-Separated Values (CSV) Files</cite></a>. October 2005. Informational. URL: <a href="https://tools.ietf.org/html/rfc4180" property="dc:requires">https://tools.ietf.org/html/rfc4180</a>
</dd><dt id="bib-encoding">[encoding]</dt><dd>Anne van Kesteren; Joshua Bell; Addison Phillips. <a href="http://www.w3.org/TR/encoding/" property="dc:requires"><cite>Encoding</cite></a>. 16 September 2014. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/encoding/" property="dc:requires">http://www.w3.org/TR/encoding/</a>
</dd><dt id="bib-tabular-metadata">[tabular-metadata]</dt><dd>Rufus Pollock; Jeni Tennison. <a href="http://www.w3.org/TR/2015/WD-tabular-metadata-20150108/" property="dc:requires"><cite>Metadata Vocabulary for Tabular Data</cite></a>. W3C Working Draft. URL: <a href="http://www.w3.org/TR/2015/WD-tabular-metadata-20150108/" property="dc:requires">http://www.w3.org/TR/2015/WD-tabular-metadata-20150108/</a>
</dd></dl></section><section id="informative-references" typeof="bibo:Chapter" resource="#informative-references" property="bibo:hasPart"><h3 id="h-informative-references" resource="#h-informative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B.2 </span>Informative references</span></h3><dl class="bibliography" resource=""><dt id="bib-EBNF-NOTATION">[EBNF-NOTATION]</dt><dd>Tim Bray; Jean Paoli; C. Michael Sperberg-McQueen; Eve Maler; François Yergau. <a href="http://www.w3.org/TR/REC-xml/#sec-notation" property="dc:references"><cite>EBNF Notation</cite></a>. W3C Recommendation. URL: <a href="http://www.w3.org/TR/REC-xml/#sec-notation" property="dc:references">http://www.w3.org/TR/REC-xml/#sec-notation</a>
</dd><dt id="bib-RFC7111">[RFC7111]</dt><dd>Michael Hausenblas; Erik Wilde; Jenni Tennison. <a href="http://www.ietf.org/rfc/rfc7111.txt" property="dc:references"><cite>URI Fragment Identifiers for the text/csv Media Type</cite></a>. Internet RFC. URL: <a href="http://www.ietf.org/rfc/rfc7111.txt" property="dc:references">http://www.ietf.org/rfc/rfc7111.txt</a>
</dd></dl></section></section></body></html>