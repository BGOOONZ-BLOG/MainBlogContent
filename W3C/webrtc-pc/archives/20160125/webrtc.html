<!DOCTYPE html>
<html lang="en" typeof="bibo:Document " prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">
<head><meta name="viewport" content="width=device-width, initial-scale=1, width = content-width, initial-scale = 1.0, shrink-to-fit=no"><meta property="dc:language" content="en" lang="">
  <meta charset="utf-8">
  <style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title , div.ednote-title, div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title, div.ednote-title { color: #2b2; }
div.warning-title { color: #f22; }
div.issue-title span, div.note-title span, div.ednote-title span, div.warning-title span {
    text-transform: uppercase;
}
div.note, div.issue, div.ednote, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .ednote > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
.issue, .note, .ednote, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note , div.ednote,  div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.ednote, span.issue, span.warning { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note, .ednote {
    border-color: #52e052;
    background: #e9fbe9;
}

.warning {
    border-color: #f11;
    border-right-width: .2em;
    border-top-width: .2em;
    border-bottom-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "âš "; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
}

li.task-list-item {
    list-style: none;
}

input.task-list-item-checkbox {
    margin: 0 0.35em 0.25em -1.6em;
    vertical-align: middle;
}
</style><style>/* HIGHLIGHTS */
code.prettyprint {
    color:  inherit;
}

/* this from google-code-prettify */
.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

@media print {
  pre.idl {
      white-space: pre-wrap;
  }
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    sans-serif;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
}
a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlCtor*/
.idlCtorName {
    color:  #ff4500;
}
.idlCtorName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName, .idlDefaultValue {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlSectionComment*/
.idlSectionComment {
    color: gray;
}

/*.idlIterable*/
.idlIterableKeyType, .idlIterableValueType {
    color:  #005a9c;
}

/*.idlMaplike*/
.idlMaplikeKeyType, .idlMaplikeValueType {
    color:  #005a9c;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.constructors, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .constructors dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .constructors dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.constructors dt code {
    background:  #cfc;
}

.attributes dd, .methods dd, .constants dd, .constructors dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link href="webrtc.css" rel="stylesheet">
  <title>WebRTC 1.0: Real-time Communication Between Browsers</title>
  
  
<style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #C83500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><link href="https://www.w3.org/2016/01/W3C-ED" rel="stylesheet"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--><script type="application/json" id="initialUserConfig">{
  "specStatus": "ED",
  "shortName": "webrtc",
  "useExperimentalStyles": true,
  "overrideCopyright": "<p class='copyright'>Initial Author of this Specification was Ian Hickson, Google Inc., with the following copyright statement:<br /> &#169; Copyright 2004-2011 Apple Computer, Inc., Mozilla Foundation, and Opera Software ASA. You are granted a license to use, reproduce and create derivative works of this document.</p> <p class='copyright'>All subsequent changes since 26 July 2011 done by the W3C WebRTC Working Group are under the following <a href='http://www.w3.org/Consortium/Legal/ipr-notice#Copyright'>Copyright</a>:<br />&#169; 2011-2015 <a href='http://www.w3.org/'><abbr title='World Wide Web Consortium'>W3C</abbr></a><sup>&#174;</sup> (<a href='http://www.csail.mit.edu/'><abbr title='Massachusetts Institute of Technology'>MIT</abbr></a>, <a href='http://www.ercim.eu/'><abbr title='European Research Consortium for Informatics and Mathematics'>ERCIM</abbr></a>, <a href='http://www.keio.ac.jp/'>Keio</a>, <a href='http://ev.buaa.edu.cn/'>Beihang</a>). <a href='http://www.w3.org/Consortium/Legal/copyright-documents'>Document use</a>  rules apply.</p> <p class='copyright'>For the entire publication on the W3C site the <a href='http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer'>liability</a> and <a href='http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks'>trademark</a> rules apply.</p>",
  "prevED": "https://w3c.github.io/webrtc-pc/archives/20151222/webrtc.html",
  "edDraftURI": "http://w3c.github.io/webrtc-pc/",
  "editors": [
    {
      "name": "Adam Bergkvist",
      "company": "Ericsson"
    },
    {
      "name": "Daniel C. Burnett",
      "company": "Invited Expert"
    },
    {
      "name": "Cullen Jennings",
      "company": "Cisco"
    },
    {
      "name": "Anant Narayanan",
      "company": "Mozilla (until November 2012)"
    },
    {
      "name": "Bernard Aboba",
      "company": "Microsoft Corporation"
    }
  ],
  "wg": "Web Real-Time Communications Working Group",
  "wgURI": "http://www.w3.org/2011/04/webrtc/",
  "wgPublicList": "public-webrtc",
  "wgPatentURI": "http://www.w3.org/2004/01/pp-impl/47318/status",
  "issueBase": "https://github.com/w3c/webrtc-pc/issues/",
  "otherLinks": [
    {
      "key": "Participate",
      "data": [
        {
          "value": "Mailing list",
          "href": "http://lists.w3.org/Archives/Public/public-webrtc/"
        },
        {
          "value": "Browse open issues",
          "href": "https://github.com/w3c/webrtc-pc/issues"
        },
        {
          "value": "IETF RTCWEB Working Group",
          "href": "https://tools.ietf.org/wg/rtcweb/"
        }
      ]
    }
  ],
  "preProcess": [
    null
  ],
  "localBiblio": {
    "JSEP": {
      "authors": [
        "Justin Uberti",
        "Cullen Jennings",
        "Eric Rescorla"
      ],
      "href": "http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/",
      "publisher": "IETF",
      "status": "Active Internet-Draft",
      "title": "Javascript Session Establishment Protocol",
      "date": "18 October 2015"
    }
  }
}</script></head>

<body id="respecDocument" role="document" class="h-entry"><div id="respecHeader" role="contentinfo" class="head">
  <p>
      
        
            <a class="logo" href="http://www.w3.org/"><img src="https://www.w3.org/Icons/w3c_home" alt="W3C" height="48" width="72"></a>
            
            
        
      
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">WebRTC 1.0: Real-time Communication Between Browsers</h1>
  
  <h2 id="w3c-editor-s-draft-25-january-2016"><abbr title="World Wide Web Consortium">W3C</abbr> Editor's Draft <time property="dcterms:issued" class="dt-published" datetime="2016-01-25">25 January 2016</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="https://w3c.github.io/webrtc-pc/archives/20160125/webrtc.html">https://w3c.github.io/webrtc-pc/archives/20160125/webrtc.html</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/webrtc/">http://www.w3.org/TR/webrtc/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://w3c.github.io/webrtc-pc/">http://w3c.github.io/webrtc-pc/</a></dd>
    
    
    
    
    
      
        <dt>Previous editor's draft:</dt>
        <dd><a href="https://w3c.github.io/webrtc-pc/archives/20151222/webrtc.html">https://w3c.github.io/webrtc-pc/archives/20151222/webrtc.html</a></dd>
      
    
    
    
    <dt>Editors:</dt>
    <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Adam Bergkvist</span>, Ericsson</span>
<span property="rdf:rest" resource="_:editor1"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor1"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Daniel C. Burnett</span>, Invited Expert</span>
<span property="rdf:rest" resource="_:editor2"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor2"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Cullen Jennings</span>, Cisco</span>
<span property="rdf:rest" resource="_:editor3"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor3"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Anant Narayanan</span>, Mozilla (until November 2012)</span>
<span property="rdf:rest" resource="_:editor4"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor4"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Bernard Aboba</span>, Microsoft Corporation</span>
<span property="rdf:rest" resource="rdf:nil"></span>
</dd>

    
    
      
        
          <dt>Participate:</dt>
          
             
                
                  <dd>
                    <a href="http://lists.w3.org/Archives/Public/public-webrtc/">
                      Mailing list
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://github.com/w3c/webrtc-pc/issues">
                      Browse open issues
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://tools.ietf.org/wg/rtcweb/">
                      IETF RTCWEB Working Group
                    </a>
                  </dd>
                
             
          
        
      
    
  </dl>
  
  
  
  
    
      <p class="copyright">Initial Author of this Specification was Ian Hickson, Google Inc., with the following copyright statement:<br> Â© Copyright 2004-2011 Apple Computer, Inc., Mozilla Foundation, and Opera Software ASA. You are granted a license to use, reproduce and create derivative works of this document.</p> <p class="copyright">All subsequent changes since 26 July 2011 done by the <abbr title="World Wide Web Consortium">W3C</abbr> WebRTC Working Group are under the following <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>:<br>Â© 2011-2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>Â®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). <a href="http://www.w3.org/Consortium/Legal/copyright-documents">Document use</a>  rules apply.</p> <p class="copyright">For the entire publication on the <abbr title="World Wide Web Consortium">W3C</abbr> site the <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a> and <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> rules apply.</p>
    
  
  <hr title="Separator for header">
</div>
  <section property="dc:abstract" class="introductory" id="abstract"><h2 resource="#h-abstract" id="h-abstract"><span property="xhv:role" resource="xhv:heading">Abstract</span></h2>
    <p>This document defines a set of ECMAScript APIs in WebIDL to allow media
    to be sent to and received from another browser or device implementing the
    appropriate set of real-time protocols. This specification is being
    developed in conjunction with a protocol specification developed by the
    IETF RTCWEB group and an API specification to get access to local media
    devices developed by the Media Capture Task Force.</p>
  </section><section id="sotd" class="introductory"><h2 resource="#h-sotd" id="h-sotd"><span property="xhv:role" resource="xhv:heading">Status of This Document</span></h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at http://www.w3.org/TR/.</em>
        </p>
        
          
          
    <p>This document is neither complete nor stable, and as such is not yet
    suitable for commercial implementation. However, early experimentation is
    encouraged. The API is based on preliminary work done in the WHATWG. The
    Web Real-Time Communications Working Group expects this specification to
    evolve significantly based on:</p>

    <ul>
      <li>The outcome of ongoing exchanges in the companion RTCWEB group at
      IETF to define the set of protocols that, together with this document,
      will enable real-time communications in Web browsers.</li>

      <li>Privacy issues that arise when exposing local capabilities and local
      streams.</li>

      <li>Technical discussions within the group.</li>

      <li>Experience gained through early experimentations.</li>

      <li>Feedback received from other groups and individuals.</li>
    </ul>
  
          
          <p>
            This document was published by the <a href="http://www.w3.org/2011/04/webrtc/">Web Real-Time Communications Working Group</a> as an Editor's Draft.
            
            
              If you wish to make comments regarding this document, please send them to
              <a href="mailto:public-webrtc@w3.org">public-webrtc@w3.org</a>
              (<a href="mailto:public-webrtc-request@w3.org?subject=subscribe">subscribe</a>,
              <a href="http://lists.w3.org/Archives/Public/public-webrtc/">archives</a>).
            
            
            
            
            
              
              All comments are welcome.
              
            
          </p>
          
          
          
            <p>
              Publication as an Editor's Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr>
              Membership. This is a draft document and may be updated, replaced or obsoleted by other
              documents at any time. It is inappropriate to cite this document as other than work in
              progress.
            </p>
          
          
          
          <p>
            
              This document was produced by
              
              a group
               operating under the
              <a id="sotd_patent" property="w3p:patentRules" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
              Policy</a>.
            
            
            
              
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/47318/status" rel="disclosure">public list of any patent
                disclosures</a>
              
              made in connection with the deliverables of
              
              the group; that page also includes
              
              instructions for disclosing a patent. An individual who has actual knowledge of a patent
              which the individual believes contains
              <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
              Claim(s)</a> must disclose the information in accordance with
              <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
              6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
            
            
          </p>
          
            <p>This document is governed by the <a id="w3c_process_revision" href="http://www.w3.org/2015/Process-20150901/">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
            </p>
          
          
        
      
    
  
</section><nav id="toc"><h2 id="table-of-contents" class="introductory">Table of Contents</h2><ul role="directory" class="toc"><li class="tocline"><a class="tocxref" href="#intro"><span class="secno">1. </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#conformance"><span class="secno">2. </span>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><span class="secno">3. </span>Terminology</a></li><li class="tocline"><a class="tocxref" href="#peer-to-peer-connections"><span class="secno">4. </span>Peer-to-peer connections</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><span class="secno">4.1 </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#configuration"><span class="secno">4.2 </span>Configuration</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcconfiguration-dictionary"><span class="secno">4.2.1 </span>RTCConfiguration Dictionary</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtcconfiguration-members"><span class="secno">4.2.1.1 </span>Dictionary <span class="formerLink"><code>RTCConfiguration</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcicecredentialtype-enum"><span class="secno">4.2.2 </span>RTCIceCredentialType Enum</a></li><li class="tocline"><a class="tocxref" href="#rtciceserver-dictionary"><span class="secno">4.2.3 </span>RTCIceServer Dictionary</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtciceserver-members"><span class="secno">4.2.3.1 </span>Dictionary <span class="formerLink"><code>RTCIceServer</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcicetransportpolicy-enum"><span class="secno">4.2.4 </span>RTCIceTransportPolicy Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcbundlepolicy-enum"><span class="secno">4.2.5 </span>RTCBundlePolicy Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcrtcpmuxpolicy-enum"><span class="secno">4.2.6 </span>RTCRtcpMuxPolicy Enum</a></li><li class="tocline"><a class="tocxref" href="#offer-answer-options"><span class="secno">4.2.7 </span>Offer/Answer Options</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtcofferansweroptions-members"><span class="secno">4.2.7.1 </span>Dictionary <span class="formerLink"><code>RTCOfferAnswerOptions</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcofferoptions-members"><span class="secno">4.2.7.2 </span>Dictionary <span class="formerLink"><code>RTCOfferOptions</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnection-interface"><span class="secno">4.3 </span>RTCPeerConnection Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#operation"><span class="secno">4.3.1 </span>Operation</a></li><li class="tocline"><a class="tocxref" href="#interface-definition"><span class="secno">4.3.2 </span>Interface Definition</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors"><span class="secno">4.3.2.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes"><span class="secno">4.3.2.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods"><span class="secno">4.3.2.3 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#legacy-interface-extensions"><span class="secno">4.3.3 </span>Legacy Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-1"><span class="secno">4.3.3.1 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#garbage-collection"><span class="secno">4.3.4 </span>Garbage collection</a></li></ul></li><li class="tocline"><a class="tocxref" href="#state-definitions"><span class="secno">4.4 </span>State Definitions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcsignalingstate-enum"><span class="secno">4.4.1 </span>RTCSignalingState Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcicegatheringstate-enum"><span class="secno">4.4.2 </span>RTCIceGatheringState Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnectionstate-enum"><span class="secno">4.4.3 </span>RTCPeerConnectionState Enum</a></li><li class="tocline"><a class="tocxref" href="#rtciceconnectionstate-enum"><span class="secno">4.4.4 </span>RTCIceConnectionState Enum</a></li></ul></li><li class="tocline"><a class="tocxref" href="#callback-definitions"><span class="secno">4.5 </span>Callback Definitions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcpeerconnectionerrorcallback"><span class="secno">4.5.1 </span>RTCPeerConnectionErrorCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-rtcpeerconnectionerrorcallback-parameters"><span class="secno">4.5.1.1 </span>Callback <span class="formerLink"><code>RTCPeerConnectionErrorCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcsessiondescriptioncallback"><span class="secno">4.5.2 </span>RTCSessionDescriptionCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-rtcsessiondescriptioncallback-parameters"><span class="secno">4.5.2.1 </span>Callback <span class="formerLink"><code>RTCSessionDescriptionCallback</code></span> Parameters</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#error-handling"><span class="secno">4.6 </span>Error Handling</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#general-principles"><span class="secno">4.6.1 </span>General Principles</a></li><li class="tocline"><a class="tocxref" href="#rtcsdperror"><span class="secno">4.6.2 </span>RTCSdpError</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-1"><span class="secno">4.6.2.1 </span>Attributes</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#session-description-model"><span class="secno">4.7 </span>Session Description Model</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcsdptype"><span class="secno">4.7.1 </span>RTCSdpType</a></li><li class="tocline"><a class="tocxref" href="#rtcsessiondescription-class"><span class="secno">4.7.2 </span>RTCSessionDescription Class</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-1"><span class="secno">4.7.2.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-2"><span class="secno">4.7.2.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#serializer"><span class="secno">4.7.2.3 </span>Serializer</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcsessiondescriptioninit-members"><span class="secno">4.7.2.4 </span>Dictionary <span class="formerLink"><code>RTCSessionDescriptionInit</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#session-negotiation-model"><span class="secno">4.8 </span>Session Negotiation Model</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#setting-negotiation-needed"><span class="secno">4.8.1 </span>Setting Negotiation-Needed</a></li><li class="tocline"><a class="tocxref" href="#clearing-negotiation-needed"><span class="secno">4.8.2 </span>Clearing Negotiation-Needed</a></li><li class="tocline"><a class="tocxref" href="#firing-an-event"><span class="secno">4.8.3 </span>Firing An Event</a></li></ul></li><li class="tocline"><a class="tocxref" href="#interfaces-for-connectivity-establishment"><span class="secno">4.9 </span>Interfaces for Connectivity Establishment</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcicecandidate-interface"><span class="secno">4.9.1 </span>RTCIceCandidate Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-2"><span class="secno">4.9.1.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-3"><span class="secno">4.9.1.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#serializer-1"><span class="secno">4.9.1.3 </span>Serializer</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcicecandidateinit-members"><span class="secno">4.9.1.4 </span>Dictionary <span class="formerLink"><code>RTCIceCandidateInit</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#rtciceprotocol-enum"><span class="secno">4.9.1.5 </span>RTCIceProtocol Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcicetcpcandidatetype-enum"><span class="secno">4.9.1.6 </span>RTCIceTcpCandidateType Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcicecandidatetype-enum"><span class="secno">4.9.1.7 </span>RTCIceCandidateType Enum</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnectioniceevent"><span class="secno">4.9.2 </span>RTCPeerConnectionIceEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-3"><span class="secno">4.9.2.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-4"><span class="secno">4.9.2.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcpeerconnectioniceeventinit-members"><span class="secno">4.9.2.3 </span>Dictionary <span class="formerLink"><code>RTCPeerConnectionIceEventInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnectioniceerrorevent"><span class="secno">4.9.3 </span>RTCPeerConnectionIceErrorEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-4"><span class="secno">4.9.3.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-5"><span class="secno">4.9.3.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcpeerconnectioniceerroreventinit-members"><span class="secno">4.9.3.3 </span>Dictionary <span class="formerLink"><code>RTCPeerConnectionIceErrorEventInit</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#priority-and-qos-model"><span class="secno">4.10 </span>Priority and QoS Model</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcprioritytype-enum"><span class="secno">4.10.1 </span>RTCPriorityType Enum</a></li></ul></li><li class="tocline"><a class="tocxref" href="#sec.cert-mgmt"><span class="secno">4.11 </span>Certificate Management</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-2"><span class="secno">4.11.1 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#rtccertificate-interface"><span class="secno">4.11.2 </span>RTCCertificate Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-6"><span class="secno">4.11.2.1 </span>Attributes</a></li></ul></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#rtp-media-api"><span class="secno">5. </span>RTP Media API</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcpeerconnection-interface-extensions"><span class="secno">5.1 </span>RTCPeerConnection Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-7"><span class="secno">5.1.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-3"><span class="secno">5.1.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtptransceiverinit-members"><span class="secno">5.1.3 </span>Dictionary <span class="formerLink"><code>RTCRtpTransceiverInit</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#processing-remote-mediastreamtracks"><span class="secno">5.1.4 </span>Processing Remote MediaStreamTracks</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcrtpsender-interface"><span class="secno">5.2 </span>RTCRtpSender Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-8"><span class="secno">5.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-4"><span class="secno">5.2.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpparameters-members"><span class="secno">5.2.3 </span>Dictionary <span class="formerLink"><code>RTCRtpParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpencodingparameters-members"><span class="secno">5.2.4 </span>Dictionary <span class="formerLink"><code>RTCRtpEncodingParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtxparameters-members"><span class="secno">5.2.5 </span>Dictionary <span class="formerLink"><code>RTCRtxParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcfecparameters-members"><span class="secno">5.2.6 </span>Dictionary <span class="formerLink"><code>RTCFecParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtcpparameters-members"><span class="secno">5.2.7 </span>Dictionary <span class="formerLink"><code>RTCRtcpParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpheaderextensionparameters-members"><span class="secno">5.2.8 </span>Dictionary <span class="formerLink"><code>RTCRtpHeaderExtensionParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpcodecparameters-members"><span class="secno">5.2.9 </span>Dictionary <span class="formerLink"><code>RTCRtpCodecParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpcapabilities-members"><span class="secno">5.2.10 </span>Dictionary <span class="formerLink"><code>RTCRtpCapabilities</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpcodeccapability-members"><span class="secno">5.2.11 </span>Dictionary <span class="formerLink"><code>RTCRtpCodecCapability</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpheaderextensioncapability-members"><span class="secno">5.2.12 </span>Dictionary <span class="formerLink"><code>RTCRtpHeaderExtensionCapability</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcrtpreceiver-interface"><span class="secno">5.3 </span>RTCRtpReceiver Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-9"><span class="secno">5.3.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-5"><span class="secno">5.3.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#attributes-10"><span class="secno">5.3.3 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcrtptransceiver-interface"><span class="secno">5.4 </span>RTCRtpTransceiver Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-11"><span class="secno">5.4.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-6"><span class="secno">5.4.2 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcdtlstransport-interface"><span class="secno">5.5 </span>RTCDtlsTransport Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-12"><span class="secno">5.5.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-7"><span class="secno">5.5.2 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcicetransport-interface"><span class="secno">5.6 </span>RTCIceTransport Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-13"><span class="secno">5.6.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-8"><span class="secno">5.6.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtciceparameters-members"><span class="secno">5.6.3 </span>Dictionary <span class="formerLink"><code>RTCIceParameters</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcicecandidatepair-members"><span class="secno">5.6.4 </span>Dictionary <span class="formerLink"><code>RTCIceCandidatePair</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtctrackevent"><span class="secno">5.7 </span>RTCTrackEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-5"><span class="secno">5.7.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-14"><span class="secno">5.7.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtctrackeventinit-members"><span class="secno">5.7.3 </span>Dictionary <span class="formerLink"><code>RTCTrackEventInit</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#peer-to-peer-data-api"><span class="secno">6. </span>Peer-to-peer Data API</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcpeerconnection-interface-extensions-1"><span class="secno">6.1 </span>RTCPeerConnection Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-15"><span class="secno">6.1.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-9"><span class="secno">6.1.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#rtcsctptransport-interface"><span class="secno">6.1.3 </span>RTCSctpTransport Interface</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-16"><span class="secno">6.1.3.1 </span>Attributes</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcdatachannel"><span class="secno">6.2 </span>RTCDataChannel</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-17"><span class="secno">6.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-10"><span class="secno">6.2.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcdatachannelinit-members"><span class="secno">6.2.3 </span>Dictionary <span class="formerLink"><code>RTCDataChannelInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcdatachannelevent"><span class="secno">6.3 </span>RTCDataChannelEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-6"><span class="secno">6.3.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-18"><span class="secno">6.3.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcdatachanneleventinit-members"><span class="secno">6.3.3 </span>Dictionary <span class="formerLink"><code>RTCDataChannelEventInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#garbage-collection-1"><span class="secno">6.4 </span>Garbage Collection</a></li></ul></li><li class="tocline"><a class="tocxref" href="#peer-to-peer-dtmf"><span class="secno">7. </span>Peer-to-peer DTMF</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcrtpsender-interface-extensions"><span class="secno">7.1 </span>RTCRtpSender Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-19"><span class="secno">7.1.1 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcdtmfsender"><span class="secno">7.2 </span>RTCDTMFSender</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-20"><span class="secno">7.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-11"><span class="secno">7.2.2 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcdtmftonechangeevent"><span class="secno">7.3 </span>RTCDTMFToneChangeEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constructors-7"><span class="secno">7.3.1 </span>Constructors</a></li><li class="tocline"><a class="tocxref" href="#attributes-21"><span class="secno">7.3.2 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcdtmftonechangeeventinit-members"><span class="secno">7.3.3 </span>Dictionary <span class="formerLink"><code>RTCDTMFToneChangeEventInit</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#sec.stats-model"><span class="secno">8. </span>Statistics Model</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#introduction-1"><span class="secno">8.1 </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnection-interface-extensions-2"><span class="secno">8.2 </span>RTCPeerConnection Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-12"><span class="secno">8.2.1 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcstatscallback"><span class="secno">8.3 </span>RTCStatsCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-rtcstatscallback-parameters"><span class="secno">8.3.1 </span>Callback <span class="formerLink"><code>RTCStatsCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcstatsreport-object"><span class="secno">8.4 </span>RTCStatsReport Object</a></li><li class="tocline"><a class="tocxref" href="#rtcstats-dictionary"><span class="secno">8.5 </span>RTCStats Dictionary</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtcstats-members"><span class="secno">8.5.1 </span>Dictionary <span class="formerLink"><code>RTCStats</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#derived-stats-dictionaries"><span class="secno">8.6 </span>Derived Stats Dictionaries</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtcrtpstreamstats-members"><span class="secno">8.6.1 </span>Dictionary <span class="formerLink"><code>RTCRTPStreamStats</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcinboundrtpstreamstats-members"><span class="secno">8.6.2 </span>Dictionary <span class="formerLink"><code>RTCInboundRTPStreamStats</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcoutboundrtpstreamstats-members"><span class="secno">8.6.3 </span>Dictionary <span class="formerLink"><code>RTCOutboundRTPStreamStats</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#example"><span class="secno">8.7 </span>Example</a></li></ul></li><li class="tocline"><a class="tocxref" href="#sec.identity-proxy"><span class="secno">9. </span>Identity</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#identity-provider-interaction"><span class="secno">9.1 </span>Identity Provider Interaction</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#sec.identity-proxy-communications"><span class="secno">9.1.1 </span>Identity Provider
        Selection</a></li><li class="tocline"><a class="tocxref" href="#sec.create-identity-proxy"><span class="secno">9.1.2 </span>Instantiating an IdP Proxy</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-22"><span class="secno">9.1.2.1 </span>Attributes</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#sec.register-idp"><span class="secno">9.2 </span>Registering an IdP Proxy</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-13"><span class="secno">9.2.1 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#interface-exposed-by-identity-providers"><span class="secno">9.2.2 </span>Interface Exposed by Identity Providers</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#methods-14"><span class="secno">9.2.2.1 </span>Methods</a></li></ul></li><li class="tocline"><a class="tocxref" href="#identity-assertion-and-validation-results"><span class="secno">9.2.3 </span>Identity Assertion and Validation Results</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtcidentityassertionresult-members"><span class="secno">9.2.3.1 </span>Dictionary <span class="formerLink"><code>RTCIdentityAssertionResult</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcidentityproviderdetails-members"><span class="secno">9.2.3.2 </span>Dictionary <span class="formerLink"><code>RTCIdentityProviderDetails</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcidentityvalidationresult-members"><span class="secno">9.2.3.3 </span>Dictionary <span class="formerLink"><code>RTCIdentityValidationResult</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#sec.identity-proxy-assertion-request"><span class="secno">9.3 </span>Requesting Identity
      Assertions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#sec.idp-loginneeded"><span class="secno">9.3.1 </span>User Login Procedure</a></li></ul></li><li class="tocline"><a class="tocxref" href="#sec.identity-verify-assertion"><span class="secno">9.4 </span>Verifying Identity Assertions</a></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnection-interface-extensions-3"><span class="secno">9.5 </span>RTCPeerConnection Interface Extensions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-23"><span class="secno">9.5.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-15"><span class="secno">9.5.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#attributes-24"><span class="secno">9.5.3 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#examples"><span class="secno">9.6 </span>Examples</a></li></ul></li><li class="tocline"><a class="tocxref" href="#media-stream-api-extensions-for-network-use"><span class="secno">10. </span>Media Stream API Extensions for Network Use</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#introduction-2"><span class="secno">10.1 </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#mediastream"><span class="secno">10.2 </span>MediaStream</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#id"><span class="secno">10.2.1 </span>id</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamtrack"><span class="secno">10.3 </span>MediaStreamTrack</a></li><li class="tocline"><a class="tocxref" href="#isolated-media-streams"><span class="secno">10.4 </span>Isolated Media Streams</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-mediastreamconstraints-members"><span class="secno">10.4.1 </span>Dictionary <span class="formerLink"><code>MediaStreamConstraints</code></span> Members</a></li><li class="tocline"><a class="tocxref" href="#isolated-track"><span class="secno">10.4.2 </span>Extended MediaStreamTrack Properties</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-25"><span class="secno">10.4.2.1 </span>Attributes</a></li></ul></li><li class="tocline"><a class="tocxref" href="#isolated-pc"><span class="secno">10.4.3 </span>Isolated Streams and RTCPeerConnection</a></li><li class="tocline"><a class="tocxref" href="#isolation-protection"><span class="secno">10.4.4 </span>Protection Afforded by Media Isolation</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#examples-and-call-flows"><span class="secno">11. </span>Examples and Call Flows</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#simple-peer-to-peer-example"><span class="secno">11.1 </span>Simple Peer-to-peer Example</a></li><li class="tocline"><a class="tocxref" href="#simple-peer-to-peer-example-with-warm-up"><span class="secno">11.2 </span>Simple Peer-to-peer Example with Warm-up</a></li><li class="tocline"><a class="tocxref" href="#simple-peer-to-peer-example-with-media-before-signaling"><span class="secno">11.3 </span>Simple Peer-to-peer Example with media before signaling</a></li><li class="tocline"><a class="tocxref" href="#simple-simulcast-example"><span class="secno">11.4 </span>Simple Simulcast Example</a></li><li class="tocline"><a class="tocxref" href="#advanced-peer-to-peer-example"><span class="secno">11.5 </span>Advanced Peer-to-peer Example</a></li><li class="tocline"><a class="tocxref" href="#peer-to-peer-data-example"><span class="secno">11.6 </span>Peer-to-peer Data Example</a></li><li class="tocline"><a class="tocxref" href="#call-flow-browser-to-browser"><span class="secno">11.7 </span>Call Flow Browser to Browser</a></li><li class="tocline"><a class="tocxref" href="#dtmf-example"><span class="secno">11.8 </span>DTMF Example</a></li></ul></li><li class="tocline"><a class="tocxref" href="#event-summary"><span class="secno">12. </span>Event summary</a></li><li class="tocline"><a class="tocxref" href="#privacy-and-security-considerations"><span class="secno">13. </span>Privacy and Security Considerations</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#impact-on-same-origin-policy"><span class="secno">13.1 </span>Impact on same origin policy</a></li><li class="tocline"><a class="tocxref" href="#revealing-ip-addresses"><span class="secno">13.2 </span>Revealing IP addresses</a></li><li class="tocline"><a class="tocxref" href="#impact-on-local-network"><span class="secno">13.3 </span>Impact on local network</a></li><li class="tocline"><a class="tocxref" href="#confidentiality-of-communications"><span class="secno">13.4 </span>Confidentiality of Communications</a></li><li class="tocline"><a class="tocxref" href="#persistent-information-exposed-by-webrtc"><span class="secno">13.5 </span>Persistent information exposed by WebRTC</a></li></ul></li><li class="tocline"><a class="tocxref" href="#change-log"><span class="secno">14. </span>Change Log</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><span class="secno">A. </span>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><span class="secno">B. </span>References</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><span class="secno">B.1 </span>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><span class="secno">B.2 </span>Informative references</a></li></ul></li></ul></nav>

  

  <section property="bibo:hasPart" resource="#intro" typeof="bibo:Chapter" class="informative" id="intro">
    <!--OddPage--><h2 resource="#h-intro" id="h-intro"><span property="xhv:role" resource="xhv:heading"><span class="secno">1. </span>Introduction</span></h2><p><em>This section is non-normative.</em></p>

    <p>There are a number of facets to video-conferencing in HTML covered by
    this specification:</p>

    <ul>
      <li>Connecting to remote peers using NAT-traversal technologies such as
      ICE, STUN, and TURN.</li>

      <li>Sending the locally-produced tracks to remote peers and receiving
      tracks from remote peers.</li>

      <li>Sending arbitrary data directly to remote peers.</li>
    </ul>

    <p>This document defines the APIs used for these features. This
    specification is being developed in conjunction with a protocol
    specification developed by the <a href="https://datatracker.ietf.org/wg/rtcweb/">IETF RTCWEB group</a> and an API
    specification to get access to local media devices
    [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] developed by the <a href="https://www.w3.org/wiki/Media_Capture">Media Capture Task Force</a>. An
    overview of the system can be found in [<cite><a href="#bib-RTCWEB-OVERVIEW" class="bibref">RTCWEB-OVERVIEW</a></cite>] and
    [<cite><a href="#bib-RTCWEB-SECURITY" class="bibref">RTCWEB-SECURITY</a></cite>].</p>
  </section>

  <section property="bibo:hasPart" resource="#conformance" typeof="bibo:Chapter" id="conformance"><!--OddPage--><h2 resource="#h-conformance" id="h-conformance"><span property="xhv:role" resource="xhv:heading"><span class="secno">2. </span>Conformance</span></h2>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p id="respecRFC2119">The key words <em class="rfc2119" title="MAY">MAY</em>, <em class="rfc2119" title="MUST">MUST</em>, <em class="rfc2119" title="MUST NOT">MUST NOT</em>, <em class="rfc2119" title="SHALL">SHALL</em>, and <em class="rfc2119" title="SHOULD">SHOULD</em> are 
  to be interpreted as described in [<cite><a href="#bib-RFC2119" class="bibref">RFC2119</a></cite>].
</p>

    <p>This specification defines conformance criteria that apply to a single
    product: the <dfn id="dfn-user-agent" data-dfn-type="dfn">user agent</dfn> that implements the interfaces that it
    contains with the exception of the <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code>
    interface which is used by the
    user agent but not implemented by the user agent.</p>

    <p>It also defines conformance criteria for identity providers which provide
    implementations of the <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code>
    interface.</p>

    <p>Conformance requirements phrased as algorithms or specific steps may be
    implemented in any manner, so long as the end result is equivalent. (In
    particular, the algorithms defined in this specification are intended to be
    easy to follow, and not intended to be performant.)</p>

    <p>Implementations that use ECMAScript to implement the APIs defined in
    this specification <em title="MUST" class="rfc2119">MUST</em> implement them in a manner consistent with the
    ECMAScript Bindings defined in the Web IDL specification [<cite><a href="#bib-WEBIDL-1" class="bibref">WEBIDL-1</a></cite>], as
    this specification uses that specification and terminology.</p>
  </section>

  <section property="bibo:hasPart" resource="#terminology" typeof="bibo:Chapter" id="terminology">
    <!--OddPage--><h2 resource="#h-terminology" id="h-terminology"><span property="xhv:role" resource="xhv:heading"><span class="secno">3. </span>Terminology</span></h2>

    <p>The <code><a href="http://dev.w3.org/html5/spec/webappapis.html#eventhandler">EventHandler</a></code>
    interface, representing a callback used for event handlers, and the
    <a href="http://dev.w3.org/html5/spec/webappapis.html#errorevent"><code><dfn id="dfn-errorevent" data-dfn-type="dfn">ErrorEvent</dfn></code></a>
    interface are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

    <p>The concepts <dfn id="dfn-queue-a-task" data-dfn-type="dfn"><a href="http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue a
    task</a></dfn>, <dfn id="dfn-fire-a-simple-event" data-dfn-type="dfn"><a href="http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">fire a
    simple event</a></dfn> and <dfn id="dfn-networking-task-source" data-dfn-type="dfn"><a href="http://dev.w3.org/html5/spec/webappapis.html#networking-task-source">networking task source</a></dfn> are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

    <p>The terms <dfn id="dfn-event" data-dfn-type="dfn">event</dfn>, <dfn id="dfn-event-handlers" data-dfn-type="dfn"><a href="http://dev.w3.org/html5/spec/webappapis.html#event-handlers">event
    handlers</a></dfn> and <dfn id="dfn-event-handler-event-types" data-dfn-type="dfn"><a href="http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">event
    handler event types</a></dfn> are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

    <p>The terms <dfn id="dfn-mediastream" data-dfn-type="dfn">MediaStream</dfn>, <dfn id="dfn-mediastreamtrack" data-dfn-type="dfn">MediaStreamTrack</dfn>, and
    <dfn id="dfn-mediastreamconstraints" data-dfn-type="dfn">MediaStreamConstraints</dfn> are defined in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>].</p>

    <p>The term <dfn id="dfn-media-description" data-dfn-type="dfn">media description</dfn> is defined in [<cite><a href="#bib-RFC4566" class="bibref">RFC4566</a></cite>].</p>
  </section>

  <section property="bibo:hasPart" resource="#peer-to-peer-connections" typeof="bibo:Chapter" id="peer-to-peer-connections">
    <!--OddPage--><h2 resource="#h-peer-to-peer-connections" id="h-peer-to-peer-connections"><span property="xhv:role" resource="xhv:heading"><span class="secno">4. </span>Peer-to-peer connections</span></h2>

    <section property="bibo:hasPart" resource="#introduction" typeof="bibo:Chapter" id="introduction">
      <h3 resource="#h-introduction" id="h-introduction"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.1 </span>Introduction</span></h3>

      <p>An <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> instance allows to establish
      peer to peer communications. Communications are coordinated
      via a signaling channel which is provided by unspecified means, but
      generally by a script in the page via the server, e.g. using
      <code>XMLHttpRequest</code> [<cite><a href="#bib-XMLHttpRequest" class="bibref">XMLHttpRequest</a></cite>] or Web Sockets
      [<cite><a href="#bib-WEBSOCKETS-API" class="bibref">WEBSOCKETS-API</a></cite>].</p>
    </section>

    <section property="bibo:hasPart" resource="#configuration" typeof="bibo:Chapter" id="configuration">
      <h3 resource="#h-configuration" id="h-configuration"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2 </span>Configuration</span></h3>

      <section property="bibo:hasPart" resource="#rtcconfiguration-dictionary" typeof="bibo:Chapter" id="rtcconfiguration-dictionary">
        <h4 resource="#h-rtcconfiguration-dictionary" id="h-rtcconfiguration-dictionary"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.1 </span>RTCConfiguration Dictionary</span></h4>

        <p>The <code>RTCConfiguration</code> defines a set of parameters to
        configure how the peer to peer communication established via
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> is established or
        re-established.</p>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCConfiguration">dictionary <span class="idlDictionaryID">RTCConfiguration</span> {
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a>&gt;</span>   <span class="idlMemberName"><a href="#widl-RTCConfiguration-iceServers">iceServers</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceTransportPolicy"><code>RTCIceTransportPolicy</code></a></span>    <span class="idlMemberName"><a href="#widl-RTCConfiguration-iceTransportPolicy">iceTransportPolicy</a></span> = <span class="idlMemberValue">"all"</span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCBundlePolicy"><code>RTCBundlePolicy</code></a></span>          <span class="idlMemberName"><a href="#widl-RTCConfiguration-bundlePolicy">bundlePolicy</a></span> = <span class="idlMemberValue">"balanced"</span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtcpMuxPolicy"><code>RTCRtcpMuxPolicy</code></a></span>         <span class="idlMemberName"><a href="#widl-RTCConfiguration-rtcpMuxPolicy">rtcpMuxPolicy</a></span> = <span class="idlMemberValue">"require"</span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>                <span class="idlMemberName"><a href="#widl-RTCConfiguration-peerIdentity">peerIdentity</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a>&gt;</span> <span class="idlMemberName"><a href="#widl-RTCConfiguration-certificates">certificates</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span>           <span class="idlMemberName"><a href="#widl-RTCConfiguration-iceCandidatePoolSize">iceCandidatePoolSize</a></span> = <span class="idlMemberValue">0</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcconfiguration-members" typeof="bibo:Chapter" id="dictionary-rtcconfiguration-members"><h5 resource="#h-dictionary-rtcconfiguration-members" id="h-dictionary-rtcconfiguration-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.1.1 </span>Dictionary <a href="#idl-def-RTCConfiguration" class="idlType"><code>RTCConfiguration</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCConfiguration-bundlePolicy"><code>bundlePolicy</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCBundlePolicy"><code>RTCBundlePolicy</code></a></span>, defaulting to <code>"balanced"</code></dt><dd>
            <p>Indicates which <a href="#target-bundle-policy">media-bundling policy</a> to use when gathering ICE candidates. </p>
          </dd><dt id="widl-RTCConfiguration-certificates"><code>certificates</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a>&gt;</span></dt><dd>
            <p>A set of certificates that
            the <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a> uses to authenticate.</p>

            <p>Valid values for this parameter are created through calls to
            the <a href="#widl-RTCPeerConnection-generateCertificate-Promise-RTCCertificate--AlgorithmIdentifier-keygenAlgorithm"><code>generateCertificate</code></a>
            function.</p>

            <p>Although any given DTLS connection will use only one certificate,
            this attribute allows the caller to provide multiple certificates
            that support different algorithms.  The final certificate will be
            selected based on the DTLS handshake, which establishes which
            certificates are allowed.  The <code>RTCPeerConnection</code>
            implementation selects which of the certificates is used for a given
            connection; how certificates are selected is outside the scope of
            this specification.</p>

            <p>If this value is absent, then a set of certificates are generated
            for each <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a> instance.</p>

            <p>This option allows applications to establish key continuity.
            An <code>RTCCertificate</code> can be persisted in [<cite><a href="#bib-INDEXEDDB" class="bibref">INDEXEDDB</a></cite>] and
            reused.  Persistence and reuse also avoids the cost of key
            generation.</p>

            <p>The value for this configuration option cannot change after its
            value is initially selected.  Attempts to change this value will be
            rejected.</p>
          </dd><dt id="widl-RTCConfiguration-iceCandidatePoolSize"><code>iceCandidatePoolSize</code> of type <span class="idlMemberType">unsigned short</span>, defaulting to <code>0</code></dt><dd>
            <p>Size of the prefetched ICE pool as defined in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-3.4.4">section 3.4.4.</a> and <a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.1">section 4.1.1.</a>)</span></p>
          </dd><dt id="widl-RTCConfiguration-iceServers"><code>iceServers</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a>&gt;</span></dt><dd>
            <p>An array of objects describing servers available to be used by ICE,
            such as STUN and TURN server.</p>
          </dd><dt id="widl-RTCConfiguration-iceTransportPolicy"><code>iceTransportPolicy</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceTransportPolicy"><code>RTCIceTransportPolicy</code></a></span>, defaulting to <code>"all"</code></dt><dd>
            <p>Indicates which candidates the <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> is allowed to use.</p>
          </dd><dt id="widl-RTCConfiguration-peerIdentity"><code>peerIdentity</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>Sets the <a href="#target-peer-identity">target peer
            identity</a> for the <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a>. The
            <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a> will not establish a connection to a remote
            peer unless it can be successfully authenticated with the provided
            name.</p>
          </dd><dt id="widl-RTCConfiguration-rtcpMuxPolicy"><code>rtcpMuxPolicy</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtcpMuxPolicy"><code>RTCRtcpMuxPolicy</code></a></span>, defaulting to <code>"require"</code></dt><dd>
            <p>Indicates which <a href="#target-rtcp-mux-policy">rtcp-mux policy</a> to use when gathering ICE candidates. </p>
          </dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#rtcicecredentialtype-enum" typeof="bibo:Chapter" id="rtcicecredentialtype-enum">
        <h4 resource="#h-rtcicecredentialtype-enum" id="h-rtcicecredentialtype-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.2 </span>RTCIceCredentialType Enum</span></h4>
        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceCredentialType">enum <span class="idlEnumID">RTCIceCredentialType</span> {
    "<a href="#idl-def-RTCIceCredentialType.password" class="idlEnumItem">password</a>",
    "<a href="#idl-def-RTCIceCredentialType.token" class="idlEnumItem">token</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceCredentialType.password">password</code></td><td>The credential is a long-term authentication password, as
            described in [<cite><a href="#bib-RFC5389" class="bibref">RFC5389</a></cite>], Section 10.2.
          </td></tr><tr><td><code id="idl-def-RTCIceCredentialType.token">token</code></td><td>The credential is an access token, as described in
          [<cite><a href="#bib-TRAM-TURN-THIRD-PARTY-AUTHZ" class="bibref">TRAM-TURN-THIRD-PARTY-AUTHZ</a></cite>], Section 6.2.</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtciceserver-dictionary" typeof="bibo:Chapter" id="rtciceserver-dictionary">
        <h4 resource="#h-rtciceserver-dictionary" id="h-rtciceserver-dictionary"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.3 </span>RTCIceServer Dictionary</span></h4>

        <p>The <code>RTCIceServer</code> dictionary is used to describe the
        STUN and TURN servers that can be used by the <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> to
        establish a connection with a peer.</p>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIceServer">dictionary <span class="idlDictionaryID">RTCIceServer</span> {
<span class="idlMember">    required <span class="idlMemberType">(DOMString or sequence&lt;DOMString&gt;)</span> <span class="idlMemberName"><a href="#widl-RTCIceServer-urls">urls</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>                          <span class="idlMemberName"><a href="#widl-RTCIceServer-username">username</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>                          <span class="idlMemberName"><a href="#widl-RTCIceServer-credential">credential</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCredentialType"><code>RTCIceCredentialType</code></a></span>               <span class="idlMemberName"><a href="#widl-RTCIceServer-credentialType">credentialType</a></span> = <span class="idlMemberValue">"password"</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtciceserver-members" typeof="bibo:Chapter" id="dictionary-rtciceserver-members"><h5 resource="#h-dictionary-rtciceserver-members" id="h-dictionary-rtciceserver-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.3.1 </span>Dictionary <a href="#idl-def-RTCIceServer" class="idlType"><code>RTCIceServer</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCIceServer-credential"><code>credential</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>If this <code><a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a></code> object represents a
            TURN server, then this attribute specifies the credential to use
            with that TURN server.</p>
          </dd><dt id="widl-RTCIceServer-credentialType"><code>credentialType</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCredentialType"><code>RTCIceCredentialType</code></a></span>, defaulting to <code>"password"</code></dt><dd>
            <p>If this <code><a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a></code> object represents a
            TURN server, then this attribute specifies how <var>credential</var>
            should be used when that TURN server requests authorization.</p>
          </dd><dt id="widl-RTCIceServer-urls"><code>urls</code> of type <span class="idlMemberType">(DOMString or sequence&lt;DOMString&gt;)</span>, required</dt><dd>
            <p>STUN or TURN URI(s) as defined in [<cite><a href="#bib-RFC7064" class="bibref">RFC7064</a></cite>] and [<cite><a href="#bib-RFC7065" class="bibref">RFC7065</a></cite>]
            or other URI types.</p>
          </dd><dt id="widl-RTCIceServer-username"><code>username</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>If this <code><a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a></code> object represents a
            TURN server, then this attribute specifies the username to use with
            that TURN server.</p>
          </dd></dl></section>

        <p>An example array of RTCIceServer objects is:</p>

        <div class="example"><div class="example-title marker"><span>Example 1</span></div><pre style="" class="highlight prettyprint prettyprinted"><code><span class="pun">[</span><span class="pln">
     </span><span class="pun">{</span><span class="pln"> </span><span class="str">"urls"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"stun:stun1.example.net"</span><span class="pln"> </span><span class="pun">},</span><span class="pln">
     </span><span class="pun">{</span><span class="pln"> </span><span class="str">"urls"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"turns:turn.example.org"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"turn:turn.example.net"</span><span class="pun">],</span><span class="pln">
       </span><span class="str">"username"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"user"</span><span class="pun">,</span><span class="pln">
       </span><span class="str">"credential"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"myPassword"</span><span class="pun">,</span><span class="pln">
       </span><span class="str">"credentialType"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"password"</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pun">]</span></code></pre></div>
      </section>

      <section property="bibo:hasPart" resource="#rtcicetransportpolicy-enum" typeof="bibo:Chapter" id="rtcicetransportpolicy-enum">
        <h4 resource="#h-rtcicetransportpolicy-enum" id="h-rtcicetransportpolicy-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.4 </span>RTCIceTransportPolicy Enum</span></h4>
        <p>As noted in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.1">section 4.1.1.</a>)</span>, if RTCIceTransportPolicy is specified, 
        it causes the browser to only surface the permitted
        candidates to the application, and only use those candidates for
        connectivity checks.</p>
        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceTransportPolicy">enum <span class="idlEnumID">RTCIceTransportPolicy</span> {
    "<a href="#idl-def-RTCIceTransportPolicy.public" class="idlEnumItem">public</a>",
    "<a href="#idl-def-RTCIceTransportPolicy.relay" class="idlEnumItem">relay</a>",
    "<a href="#idl-def-RTCIceTransportPolicy.all" class="idlEnumItem">all</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceTransportPolicy.public">public</code></td><td>The <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> <em title="MUST" class="rfc2119">MUST</em> filter out candidates with private
          IP addresses [<cite><a href="#bib-RFC1918" class="bibref">RFC1918</a></cite>].</td></tr><tr><td><code id="idl-def-RTCIceTransportPolicy.relay">relay</code></td><td>The <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> <em title="MUST" class="rfc2119">MUST</em> only use media relay candidates such as
          candidates passing through a TURN server. This can be used to reduce
          leakage of IP addresses in certain use cases.</td></tr><tr><td><code id="idl-def-RTCIceTransportPolicy.all">all</code></td><td>The <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> may use any type of candidates when this value is
          specified.</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtcbundlepolicy-enum" typeof="bibo:Chapter" id="rtcbundlepolicy-enum">
        <h4 resource="#h-rtcbundlepolicy-enum" id="h-rtcbundlepolicy-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.5 </span>RTCBundlePolicy Enum</span></h4>

        <p>As described in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.1">section 4.1.1.</a>)</span>, BUNDLE policy
        affects which media tracks are negotiated if
        the remote endpoint is not BUNDLE-aware, and what ICE
        candidates are gathered.  If the remote endpoint is
        BUNDLE-aware, all media tracks and data channels are BUNDLEd
        onto the same transport.</p>

        <pre id="target-bundle-policy" class="idl"><span class="idlEnum" id="idl-def-RTCBundlePolicy">enum <span class="idlEnumID">RTCBundlePolicy</span> {
    "<a href="#idl-def-RTCBundlePolicy.balanced" class="idlEnumItem">balanced</a>",
    "<a href="#idl-def-RTCBundlePolicy.max-compat" class="idlEnumItem">max-compat</a>",
    "<a href="#idl-def-RTCBundlePolicy.max-bundle" class="idlEnumItem">max-bundle</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCBundlePolicy.balanced">balanced</code></td><td>Gather ICE candidates for each media type in use (audio,
          video, and data).  If the remote endpoint is not
          BUNDLE-aware, negotiate only one audio and video track on
          separate transports.</td></tr><tr><td><code id="idl-def-RTCBundlePolicy.max-compat">max-compat</code></td><td>Gather ICE candidates for each track. If the remote
          endpoint is not BUNDLE-aware, negotiate all media tracks on
          separate transports.</td></tr><tr><td><code id="idl-def-RTCBundlePolicy.max-bundle">max-bundle</code></td><td>Gather ICE candidates for only one track.  If the remote
          endpoint is not BUNDLE-aware, negotiate only one media
          track.</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtcrtcpmuxpolicy-enum" typeof="bibo:Chapter" id="rtcrtcpmuxpolicy-enum">
        <h4 resource="#h-rtcrtcpmuxpolicy-enum" id="h-rtcrtcpmuxpolicy-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.6 </span>RTCRtcpMuxPolicy Enum</span></h4>

        <p>Defined in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.1">section 4.1.1.</a>)</span>.  The following is a
        non-normative summary for convenience.</p>

        <p>The RtcpMuxPolicy affects what ICE candidates are gathered
        to support non-multiplexed RTCP.</p>

        <pre id="target-rtcp-mux-policy" class="idl"><span class="idlEnum" id="idl-def-RTCRtcpMuxPolicy">enum <span class="idlEnumID">RTCRtcpMuxPolicy</span> {
    "<a href="#idl-def-RTCRtcpMuxPolicy.negotiate" class="idlEnumItem">negotiate</a>",
    "<a href="#idl-def-RTCRtcpMuxPolicy.require" class="idlEnumItem">require</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCRtcpMuxPolicy.negotiate">negotiate</code></td><td>Gather ICE candidates for both RTP and RTCP candidates.
          If the remote-endpoint is capable of multiplexing RTCP,
          multiplex RTCP on the RTP candidates.  If it is not, use
          both the RTP and RTCP candidates separately.</td></tr><tr><td><code id="idl-def-RTCRtcpMuxPolicy.require">require</code></td><td>Gather ICE candidates only for RTP and multiplex RTCP on
          the RTP candidates.  If the remote endpoint is not capable
          of rtcp-mux, session negotiation will fail.</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#offer-answer-options" typeof="bibo:Chapter" id="offer-answer-options">
        <h4 resource="#h-offer-answer-options" id="h-offer-answer-options"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.7 </span>Offer/Answer Options</span></h4>

        <p>These dictionaries describe the options that can be used to control
        the offer/answer creation process.</p>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCOfferAnswerOptions">dictionary <span class="idlDictionaryID">RTCOfferAnswerOptions</span> {
<span class="idlMember">             <span class="idlMemberType">boolean</span> <span class="idlMemberName"><a href="#widl-RTCOfferAnswerOptions-voiceActivityDetection">voiceActivityDetection</a></span> = <span class="idlMemberValue">true</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcofferansweroptions-members" typeof="bibo:Chapter" id="dictionary-rtcofferansweroptions-members"><h5 resource="#h-dictionary-rtcofferansweroptions-members" id="h-dictionary-rtcofferansweroptions-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.7.1 </span>Dictionary <a href="#idl-def-RTCOfferAnswerOptions" class="idlType"><code>RTCOfferAnswerOptions</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCOfferAnswerOptions-voiceActivityDetection"><code>voiceActivityDetection</code> of type <span class="idlMemberType">boolean</span>, defaulting to <code>true</code></dt><dd>
            <p>Many codecs and systems are capable of detecting "silence" and
            changing their behavior in this case by doing things such as not
            transmitting any media. In many cases, such as when dealing with
            emergency calling or sounds other than spoken voice, it is
            desirable to be able to turn off this behavior. This option allows
            the application to provide information about whether it wishes this
            type of processing enabled or disabled.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCOfferOptions">dictionary <span class="idlDictionaryID">RTCOfferOptions</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-RTCOfferAnswerOptions"><code>RTCOfferAnswerOptions</code></a></span> {
<span class="idlMember">             <span class="idlMemberType">boolean</span> <span class="idlMemberName"><a href="#widl-RTCOfferOptions-iceRestart">iceRestart</a></span> = <span class="idlMemberValue">false</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcofferoptions-members" typeof="bibo:Chapter" id="dictionary-rtcofferoptions-members"><h5 resource="#h-dictionary-rtcofferoptions-members" id="h-dictionary-rtcofferoptions-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.2.7.2 </span>Dictionary <a href="#idl-def-RTCOfferOptions" class="idlType"><code>RTCOfferOptions</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCOfferOptions-iceRestart"><code>iceRestart</code> of type <span class="idlMemberType">boolean</span>, defaulting to <code>false</code></dt><dd>
            <p>When the value of this dictionary member is true, the generated
            description will have ICE credentials that are different from the
            current credentials (as visible in the
            <code><a data-link-type="dfn" class="internalDFN" href="#dom-peerconnection-localdescription"><code>localDescription</code></a></code> attribute's SDP). Applying the
            generated description will restart ICE.</p>

            <p>When the value of this dictionary member is false, and the
            <code><a data-link-type="dfn" class="internalDFN" href="#dom-peerconnection-localdescription"><code>localDescription</code></a></code> attribute has valid ICE
            credentials, the generated description will have the same ICE
            credentials as the current value from the
            <code><a data-link-type="dfn" class="internalDFN" href="#dom-peerconnection-localdescription"><code>localDescription</code></a></code> attribute.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCAnswerOptions">dictionary <span class="idlDictionaryID">RTCAnswerOptions</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-RTCOfferAnswerOptions"><code>RTCOfferAnswerOptions</code></a></span> {
};</span></pre>

      </section>
    </section>

    <section property="bibo:hasPart" resource="#rtcpeerconnection-interface" typeof="bibo:Chapter" id="rtcpeerconnection-interface">
      <h3 resource="#h-rtcpeerconnection-interface" id="h-rtcpeerconnection-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3 </span>RTCPeerConnection Interface</span></h3>

      <p>The general operation of the RTCPeerConnection is described in
      [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>].</p>

      <section property="bibo:hasPart" resource="#operation" typeof="bibo:Chapter" id="operation">
        <h4 resource="#h-operation" id="h-operation"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.1 </span>Operation</span></h4>

        <p>Calling <code>new <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a>(<var>configuration</var>
        )</code> creates an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

        <p>The <var>configuration</var> has the information to find and access
        the servers used by ICE. There may be multiple servers of each type and
        any TURN server also acts as a STUN server.</p>

        <p>An <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object has an associated
        <dfn data-dfn-type="dfn" id="rtcpeerconnection-ice-agent">ICE agent</dfn> [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>],
        <dfn id="dfn-signaling-state" data-dfn-type="dfn">signaling state</dfn>, <dfn id="dfn-ice-gathering-state" data-dfn-type="dfn">ICE gathering state</dfn>, and <dfn id="dfn-ice-connection-state" data-dfn-type="dfn">ICE
        connection state</dfn>. These are initialized when the object is created.</p>

        <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection"><code>RTCPeerConnection()</code></dfn> constructor
        is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

        <ol>
          <li>
            <p>Let <var>connection</var> be a newly created
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>
          </li>

          <li>
            <p><a href="#set-pc-configuration">Set the configuration</a>
            specified by the constructor's first argument.</p>
          </li>

          <li>
            <p>Create an ICE Agent as defined in [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>] and let
            <var>connection</var>'s <code>RTCPeerConnection</code> ICE Agent be
            that ICE Agent. The ICE Agent will
            proceed with gathering as soon as the <a href="#ice-transports-setting">ICE transports setting</a> is not set to
            <code>none</code>. At this point the ICE Agent does not know how
            many ICE components it needs (and hence the number of candidates to
            gather), but it can make a reasonable assumption such as 2. As the
            <code>RTCPeerConnection</code> object gets more information, the
            ICE Agent can adjust the number of components.</p>
          </li>

          <li>
            <p>Set <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">
            signaling state</a> to <code>stable</code>.</p>
          </li>

          <li>
            <p>Set <var>connection</var>'s
            <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-connection-state">ICE connection state</a> to <code>new</code>.</p>
          </li>

          <li>
            <p>Set <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">
            ICE gathering state</a> to <code>new</code>.</p>
          </li>

          <li>
            <p>Set <var>connection</var>'s
            <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>,
            <code><a href="#dom-peerconnection-currentlocaldesc">currentLocalDescription</a></code>,
            <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
            and <code><a href="#dom-peerconnection-currentremotedesc">currentRemoteDescription</a></code>
            to null.
            </p>
          </li>

          <li>
            <p>Initialize an internal variable <var>operations</var> to represent a queue of
            operations with an empty array.</p>
          </li>

          <li>
            <p>If the <code>certificates</code> value in
            the <code>RTCConfiguration</code> structure is non-empty, check that
            the <code>expires</code> on each value is in the future.  If a
            certificate has expired, throw an <code>InvalidParameter</code>
            exception and abort these steps; otherwise, store the certificates.
            If no <code>certificates</code> value was specified, one or more
            new <code>RTCCertificate</code> instances are generated for use with
            this <code>RTCPeerConnection</code> instance.</p>
          </li>

          <li>
            <p>Return <var>connection</var>.</p>
          </li>
        </ol>

        <p>Once the RTCPeerConnection object has been initialized, for every
        call to <code>createOffer</code>, <code>setLocalDescription</code>,
        <code>createAnswer</code>, <code>setRemoteDescription</code>,
        and <code>addIceCandidate</code>,
        execute the following steps:</p>

        <ol>
          <li>
            <p>Let <var>p</var> be a new promise.</p>
          </li>

          <li>
            <p>Append an object representing the current call being handled
            (i.e. function name and corresponding arguments) to the
            <var>operations</var> array.</p>
          </li>

          <li>
            <p>If the length of the <var>operations</var> array is exactly 1,
            execute the object from the front of the queue.</p>
          </li>

          <li>
            <p>Upon fulfillment or rejection of the promise returned
            by the function, fulfill or reject <var>p</var> with the
            corresponding value or reason.  Upon fulfillment or
            rejection of <var>p</var>, execute the following
            steps:</p>
            <ol>
              <li><p>Remove the corresponding object from
                the <var>operations</var> array.</p></li>
              <li><p>If the array is non-empty, execute the first
                object queued.</p></li>
            </ol>
          </li>

          <li>
            <p>Return <var>p</var>.</p>
          </li>
        </ol>

        <p>The general idea is to have only one among <code>createOffer</code>,
        <code>setLocalDescription</code>, <code>createAnswer</code> and
        <code>setRemoteDescription</code>
        and <code>addIceCandidate</code> executing at any given
        time. If subsequent calls are made while the returned promise
        of a previous call is still unsettled, they are added to a
        queue and executed when all the previous calls are executed
        and their promises are settled.</p>

        <p>Additionally, during the lifetime of the RTCPeerConnection object,
        the following procedures are followed when an ICE event occurs:</p>

        <ol>
          <li>
            <p>If the <code>RTCPeerConnection</code>'s
            <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">ICE gathering state</a> is <code>new</code> and the <a href="#ice-transports-setting">ICE transports setting</a> is not set to
            <code>none</code>, the user agent <em title="MUST" class="rfc2119">MUST</em> queue a task to start
            gathering ICE addresses and <a data-link-type="dfn" class="internalDFN" href="#update-ice-gathering-state">update the ICE gathering state</a>
            to <code>gathering</code>.</p>
          </li>

          <li>
            <p>If the ICE Agent has found one or more candidate pairs for each
            <code>MediaStreamTrack</code> that forms a valid connection, <a data-link-type="dfn" class="internalDFN" href="#update-ice-connection-state">update the ICE connection
            state</a> to <code>connected</code>.</p>
          </li>

          <li>
            <p>When the ICE Agent finishes checking all candidate pairs, if at
            least one connection has been found for each <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a>, <a data-link-type="dfn" class="internalDFN" href="#update-ice-connection-state">update the
            ICE connection state</a> to <code>completed</code>, otherwise to
            <code>failed</code>.</p>
          </li>
        </ol>

        <p>When a new ICE candidate is available or when the ICE gathering process is done
        , the user agent <em title="MUST" class="rfc2119">MUST</em> queue a task to run the
        following steps:</p>

        <ol>
          <li>
            <p>Let <var>connection</var> be the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object associated with this
            ICE Agent.</p>
          </li>

          <li>
            <p>If <var>connection</var>'s
            <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, abort these steps.</p>
          </li>

          <li>
            <p>If the intent of the ICE Agent is to notify the script that:</p>

            <ul>
              <li>
                <p>A new candidate is available.</p>

                <p>Add the candidate to <var>connection</var>'s
                <code><a data-link-type="dfn" class="internalDFN" href="#dom-peerconnection-localdescription"><code>localDescription</code></a></code> and create a
                <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> instance to represent the
                candidate. Let <var>newCandidate</var> be that object.</p>
              </li>

              <li>
                <p>The gathering process is done.</p>

                <p><a data-link-type="dfn" class="internalDFN" href="#update-ice-gathering-state" data-lt="update the ICE gathering state">Update <var>connection</var>'s ICE gathering
                state</a> to <code>completed</code> and let
                <var>newCandidate</var> be null.</p>
              </li>
            </ul>
          </li>

          <li>
            <p>Fire an event named <code><a href="#event-icecandidate">icecandidate</a></code> with
            <var>newCandidate</var> at <var>connection</var>.</p>
          </li>
        </ol>

        <p>To <dfn data-dfn-type="dfn" id="update-ice-gathering-state">update the <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">ICE gathering state</a></dfn> of an
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> instance <var>connection</var> to
        <var>newState</var>, the User Agent <em title="MUST" class="rfc2119">MUST</em> queue a task that sets
        <var>connection</var>'s <a href="#dom-peerconnection-ice-gathering-state">iceGatheringState</a>
        attribute to <var>newState</var> and fires a simple event named
        <code><a href="#event-icegatheringstatechange">icegatheringstatechange</a></code> at
        <var>connection</var>.</p>

        <p>To <dfn data-dfn-type="dfn" id="update-ice-connection-state">update the <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-connection-state">ICE connection state</a></dfn> of an
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> instance <var>connection</var> to
        <var>newState</var>, the User Agent <em title="MUST" class="rfc2119">MUST</em> queue a task that sets
        <var>connection</var>'s <a href="#dom-peerconnection-ice-connection-state">iceConnectionState</a>
        attribute to <var>newState</var> and fires a simple event named
        <code><a href="#event-iceconnectionstatechange">icegatheringstatechange</a></code> at
        <var>connection</var>.</p>

        <p>To <dfn data-dfn-type="dfn" id="set-description">set an RTCSessionDescription</dfn>
        <var>description</var> on an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
        object <var>connection</var>, run the following steps:</p>

        <ol>
          <li>
            <p>If <var>connection</var>'s
            <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling
            state</a> is <code>closed</code>, the user agent <em title="MUST" class="rfc2119">MUST</em> return a
            promise rejected with an <code>InvalidStateError</code>.</p>
          </li>

          <li>
            <p>Let <var>p</var> be a new promise.</p>
          </li>

          <li>
            <p>In parallel, start the process to apply <var>description</var> as
            described in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.4">section 5.4.</a> and <a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.5">section 5.5.</a>)</span>.</p>

            <ol>
              <li>
                <p>If the process to apply <var>description</var> fails for
                any reason, then user agent <em title="MUST" class="rfc2119">MUST</em> queue a task runs the
                following steps:</p>

                <ol>
                  <li>
                    <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                    is <code>closed</code>, then abort these steps.</p>
                  </li>

                  <li>
                    <p>If the content of <var>description</var> is invalid or if
                    <var>description</var>'s <code><a href="#widl-RTCSessionDescription-type">type</a></code> is wrong for
                    the current <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> of
                    <var>connection</var>, then reject <var>p</var> with an
                    <code>InvalidSessionDescriptionError</code> and abort these
                    steps.</p>
                  </li>

                  <li>
                    <p>If <var>description</var> cannot be applied at the media
                    layer, but the User Agent recovered, possibly by rolling back
                    to the previous configuration, then reject <var>p</var> with
                    <code>IncompatibleSessionDescriptionError</code> and abort
                    these steps.</p>

                    <p>This occurs, for example, when the version of
                    <var>description</var> is older than the one currently
                    being used.</p>
                  </li>

                  <li>
                    <p>Otherwise, set <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> to
                    <code>closed</code>.</p>
                  </li>

                  <li>
                    <p>Fire a simple event named <code><a href="#event-signalingstatechange">signalingstatechange</a></code>
                    at <var>connection</var>.</p>
                  </li>

                  <li>
                    <p>Reject <var>p</var> with <code>InternalError</code>.</p>
                  </li>
                </ol>
              </li>

              <li>
                <p>If <var>description</var> is applied successfully, the user
                agent <em title="MUST" class="rfc2119">MUST</em> queue a task that runs the following steps:</p>

                <ol>
                  <li>
                    <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                    is <code>closed</code>, then abort these steps.</p>
                  </li>

                  <li>
                    <p>If <var>description</var> is set as a local description, and
                    its content matches the state of all tracks and data channels,
                    <a href="#clearing-negotiation-needed">as defined below</a>,
                    clear the negotiation-needed flag.
                    </p>

                    <div class="issue"><div id="h-issue1" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><p class="">NOTE: The principles of pending and current SDP
                    were agreed by the WG but the details in the next steps have not
                    yet been fully reviewed. TODO - review this.</p></div>
                  </li>

                  <li>
                    <p>If <var>description</var> is set as a local description,
                    then run one of the following steps:</p>

                    <ul>
                      <!-- A) transition stable to haveLocalOffer -->
                      <li>
                        <p>If <var>description</var> is of type "offer",
                        set <var>connection</var>'s <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
                        attribute to <var>description</var> and <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>have-local-offer</code>.</p>
                      </li>

                      <!-- C) transition haveRemoteOffer or haveLocalProvAnswer to
                      stable -->
                      <li>
                        <p>If <var>description</var> is
                        of type "answer", then this completes an offer answer
                        negotiation. Set <var>connection</var>'s <code><a href="#dom-peerconnection-currentlocaldesc">currentLocalDescription</a></code>
                        to <var>description</var> and <code><a href="#dom-peerconnection-currentremotedesc">currentRemoteDescription</a></code>
                        to the value of <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>.
                        Set both <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
                        and <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
                        to null. Finally set <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>stable</code></p>
                      </li>

                      <!-- B) transition rollback to haveLocalOffer to stable -->
                      <li>
                        <p>If <var>description</var> is
                        of type "rollback", then this is a rollback. Set
                        <var>connection</var>'s <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
                        to null and <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>stable</code>.</p>
                      </li>

                      <!-- G) transition haveRemoteOffer to haveLocalProvAnswer -->
                      <li>
                        <p>If <var>description</var> is
                        of type "pranswer", then set <var>connection</var>'s
                        <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
                        to <var>description</var> and <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>have-local-pranswer</code>.</p>
                      </li>
                    </ul>
                  </li>

                  <li>
                    <p>Otherwise, if <var>description</var> is set as a remote
                    description, then run one of the following steps:</p>

                    <ul>
                      <!-- D) transition stable to haveRemoteOffer -->
                      <li>
                        <p>If <var>description</var> is
                        of type "offer",
                        set <var>connection</var>'s <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
                        attribute to <var>description</var> and <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>have-remote-offer</code>.</p>
                      </li>

                      <!-- F) transition haveRemoteOffer or haveLocalProvAnswer to
                      stable -->
                      <li>
                        <p>If <var>description</var> is
                        of type "answer", then this completes an offer answer
                        negotiation. Set <var>connection</var>'s <code><a href="#dom-peerconnection-currentremotedesc">currentRemoteDescription</a></code>
                        to <var>description</var> and <code><a href="#dom-peerconnection-currentlocaldesc">currentLocalDescription</a></code>
                        to the value of <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>.
                        Set both <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
                        and <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
                        to null. Finally set <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>stable</code></p>
                      </li>

                      <!-- E) transition rollback to haveRemoteOffer to stable -->
                      <li>
                        <p>If <var>description</var> is
                        of type "rollback", then this is a rollback. Set
                        <var>connection</var>'s <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
                        to null and <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>stable</code>.</p>
                      </li>

                      <!-- H) transition haveRemoteOffer to haveLocalProvAnswer -->
                      <li>
                        <p>If <var>description</var> is
                        of type "pranswer", then set <var>connection</var>'s
                        <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
                        to <var>description</var> and <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                        to <code>have-remote-pranswer</code>.</p>
                      </li>
                    </ul>
                  </li>

                  <li>
                    <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                    changed above, fire a simple event named <code><a href="#event-signalingstatechange">signalingstatechange</a></code>
                    at <var>connection</var>.</p>
                  </li>

                  <li>
                    <p>If <var>description</var> is set as a local description,
                    <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">ICE gathering
                    state</a> is <code>new</code>, and <var>description</var>
                    contains media, then <a data-link-type="dfn" class="internalDFN" href="#update-ice-gathering-state" data-lt="update the ICE gathering state">update <var>connection</var>'s
                    ICE gathering state</a> to <code>gathering</code>.</p>
                  </li>

                  <li>
                    <p>If the process to apply <var>description</var> resulted
                    in an ICE restart <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.7">section 5.7.</a> and <a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.8">section 5.8.</a>)</span>, then run the following
                    steps:</p>

                    <ol>
                      <li>
                        <p>If <var>connection</var> is not already gathering,
                        <a data-link-type="dfn" class="internalDFN" href="#update-ice-gathering-state" data-lt="update the ICE gathering state">update
                        <var>connection</var>'s ICE gathering state</a> to
                        <code>gathering</code>.</p>
                      </li>

                      <li>
                        <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-connection-state">
                        ICE connection state</a>
                        is <code>completed</code>, <a data-link-type="dfn" class="internalDFN" href="#update-ice-connection-state" data-lt="update the ICE connection state">update
                        <var>connection</var>'s ICE connection state</a> to
                        <code>connected</code>.</p>
                      </li>
                    </ol>
                  </li>

                  <li>
                    <p>If <var>description</var> is set as a remote description
                    with new media descriptions [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>], the User Agent
                    <em title="MUST" class="rfc2119">MUST</em> <a href="#dispatch-receiver">dispatch a receiver</a> for
                    all new media descriptions.</p>
                  </li>

                  <li>
                    <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is
                    now <code>stable</code>, and the negotiation-needed flag is
                    set, the User Agent <em title="MUST" class="rfc2119">MUST</em> queue a task to fire a simple event
                    named <code><a href="#event-negotiation">negotiationneeded</a></code> at
                    <var>connection</var> and clear the negotiation-needed flag.</p>
                  </li>

                  <li>
                    <p>Resolve <var>p</var> with <var>undefined</var>.</p>
                  </li>
                </ol>
              </li>
            </ol>
          </li>

          <li>
            <p>Return <var>p</var>.</p>
          </li>
        </ol>

        <p>The task source for the tasks
        listed in this section is the <a data-link-type="dfn" class="internalDFN" href="#dfn-networking-task-source">networking task source</a>.</p>

      </section>

      <section property="bibo:hasPart" resource="#interface-definition" typeof="bibo:Chapter" id="interface-definition">
        <h4 resource="#h-interface-definition" id="h-interface-definition"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.2 </span>Interface Definition</span></h4>

        <p>The <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface presented in this
        section is extended by several partial
        interfaces throughout this specification. Notably, the <a href="#rtcpeerconnection-interface-extensions">RTP Media section</a>, that
        adds the APIs to send and receive <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code>
        objects.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection">[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCPeerConnection--RTCConfiguration-configuration">Constructor</a></span> (<span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></span> <span class="idlParamName">configuration</span></span>)</span>]
interface <span class="idlInterfaceID">RTCPeerConnection</span> : <span class="idlSuperclass">EventTarget </span> {
<span class="idlMethod">    <span class="idlMethType">Promise&lt;<a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-createOffer-Promise-RTCSessionDescription--RTCOfferOptions-options">createOffer</a></span> (<span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCOfferOptions"><code>RTCOfferOptions</code></a></span> <span class="idlParamName">options</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;<a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-createAnswer-Promise-RTCSessionDescription--RTCAnswerOptions-options">createAnswer</a></span> (<span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCAnswerOptions"><code>RTCAnswerOptions</code></a></span> <span class="idlParamName">options</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;void&gt;</span>                  <span class="idlMethName"><a href="#widl-RTCPeerConnection-setLocalDescription-Promise-void--RTCSessionDescriptionInit-description">setLocalDescription</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></span> <span class="idlParamName">description</span></span>);</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>?</span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-localDescription">localDescription</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>?</span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-currentLocalDescription">currentLocalDescription</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>?</span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-pendingLocalDescription">pendingLocalDescription</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;void&gt;</span>                  <span class="idlMethName"><a href="#widl-RTCPeerConnection-setRemoteDescription-Promise-void--RTCSessionDescriptionInit-description">setRemoteDescription</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></span> <span class="idlParamName">description</span></span>);</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>?</span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-remoteDescription">remoteDescription</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>?</span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-currentRemoteDescription">currentRemoteDescription</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>?</span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-pendingRemoteDescription">pendingRemoteDescription</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;void&gt;</span>                  <span class="idlMethName"><a href="#widl-RTCPeerConnection-addIceCandidate-Promise-void--RTCIceCandidateInit-RTCIceCandidate-candidate">addIceCandidate</a></span> (<span class="idlParam"><span class="idlParamType">(<a class="idlType" href="#idl-def-RTCIceCandidateInit"><code>RTCIceCandidateInit</code></a> or <a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>)</span> <span class="idlParamName">candidate</span></span>);</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSignalingState"><code>RTCSignalingState</code></a></span>         <span class="idlAttrName"><a href="#widl-RTCPeerConnection-signalingState">signalingState</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceGatheringState"><code>RTCIceGatheringState</code></a></span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnection-iceGatheringState">iceGatheringState</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceConnectionState"><code>RTCIceConnectionState</code></a></span>     <span class="idlAttrName"><a href="#widl-RTCPeerConnection-iceConnectionState">iceConnectionState</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCPeerConnectionState"><code>RTCPeerConnectionState</code></a></span>    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-connectionState">connectionState</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">boolean?</span>                  <span class="idlAttrName"><a href="#widl-RTCPeerConnection-canTrickleIceCandidates">canTrickleIceCandidates</a></span>;</span>
<span class="idlAttribute">    static readonly attribute <span class="idlAttrType">FrozenArray&lt;<a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a>&gt;</span> <span class="idlAttrName"><a href="#widl-RTCPeerConnection-defaultIceServers">defaultIceServers</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></span>               <span class="idlMethName"><a href="#widl-RTCPeerConnection-getConfiguration-RTCConfiguration">getConfiguration</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                           <span class="idlMethName"><a href="#widl-RTCPeerConnection-setConfiguration-void-RTCConfiguration-configuration">setConfiguration</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></span> <span class="idlParamName">configuration</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                           <span class="idlMethName"><a href="#widl-RTCPeerConnection-close-void">close</a></span> ();</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onnegotiationneeded">onnegotiationneeded</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onicecandidate">onicecandidate</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onicecandidateerror">onicecandidateerror</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onsignalingstatechange">onsignalingstatechange</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-oniceconnectionstatechange">oniceconnectionstatechange</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onicegatheringstatechange">onicegatheringstatechange</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>              <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onconnectionstatechange">onconnectionstatechange</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors" typeof="bibo:Chapter" id="constructors"><h5 resource="#h-constructors" id="h-constructors"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.2.1 </span>Constructors</span></h5><dl class="constructors"><dt id="widl-ctor-RTCPeerConnection--RTCConfiguration-configuration"><code>RTCPeerConnection</code></dt><dd>
            See the <a href="#dom-peerconnection">RTCPeerConnection constructor
            algorithm</a>.
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">configuration</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes" typeof="bibo:Chapter" id="attributes"><h5 resource="#h-attributes" id="h-attributes"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.2.2 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCPeerConnection-canTrickleIceCandidates"><code>canTrickleIceCandidates</code> of type <span class="idlAttrType">boolean</span>, readonly       , nullable</dt><dd>
            <p>This attribute indicates whether the remote peer is able to
            accept trickled ICE candidates [<cite><a href="#bib-TRICKLE-ICE" class="bibref">TRICKLE-ICE</a></cite>].  The value is
            determined based on whether a remote description indicates support
            for trickle ICE, as defined in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.9">section 4.1.9.</a>)</span>.  Prior to
            the completion
            of <a href="#dom-peerconnection-setremotedescription"><code>setRemoteDescription</code></a>,
            this value is <code>null</code>.
          </p></dd><dt id="widl-RTCPeerConnection-connectionState"><code>connectionState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCPeerConnectionState"><code>RTCPeerConnectionState</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-connection-state"><code>connectionState</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the aggregate of the states of
            the <code>DtlsTransport</code>s
            and <code>IceTransport</code>s of
            the <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a>, as describe in the
            values of the <a class="idlType" href="#idl-def-RTCPeerConnectionState"><code>RTCPeerConnectionState</code></a> enum.

              </p>
          </dd><dt id="widl-RTCPeerConnection-currentLocalDescription"><code>currentLocalDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <code><a href="#dom-peerconnection-currentlocaldesc">currentLocalDescription</a></code>
            attribute represents the local <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code>
            that was successfully negotiated the last time the<code>RTCPeerConnection</code> transitioned into
            the stable state plus any local candidates that have been generated by the ICE
            Agent since the offer or answer was created. This attribute is updated by <code><a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a></code>.</p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-currentlocaldesc"><code>currentLocalDescription</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the last value that algorithms in this
            specification set it to, completed with any local candidates that have been
            generated by the ICE Agent since the offer or answer was created.
            Prior to being set, it returns null.
            </p>
          </dd><dt id="widl-RTCPeerConnection-currentRemoteDescription"><code>currentRemoteDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <code><a href="#dom-peerconnection-currentremotedesc">currentRemoteDescription</a></code>
            attribute represents the last remote
            <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> that was successfully
            negotiated the last time the<code>RTCPeerConnection</code> transitioned into the
            stable state plus any remote candidates that have been supplied via
            <code><a href="#dom-peerconnection-addicecandidate">addIceCandidate()</a></code>
            since the offer or answer was created. This attribute is updated by
            <code><a href="#dom-peerconnection-setremotedescription">setRemoteDescription()</a></code>.
            </p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-currentremotedesc"><code>currentRemoteDescription</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the value that algorithms in this
            specification set it to, completed with any remote candidates that have been
            supplied via <code><a href="#dom-peerconnection-addicecandidate">addIceCandidate()</a></code>
            since the offer or answer was created. Prior to being set, it returns null.
</p>
          </dd><dt id="widl-RTCPeerConnection-defaultIceServers"><code>defaultIceServers</code> of type <span class="idlAttrType">FrozenArray&lt;<a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a>&gt;</span>, static readonly</dt><dd>
            <p>The <code>defaultIceServers</code> attribute provides a list of
            ICE servers that are configured into the browser.  A browser might
            be configured to use local or private STUN or TURN servers.  This
            method allows an application to learn about these servers and
            optionally use them.
            </p>
          </dd><dt id="widl-RTCPeerConnection-iceConnectionState"><code>iceConnectionState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceConnectionState"><code>RTCIceConnectionState</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-ice-connection-state"><code>iceConnectionState</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-connection-state">ICE connection state</a> of the <code>RTCPeerConnection</code> instance.</p>
          </dd><dt id="widl-RTCPeerConnection-iceGatheringState"><code>iceGatheringState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceGatheringState"><code>RTCIceGatheringState</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-ice-gathering-state"><code>iceGatheringState</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">ICE gathering state</a> of the <code>RTCPeerConnection</code> instance.</p>
          </dd><dt id="widl-RTCPeerConnection-localDescription"><code>localDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-localdescription"><code>localDescription</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
            if it is not null and otherwise it <em title="MUST" class="rfc2119">MUST</em> return <code><a href="#dom-peerconnection-currentlocaldesc">currentLocalDescription</a></code>. </p>
          </dd><dt id="widl-RTCPeerConnection-onconnectionstatechange"><code>onconnectionstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            The event type of this event handler is <code><a href="#event-connectionstatechange">connectionstatechange</a></code>.
          </dd><dt id="widl-RTCPeerConnection-onicecandidate"><code>onicecandidate</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-icecandidate">icecandidate</a></code>.</dd><dt id="widl-RTCPeerConnection-onicecandidateerror"><code>onicecandidateerror</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-icecandidateerror">icecandidateerror</a></code>.</dd><dt id="widl-RTCPeerConnection-oniceconnectionstatechange"><code>oniceconnectionstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-iceconnectionstatechange">iceconnectionstatechange</a></code>
          </dd><dt id="widl-RTCPeerConnection-onicegatheringstatechange"><code>onicegatheringstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-icegatheringstatechange">icegatheringstatechange</a></code>.
          </dd><dt id="widl-RTCPeerConnection-onnegotiationneeded"><code>onnegotiationneeded</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-negotiation">negotiationneeded</a></code>.</dd><dt id="widl-RTCPeerConnection-onsignalingstatechange"><code>onsignalingstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-signalingstatechange">signalingstatechange</a></code>.</dd><dt id="widl-RTCPeerConnection-pendingLocalDescription"><code>pendingLocalDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code>
            attribute represents a local
            <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> that is in the process of
            being negotiated plus any local candidates that have been generated
            by the ICE Agent since the offer or answer was created. If the
           <code>RTCPeerConnection</code> is in the stable state, the value is null.
            This attribute is updated by <code><a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a></code>.
            </p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-pendinglocaldesc"><code>pendingLocalDescription</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the last value that algorithms in this
            specification set it to, completed with any local candidates that have been
            generated by the ICE Agent since the offer or answer was created.
            Prior to being set, it returns null.
            </p>
          </dd><dt id="widl-RTCPeerConnection-pendingRemoteDescription"><code>pendingRemoteDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
            attribute represents a remote
            <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> that is in the process of
            being negotiated, completed with any remote candidates that have been supplied
            via <code><a href="#dom-peerconnection-addicecandidate">addIceCandidate()</a></code>
            since the offer or answer was created. If the
           <code>RTCPeerConnection</code> is in the stable state, the value is null.
            This attribute is updated by <code><a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a></code>.
            </p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-pendingremotedesc"><code>pendingRemoteDescription</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the value that algorithms in this
            specification set it to, completed with any remote candidates that have been
            supplied via <code><a href="#dom-peerconnection-addicecandidate">addIceCandidate()</a></code>
            since the offer or answer was created. Prior to being set, it returns null.
</p>
          </dd><dt id="widl-RTCPeerConnection-remoteDescription"><code>remoteDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-remotedescription"><code>remoteDescription</code></dfn>
            attribute  <em title="MUST" class="rfc2119">MUST</em> return <code><a href="#dom-peerconnection-pendingremotedesc">pendingRemoteDescription</a></code>
            if it is not null and otherwise it <em title="MUST" class="rfc2119">MUST</em> return <code><a href="#dom-peerconnection-currentremotedesc">currentRemoteDescription</a></code>. </p>
          </dd><dt id="widl-RTCPeerConnection-signalingState"><code>signalingState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSignalingState"><code>RTCSignalingState</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-signaling-state"><code>signalingState</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the <code><a href="#dom-peerconnection-signaling-state">RTCPeerConnection</a></code>
            object's
            <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>.</p>
          </dd></dl></section><section property="bibo:hasPart" resource="#methods" typeof="bibo:Chapter" id="methods"><h5 resource="#h-methods" id="h-methods"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.2.3 </span>Methods</span></h5><dl class="methods"><dt id="widl-RTCPeerConnection-addIceCandidate-Promise-void--RTCIceCandidateInit-RTCIceCandidate-candidate"><code>addIceCandidate</code></dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-addicecandidate"><code>addIceCandidate()</code></dfn>
            method provides a remote candidate to the ICE Agent. In addition to
            being added to the remote description, connectivity checks will be
            sent to the new candidates as long as the <a href="#ice-transports-setting">ICE Transports setting</a> is not set to
            <code>none</code>. This call will result in a change to the
            <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-connection-state">ICE connection state</a>, and may result in a change to
            media state if it results in different connectivity being
            established. The only members of <code>candidate</code>
            used by this method are <var>candidate</var>, <var>sdpMid</var> and
            <var>sdpMLineIndex</var>; the rest are ignored.</p>

            <ol>
              <li>
                <p>If this <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
                <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, return a promise
                rejected with an <code>InvalidStateError</code>.</p>
              </li>

              <li>
                <p>If <var>candidate</var> is missing values for both <var>sdpMid</var> and
                <var>sdpMLineIndex</var>, return a promise rejected with a
                <code>TypeError</code>.</p>
              </li>

              <li>
                <p>If the candidate could not be successfully applied, return a promise
                rejected with a <code>DOMError</code> object whose <code>name</code>
                attribute has the value TBD.</p>
                <div class="issue"><div id="h-issue2" role="heading" aria-level="6" class="issue-title marker"><span>Issue</span></div><p class="">TODO: define names for DOMError
                (InvalidCandidate and InvalidMidIndex (see also <a href="https://github.com/w3c/webrtc-pc/issues/319">Issue 319</a>))</p></div>
              </li>

              <li>
                <p>Let <var>p</var> be a new promise.</p>
              </li>

              <li>
                <p>If the candidate is successfully applied, resolve
                <var>p</var> with <code>undefined</code>.</p>
              </li>

              <li>
                <p>Return <var>p</var>.</p>
              </li>
            </ol>

            <div class="issue"><div id="h-issue3" role="heading" aria-level="6" class="issue-title marker"><span>Issue</span></div><div class="">
              What errors do we need here? Should we reuse the
              *SessionDescriptionError names or invent new ones for candidates?
              Should this method be queued? (see also <a href="https://github.com/w3c/webrtc-pc/issues/319">Issue 319</a>)
            </div></div>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">candidate</td><td class="prmType"><code>(<a class="idlType" href="#idl-def-RTCIceCandidateInit"><code>RTCIceCandidateInit</code></a> or <a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>)</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;void&gt;</code></div></dd><dt id="widl-RTCPeerConnection-close-void"><code>close</code></dt><dd>
            <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection-close"><code title="">RTCPeerConnection close()</code></dfn> method is invoked, the
            user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>If the <code>RTCPeerConnection</code> object's
              <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is
              <code>closed</code>, abort these steps.</li>

              <li>
                <p>Destroy the <a href="#rtcpeerconnection-ice-agent"><code>RTCPeerConnection</code>
                ICE Agent</a>, abruptly ending any active ICE processing and
                any active streaming, and releasing any relevant resources
                (e.g. TURN permissions).</p>
              </li>

              <li>All <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code>s in the <code>
              <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's  <a href="#senders-set">set of senders</a> are now considered <a href="#sender-stopped">stopped</a>.</li>

              <li>
                <p>Set the object's
                <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> to <code>closed</code>.</p>
              </li>
            </ol>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-createAnswer-Promise-RTCSessionDescription--RTCAnswerOptions-options"><code>createAnswer</code></dt><dd>
            <p>The <code>createAnswer</code> method generates an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] answer with the
            supported configuration for the session that is compatible with the
            parameters in the remote configuration. Like <code>createOffer</code>, the
            returned blob contains descriptions of the local <code>MediaStreamTrack</code>s
            attached to this <code>RTCPeerConnection</code>, the codec/RTP/RTCP options
            negotiated for this session, and any candidates that have been
            gathered by the ICE Agent. The <code>options</code> parameter may be supplied to
            provide additional control over the generated answer.</p>

            <p>As an answer, the generated SDP will contain a specific
            configuration that, along with the corresponding offer, specifies
            how the media plane should be established. The generation of the
            SDP <em title="MUST" class="rfc2119">MUST</em> follow the appropriate process for generating an
            answer.</p>

            <p>Session descriptions generated by createAnswer <em title="MUST" class="rfc2119">MUST</em> be
            immediately usable by <code>setLocalDescription</code> without causing an
            error as long as <code>setLocalDescription</code> is called reasonably soon.
            Like <code>createOffer</code>, the returned description <em title="SHOULD" class="rfc2119">SHOULD</em> reflect
            the current state of the system. The session descriptions <em title="MUST" class="rfc2119">MUST</em>
            remain usable by <code>setLocalDescription</code> without causing an error until
            at least the end of the fulfillment callback of the returned promise. Calling this
            method is needed to get the ICE user name fragment and
            password.</p>

            <p>An answer can be marked as provisional, as described in
            <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.4.1">section 4.1.4.1.</a>)</span>, by setting the <code><a href="#widl-RTCSessionDescription-type">type</a></code> to
            <code>pranswer</code>.</p>

            <p>If the <code>RTCPeerConnection</code> is configured to generate
            Identity assertions by calling setIdentityProvider, then the
            session description <em title="SHALL" class="rfc2119">SHALL</em> contain an appropriate assertion.  If the
            identity provider is unable to produce an identity assertion, the
            call to <code>createAnswer</code> <em title="MUST" class="rfc2119">MUST</em> be rejected with a
            <code>DOMError</code> that has a name of <code>IdpError</code>.</p>

            <p>If this <code>RTCPeerConnection</code> object is closed before
            the SDP generation process completes, the user agent <em title="MUST" class="rfc2119">MUST</em> suppress
            the result and not resolve or reject the returned promise.</p>

            <p>If the SDP generation process completed successfully, the user
            agent <em title="MUST" class="rfc2119">MUST</em> resolve the returned promise with a
            newly created <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> object,
            representing the generated answer.</p>

            <p>If the SDP generation process failed for any reason, the user
            agent <em title="MUST" class="rfc2119">MUST</em> reject the returned promise with a <code>DOMError</code>
            object of type TBD.</p>
            <div id="issue-319" class="issue"><div id="h-issue4" role="heading" aria-level="6" class="issue-title marker"><a href="https://github.com/w3c/webrtc-pc/issues/319"><span>Issue 319</span></a></div><p class="">TODO: define type of error for SDP generation</p></div>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">options</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCAnswerOptions"><code>RTCAnswerOptions</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;<a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>&gt;</code></div></dd><dt id="widl-RTCPeerConnection-createOffer-Promise-RTCSessionDescription--RTCOfferOptions-options"><code>createOffer</code></dt><dd>
            <p>The createOffer method generates a blob of SDP that contains an
            RFC 3264 offer with the supported configurations for the session,
            including descriptions of the local <code>MediaStreamTrack</code>s
            attached to this <code>RTCPeerConnection</code>, the codec/RTP/RTCP
            options supported by this implementation, and any candidates that
            have been gathered by the ICE Agent. The <code>options</code> parameter may be
            supplied to provide additional control over the offer
            generated.</p>

            <p>As an offer, the generated SDP will contain the full set of
            capabilities supported by the session (as opposed to an answer,
            which will include only a specific negotiated subset to use); for
            each SDP line, the generation of the SDP <em title="MUST" class="rfc2119">MUST</em> follow the
            appropriate process for generating an offer. In the event
            <code>createOffer</code> is called after the session is established, <code>createOffer</code>
            will generate an offer that is compatible with the current session,
            incorporating any changes that have been made to the session since
            the last complete offer-answer exchange, such as addition or
            removal of tracks. If no changes have been made, the offer will
            include the capabilities of the current local description as well
            as any additional capabilities that could be negotiated in an
            updated offer.</p>

            <p>Session descriptions generated by <code>createOffer</code> <em title="MUST" class="rfc2119">MUST</em> be
            immediately usable by <code>setLocalDescription</code> without causing an error
            as long as <code>setLocalDescription</code> is called reasonably soon.
            If a system has limited resources (e.g. a finite number
            of decoders), <code>createOffer</code> needs to return an offer that reflects
            the current state of the system, so that <code>setLocalDescription</code> will
            succeed when it attempts to acquire those resources. The session
            descriptions <em title="MUST" class="rfc2119">MUST</em> remain usable by <code>setLocalDescription</code> without
            causing an error until at least the end of the fulfillment callback of the
            returned promise. Calling this method is needed to get the ICE user name
            fragment and password.</p>

            <p>The value for <code>certificates</code> in
            the <code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code> for
            the <code>RTCPeerConnection</code> is used to produce a set of
            certificate fingerprints.  These certificate fingerprints are used
            in the construction of SDP and as input to requests for identity
            assertions.</p>

            <p>If the <code>RTCPeerConnection</code> is configured to generate
            Identity assertions by calling <code>setIdentityProvider</code>, then the
            session description <em title="SHALL" class="rfc2119">SHALL</em> contain an appropriate assertion.  If the
            identity provider is unable to produce an identity assertion, the
            call to <code>createOffer</code> <em title="MUST" class="rfc2119">MUST</em> be rejected with a
            <code>DOMError</code> that has a name of <code>IdpError</code>.</p>

            <p>If this <code>RTCPeerConnection</code> object is closed before
            the SDP generation process completes, the user agent <em title="MUST" class="rfc2119">MUST</em> suppress
            the result and not resolve or reject the returned promise.</p>

            <p>If the SDP generation process completed successfully, the user
            agent <em title="MUST" class="rfc2119">MUST</em> resolve the returned promise with a
            newly created <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> object,
            representing the generated offer.</p>

            <p class="fingerprint">The SDP generation process exposes a
            subset of the media capabilities of the underlying system,
            which provides
            generally persistent cross-origin information on the
            device. It thus increases the fingerprinting surface of
            the application. In privacy-sensitive contexts, browsers
            can consider mitigations such as generating SDP matching
            only a common subset of the capabilities.<img alt="(This is a fingerprinting vector.)" src="images/fingerprint.png" height="21" width="15"></p>

            <p>If the SDP generation process failed for any other reason, the
            user agent <em title="MUST" class="rfc2119">MUST</em> reject the returned promise with an
            <code>DOMError</code> object of type TBD as its argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">options</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCOfferOptions"><code>RTCOfferOptions</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;<a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>&gt;</code></div></dd><dt id="widl-RTCPeerConnection-getConfiguration-RTCConfiguration"><code>getConfiguration</code></dt><dd>
            <p>Returns a <code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code> object
            representing the current configuration of this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

            <p>When this method is call, the user agent <em title="MUST" class="rfc2119">MUST</em> a construct new
            <code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code> object to be returned, and
            initialize it using the ICE Agent's <a href="#ice-transports-setting">ICE transports setting</a> and <a href="#ice-servers-list">ICE servers list</a>.</p>

            <p>The returned configuration <em title="MUST" class="rfc2119">MUST</em> include
            a <code>certificates</code> attribute containing the candidate set
            of certificates used for connecting to peers.  This attribute
            contains the certificates chosen by the application, or the
            certificates generated by the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> for use with this
            <code>RTCPeerConnection</code> instance.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code></div></dd><dt id="widl-RTCPeerConnection-setConfiguration-void-RTCConfiguration-configuration"><code>setConfiguration</code></dt><dd>
            <p>The <code>setConfiguration</code> method updates the ICE Agent process of gathering
            local candidates and pinging remote candidates.</p>

            <p>This call may result in a change to the state of the ICE Agent,
            and may result in a change to media state if it results in
            connectivity being established.</p>

            <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection-setconfiguration">
            <code>setConfiguration()</code></dfn> method is invoked, the user
            agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>If this <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
                <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, throw an
                <code>InvalidStateError</code> exception and abort these
                steps.</p>
              </li>

              <li>
                <p><a href="#set-pc-configuration">Set the configuration</a>
                specified by the methods argument.</p>
              </li>
            </ol>

            <p>To <dfn data-dfn-type="dfn" id="set-pc-configuration">set a configuration</dfn>, run
            the following steps:</p>

            <ol>
              <li>Let <var>configuration</var> be the
              <code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code> dictionary to be processed.</li>

              <li>If <code><var>configuration</var>.peerIdentity</code> is set
              and its value differs from the <a data-link-type="dfn" class="internalDFN" href="#target-peer-identity">target peer identity</a>,
              throw an <code>InvalidModificationError</code>.</li>

              <li>If <code><var>configuration</var>.certificates</code> is set
              and the set of certificates differs from the ones used when the
              <code>RTCPeerConnection</code> object was constructed,
              throw an <code>InvalidModificationError</code>.</li>

              <li>
                <p>Let the value of <code><var>configuration</var>.<a href="#widl-RTCConfiguration-iceTransportPolicy">iceTransportPolicy</a></code>
                be the ICE Agent's <dfn data-dfn-type="dfn" id="ice-transports-setting">ICE transports setting</dfn>.</p>
              </li>

              <li>
                <p>Let the value of <code><var>configuration</var>.<a href="#widl-RTCConfiguration-bundlePolicy">bundlePolicy</a></code>
                be the user agent's bundle policy.</p>
              </li>

              <li>
                <p>Let the value of <code><var>configuration</var>.<a href="#widl-RTCConfiguration-iceCandidatePoolSize">iceCandidatePoolSize</a></code>
                be the user agent's prefetched ICE
                candidate pool size as defined in <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-4.1.10">section 4.1.10.</a>)</span>.</p>
              </li>
              
              <li>
                <p>Let <var>validatedServers</var> be an empty list.</p>
              </li>

              <li>
                <p>If <code><var>configuration</var>.<a href="#widl-RTCConfiguration-iceServers">iceServers</a></code>
                is defined, then run the following steps for each
                element:</p>

                <ol>
                  <li>
                    <p>Let <var>server</var> be the current list element.</p>
                  </li>

                  <li>
                    <p>If <code><var>server</var>.urls</code> is a string, let
                    <code><var>server</var>.urls</code> be a list consisting of just that
                    string.</p>
                  </li>

                  <li>
                    <p>For each <var>url</var> in <code><var>server</var>.urls</code>
                    parse <var>url</var> and obtain <var>scheme name</var>. If the
                    <var>scheme name</var> is not implemented by the browser, or if
                    parsing based on the syntax defined in [<cite><a href="#bib-RFC7064" class="bibref">RFC7064</a></cite>] and [<cite><a href="#bib-RFC7065" class="bibref">RFC7065</a></cite>]
                    fails, throw a <code>SyntaxError</code> and abort these steps.</p>
                  </li>

                  <li>
                    <p>If <var>scheme name</var> is <code>turn</code> or <code>turns</code>, and either of 
                    <code><var>server</var>.username</code> or
                    <code><var>server</var>.credential</code> are omitted, then throw an
                    <code>InvalidAccessError</code> and abort these steps.</p>
                  </li>

                  <li>
                    <p>Append<var>server</var> to <var>validatedServers</var>.
                    </p>
                  </li>
                </ol>

                <p>Let <var>validatedServers</var> be the ICE Agent's
                <dfn data-dfn-type="dfn" id="ice-servers-list">ICE servers list</dfn>.</p>

                <p>If a new list of servers replaces the ICE Agent's existing
                ICE servers list, no action will be taken until the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">ICE gathering
                state</a> transitions to <code>gathering</code>. If a script
                wants this to happen immediately, it should do an ICE
                restart.</p>
              </li>
            </ol>

            <div class="issue"><div id="h-issue5" role="heading" aria-level="6" class="issue-title marker"><span>Issue</span></div><div class="">
              The exception types throw in the above algorithm are provisional
              (until we decide what to do in each case). See also <a href="https://github.com/w3c/webrtc-pc/issues/319">Issue 319</a>
            </div></div>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">configuration</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-setLocalDescription-Promise-void--RTCSessionDescriptionInit-description"><code>setLocalDescription</code></dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-setlocaldescription"><code>setLocalDescription()</code></dfn>
            method instructs the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> to apply
            the supplied <code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code> as the local
            description.</p>

            <p>This API changes the local media state. In order to successfully
            handle scenarios where the application wants to offer to change
            from one media format to a different, incompatible format, the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> <em title="MUST" class="rfc2119">MUST</em> be able to
            simultaneously support use of both the current and pending local
            descriptions (e.g. support codecs that exist in both descriptions)
            until a final answer is received, at which point the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> can fully adopt the pending local
            description, or rollback to the current description if the remote side
            rejected the change.</p>

            <p>When the method is invoked, the user agent must <a href="#set-description">set the RTCSessionDescription</a> indicated
            by the method's first argument.</p>

            <p><span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-6">section 6.</a>)</span> 
            specifies what elements of the SDP returned by <code>createOffer</code>
            can be changed before passing it to <code>setLocalDescription</code>.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">description</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;void&gt;</code></div></dd><dt id="widl-RTCPeerConnection-setRemoteDescription-Promise-void--RTCSessionDescriptionInit-description"><code>setRemoteDescription</code></dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-setremotedescription"><code>setRemoteDescription()</code></dfn>
            method instructs the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> to apply
            the supplied <code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code> as the
            remote offer or answer. This API changes the local media state.</p>

            <p>When the method is invoked, the user agent must <a href="#set-description">set the RTCSessionDescription</a> indicated
            by the method's first argument.
            In addition, a remote description is processed to determine and
            verify the identity of the peer.</p>

            <p>If an <code>a=identity</code> attribute is present in the session
            description, the browser <a href="#sec.identity-verify-assertion">validates the identity
            assertion.</a>.</p>

            <p>If the "peerIdentity" configuration is applied to the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>, this establishes a <dfn data-dfn-type="dfn" id="target-peer-identity">target peer identity</dfn> of the provided
            value.  Alternatively, if the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
            has previously authenticated the identity of the peer (that is,
            there is a current value for <code><a href="#widl-RTCPeerConnection-peerIdentity">peerIdentity</a></code> ),
            then this also establishes a <a href="#target-peer-identity">target
            peer identity</a>.</p>

            <p>The <a href="#target-peer-identity">target peer identity</a>
            cannot be changed once set. Once set, if a different value is
            provided, the user agent <em title="MUST" class="rfc2119">MUST</em> reject the returned promise with
            <code>IncompatibleSessionDescriptionError</code> and abort this
            operation. The <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> <em title="MUST" class="rfc2119">MUST</em> be closed
            if the validated peer identity does not match the <a href="#target-peer-identity">target peer identity</a>.</p>

            <p>If there is no <a href="#target-peer-identity">target peer
            identity</a>, then <code>setRemoteDescription</code> does not await
            the completion of identity validation.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">description</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;void&gt;</code></div></dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#legacy-interface-extensions" typeof="bibo:Chapter" id="legacy-interface-extensions">
        <h4 resource="#h-legacy-interface-extensions" id="h-legacy-interface-extensions"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.3 </span>Legacy Interface Extensions</span></h4>

        <div class="note"><div id="h-note1" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><div class="">These methods are kept on <code>
            <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a>
          </code> for legacy purposes.</div></div>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection-1">partial interface <span class="idlInterfaceID">RTCPeerConnection</span> {
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-createOffer-void-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback-RTCOfferOptions-options">createOffer</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCOfferOptions"><code>RTCOfferOptions</code></a></span> <span class="idlParamName">options</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-setLocalDescription-void-RTCSessionDescriptionInit-description-VoidFunction-successCallback-RTCPeerConnectionErrorCallback-failureCallback">setLocalDescription</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></span> <span class="idlParamName">description</span></span>, <span class="idlParam"><span class="idlParamType">VoidFunction</span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-createAnswer-void-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback">createAnswer</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-setRemoteDescription-void-RTCSessionDescriptionInit-description-VoidFunction-successCallback-RTCPeerConnectionErrorCallback-failureCallback">setRemoteDescription</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></span> <span class="idlParamName">description</span></span>, <span class="idlParam"><span class="idlParamType">VoidFunction</span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-addIceCandidate-void-RTCIceCandidateInit-RTCIceCandidate-candidate-VoidFunction-successCallback-RTCPeerConnectionErrorCallback-failureCallback">addIceCandidate</a></span> (<span class="idlParam"><span class="idlParamType">(<a class="idlType" href="#idl-def-RTCIceCandidateInit"><code>RTCIceCandidateInit</code></a> or <a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>)</span> <span class="idlParamName">candidate</span></span>, <span class="idlParam"><span class="idlParamType">VoidFunction</span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-getStats-void-MediaStreamTrack-selector-RTCStatsCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback">getStats</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>?</span> <span class="idlParamName">selector</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCStatsCallback"><code>RTCStatsCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#methods-1" typeof="bibo:Chapter" id="methods-1"><h5 resource="#h-methods-1" id="h-methods-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.3.1 </span>Methods</span></h5><dl class="methods"><dt id="widl-RTCPeerConnection-addIceCandidate-void-RTCIceCandidateInit-RTCIceCandidate-candidate-VoidFunction-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>addIceCandidate</code></dt><dd>
            <p>When the <code>addIceCandidate</code> method is called, the
            user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>candidate</var> be the method's first argument.</p>
              </li>
              <li>
                <p>Let <var>successCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>
              <li>
                <p>Let <var>failureCallback</var> be the callback indicated by
                the method's third argument.</p>
              </li>
              <li>
                <p>Run the steps specified by <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a href="#dom-peerconnection-addicecandidate">addIceCandiddate()</a>
                method with <var>candidate</var> as the sole argument, and let
                <var>p</var> be the resulting promise.</p>
              </li>
            </ol>

            <p>Upon fulfillment of <var>p</var>,
            invoke <var>successCallback</var> with <code>undefined</code> as the
            argument.</p>

            <p>Upon rejection of <var>p</var> with reason <var>r</var>,
            invoke <var>failureCallback</var> with <var>r</var> as the
            argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">candidate</td><td class="prmType"><code>(<a class="idlType" href="#idl-def-RTCIceCandidateInit"><code>RTCIceCandidateInit</code></a> or <a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>)</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code>VoidFunction</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-createAnswer-void-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>createAnswer</code></dt><dd>
            <p>When the <code>createAnswer</code> method is called, the user
            agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>successCallback</var> be the method's first
                argument.</p>
              </li>
              <li>
                <p>Let <var>failureCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>
              <li>
                <p>Run the steps specified by <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a href="#widl-RTCPeerConnection-createAnswer-Promise-RTCSessionDescription--RTCAnswerOptions-options">createAnswer()</a>
                method with no arguments, and let <var>p</var> be the resulting
                promise.</p>
              </li>
            </ol>

            <p>Upon fulfillment of <var>p</var> with value <var>answer</var>,
            invoke <var>successCallback</var> with <var>answer</var> as the
            argument.</p>

            <p>Upon rejection of <var>p</var> with reason <var>r</var>,
            invoke <var>failureCallback</var> with <var>r</var> as the
            argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-createOffer-void-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback-RTCOfferOptions-options"><code>createOffer</code></dt><dd>
            <p>When the <code>createOffer</code> method is called, the user
            agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>successCallback</var> be the method's first
                argument.</p>
              </li>
              <li>
                <p>Let <var>failureCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>
              <li>
                <p>Let <var>options</var> be the callback indicated by
                the method's third argument.</p>
              </li>
              <li>
                <p>Run the steps specified by <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a href="#widl-RTCPeerConnection-createOffer-Promise-RTCSessionDescription--RTCOfferOptions-options">createOffer()</a>
                method with <var>options</var> as the sole argument, and let
                <var>p</var> be the resulting promise.</p>
              </li>
            </ol>

            <p>Upon fulfillment of <var>p</var> with value <var>offer</var>,
            invoke <var>successCallback</var> with <var>offer</var> as the
            argument.</p>

            <p>Upon rejection of <var>p</var> with reason <var>r</var>,
            invoke <var>failureCallback</var> with <var>r</var> as the
            argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">options</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCOfferOptions"><code>RTCOfferOptions</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-getStats-void-MediaStreamTrack-selector-RTCStatsCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>getStats</code></dt><dd>
            <p>When the <code>getStats</code> method is called, the
            user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>selector</var> be the method's first argument.</p>
              </li>
              <li>
                <p>Let <var>successCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>
              <li>
                <p>Let <var>failureCallback</var> be the callback indicated by
                the method's third argument.</p>
              </li>
              <li>
                <p>Run the steps specified by <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a href="#widl-RTCPeerConnection-getStats-Promise-RTCStatsReport--MediaStreamTrack-selector">getStats()</a>
                method with <var>selector</var> as the sole argument, and let
                <var>p</var> be the resulting promise.</p>
              </li>
            </ol>

            <p>Upon fulfillment of <var>p</var> with value <var>report</var>,
            invoke <var>successCallback</var> with <var>report</var> as the
            argument.</p>

            <p>Upon rejection of <var>p</var> with reason <var>r</var>,
            invoke <var>failureCallback</var> with <var>r</var> as the
            argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">selector</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code></td><td class="prmNullTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCStatsCallback"><code>RTCStatsCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-setLocalDescription-void-RTCSessionDescriptionInit-description-VoidFunction-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>setLocalDescription</code></dt><dd>
            <p>When the <code>setLocalDescription</code> method is called, the
            user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>description</var> be the method's first
                argument.</p>
              </li>
              <li>
                <p>Let <var>successCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>
              <li>
                <p>Let <var>failureCallback</var> be the callback indicated by
                the method's third argument.</p>
              </li>
              <li>
                <p>Run the steps specified by <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a>
                method with <var>description</var> as the sole argument, and let
                <var>p</var> be the resulting promise.</p>
              </li>
            </ol>

            <p>Upon fulfillment of <var>p</var>,
            invoke <var>successCallback</var> with <code>undefined</code> as the
            argument.</p>

            <p>Upon rejection of <var>p</var> with reason <var>r</var>,
            invoke <var>failureCallback</var> with <var>r</var> as the
            argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">description</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code>VoidFunction</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCPeerConnection-setRemoteDescription-void-RTCSessionDescriptionInit-description-VoidFunction-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>setRemoteDescription</code></dt><dd>
            <p>When the <code>setRemoteDescription</code> method is called, the
            user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>description</var> be the method's first
                argument.</p>
              </li>
              <li>
                <p>Let <var>successCallback</var> be the callback indicated by
                the method's second argument.</p>
              </li>
              <li>
                <p>Let <var>failureCallback</var> be the callback indicated by
                the method's third argument.</p>
              </li>
              <li>
                <p>Run the steps specified by <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s <a href="#dom-peerconnection-setremotedescription">setRemoteDescription()</a>
                method with <var>description</var> as the sole argument, and let
                <var>p</var> be the resulting promise.</p>
              </li>
            </ol>

            <p>Upon fulfillment of <var>p</var>,
            invoke <var>successCallback</var> with <code>undefined</code> as the
            argument.</p>

            <p>Upon rejection of <var>p</var> with reason <var>r</var>,
            invoke <var>failureCallback</var> with <var>r</var> as the
            argument.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">description</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code>VoidFunction</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#garbage-collection" typeof="bibo:Chapter" id="garbage-collection">
        <h4 resource="#h-garbage-collection" id="h-garbage-collection"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.3.4 </span>Garbage collection</span></h4>

        <p>An <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object <em title="MUST" class="rfc2119">MUST</em> not be garbage
        collected as long as any event can cause an event handler to be
        triggered on the object. When the object's
        <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, no such event handler can be
        triggered and it is therefore safe to garbage collect the object.</p>

        <p>All <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> and
        <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> objects that are connected to a
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> have a strong
        reference to the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#state-definitions" typeof="bibo:Chapter" id="state-definitions">
      <h3 resource="#h-state-definitions" id="h-state-definitions"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4 </span>State Definitions</span></h3>

      <section property="bibo:hasPart" resource="#rtcsignalingstate-enum" typeof="bibo:Chapter" id="rtcsignalingstate-enum">
        <h4 resource="#h-rtcsignalingstate-enum" id="h-rtcsignalingstate-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4.1 </span>RTCSignalingState Enum</span></h4>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCSignalingState">enum <span class="idlEnumID">RTCSignalingState</span> {
    "<a href="#idl-def-RTCSignalingState.stable" class="idlEnumItem">stable</a>",
    "<a href="#idl-def-RTCSignalingState.have-local-offer" class="idlEnumItem">have-local-offer</a>",
    "<a href="#idl-def-RTCSignalingState.have-remote-offer" class="idlEnumItem">have-remote-offer</a>",
    "<a href="#idl-def-RTCSignalingState.have-local-pranswer" class="idlEnumItem">have-local-pranswer</a>",
    "<a href="#idl-def-RTCSignalingState.have-remote-pranswer" class="idlEnumItem">have-remote-pranswer</a>",
    "<a href="#idl-def-RTCSignalingState.closed" class="idlEnumItem">closed</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCSignalingState.stable">stable</code></td><td>There is no offerÂ­answer exchange in progress. This is also
          the initial state in which case the local and remote descriptions are
          empty.</td></tr><tr><td><code id="idl-def-RTCSignalingState.have-local-offer">have-local-offer</code></td><td>A local description, of type "offer", has been successfully
          applied.</td></tr><tr><td><code id="idl-def-RTCSignalingState.have-remote-offer">have-remote-offer</code></td><td>A remote description, of type "offer", has been successfully
          applied.</td></tr><tr><td><code id="idl-def-RTCSignalingState.have-local-pranswer">have-local-pranswer</code></td><td>A remote description of type "offer" has been successfully
          applied and a local description of type "pranswer" has been
          successfully applied.</td></tr><tr><td><code id="idl-def-RTCSignalingState.have-remote-pranswer">have-remote-pranswer</code></td><td>A local description of type "offer" has been successfully applied
          and a remote description of type "pranswer" has been successfully
          applied.</td></tr><tr><td><code id="idl-def-RTCSignalingState.closed">closed</code></td><td>The connection is closed.</td></tr></tbody></table>

        <figure id="fig-non-normative-signalling-state-transitions-diagram"><img alt="signalling state transition diagram" src="images/peerstates.svg" width="600"><figcaption>Fig. <span class="figno">1</span> <span class="fig-title">Non-normative signalling state transitions diagram</span></figcaption></figure>

        <p>An example set of transitions might be:</p>
        <dl>
        <dt>Caller transition:</dt>

        <dd><ul>
          <li>new RTCPeerConnection(): <code>stable</code></li>

          <li>setLocal(offer): <code>have-local-offer</code></li>

          <li>setRemote(pranswer): <code>have-remote-pranswer</code></li>

          <li>setRemote(answer): <code>stable</code></li>

          <li>close(): <code>closed</code></li>
        </ul></dd>

        <dt>Callee transition:</dt>

        <dd><ul>
          <li>new RTCPeerConnection(): <code>stable</code></li>

          <li>setRemote(offer): <code>have-remote-offer</code></li>

          <li>setLocal(pranswer): <code>have-local-pranswer</code></li>

          <li>setLocal(answer): <code>stable</code></li>

          <li>close(): <code>closed</code></li>
        </ul></dd>
        </dl>
      </section>

      <section property="bibo:hasPart" resource="#rtcicegatheringstate-enum" typeof="bibo:Chapter" id="rtcicegatheringstate-enum">
        <h4 resource="#h-rtcicegatheringstate-enum" id="h-rtcicegatheringstate-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4.2 </span>RTCIceGatheringState Enum</span></h4>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceGatheringState">enum <span class="idlEnumID">RTCIceGatheringState</span> {
    "<a href="#idl-def-RTCIceGatheringState.new" class="idlEnumItem">new</a>",
    "<a href="#idl-def-RTCIceGatheringState.gathering" class="idlEnumItem">gathering</a>",
    "<a href="#idl-def-RTCIceGatheringState.complete" class="idlEnumItem">complete</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceGatheringState.new">new</code></td><td>The object was just created, and no networking has occurred
          yet.</td></tr><tr><td><code id="idl-def-RTCIceGatheringState.gathering">gathering</code></td><td>The <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> is in the process of gathering candidates for this
          RTCPeerConnection.</td></tr><tr><td><code id="idl-def-RTCIceGatheringState.complete">complete</code></td><td>The <a data-link-type="dfn" class="internalDFN" href="#rtcpeerconnection-ice-agent">ICE agent</a> has completed gathering. Events such as adding a
          new interface or a new TURN server will cause the state to go back to
          gathering.</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtcpeerconnectionstate-enum" typeof="bibo:Chapter" id="rtcpeerconnectionstate-enum">
        <h4 resource="#h-rtcpeerconnectionstate-enum" id="h-rtcpeerconnectionstate-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4.3 </span>RTCPeerConnectionState Enum</span></h4>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCPeerConnectionState">enum <span class="idlEnumID">RTCPeerConnectionState</span> {
    "<a href="#idl-def-RTCPeerConnectionState.new" class="idlEnumItem">new</a>",
    "<a href="#idl-def-RTCPeerConnectionState.connecting" class="idlEnumItem">connecting</a>",
    "<a href="#idl-def-RTCPeerConnectionState.connected" class="idlEnumItem">connected</a>",
    "<a href="#idl-def-RTCPeerConnectionState.disconnected" class="idlEnumItem">disconnected</a>",
    "<a href="#idl-def-RTCPeerConnectionState.failed" class="idlEnumItem">failed</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCPeerConnectionState.new">new</code></td><td>Any of the <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>s or
            <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>s are in
            the <code>new</code> state and none of the transports are
            in the <code>connecting</code>, <code>checking</code>,
            <code>failed</code> or <code>disconnected</code> state,
            or all transports are in the <code>closed</code> state.

          </td></tr><tr><td><code id="idl-def-RTCPeerConnectionState.connecting">connecting</code></td><td>Any of the <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>s
            or <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>s are in
            the <code>connecting</code> or <code>checking</code> state
            and none of them is in the <code>failed</code> state.

          </td></tr><tr><td><code id="idl-def-RTCPeerConnectionState.connected">connected</code></td><td>All <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>s
          and <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>s are in
          the <code>connected</code>, <code>completed</code> or
          <code>closed</code> state and at least of them is in
          the <code>connected</code> or <code>completed</code>
          state. </td></tr><tr><td><code id="idl-def-RTCPeerConnectionState.disconnected">disconnected</code></td><td>Any of the <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>s
            or <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>s are in
            the <code>disconnected</code> state and none of them are in
            the <code>failed</code> or <code>connecting</code>
            or <code>checking</code> state.

          </td></tr><tr><td><code id="idl-def-RTCPeerConnectionState.failed">failed</code></td><td>Any of the <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>s
            or <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>s are in
            a <code>failed</code> state.</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtciceconnectionstate-enum" typeof="bibo:Chapter" id="rtciceconnectionstate-enum">
        <h4 resource="#h-rtciceconnectionstate-enum" id="h-rtciceconnectionstate-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.4.4 </span>RTCIceConnectionState Enum</span></h4>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceConnectionState">enum <span class="idlEnumID">RTCIceConnectionState</span> {
    "<a href="#idl-def-RTCIceConnectionState.new" class="idlEnumItem">new</a>",
    "<a href="#idl-def-RTCIceConnectionState.checking" class="idlEnumItem">checking</a>",
    "<a href="#idl-def-RTCIceConnectionState.connected" class="idlEnumItem">connected</a>",
    "<a href="#idl-def-RTCIceConnectionState.completed" class="idlEnumItem">completed</a>",
    "<a href="#idl-def-RTCIceConnectionState.failed" class="idlEnumItem">failed</a>",
    "<a href="#idl-def-RTCIceConnectionState.disconnected" class="idlEnumItem">disconnected</a>",
    "<a href="#idl-def-RTCIceConnectionState.closed" class="idlEnumItem">closed</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceConnectionState.new">new</code></td><td>The ICE Agent is gathering addresses and/or waiting for remote
          candidates to be supplied.</td></tr><tr><td><code id="idl-def-RTCIceConnectionState.checking">checking</code></td><td>The ICE Agent has received remote candidates on at least one
          component, and is checking candidate pairs but has not yet found a
          connection. In addition to checking, it may also still be
          gathering.</td></tr><tr><td><code id="idl-def-RTCIceConnectionState.connected">connected</code></td><td>The ICE Agent has found a usable connection for all components
          but is still checking other candidate pairs to see if there is a
          better connection. It may also still be gathering.</td></tr><tr><td><code id="idl-def-RTCIceConnectionState.completed">completed</code></td><td>The ICE Agent has finished gathering and checking and found a
            connection for all components.
            Details on how the completed state in ICE is reached are covered in
            [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>].  </td></tr><tr><td><code id="idl-def-RTCIceConnectionState.failed">failed</code></td><td>The ICE Agent is finished checking all candidate pairs and failed
          to find a connection for at least one component. Connections may have
          been found for some components.</td></tr><tr><td><code id="idl-def-RTCIceConnectionState.disconnected">disconnected</code></td><td>Liveness checks have failed for one or more components. This is
          more aggressive than <code>failed</code>, and may trigger
          intermittently (and resolve itself without action) on a flaky
          network.</td></tr><tr><td><code id="idl-def-RTCIceConnectionState.closed">closed</code></td><td>The ICE Agent has shut down and is no longer responding to STUN
          requests.</td></tr></tbody></table>

        <p>States take either the value of any component or all components, as
        outlined below:</p>

        <ul>
          <li><code>checking</code> occurs if ANY component has received a
          candidate and can start checking</li>

          <li><code>connected</code> occurs if ALL components have established
          a working connection</li>

          <li><code>completed</code> occurs if ALL components have finalized
          the running of their ICE processes</li>

          <li><code>failed</code> occurs if ANY component has given up trying
          to connect</li>

          <li><code>disconnected</code> occurs if ANY component has failed
          liveness checks</li>

          <li><code>closed</code> occurs only if
          <code>RTCPeerConnection.close()</code> has been called.</li>
        </ul>

        <p>If a component is discarded as a result of signaling (e.g. RTCP mux
        or BUNDLE), the state may advance directly from <code>checking</code>
        to <code>completed</code>.</p>

        <p>Some example transitions might be:</p>

        <ul>
          <li>new RTCPeerConnection(): <code>new</code></li>

          <li>(<code>new</code>, remote candidates received):
          <code>checking</code></li>

          <li>(<code>checking</code>, found usable connection):
          <code>connected</code></li>
          
          <li>(<code>checking</code>, checks fail but gathering still in progress):
          <code>disconnected</code></li>

          <li>(<code>checking</code>, gave up): <code>failed</code></li>
          
          <li>(<code>disconnected</code>, new local candidates):
          <code>checking</code></li>

          <li>(<code>connected</code>, finished all checks):
          <code>completed</code></li>

          <li>(<code>completed</code>, lost connectivity):
          <code>disconnected</code></li>

          <li>(any state, ICE restart occurs): <code>new</code></li>

          <li>close(): <code>closed</code></li>
        </ul>

        <figure id="fig-non-normative-ice-state-transition-diagram"><img alt="ICE state transition diagram" src="images/icestates.svg" width="600">
          <figcaption>Fig. <span class="figno">2</span> <span class="fig-title">Non-normative ICE state transition diagram</span></figcaption></figure>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#callback-definitions" typeof="bibo:Chapter" id="callback-definitions">
      <h3 resource="#h-callback-definitions" id="h-callback-definitions"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.5 </span>Callback Definitions</span></h3>

      <section property="bibo:hasPart" resource="#rtcpeerconnectionerrorcallback" typeof="bibo:Chapter" id="rtcpeerconnectionerrorcallback">
        <h4 resource="#h-rtcpeerconnectionerrorcallback" id="h-rtcpeerconnectionerrorcallback"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.5.1 </span>RTCPeerConnectionErrorCallback</span></h4>

        <pre class="idl"><span class="idlCallback" id="idl-def-RTCPeerConnectionErrorCallback">callback <span class="idlCallbackID">RTCPeerConnectionErrorCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType">DOMError</span> <span class="idlParamName">error</span></span>);</span></pre><section property="bibo:hasPart" resource="#callback-rtcpeerconnectionerrorcallback-parameters" typeof="bibo:Chapter" id="callback-rtcpeerconnectionerrorcallback-parameters"><h5 resource="#h-callback-rtcpeerconnectionerrorcallback-parameters" id="h-callback-rtcpeerconnectionerrorcallback-parameters"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.5.1.1 </span>Callback <a href="#idl-def-RTCPeerConnectionErrorCallback" class="idlType"><code>RTCPeerConnectionErrorCallback</code></a> Parameters</span></h5><dl class="callback-members"><dt id="widl-RTCPeerConnectionErrorCallback-error"><code>error</code> of type <span class="idlMemberType">DOMError</span></dt><dd>An error object encapsulating information about what went
          wrong.</dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#rtcsessiondescriptioncallback" typeof="bibo:Chapter" id="rtcsessiondescriptioncallback">
        <h4 resource="#h-rtcsessiondescriptioncallback" id="h-rtcsessiondescriptioncallback"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.5.2 </span>RTCSessionDescriptionCallback</span></h4>

        <pre class="idl"><span class="idlCallback" id="idl-def-RTCSessionDescriptionCallback">callback <span class="idlCallbackID">RTCSessionDescriptionCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlParamName">sdp</span></span>);</span></pre><section property="bibo:hasPart" resource="#callback-rtcsessiondescriptioncallback-parameters" typeof="bibo:Chapter" id="callback-rtcsessiondescriptioncallback-parameters"><h5 resource="#h-callback-rtcsessiondescriptioncallback-parameters" id="h-callback-rtcsessiondescriptioncallback-parameters"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.5.2.1 </span>Callback <a href="#idl-def-RTCSessionDescriptionCallback" class="idlType"><code>RTCSessionDescriptionCallback</code></a> Parameters</span></h5><dl class="callback-members"><dt id="widl-RTCSessionDescriptionCallback-sdp"><code>sdp</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span></dt><dd>The object containing the SDP [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>].</dd></dl></section>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#error-handling" typeof="bibo:Chapter" id="error-handling">
      <h3 resource="#h-error-handling" id="h-error-handling"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.6 </span>Error Handling</span></h3>

      <section property="bibo:hasPart" resource="#general-principles" typeof="bibo:Chapter" id="general-principles">
        <h4 resource="#h-general-principles" id="h-general-principles"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.6.1 </span>General Principles</span></h4>

        <p>All methods that return promises are governed by the standard error
        handling rules of promises. Methods that do not return promises may throw
        exceptions to indicate errors.</p>

        <p>Legacy-methods may only throw exceptions to indicate invalid state
        and other programming errors. For example, when a legacy-method is
        called when the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> is in an invalid
        state or a state in which that particular method is not allowed to be
        executed, it will throw an exception. In all other cases, legacy methods
        <em title="MUST" class="rfc2119">MUST</em> provide an error object to the error callback.</p>
      </section>

      <section property="bibo:hasPart" resource="#rtcsdperror" typeof="bibo:Chapter" id="rtcsdperror">
        <h4 resource="#h-rtcsdperror" id="h-rtcsdperror"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.6.2 </span>RTCSdpError</span></h4>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCSdpError">interface <span class="idlInterfaceID">RTCSdpError</span> : <span class="idlSuperclass">DOMError</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned long</span> <span class="idlAttrName"><a href="#widl-RTCSdpError-sdpLineNumber">sdpLineNumber</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-1" typeof="bibo:Chapter" id="attributes-1"><h5 resource="#h-attributes-1" id="h-attributes-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.6.2.1 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCSdpError-sdpLineNumber"><code>sdpLineNumber</code> of type <span class="idlAttrType">unsigned long</span>, readonly       </dt><dd>The line number of an <code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code>
          at which the error was encountered.</dd></dl></section>

        <div class="issue"><div id="h-issue6" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><div class="">
          <p>(see also <a href="https://github.com/w3c/webrtc-pc/issues/319">Issue 319</a>)</p>
          <p>Ask the DOM team to extend their list with the following errors.
          The error names and their descriptions are directly copied from the
          old RTCErrorName enum and might need some adjustment before being
          added to the public list of errors.</p>

          <ul>
            <li>InvalidSessionDescriptionError: The provided
            RTCSessionDescriptionInit contained invalid SDP, or the type was wrong
            for the current state of the RTCPeerConnection. User agents <em title="SHOULD" class="rfc2119">SHOULD</em>
            provide as much additional information in the error message as
            possible, including the sdpLineNumber, if appropriate.</li>

            <li>IncompatibleSessionDescriptionError: The provided
            RTCSessionDescriptionInit contained SDP that could not be correctly
            applied to the RTCPeerConnection due to its current state. User
            agents <em title="SHOULD" class="rfc2119">SHOULD</em> provide as much additional information in the error
            message as possible, including the sdpLineNumber, if
            appropriate.</li>

            <li>IncompatibleConstraintsError: The provided MediaConstraints
            could not be correctly applied to the RTCPeerConnection due to its
            current state. User agents <em title="SHOULD" class="rfc2119">SHOULD</em> provide as much additional
            information in the error message as possible.</li>

            <li>InternalError: The RTCPeerConnection encountered an error that
            it could not recover from.</li>
          </ul>
        </div></div>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#session-description-model" typeof="bibo:Chapter" id="session-description-model">
      <h3 resource="#h-session-description-model" id="h-session-description-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7 </span>Session Description Model</span></h3>

      <section property="bibo:hasPart" resource="#rtcsdptype" typeof="bibo:Chapter" id="rtcsdptype">
        <h4 resource="#h-rtcsdptype" id="h-rtcsdptype"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7.1 </span>RTCSdpType</span></h4>

        <p>The RTCSdpType enum describes the type of an
        <code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code> or
        <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> instance.</p>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCSdpType">enum <span class="idlEnumID">RTCSdpType</span> {
    "<a href="#idl-def-RTCSdpType.offer" class="idlEnumItem">offer</a>",
    "<a href="#idl-def-RTCSdpType.pranswer" class="idlEnumItem">pranswer</a>",
    "<a href="#idl-def-RTCSdpType.answer" class="idlEnumItem">answer</a>",
    "<a href="#idl-def-RTCSdpType.rollback" class="idlEnumItem">rollback</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCSdpType.offer">offer</code></td><td>
            <p>An <code>RTCSdpType</code> of <code>offer</code> indicates that a description <em title="MUST" class="rfc2119">MUST</em> be
            treated as an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] offer.</p>
          </td></tr><tr><td><code id="idl-def-RTCSdpType.pranswer">pranswer</code></td><td>
            <p>An <code>RTCSdpType</code> of <code>pranswer</code> indicates that a description <em title="MUST" class="rfc2119">MUST</em>
            be treated as an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] answer, but not a final answer. A
            description used as an SDP <code>pranswer</code> may be applied as a response
            to an SDP offer, or an update to a previously sent SDP
            pranswer.</p>
          </td></tr><tr><td><code id="idl-def-RTCSdpType.answer">answer</code></td><td>
            <p>An <code>RTCSdpType</code> of <code>answer</code> indicates that a description <em title="MUST" class="rfc2119">MUST</em> be
            treated as an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] final answer, and the offer-answer exchange
            <em title="MUST" class="rfc2119">MUST</em> be considered complete. A description used as an SDP answer
            may be applied as a response to an SDP offer or as an update to a
            previously sent SDP pranswer.</p>
          </td></tr><tr><td><code id="idl-def-RTCSdpType.rollback">rollback</code></td><td>
            <p>An <code>RTCSdpType</code> of <code>rollback</code> indicates that a description <em title="MUST" class="rfc2119">MUST</em> be
            treated as canceling the current SDP negotiation and moving
            the SDP [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] offer and answer back to what it was in the previous stable
            state. Note the local or remote SDP descriptions in the
	    previous stable state could be null if there has
            not yet been a successful offer-answer negotiation.</p>
          </td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtcsessiondescription-class" typeof="bibo:Chapter" id="rtcsessiondescription-class">
        <h4 resource="#h-rtcsessiondescription-class" id="h-rtcsessiondescription-class"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7.2 </span>RTCSessionDescription Class</span></h4>

        <p>The <code>RTCSessionDescription</code> class is used by
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> to expose local and remote session
        descriptions.  Attributes on this interface are mutable for legacy
        reasons.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCSessionDescription"><span class="idlDictionary" id="idl-def-RTCSessionDescriptionInit">dictionary <span class="idlDictionaryID">RTCSessionDescriptionInit</span> {
<span class="idlMember">    required <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span> <span class="idlMemberName"><a href="#widl-RTCSessionDescriptionInit-type">type</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>  <span class="idlMemberName"><a href="#widl-RTCSessionDescriptionInit-sdp">sdp</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCSessionDescription--RTCSessionDescriptionInit-descriptionInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></span> <span class="idlParamName">descriptionInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCSessionDescription</span> {
<span class="idlAttribute">                    attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span> <span class="idlAttrName"><a href="#widl-RTCSessionDescription-type">type</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span>  <span class="idlAttrName"><a href="#widl-RTCSessionDescription-sdp">sdp</a></span>;</span>
<span class="idlSerializer">    serializer = <span class="idlSerializerValues">{attribute}</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-1" typeof="bibo:Chapter" id="constructors-1"><h5 resource="#h-constructors-1" id="h-constructors-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7.2.1 </span>Constructors</span></h5><dl class="constructors"><dt id="widl-ctor-RTCSessionDescription--RTCSessionDescriptionInit-descriptionInitDict"><code>RTCSessionDescription</code></dt><dd>The <dfn data-dfn-type="dfn" id="dom-sessiondescription"><code>RTCSessionDescription()</code></dfn>
          constructor takes a dictionary argument,
          <var>descriptionInitDict</var>, whose content is used to initialize
          the new <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> object.  This
          constructor is deprecated; it exists for legacy compatibility reasons
          only.<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">descriptionInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionInit"><code>RTCSessionDescriptionInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-2" typeof="bibo:Chapter" id="attributes-2"><h5 resource="#h-attributes-2" id="h-attributes-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7.2.2 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCSessionDescription-sdp"><code>sdp</code> of type <span class="idlAttrType">DOMString</span></dt><dd>The string representation of the SDP [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>].</dd><dt id="widl-RTCSessionDescription-type"><code>type</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span></dt><dd>The type of this RTCSessionDescription.</dd></dl></section><section property="bibo:hasPart" resource="#serializer" typeof="bibo:Chapter" id="serializer"><h5 resource="#h-serializer" id="h-serializer"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7.2.3 </span>Serializer</span></h5><div><p>Instances of this interface are serialized as a map with entries for each of the serializable attributes.</p><p></p></div></section>

        <section property="bibo:hasPart" resource="#dictionary-rtcsessiondescriptioninit-members" typeof="bibo:Chapter" id="dictionary-rtcsessiondescriptioninit-members"><h5 resource="#h-dictionary-rtcsessiondescriptioninit-members" id="h-dictionary-rtcsessiondescriptioninit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.7.2.4 </span>Dictionary <a href="#idl-def-RTCSessionDescriptionInit" class="idlType"><code>RTCSessionDescriptionInit</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCSessionDescriptionInit-sdp"><code>sdp</code> of type <span class="idlMemberType">DOMString</span></dt><dd>The string representation of the SDP [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>];
          if <code>type</code> is <code>rollback</code>, this member can be left undefined.</dd><dt id="widl-RTCSessionDescriptionInit-type"><code>type</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span>, required</dt><dd>DOMString sdp</dd></dl></section>
      </section>
    </section>
    <section property="bibo:hasPart" resource="#session-negotiation-model" typeof="bibo:Chapter" id="session-negotiation-model">
      <h3 resource="#h-session-negotiation-model" id="h-session-negotiation-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.8 </span>Session Negotiation Model</span></h3>
      <p>Many changes to state of an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> will
        require communication with
        the remote side via the signaling channel, in order to have the desired
        effect. The app can be kept informed as to when it needs to do signaling,
        by listening to the <code>negotiationneeded</code> event.</p>
      <section property="bibo:hasPart" resource="#setting-negotiation-needed" typeof="bibo:Chapter" id="setting-negotiation-needed">
        <h4 resource="#h-setting-negotiation-needed" id="h-setting-negotiation-needed"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.8.1 </span>Setting Negotiation-Needed</span></h4>
        <p>If an operation is performed on an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
          that requires signaling,
          the connection will be marked as needing negotiation. Examples of such
          operations include adding or stopping a track, or adding the first
          data channel.</p>
        <p>Internal changes within the implementation can also result in the
          connection being marked as needing negotiation. For example, if a
          <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> enters the ended state because
          its source device became unavailable.
        </p>
      </section>
      <section property="bibo:hasPart" resource="#clearing-negotiation-needed" typeof="bibo:Chapter" id="clearing-negotiation-needed">
        <h4 resource="#h-clearing-negotiation-needed" id="h-clearing-negotiation-needed"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.8.2 </span>Clearing Negotiation-Needed</span></h4>
        <p>The negotiation-needed flag is cleared when
          <code>setLocalDescription</code> is
          called (either for an offer or answer), and the supplied description
          matches the state of the tracks/datachannels that currenly exist on the
          <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>. Specifically, this means that
          all live tracks have an associated section in the local description
          with their MSID, all ended tracks have been removed from the local
          description, and, if any data channels have been created, a data
          section exists in the local description.</p>
        <p>Note that <code>setLocalDescription(answer)</code> will clear the
          negotiation-needed flag only if the offer had a corresponding section for
          all the tracks/datachannels on the answerer side. Otherwise, a new offer by
          the answerer is still needed, and so the state is not cleared.</p>
      </section>
      <section property="bibo:hasPart" resource="#firing-an-event" typeof="bibo:Chapter" id="firing-an-event">
        <h4 resource="#h-firing-an-event" id="h-firing-an-event"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.8.3 </span>Firing An Event</span></h4>
        <p>When the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> <var>connection</var>
           is marked as negotiation-needed, and it was not already marked as such:</p>
        <ul>
          <li>If the <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>stable</code>, schedule a task to check the
            negotiation-needed flag and, if still set, fire a
            <a href="#event-negotiation">negotiationneeded</a> event on
            <var>connection</var>.</li>
          <li>Otherwise, do nothing. If necessary, an event will be fired during
            <code>setLocalDescription</code> or
            <code>setRemoteDescription</code> processing, as described above.</li>
        </ul>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#interfaces-for-connectivity-establishment" typeof="bibo:Chapter" id="interfaces-for-connectivity-establishment">
      <h3 resource="#h-interfaces-for-connectivity-establishment" id="h-interfaces-for-connectivity-establishment"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9 </span>Interfaces for Connectivity Establishment</span></h3>

      <section property="bibo:hasPart" resource="#rtcicecandidate-interface" typeof="bibo:Chapter" id="rtcicecandidate-interface">
        <h4 resource="#h-rtcicecandidate-interface" id="h-rtcicecandidate-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1 </span>RTCIceCandidate Interface</span></h4>

        <p>This interface describes an ICE candidate.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCIceCandidate"><span class="idlDictionary" id="idl-def-RTCIceCandidateInit">dictionary <span class="idlDictionaryID">RTCIceCandidateInit</span> {
<span class="idlMember">    required <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCIceCandidateInit-candidate">candidate</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCIceCandidateInit-sdpMid">sdpMid</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCIceCandidateInit-sdpMLineIndex">sdpMLineIndex</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCIceCandidate--RTCIceCandidateInit-candidateInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCIceCandidateInit"><code>RTCIceCandidateInit</code></a></span> <span class="idlParamName">candidateInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCIceCandidate</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>               <span class="idlAttrName"><a href="#widl-RTCIceCandidate-candidate">candidate</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString?</span>              <span class="idlAttrName"><a href="#widl-RTCIceCandidate-sdpMid">sdpMid</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short?</span>         <span class="idlAttrName"><a href="#widl-RTCIceCandidate-sdpMLineIndex">sdpMLineIndex</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>               <span class="idlAttrName"><a href="#widl-RTCIceCandidate-foundation">foundation</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned long</span>           <span class="idlAttrName"><a href="#widl-RTCIceCandidate-priority">priority</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>               <span class="idlAttrName"><a href="#widl-RTCIceCandidate-ip">ip</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceProtocol"><code>RTCIceProtocol</code></a></span>          <span class="idlAttrName"><a href="#widl-RTCIceCandidate-protocol">protocol</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short</span>          <span class="idlAttrName"><a href="#widl-RTCIceCandidate-port">port</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceCandidateType"><code>RTCIceCandidateType</code></a></span>     <span class="idlAttrName"><a href="#widl-RTCIceCandidate-type">type</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceTcpCandidateType"><code>RTCIceTcpCandidateType</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCIceCandidate-tcpType">tcpType</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString?</span>              <span class="idlAttrName"><a href="#widl-RTCIceCandidate-relatedAddress">relatedAddress</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short?</span>         <span class="idlAttrName"><a href="#widl-RTCIceCandidate-relatedPort">relatedPort</a></span>;</span>
<span class="idlSerializer">    serializer = <span class="idlSerializerValues">{candidate, sdpMid, sdpMLineIndex}</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-2" typeof="bibo:Chapter" id="constructors-2"><h5 resource="#h-constructors-2" id="h-constructors-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.1 </span>Constructors</span></h5><dl class="constructors"><dt id="widl-ctor-RTCIceCandidate--RTCIceCandidateInit-candidateInitDict"><code>RTCIceCandidate</code></dt><dd>The <dfn data-dfn-type="dfn" id="dom-icecandidate"><code>RTCIceCandidate()</code></dfn> constructor
          takes a dictionary argument, <var>candidateInitDict</var>, whose content is used
          to initialize the new
          <a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>
          object. If either <var>sdpMid</var> or <var>sdpMLineIndex</var> is not present in
          <var>candidateInitDict</var>, the corresponding attribute will be initialized to
          <code>null</code>. If neither is present, a <code>TypeError</code> exception
          will be thrown.<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">candidateInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCIceCandidateInit"><code>RTCIceCandidateInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-3" typeof="bibo:Chapter" id="attributes-3"><h5 resource="#h-attributes-3" id="h-attributes-3"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.2 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCIceCandidate-candidate"><code>candidate</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>This carries the <code>candidate-attribute</code> as defined in
          section 15.1 of [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>].</dd><dt id="widl-RTCIceCandidate-foundation"><code>foundation</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>A unique identifier that allows ICE to correlate candidates that
          appear on multiple <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>s.</dd><dt id="widl-RTCIceCandidate-ip"><code>ip</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd><p>The IP address of the candidate.</p>
          <div class="note"><div id="h-note2" role="heading" aria-level="6" class="note-title marker"><span>Note</span></div><div class="">
            <p>The IP addresses exposed in candidates gathered via ICE
              and made visibile to the application in
              <code>RTCIceCandidate</code> instances can reveal more
              information about the device and the user (e.g. location,
              local network topology) than the user might have
              expected in a non-WebRTC enabled browser.</p>
            <p>These IP addresses are always exposed to the
            application, and potentially exposed to the
            communicating party, and can be exposed without any
            specific user consent (e.g. for peer connections used
            with data channels, or to receive media only).</p>
            <p class="fingerprint">These IP addresses can also be
            used as temporary or persistent cross-origin states, and
            thus contribute to the fingerprinting surface of the device.<img alt="(This is a fingerprinting vector.)" src="images/fingerprint.png" height="21" width="15"></p>
            <p>Applications can avoid exposing IP addresses to the
            communicating party, either temporarily or permanently, by
            forcing the ICE agent to report only relay candidates via
            the <code>iceTransportPolicy</code> member
            of <code><a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a></code>, or by not signalling
            non-relay ICE candidates (e.g. until the user has accepted
            to share media).</p>
            <p>To limit the IP addresses exposed to the application
            itself, browsers can offer their users different policies
            regarding sharing local IP addresses, as defined in
            [<cite><a href="#bib-RTCWEB-IP-HANDLING" class="bibref">RTCWEB-IP-HANDLING</a></cite>].</p>
          </div></div>
          </dd><dt id="widl-RTCIceCandidate-port"><code>port</code> of type <span class="idlAttrType">unsigned short</span>, readonly       </dt><dd>The port of the candidate.</dd><dt id="widl-RTCIceCandidate-priority"><code>priority</code> of type <span class="idlAttrType">unsigned long</span>, readonly       </dt><dd>The assigned priority of the candidate.</dd><dt id="widl-RTCIceCandidate-protocol"><code>protocol</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceProtocol"><code>RTCIceProtocol</code></a></span>, readonly       </dt><dd>The protocol of the candidate (<code>udp</code>/<code>tcp</code>).</dd><dt id="widl-RTCIceCandidate-relatedAddress"><code>relatedAddress</code> of type <span class="idlAttrType">DOMString</span>, readonly       , nullable</dt><dd>For a candidate that is derived from another, such as a relay or reflexive
          candidate, the <dfn id="dfn-relatedaddress" data-dfn-type="dfn">relatedAddress</dfn> is the IP address of the candidate that
          it is derived from. For host candidates, the <code>relatedAddress</code>
          is <code>null</code>.</dd><dt id="widl-RTCIceCandidate-relatedPort"><code>relatedPort</code> of type <span class="idlAttrType">unsigned short</span>, readonly       , nullable</dt><dd>For a candidate that is derived from another, such as a relay or reflexive
          candidate, the <dfn id="dfn-relatedport" data-dfn-type="dfn">relatedPort</dfn> is the port of the candidate that
          it is derived from. For host candidates, the <code>relatedPort</code>
          is <code>null</code>.</dd><dt id="widl-RTCIceCandidate-sdpMLineIndex"><code>sdpMLineIndex</code> of type <span class="idlAttrType">unsigned short</span>, readonly       , nullable</dt><dd>If not <code>null</code>, this indicates the index (starting at zero) of the
          <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> in the SDP this candidate is associated with.</dd><dt id="widl-RTCIceCandidate-sdpMid"><code>sdpMid</code> of type <span class="idlAttrType">DOMString</span>, readonly       , nullable</dt><dd>If not <code>null</code>, this contains the identifier of the "media stream
          identification" as defined in [<cite><a href="#bib-RFC5888" class="bibref">RFC5888</a></cite>] for the media component this
          candidate is associated with.</dd><dt id="widl-RTCIceCandidate-tcpType"><code>tcpType</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceTcpCandidateType"><code>RTCIceTcpCandidateType</code></a></span>, readonly       , nullable</dt><dd>If <code>protocol</code> is <code>tcp</code>, <code>tcpType</code> represents
          the type of TCP candidate. Otherwise, <code>tcpType</code> is <code>null</code>.</dd><dt id="widl-RTCIceCandidate-type"><code>type</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceCandidateType"><code>RTCIceCandidateType</code></a></span>, readonly       </dt><dd>The type of the candidate.</dd></dl></section><section property="bibo:hasPart" resource="#serializer-1" typeof="bibo:Chapter" id="serializer-1"><h5 resource="#h-serializer-1" id="h-serializer-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.3 </span>Serializer</span></h5><div><p>Instances of this interface are serialized as a map with entries for the following attributes: candidate, sdpMid, sdpMLineIndex.</p><p></p></div></section>

        <section property="bibo:hasPart" resource="#dictionary-rtcicecandidateinit-members" typeof="bibo:Chapter" id="dictionary-rtcicecandidateinit-members"><h5 resource="#h-dictionary-rtcicecandidateinit-members" id="h-dictionary-rtcicecandidateinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.4 </span>Dictionary <a href="#idl-def-RTCIceCandidateInit" class="idlType"><code>RTCIceCandidateInit</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCIceCandidateInit-candidate"><code>candidate</code> of type <span class="idlMemberType">DOMString</span>, required</dt><dd>

          </dd><dt id="widl-RTCIceCandidateInit-sdpMLineIndex"><code>sdpMLineIndex</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>
        </dd><dt id="widl-RTCIceCandidateInit-sdpMid"><code>sdpMid</code> of type <span class="idlMemberType">DOMString</span></dt><dd>

          </dd></dl></section>

        <section property="bibo:hasPart" resource="#rtciceprotocol-enum" typeof="bibo:Chapter" id="rtciceprotocol-enum">
          <h5 resource="#h-rtciceprotocol-enum" id="h-rtciceprotocol-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.5 </span>RTCIceProtocol Enum</span></h5>

          <p>The <dfn id="dfn-rtciceprotocol" data-dfn-type="dfn">RTCIceProtocol</dfn> represents the protocol of the ICE candidate.</p>

          <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceProtocol">enum <span class="idlEnumID">RTCIceProtocol</span> {
    "<a href="#idl-def-RTCIceProtocol.udp" class="idlEnumItem">udp</a>",
    "<a href="#idl-def-RTCIceProtocol.tcp" class="idlEnumItem">tcp</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceProtocol.udp">udp</code></td><td>A UDP candidate, as described in [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>].</td></tr><tr><td><code id="idl-def-RTCIceProtocol.tcp">tcp</code></td><td>A TCP candidate, as described in [<cite><a href="#bib-RFC6544" class="bibref">RFC6544</a></cite>].</td></tr></tbody></table>
        </section>

        <section property="bibo:hasPart" resource="#rtcicetcpcandidatetype-enum" typeof="bibo:Chapter" id="rtcicetcpcandidatetype-enum">
          <h5 resource="#h-rtcicetcpcandidatetype-enum" id="h-rtcicetcpcandidatetype-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.6 </span>RTCIceTcpCandidateType Enum</span></h5>

          <p>The <dfn id="dfn-rtcicetcpcandidatetype" data-dfn-type="dfn">RTCIceTcpCandidateType</dfn> represents the type of the ICE TCP
          candidate, as defined in [<cite><a href="#bib-RFC6544" class="bibref">RFC6544</a></cite>].</p>

          <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceTcpCandidateType">enum <span class="idlEnumID">RTCIceTcpCandidateType</span> {
    "<a href="#idl-def-RTCIceTcpCandidateType.active" class="idlEnumItem">active</a>",
    "<a href="#idl-def-RTCIceTcpCandidateType.passive" class="idlEnumItem">passive</a>",
    "<a href="#idl-def-RTCIceTcpCandidateType.so" class="idlEnumItem">so</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceTcpCandidateType.active">active</code></td><td>An <code>active</code> TCP candidate is one for which the transport will
            attempt to open an outbound connection but will not receive incoming
            connection requests.</td></tr><tr><td><code id="idl-def-RTCIceTcpCandidateType.passive">passive</code></td><td>A <code>passive</code> TCP candidate is one for which the transport
            will receive incoming connection attempts but not attempt a connection.</td></tr><tr><td><code id="idl-def-RTCIceTcpCandidateType.so">so</code></td><td>An <code>so</code> candidate is one for which the transport will attempt
             to open a connection simultaneously with its peer.</td></tr></tbody></table>
        </section>

        <section property="bibo:hasPart" resource="#rtcicecandidatetype-enum" typeof="bibo:Chapter" id="rtcicecandidatetype-enum">
          <h5 resource="#h-rtcicecandidatetype-enum" id="h-rtcicecandidatetype-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.1.7 </span>RTCIceCandidateType Enum</span></h5>

          <p>The <dfn id="dfn-rtcicecandidatetype" data-dfn-type="dfn">RTCIceCandidateType</dfn> represents the type of the ICE candidate,
          as defined in [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>].</p>

          <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceCandidateType">enum <span class="idlEnumID">RTCIceCandidateType</span> {
    "<a href="#idl-def-RTCIceCandidateType.host" class="idlEnumItem">host</a>",
    "<a href="#idl-def-RTCIceCandidateType.srflx" class="idlEnumItem">srflx</a>",
    "<a href="#idl-def-RTCIceCandidateType.prflx" class="idlEnumItem">prflx</a>",
    "<a href="#idl-def-RTCIceCandidateType.relay" class="idlEnumItem">relay</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceCandidateType.host">host</code></td><td>A host candidate.</td></tr><tr><td><code id="idl-def-RTCIceCandidateType.srflx">srflx</code></td><td>A server reflexive candidate.</td></tr><tr><td><code id="idl-def-RTCIceCandidateType.prflx">prflx</code></td><td>A peer reflexive candidate.</td></tr><tr><td><code id="idl-def-RTCIceCandidateType.relay">relay</code></td><td>A relay candidate.</td></tr></tbody></table>
        </section>
      </section>

      <section property="bibo:hasPart" resource="#rtcpeerconnectioniceevent" typeof="bibo:Chapter" id="rtcpeerconnectioniceevent">
        <h4 resource="#h-rtcpeerconnectioniceevent" id="h-rtcpeerconnectioniceevent"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.2 </span>RTCPeerConnectionIceEvent</span></h4>

        <p>The <code>icecandidate</code> event of the RTCPeerConnection uses
        the <code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code> interface.</p>

        <p><dfn id="dfn-firing-an-rtcpeerconnectioniceevent-event-named-e" data-dfn-type="dfn">Firing an
        <code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code> event named
        <var>e</var></dfn> with an <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code>
        <var>candidate</var> means that an event with the name <var>e</var>,
        which does not bubble (except where otherwise stated) and is not
        cancelable (except where otherwise stated), and which uses the
        <code>RTCPeerConnectionIceEvent</code> interface with the
        <code>candidate</code> attribute set to the new ICE candidate, <em title="MUST" class="rfc2119">MUST</em> be
        created and dispatched at the given target.</p>

        <p>When firing an <code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code> event
        that contains a <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> object, it <em title="MUST" class="rfc2119">MUST</em>
        include values for
        both <a href="#widl-RTCIceCandidate-sdpMid"><code>sdpMid</code></a>
        and <a href="#widl-RTCIceCandidate-sdpMLineIndex"><code>sdpMLineIndex</code></a>.
        If the <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> is of type <code>srflx</code>
        or type <code>relay</code>, the <code>url</code> property of the event <em title="MUST" class="rfc2119">MUST</em> be
        set to the URL of the ICE server from which the candidate was obtained.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnectionIceEvent"><span class="idlDictionary" id="idl-def-RTCPeerConnectionIceEventInit">dictionary <span class="idlDictionaryID">RTCPeerConnectionIceEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span> <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceEventInit-candidate">candidate</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>       <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceEventInit-url">url</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCPeerConnectionIceEvent--DOMString-type-RTCPeerConnectionIceEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionIceEventInit"><code>RTCPeerConnectionIceEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCPeerConnectionIceEvent</span> : <span class="idlSuperclass"><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceEvent-candidate">candidate</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString?</span>       <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceEvent-url">url</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-3" typeof="bibo:Chapter" id="constructors-3"><h5 resource="#h-constructors-3" id="h-constructors-3"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.2.1 </span>Constructors</span></h5><dl class="constructors"><dt id="widl-ctor-RTCPeerConnectionIceEvent--DOMString-type-RTCPeerConnectionIceEventInit-eventInitDict"><code>RTCPeerConnectionIceEvent</code></dt><dd>

          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEventInit"><code>RTCPeerConnectionIceEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-4" typeof="bibo:Chapter" id="attributes-4"><h5 resource="#h-attributes-4" id="h-attributes-4"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.2.2 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCPeerConnectionIceEvent-candidate"><code>candidate</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <code>candidate</code> attribute is the
            <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> object with the new ICE
            candidate that caused the event.</p>

            <p>This attribute is set to <code>null</code> when an event is
            generated to indicate the end of candidate gathering.</p>

            <div class="note"><div id="h-note3" role="heading" aria-level="6" class="note-title marker"><span>Note</span></div><p class="">Even where there are multiple media components, only
            one event containing a <code>null</code> candidate is fired.</p></div>
          </dd><dt id="widl-RTCPeerConnectionIceEvent-url"><code>url</code> of type <span class="idlAttrType">DOMString</span>, readonly       , nullable</dt><dd>
            <p>The <code>url</code> attribute is the STUN or TURN URL that
            identifies the STUN or TURN server used to gather this candidate.
            If the candidate was not gathered from a STUN or TURN server, this
            parameter will be set to <code>null</code>.</p>
          </dd></dl></section>

        <section property="bibo:hasPart" resource="#dictionary-rtcpeerconnectioniceeventinit-members" typeof="bibo:Chapter" id="dictionary-rtcpeerconnectioniceeventinit-members"><h5 resource="#h-dictionary-rtcpeerconnectioniceeventinit-members" id="h-dictionary-rtcpeerconnectioniceeventinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.2.3 </span>Dictionary <a href="#idl-def-RTCPeerConnectionIceEventInit" class="idlType"><code>RTCPeerConnectionIceEventInit</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCPeerConnectionIceEventInit-candidate"><code>candidate</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span></dt><dd>
            <p>See <a href="#widl-RTCPeerConnectionIceEvent-candidate">the <code>candidate</code> attribute of the <code>RTCPeerConnectionIceEvent</code> interface</a>.</p>
          </dd><dt id="widl-RTCPeerConnectionIceEventInit-url"><code>url</code> of type <span class="idlMemberType">DOMString</span></dt><dd></dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#rtcpeerconnectioniceerrorevent" typeof="bibo:Chapter" id="rtcpeerconnectioniceerrorevent">
        <h4 resource="#h-rtcpeerconnectioniceerrorevent" id="h-rtcpeerconnectioniceerrorevent"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.3 </span>RTCPeerConnectionIceErrorEvent</span></h4>

        <p>The <code>icecandidateerror</code> event of the RTCPeerConnection uses
        the <code><a class="idlType" href="#idl-def-RTCPeerConnectionIceErrorEvent"><code>RTCPeerConnectionIceErrorEvent</code></a></code> interface.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnectionIceErrorEvent"><span class="idlDictionary" id="idl-def-RTCPeerConnectionIceErrorEventInit">dictionary <span class="idlDictionaryID">RTCPeerConnectionIceErrorEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceErrorEventInit-hostCandidate">hostCandidate</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceErrorEventInit-url">url</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceErrorEventInit-errorCode">errorCode</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">USVString</span>      <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceErrorEventInit-statusText">statusText</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCPeerConnectionIceErrorEvent--DOMString-type-RTCPeerConnectionIceErrorEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionIceErrorEventInit"><code>RTCPeerConnectionIceErrorEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCPeerConnectionIceErrorEvent</span> : <span class="idlSuperclass"><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceErrorEvent-hostCandidate">hostCandidate</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceErrorEvent-url">url</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short</span> <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceErrorEvent-errorCode">errorCode</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">USVString</span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceErrorEvent-errorText">errorText</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-4" typeof="bibo:Chapter" id="constructors-4"><h5 resource="#h-constructors-4" id="h-constructors-4"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.3.1 </span>Constructors</span></h5><dl class="constructors"><dt id="widl-ctor-RTCPeerConnectionIceErrorEvent--DOMString-type-RTCPeerConnectionIceErrorEventInit-eventInitDict"><code>RTCPeerConnectionIceErrorEvent</code></dt><dd>readonly attribute DOMString hostCandidate<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionIceErrorEventInit"><code>RTCPeerConnectionIceErrorEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-5" typeof="bibo:Chapter" id="attributes-5"><h5 resource="#h-attributes-5" id="h-attributes-5"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.3.2 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCPeerConnectionIceErrorEvent-errorCode"><code>errorCode</code> of type <span class="idlAttrType">unsigned short</span>, readonly       </dt><dd>
            <p>The <code>errorCode</code> attribute is the numeric STUN
            error code returned by the STUN or TURN server.</p>
            <p>If the server could not be reached, <code>errorCode</code> will
            be set to a TBD value in the 7XX range, as this does not conflict
            with the STUN error code range.</p>
            <div class="issue"><div id="h-issue7" role="heading" aria-level="6" class="issue-title marker"><span>Issue</span></div><p class="">Error code to be defined</p></div>
          </dd><dt id="widl-RTCPeerConnectionIceErrorEvent-errorText"><code>errorText</code> of type <span class="idlAttrType">USVString</span>, readonly       </dt><dd>
            <p>The <code>errorText</code> attribute is the STUN reason text
            returned by the STUN or TURN server.</p>
            <p>If the server could not be reached, <code>errorText</code> will
            be set to an implementation-specific value providing details about
            the error.</p>
          </dd><dt id="widl-RTCPeerConnectionIceErrorEvent-hostCandidate"><code>hostCandidate</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>
            <p>The <code>hostCandidate</code> attribute is the local IP address and
            port used to communicate with the STUN or TURN server.</p>
            <p> On a multihomed system, multiple interfaces may be used to contact the
            server, and this attribute allows the application to figure out
            on which one the failure occurred.</p>
            <p>If use of multiple interfaces has been prohibited for privacy
            reasons, this attribute will be set to 0.0.0.0:0 or [::]:0, as
            appropriate.</p>
          </dd><dt id="widl-RTCPeerConnectionIceErrorEvent-url"><code>url</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>
            <p>The <code>url</code> attribute is the STUN or TURN URL that
            identifies the STUN or TURN server for which the
            failure occurred.</p>
          </dd></dl></section>

        <section property="bibo:hasPart" resource="#dictionary-rtcpeerconnectioniceerroreventinit-members" typeof="bibo:Chapter" id="dictionary-rtcpeerconnectioniceerroreventinit-members"><h5 resource="#h-dictionary-rtcpeerconnectioniceerroreventinit-members" id="h-dictionary-rtcpeerconnectioniceerroreventinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.9.3.3 </span>Dictionary <a href="#idl-def-RTCPeerConnectionIceErrorEventInit" class="idlType"><code>RTCPeerConnectionIceErrorEventInit</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCPeerConnectionIceErrorEventInit-errorCode"><code>errorCode</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>USVString statusText</dd><dt id="widl-RTCPeerConnectionIceErrorEventInit-hostCandidate"><code>hostCandidate</code> of type <span class="idlMemberType">DOMString</span></dt><dd>DOMString url</dd><dt id="widl-RTCPeerConnectionIceErrorEventInit-statusText"><code>statusText</code> of type <span class="idlMemberType">USVString</span></dt><dd></dd><dt id="widl-RTCPeerConnectionIceErrorEventInit-url"><code>url</code> of type <span class="idlMemberType">DOMString</span></dt><dd>unsigned short errorCode</dd></dl></section>
      </section>

    </section>

    <section property="bibo:hasPart" resource="#priority-and-qos-model" typeof="bibo:Chapter" id="priority-and-qos-model">
      <h3 resource="#h-priority-and-qos-model" id="h-priority-and-qos-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.10 </span>Priority and QoS Model</span></h3>

      <p> Many applications have multiple media flows of the same
        data type and often some of the flows are more important than
        others.  WebRTC uses the priority and Quality of Service (QoS) framework
        described in [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>] and [<cite><a href="#bib-TSVWG-RTCWEB-QOS" class="bibref">TSVWG-RTCWEB-QOS</a></cite>]
        to provide priority and DSCP marking for packets that will
        help provide QoS in some networking environments. The
        priority setting can be used to indicate the relative priority
        of various flows. The priority API allows the JavaScript
        applications to tell the browser whether a particular media
        flow is high, medium, low or of very low importance to the
        application by setting the <code>priority</code> property
        of <code><a class="idlType" href="#idl-def-RTCRtpEncodingParameters"><code>RTCRtpEncodingParameters</code></a></code> objects to one of the following values.</p>

      <section property="bibo:hasPart" resource="#rtcprioritytype-enum" typeof="bibo:Chapter" id="rtcprioritytype-enum">
        <h4 resource="#h-rtcprioritytype-enum" id="h-rtcprioritytype-enum"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.10.1 </span>RTCPriorityType Enum</span></h4>
        <pre class="idl"><span class="idlEnum" id="idl-def-RTCPriorityType">enum <span class="idlEnumID">RTCPriorityType</span> {
    "<a href="#idl-def-RTCPriorityType.very-low" class="idlEnumItem">very-low</a>",
    "<a href="#idl-def-RTCPriorityType.low" class="idlEnumItem">low</a>",
    "<a href="#idl-def-RTCPriorityType.medium" class="idlEnumItem">medium</a>",
    "<a href="#idl-def-RTCPriorityType.high" class="idlEnumItem">high</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCPriorityType.very-low">very-low</code></td><td>See [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>], Section 4.</td></tr><tr><td><code id="idl-def-RTCPriorityType.low">low</code></td><td>See [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>], Section 4.</td></tr><tr><td><code id="idl-def-RTCPriorityType.medium">medium</code></td><td>See [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>], Section 4.</td></tr><tr><td><code id="idl-def-RTCPriorityType.high">high</code></td><td>See [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>], Section 4.</td></tr></tbody></table>
      </section>

      <p>
        Applications that use this API should be aware that often
        better overall user experience is obtained by lowering the
        priority of things that are not as important rather than
        raising the the priority of the things that are.
      </p>
    </section>

    <section property="bibo:hasPart" resource="#sec.cert-mgmt" typeof="bibo:Chapter">
      <h3 resource="#sec.cert-mgmt" id="sec.cert-mgmt"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.11 </span>Certificate Management</span></h3>
      <p>
        The certificates that <code>RTCPeerConnection</code> instances use to
        authenticate with peers use the <a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a>
        interface.  These objects can be explicitly generated by applications
        using <code>RTCPeerConnection.generateCertificate</code> and provided in
        the <a class="idlType" href="#idl-def-RTCConfiguration"><code>RTCConfiguration</code></a> when constructing a
        new <code>RTCPeerConnection</code> instance.
      </p>
      <p>
        The explicit certificate management functions provided here are
        optional.  If an application does not provide
        the <code>certificates</code> configuration option when constructing
        an <code>RTCPeerConnection</code> a new set of certificates <em title="MUST" class="rfc2119">MUST</em> be
        generated by the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a>.  That set <em title="MUST" class="rfc2119">MUST</em> include an ECDSA
        certificate with a private key on the P-256 curve and a signature with a
        SHA-256 hash.
      </p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection-2">partial interface <span class="idlInterfaceID">RTCPeerConnection</span> {
<span class="idlMethod">    static <span class="idlMethType">Promise&lt;<a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-generateCertificate-Promise-RTCCertificate--AlgorithmIdentifier-keygenAlgorithm">generateCertificate</a></span> (<span class="idlParam"><span class="idlParamType">AlgorithmIdentifier</span> <span class="idlParamName">keygenAlgorithm</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#methods-2" typeof="bibo:Chapter" id="methods-2"><h4 resource="#h-methods-2" id="h-methods-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.11.1 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCPeerConnection-generateCertificate-Promise-RTCCertificate--AlgorithmIdentifier-keygenAlgorithm"><code>generateCertificate</code>, static</dt><dd>
          <p>The <code>generateCertificate</code> function causes the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user
          agent</a> to create and store an X.509 certificate [<cite><a href="#bib-X509V3" class="bibref">X509V3</a></cite>] and
          corresponding private key.  A handle to information is provided in the
          form of the <code>RTCCertificate</code> interface.  The
          returned <code>RTCCertificate</code> can be used to control the
          certificate that is offered in the DTLS sessions established
          by <code>RTCPeerConnection</code>.</p>

          <p>The <var>keygenAlgorithm</var> argument is used to control how the
          private key associated with the certificate is generated.
          The <var>keygenAlgorithm</var> argument uses the WebCrypto
          [<cite><a href="#bib-WebCryptoAPI" class="bibref">WebCryptoAPI</a></cite>] <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-AlgorithmIdentifier"><code>AlgorithmIdentifier</code></a>
          type.  The <var>keygenAlgorithm</var> value <em title="MUST" class="rfc2119">MUST</em> be a valid argument
          to <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#SubtleCrypto-method-generateKey"><code>window.crypto.subtle.generateKey</code></a>;
          that is, the value <em title="MUST" class="rfc2119">MUST</em> produce a non-error result when normalized
          according to the
          WebCrypto <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-normalization">algorithm
          normalization process</a> [<cite><a href="#bib-WebCryptoAPI" class="bibref">WebCryptoAPI</a></cite>] with an operation name
          of <code>generateKey</code> and a
          [[<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-supportedAlgorithms">supportedAlgorithms</a>]]
          value specific to production of certificates
          for <code>RTCPeerConnection</code>.  If the algorithm normalization
          process produces an error, the call
          to <code>generateCertificate</code> <em title="MUST" class="rfc2119">MUST</em> be rejected with that
          error.</p>

          <p>Signatures produced by the generated key are used to authenticate
          the DTLS connection. The identified algorithm (as identified by
          the <code>name</code> of the
          normalized <code>AlgorithmIdentifier</code>) <em title="MUST" class="rfc2119">MUST</em> be an asymmetric
          algorithm that can be used to produce a signature.</p>

          <p>The certificate produced by this process also contains a signature.
          The validity of this signature is only relevant for compatibility
          reasons.  Only the public key and the resulting certificate
          fingerprint are used by <code>RTCPeerConnection</code>, but it is more
          likely that a certificate will be accepted if the certificate is well
          formed.  The browser selects the algorithm used to sign the
          certificate; a browser <em title="SHOULD" class="rfc2119">SHOULD</em> select SHA-256 [<cite><a href="#bib-FIPS-180-4" class="bibref">FIPS-180-4</a></cite>] if a hash
          algorithm is needed.</p>

          <p>The resulting certificate <em title="MUST NOT" class="rfc2119">MUST NOT</em> include information that can be
          linked to a user or <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a>.  Randomized values for
          distinguished name and serial number <em title="SHOULD" class="rfc2119">SHOULD</em> be used.</p>

          <p>An optional <code>expires</code> attribute <em title="MAY" class="rfc2119">MAY</em> be added to
          the <var>keygenAlgorithm</var> parameter.  If this contains
          a <code>DOMTimeStamp</code> value, it indicates the maximum
          time that the <code><a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a></code> is valid for relative
          to the current time.  A <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> sets
          the <code><a href="#widl-RTCCertificate-expires">expires</a></code>
          attribute of the returned <code><a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a></code> to the
          current time plus the value of the <code>expires</code> attribute.
          However, a <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> <em title="MAY" class="rfc2119">MAY</em> choose to limit the period over which
          an <code><a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a></code> is valid.</p>

          <p>A <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> <em title="MUST" class="rfc2119">MUST</em> reject a call
          to <code>generateCertificate()</code> with a <code>DOMError</code> of
          type <code>NotSupportedError</code> if the <var>keygenAlgorithm</var>
          parameter identifies an algorithm that the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> cannot or
          will not use to generate a certificate
          for <code>RTCPeerConnection</code>.</p>

          <p>The following values <em title="MUST" class="rfc2119">MUST</em> be supported by a <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a>:
            <code>{ name:
            "<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#rsassa-pkcs1">RSASSA-PKCS1-v1_5</a>",
            modulusLength: 2048, publicExponent: new Uint8Array([1, 0, 1]), hash: "SHA-256" }</code>, and <code>{
            name:
            "<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#ecdsa">ECDSA</a>",
            namedCurve:
            "<a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#dfn-NamedCurve">P-256</a>"
            }</code>.</p>

          <div class="note"><div id="h-note4" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><p class="">It is expected that a <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> will have a
          small or even fixed set of values that it will accept.</p></div>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">keygenAlgorithm</td><td class="prmType"><code>AlgorithmIdentifier</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;<a class="idlType" href="#idl-def-RTCCertificate"><code>RTCCertificate</code></a>&gt;</code></div></dd></dl></section>

      <section property="bibo:hasPart" resource="#rtccertificate-interface" typeof="bibo:Chapter" id="rtccertificate-interface">
        <h4 resource="#h-rtccertificate-interface" id="h-rtccertificate-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.11.2 </span>RTCCertificate Interface</span></h4>

        <p>The <dfn id="dfn-rtccertificate" data-dfn-type="dfn"><code>RTCCertificate</code></dfn> interface represents a
        certificate used to authenticate WebRTC communications.  In addition to
        the visible properties, internal slots contain a handle to the generated
        private keying materal
        ([[<dfn data-dfn-type="dfn" id="RTCCertificate-handle">handle</dfn>]]) and a certificate
        ([[<dfn data-dfn-type="dfn" id="RTCCertificate-certificate">certificate</dfn>]])
        that <code>RTCPeerConnection</code> uses to authenticate with a
        peer.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCCertificate">interface <span class="idlInterfaceID">RTCCertificate</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMTimeStamp</span> <span class="idlAttrName"><a href="#widl-RTCCertificate-expires">expires</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-6" typeof="bibo:Chapter" id="attributes-6"><h5 resource="#h-attributes-6" id="h-attributes-6"><span property="xhv:role" resource="xhv:heading"><span class="secno">4.11.2.1 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCCertificate-expires"><code>expires</code> of type <span class="idlAttrType">DOMTimeStamp</span>, readonly       </dt><dd>
            <p>The <var>expires</var> attribute indicates the date and time
            in milliseconds relative to 1970-01-01T00:00:00Z
            after which the certificate will be considered invalid by the
            browser.  After this time, attempts to construct
            an <code>RTCPeerConnection</code> using this certificate fail.</p>
            <p>Note that this value might not be reflected in
            a <code>notAfter</code> parameter in the certificate itself.</p>
          </dd></dl></section>

        <p>For the purposes of this API, the
        [[<a href="#RTCCertificate-certificate">certificate</a>]] slot contains
        unstructured binary data.</p>

        <p>Note that a <code>RTCCertificate</code> might not directly hold
        private keying material, this might be stored in a secure module.</p>

        <p>The <code>RTCCertificate</code> object can be stored and retrieved
        from persistent storage by an application.  When a <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> is
        required to obtain a structured clone [<cite><a href="#bib-HTML" class="bibref">HTML</a></cite>] of
        a <code>RTCCertificate</code> object, it performs the following
        steps:</p>
        <ol>
          <li>Let <var>input</var> and <var>memory</var> be the corresponding
          inputs defined by the internal structured cloning algorithm,
          where <var>input</var> represents a <code>RTCCertificate</code> object
          to be cloned.</li>

          <li>Let <var>output</var> be a newly
          constructed <code>RTCCertificate</code> object.</li>

          <li>Copy the value of the <code>expires</code> attribute
          from <var>input</var> to <var>output</var>.</li>

          <li>Let the [[<a href="#RTCCertificate-certificate">certificate</a>]]
          internal slot of <var>output</var> be set to the result of invoking
          the internal structured clone algorithm recursively on the
          corresponding internal slots of <var>input</var>, with the slot
          contents as the new "<var>input</var>" argument and <var>memory</var>
          as the new "<var>memory</var>" argument.</li>

          <li>Let the [[<a href="#RTCCertificate-handle">handle</a>]] internal
          slot of <var>output</var> refer to the same private keying material
          represented by the [[<a href="#RTCCertificate-handle">handle</a>]]
          internal slot of <var>input</var>.</li>
        </ol>
      </section>

    </section>
  </section>

  <section property="bibo:hasPart" resource="#rtp-media-api" typeof="bibo:Chapter" id="rtp-media-api">
      <!--OddPage--><h2 resource="#h-rtp-media-api" id="h-rtp-media-api"><span property="xhv:role" resource="xhv:heading"><span class="secno">5. </span>RTP Media API</span></h2>

      <p>The RTP media API lets a web application send and receive <code>MediaStreamTrack</code>s
      over a peer-to-peer connection. Tracks, when added to a <code>RTCPeerConnection</code>, result in
      signaling; when this signaling is forwarded to a remote peer, it causes
      corresponding tracks to be created on the remote side.</p>

      <p>The actual encoding and transmission of <code>MediaStreamTrack</code>s is managed through
      objects called <code>RTCRtpSender</code>s. Similarly, the reception and decoding of
      <code>MediaStreamTrack</code>s is managed through objects called <code>RTCRtpReceiver</code>s.
      Each track to be sent is associated with exactly one <code>RTCRtpSender</code>, and
      each track to be received is associated with exactly one <code>RTCRtpReceiver</code>.</p>

      <p><code>RTCRtpSender</code>s are created when the application attaches a
      <code>MediaStreamTrack</code> to a <code>RTCPeerConnection</code>, via the
      <code>addTrack</code> method. <code>RTCRtpReceiver</code>s, on the other
      hand, are created when remote signaling indicates new tracks are available,
      and each new <code>MediaStreamTrack</code> and its associated <code>RTCRtpReceiver</code>
      are surfaced to the application via the <code>ontrack</code> event.</p>

      <p>A <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object contains a
      <dfn data-dfn-type="dfn" id="senders-set">set of <code>RTCRtpSender</code>s</dfn>, representing tracks to
      be sent, and a <dfn data-dfn-type="dfn" id="receivers-set">set of <code>RTCRtpReceiver</code>s</dfn>,
      representing tracks that are to be received on this
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object, and
      a <dfn data-dfn-type="dfn" id="transceivers-set">set
      of <code>RTCRtpTransceiver</code>s</dfn>, representing the
      paired senders and receiver with some shared state. All of
      these sets are initialized to empty sets when the
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object is created.</p>

      <section property="bibo:hasPart" resource="#rtcpeerconnection-interface-extensions" typeof="bibo:Chapter" id="rtcpeerconnection-interface-extensions">
        <h3 resource="#h-rtcpeerconnection-interface-extensions" id="h-rtcpeerconnection-interface-extensions"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1 </span>RTCPeerConnection Interface Extensions</span></h3>

        <p>The RTP media API extends the
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface as described below.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection-3">partial interface <span class="idlInterfaceID">RTCPeerConnection</span> {
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a>&gt;</span>      <span class="idlMethName"><a href="#widl-RTCPeerConnection-getSenders-sequence-RTCRtpSender">getSenders</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a>&gt;</span>    <span class="idlMethName"><a href="#widl-RTCPeerConnection-getReceivers-sequence-RTCRtpReceiver">getReceivers</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-getTransceivers-sequence-RTCRtpTransceiver">getTransceivers</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></span>                <span class="idlMethName"><a href="#widl-RTCPeerConnection-addTrack-RTCRtpSender-MediaStreamTrack-track-MediaStream-streams">addTrack</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span> <span class="idlParamName">track</span></span>, <span class="idlParam"><span class="idlParamType"><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>...</span> <span class="idlParamName">streams</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                        <span class="idlMethName"><a href="#widl-RTCPeerConnection-removeTrack-void-RTCRtpSender-sender">removeTrack</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></span> <span class="idlParamName">sender</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a></span>           <span class="idlMethName"><a href="#widl-RTCPeerConnection-addTransceiver-RTCRtpTransceiver-MediaStreamTrack-DOMString-trackOrKind-RTCRtpTransceiverInit-init">addTransceiver</a></span> (<span class="idlParam"><span class="idlParamType">(<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a> or DOMString)</span> <span class="idlParamName">trackOrKind</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCRtpTransceiverInit"><code>RTCRtpTransceiverInit</code></a></span> <span class="idlParamName">init</span></span>);</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-RTCPeerConnection-ontrack">ontrack</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-7" typeof="bibo:Chapter" id="attributes-7"><h4 resource="#h-attributes-7" id="h-attributes-7"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCPeerConnection-ontrack"><code>ontrack</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            <p>The event type of this event handler is <code><a href="#event-track">track</a></code>.</p>
          </dd></dl></section><section property="bibo:hasPart" resource="#methods-3" typeof="bibo:Chapter" id="methods-3"><h4 resource="#h-methods-3" id="h-methods-3"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCPeerConnection-addTrack-RTCRtpSender-MediaStreamTrack-track-MediaStream-streams"><code>addTrack</code></dt><dd>
            <p>Adds a new track to the <code>RTCPeerConnection</code>, and indicates that it
              is contained in the specified <code>MediaStream</code>s.</p>

            <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection-addtrack"><code title="">addTrack()</code></dfn> method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em>
            run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>connection</var> be the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object on which the
                <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> <var>track</var>, is to be
                added.</p>
              </li>

              <li>
                <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                is <code>closed</code>, throw an
                <code>InvalidStateError</code> exception and abort these
                steps.</p>
              </li>

              <li>
                <p>If an <code>RTCRtpSender</code> for <var>track</var> already exists in
                <var>connection</var>'s <a href="#senders-set">set of senders</a>,
                throw an <code>InvalidParameter</code> exception and abort these
                steps.</p>
	      </li>

              <li>
                <p>If an <code>RTCRtpSender</code> exists in <var>connection</var>'s set of
                senders that has never been used to send (the corresponding <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> has
                always had a direction of <code>recvonly</code> or <code>inactive</code>),
                then set that sender's <code>.track</code> to <var>track</var> and return
                the sender.</p>

                <p>Doing so will cause future calls to <code>createOffer</code>
                  and <code>createAnswer</code> to mark the corresponding <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a>
                  as <code>sendrecv</code> or <code>sendonly</code>, as defined in
                  [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>].
                </p>.
              </li>

              <li>
                <p>If no such sender exists, create a new <code>RTCRtpTransceiver</code>
                with <code>.sender.track</code> set to <var>track</var>, add it to
                 <var>connection</var>'s set of transceivers, and
                 return <code>.sender</code> to the caller.</p>
              </li>

              <li>
                <p>A track could have contents that are inaccessible to the
                application. This can be due to being marked with a
                <code>peerIdentity</code> option or anything that would make a
                track <a href="http://www.w3.org/html/wg/drafts/html/master/infrastructure.html#cors-cross-origin">
                CORS cross-origin</a>. These tracks can be supplied to the
                <code>addTrack</code> method, and have an <code>RTCRtpSender</code> created for them, but content
                <em title="MUST NOT" class="rfc2119">MUST NOT</em> be transmitted, unless they are also marked with
                <code>peerIdentity</code> and they meet the
                requirements for sending (see <a href="#isolated-pc">
                isolated streams and <code>RTCPeerConnection</code></a>).</p>

                <p>All other tracks that are not accessible to the application
                <em title="MUST NOT" class="rfc2119">MUST NOT</em> be sent to the peer, with silence (audio), black
                frames (video) or equivalently absent content being sent in
                place of track content.</p>

                <p>Note that this property can change over time.</p>
              </li>

              <li>
                <p>Mark <var>connection</var> as needing negotiation.</p>
              </li>
            </ol>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">track</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">streams</td><td class="prmType"><code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code></div></dd><dt id="widl-RTCPeerConnection-addTransceiver-RTCRtpTransceiver-MediaStreamTrack-DOMString-trackOrKind-RTCRtpTransceiverInit-init"><code>addTransceiver</code></dt><dd>
            <p>Create a new <code><a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a></code> and add it to the
            collection of transceivers that will be returned
            by <code><a href="#dom-peerconnection-getreceivers">getReceivers()</a></code>.</p>

            <p>Adding a transceiver will cause future calls to <code>createOffer</code> to
              add a <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> for the corresponding transceiver, as defined in
              [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>].
            </p>.

            <p>If a track is passed in, the value of the <code>.sender.track</code> will
            be set to that track and the MSID and media type generated
            by <code>createOffer</code> will be that of the track.</p>

            <p>If a kind is passed in, the value of the <code>.sender.track</code> will be
            null and and media type generated by <code>createOffer</code> will be that of
            the kind.  The MSID generated by <code>createOffer</code> (if necessary, such
            as when <code>init.send == true</code>) will be selected by the user agent and
            will not be related to any track.  Future calls
            to <code>.sender.replaceTrack</code> with a track of a different kind will fail. Future calls
            will not change the MSID associated with the transceiver.</p>

            <p>If <code>init.sendEncodings</code> is set, then subsequent calls
               to <code>createOffer</code> will be configured to send with multiple RTP encodings as
               defined in [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>].  When <code>setRemoteDescription</code> is called with a
               corresponding remote description that is able to receive multiple RTP encodings as
               defined in [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>], the <code>RTCRtpSender</code> may send multiple RTP
               encodings and the parameters in <code>RTCRtpTransceiver.sender.getParameters()</code>
               will reflect the encodings negotiated.
            </p>

            <p>
              RID values passed into <code>init.sendEncodings</code> must be composed only of
              case-sensitive alphanumeric characters (a-z, A-Z, 0-9) up to a maximum of 16
              characters.
            </p>

          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">trackOrKind</td><td class="prmType"><code>(<a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a> or DOMString)</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">init</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCRtpTransceiverInit"><code>RTCRtpTransceiverInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a></code></div></dd><dt id="widl-RTCPeerConnection-getReceivers-sequence-RTCRtpReceiver"><code>getReceivers</code></dt><dd>
            <p>Returns a sequence of <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> objects
            representing the RTP receivers that are currently attached to this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-getreceivers"><code>getReceivers()</code></dfn>
            method <em title="MUST" class="rfc2119">MUST</em> return a new sequence that represents a snapshot of all
            the <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> objects in this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <a href="#receivers-set">set of receivers</a>. The conversion from
            the receivers set to the sequence, to be returned, is user agent
            defined and the order does not have to be stable between calls.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a>&gt;</code></div></dd><dt id="widl-RTCPeerConnection-getSenders-sequence-RTCRtpSender"><code>getSenders</code></dt><dd>
            <p>Returns a sequence of <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code> objects
            representing the RTP senders that are currently attached to this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-getsenders"><code>getSenders()</code></dfn>
            method <em title="MUST" class="rfc2119">MUST</em> return a new sequence that represents a snapshot of all
            the <code>RTCRtpSenders</code> objects in this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <a href="#senders-set">set of senders</a>. The conversion from the
            senders set to the sequence, to be returned, is user agent defined
            and the order does not have to be stable between calls.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a>&gt;</code></div></dd><dt id="widl-RTCPeerConnection-getTransceivers-sequence-RTCRtpTransceiver"><code>getTransceivers</code></dt><dd>
            <p>Returns a sequence
            of <code><a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a></code> objects
            representing the RTP transeceivers that are currently
            attached to this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

            <p>The <dfn data-dfn-type="dfn" id="dom-peerconnection-gettranseceivers"><code>getTransceivers()</code></dfn>
            method <em title="MUST" class="rfc2119">MUST</em> return a new sequence that represents a snapshot of all
            the <code><a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a></code> objects in this
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <a href="#transceivers-set">set of transeceivers</a>. The
            conversion from the transeceiver set to the sequence, to
            be returned, is user agent defined and the order does not
            have to be stable between calls.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a>&gt;</code></div></dd><dt id="widl-RTCPeerConnection-removeTrack-void-RTCRtpSender-sender"><code>removeTrack</code></dt><dd>
            <p>Stops sending media from <var>sender</var>.  The <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code> will still
            appear in <code>getSenders</code>. Doing so will cause future calls
            to <code>createOffer</code> to mark the <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> for the corresponding
            transceiver as <code>recvonly</code> or <code>inactive</code>, as defined in
            [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>].

            <!-- onended -->
            </p><p>When the other peer stops sending a track in this manner, an
            <code title="event-MediaStreamTrack-ended">ended</code> event is
            fired at the <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> object.</p>

            <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection-removetrack"><code title="">removeTrack()</code></dfn> method is invoked, the user agent
            <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>
                <p>Let <var>connection</var> be the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object on which the
                <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code>, <var>sender</var>, is to be
                stopped.</p>
              </li>

              <li>
                <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                is <code>closed</code>, throw an
                <code>InvalidStateError</code> exception.</p>
              </li>

              <li>
                <p>If <var>sender</var> is <a href="#sender-stopped">stopped</a>
                or not in <var>connection</var>'s
                <a href="#senders-set">set of senders</a>, then abort
                these steps.</p>
              </li>

              <li>
                <p><a href="#sender-stopped">Stop</a> <var>sender</var>.</p>
              </li>

              <li>
                <p>Mark <var>connection</var> as needing negotiation.</p>
              </li>
            </ol>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">sender</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpTransceiverInit">dictionary <span class="idlDictionaryID">RTCRtpTransceiverInit</span> {
<span class="idlMember">             <span class="idlMemberType">boolean</span>                            <span class="idlMemberName"><a href="#widl-RTCRtpTransceiverInit-send">send</a></span> = <span class="idlMemberValue">true</span>;</span>
<span class="idlMember">             <span class="idlMemberType">boolean</span>                            <span class="idlMemberName"><a href="#widl-RTCRtpTransceiverInit-receive">receive</a></span> = <span class="idlMemberValue">true</span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>&gt;</span>              <span class="idlMemberName"><a href="#widl-RTCRtpTransceiverInit-streams">streams</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpEncodingParameters"><code>RTCRtpEncodingParameters</code></a>&gt;</span> <span class="idlMemberName"><a href="#widl-RTCRtpTransceiverInit-sendEncodings">sendEncodings</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtptransceiverinit-members" typeof="bibo:Chapter" id="dictionary-rtcrtptransceiverinit-members"><h4 resource="#h-dictionary-rtcrtptransceiverinit-members" id="h-dictionary-rtcrtptransceiverinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1.3 </span>Dictionary <a href="#idl-def-RTCRtpTransceiverInit" class="idlType"><code>RTCRtpTransceiverInit</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpTransceiverInit-receive"><code>receive</code> of type <span class="idlMemberType">boolean</span>, defaulting to <code>true</code></dt><dd>
            <p>If true, indicates that
            the <code>RTCRtpTransceiver</code>'s <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a>
            will offer to receive RTP and receive RTP if the remote peer accepts.  If
            false, indicates that the <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a> will not offer to
            receive RTP and will not receive RTP (the direction of the <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> generated by
            createOffer will be <code>sendonly</code> or <code>inactive</code>).</p>
          </dd><dt id="widl-RTCRtpTransceiverInit-send"><code>send</code> of type <span class="idlMemberType">boolean</span>, defaulting to <code>true</code></dt><dd>
            <p>If true, indicates that
            the <a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a>'s <a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a>
            will offer to send RTP and send RTP if the remote peer accepts.  If false,
            indicates that the <a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a> will not offer to send RTP
            and will not send RTP (the direction of the <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> generated by createOffer
            will be <code>recvonly</code> or <code>inactive</code>).</p>
          </dd><dt id="widl-RTCRtpTransceiverInit-sendEncodings"><code>sendEncodings</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpEncodingParameters"><code>RTCRtpEncodingParameters</code></a>&gt;</span></dt><dd>
            <p>A sequence containing parameters for sending RTP
            encodings of media.</p>
          </dd><dt id="widl-RTCRtpTransceiverInit-streams"><code>streams</code> of type <span class="idlMemberType">sequence&lt;<a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>&gt;</span></dt><dd>
	    <p>When the remote PeerConnection's ontrack event fires
	    corresponding to the <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a>
	    being added, these are the streams that will be put in the
	    event.
	    </p>
	  </dd></dl></section>

        <section property="bibo:hasPart" resource="#processing-remote-mediastreamtracks" typeof="bibo:Chapter" id="processing-remote-mediastreamtracks">
          <h4 resource="#h-processing-remote-mediastreamtracks" id="h-processing-remote-mediastreamtracks"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1.4 </span>Processing Remote MediaStreamTracks</span></h4>

          <p>Rejection of incoming <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> objects
          can be done by the application, after receiving the track, by stopping
          it.</p>

          <p>To <dfn data-dfn-type="dfn" id="dispatch-receiver">dispatch a receiver</dfn> for an
          incoming media description [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>], the user agent <em title="MUST" class="rfc2119">MUST</em> run
          the following steps:

          </p><ol>
            <li>
              <p>Let <var>connection</var> be the
              <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> expecting this media.</p>
            </li>

            <li>
              <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
              is <code>closed</code>, abort these
              steps.</p>
            </li>

            <li>
              <p>Let <var>streams</var> be a list of <code>
              <a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code> objects that the sender indicated the
              sent <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> being a part of. The
              information needed to collect these objects is part of the media
              description.</p>
            </li>

            <li>
              <p>Run the following steps to create a track
              representing the incoming media description:</p>

              <ol>
                <li>
                  <p>Create a <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> object
                  <var>track</var> to represent the media description.</p>
                </li>

                <li>
                  <p>Initialize <code><var>track</var>.kind</code>
                  attribute to <code>audio</code> or <code>video</code>
                  depending on the media type of the media description.</p>
                </li>

                <li>
                  <p>Initialize <code><var>track</var>.id</code>
                  attribute to the media description track id.</p>
                </li>

                <li>
                  <p>Initialize <code><var>track</var>.label</code>
                  attribute to <code>remote audio</code> or <code>remote
                  video</code> depending on the media type of the media
                  description.</p>
                </li>

                <li>
                  <p>Initialize <code><var>track</var>.readyState</code>
                  attribute to <code>live</code>.</p>
                </li>

                <li>
                  <p>Initialize <code><var>track</var>.muted</code>
                  attribute to <code>true</code>. See the <a href="#mediastreamtrack"><code>MediaStreamTrack</code></a> section about how
                  the <code>muted</code> attribute reflects if a
                  <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> is receiving media data
                  or not.</p>
                </li>

              </ol>
            </li>

            <li>
              <p>Add <var>track</var> to all <code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code>
              objects in <var>streams</var>.</p>

              <div class="note"><div id="h-note5" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><p class="">This will result in an addtrack event being fired
              at each MediaStream as described in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>].</p></div>
            </li>

            <li>
              <p>Create a new <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> object
              <var>receiver</var> for <var>track</var>, and add it
                to <var>connection</var>'s <a href="#receivers-set">set of receivers</a>.</p>
            </li>

            <li>
              <p>Fire an event named
              <code title="event-track"><a href="#event-track">track</a></code> with
              <var>transceiver</var>, <var>track</var>, and <var>streams</var>
              at the <var title="">connection</var> object.</p>
            </li>
          </ol>

          <p>When an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> finds that a track
          from the remote peer has been removed, the user agent <em title="MUST" class="rfc2119">MUST</em> follow these
          steps:</p>

          <ol>
            <li>
              <p>Let <var>connection</var> be the
              <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> associated with the track
              being removed.</p>
            </li>

            <li>
              <p>Let <var>track</var> be the <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code>
              object that represents the track being removed, if any. If
              there isn't one, then abort these steps.</p>
            </li>

            <li>
              <p>By definition, <var>track</var> is now ended.</p>

              <div class="note"><div id="h-note6" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><p class="">A task is thus
              <span title="queue a task">queued</span> to update
              <var>track</var> and fire an event.</p></div>
            </li>

            <li>
              <p>Queue a task to run the following substeps:</p>

              <ol>
                <li>
                  <p>If <var>connection</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a>
                  is <code>closed</code>, abort these
                  steps.</p>
                </li><!-- close() was probably called just before this
           task ran -->

                <li>
                  <p>Remove the <code>RTCRtpReceiver</code> associated with <var>track</var> from
                  <var>connection</var>'s <a href="#receivers-set">set of receivers</a>.</p>
                </li>
              </ol>
            </li>
          </ol>

          <div class="issue"><div id="h-issue8" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><div class="">
            <p>Since the beginning of this specification, remote MediaStreamTracks have been
            created by the setRemoteDescription call, one track for each non-rejected
            <a data-link-type="dfn" class="internalDFN" href="#dfn-media-description">media description</a> in the remote description. This meant that at the caller,
            MediaStreamTracks were not created until the answer was received, and any media
            received prior to a remote description (AKA "early media") would be discarded.
            If any form of remote description is provided (either an answer or a pranswer),
            this issue does not occur.</p>

            <p>If we want to allow early media to be played out, minor changes are necessary.
            Fundamentally, we would need to change when tracks are created
            for the offerer; this would have to happen either as a result of setLocalDescription,
            or when media packets are received. This ensures that these objects can be created and
            connected to media elements for playout.</p>

            <p>However, there are three consequences to this potential change:</p>
              <ol>
                <li>Media may arrive before the remote DTLS fingerprint has been received.
                This means that media could be played out before the validity of the
                DTLS fingerprint has been established, which may be hard to explain to users.
                As such, it is recommended that media not be played out unless some
                TBD RTCConfiguration property (e.g. AllowUnverifiedMedia) has been set.
                </li>
                <li>The information needed to correlate MediaStreamTracks with their
                enclosing MediaStreams will not yet be present when the tracks are
                initially generated. Therefore, the implementation will need to
                create dummy MediaStream objects for each MediaStreamTrack, and then
                possibly change the associated MediaStream for each track when the
                remote description is received (e.g. if it indicates that an audio
                and video MediaStreamTrack should be combined into a single MediaStream).
                Since media elements act on MediaStreams, some complex reshuffling may
                need to occur when the remote description is received.
                </li>
                <li>The track events fired and their timing will change.
                For the offerer, ontrack will now fire during setLocalDescription,
                once for each track being offered, and track.onended will fire during
                setRemoteDescription for any offered tracks that were rejected.
                For the answerer, ontrack will continue to fire during setRemoteDescription,
                as it does today (this is necessary to allow the answerer to reject
                offered tracks by stopping them).
                </li>
              </ol>

            <p>For now, we simply make note of this issue, until it can be
            considered fully by the WG.</p>
          </div></div>

        </section>
      </section>

      <section property="bibo:hasPart" resource="#rtcrtpsender-interface" typeof="bibo:Chapter" id="rtcrtpsender-interface">
        <h3 resource="#h-rtcrtpsender-interface" id="h-rtcrtpsender-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2 </span>RTCRtpSender Interface</span></h3>

        <p>The <code>RTCRtpSender</code> interface allows an application to control how a given
        <code>MediaStreamTrack</code> is encoded and transmitted to a remote peer.
        When <code>setParameters</code> is called is on an <code>RTCRtpSender</code> object,
        the encoding is changed appropriately.</p>

        <p>An <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code> can be <dfn data-dfn-type="dfn" id="sender-stopped">stopped</dfn>, which indicates that it will no longer
        send any media.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCRtpSender">interface <span class="idlInterfaceID">RTCRtpSender</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>  <span class="idlAttrName"><a href="#widl-RTCRtpSender-track">track</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>  <span class="idlAttrName"><a href="#widl-RTCRtpSender-transport">transport</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCRtpSender-rtcpTransport">rtcpTransport</a></span>;</span>
<span class="idlMethod">    static <span class="idlMethType"><a class="idlType" href="#idl-def-RTCRtpCapabilities"><code>RTCRtpCapabilities</code></a></span> <span class="idlMethName"><a href="#widl-RTCRtpSender-getCapabilities-RTCRtpCapabilities-DOMString-kind">getCapabilities</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">kind</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span>                      <span class="idlMethName"><a href="#widl-RTCRtpSender-setParameters-void-RTCRtpParameters-parameters">setParameters</a></span> (<span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCRtpParameters"><code>RTCRtpParameters</code></a></span> <span class="idlParamName">parameters</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCRtpParameters"><code>RTCRtpParameters</code></a></span>          <span class="idlMethName"><a href="#widl-RTCRtpSender-getParameters-RTCRtpParameters">getParameters</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;void&gt;</span>             <span class="idlMethName"><a href="#widl-RTCRtpSender-replaceTrack-Promise-void--MediaStreamTrack-withTrack">replaceTrack</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span> <span class="idlParamName">withTrack</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-8" typeof="bibo:Chapter" id="attributes-8"><h4 resource="#h-attributes-8" id="h-attributes-8"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCRtpSender-rtcpTransport"><code>rtcpTransport</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>, readonly       , nullable</dt><dd>
            <p>The <code id="dom-rtpsender-rtcptransport">rtcpTransport</code>
            attribute is the transport over which RTCP is sent and
            received.  When BUNDLE is used,
            many <code>RTCRtpSender</code> objects will share
            one <code>rtcpTransport</code> and will all
            send and receive RTCP over the same transport.  When RTCP
            mux is used, <code>rtcpTransport</code> will
            be null, and both RTP and RTCP traffic will flow
            over the transport described by <code>transport</code>.
          </p></dd><dt id="widl-RTCRtpSender-track"><code>track</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>, readonly       </dt><dd>
            <p>The <code id="dom-rtpsender-track">track</code>
            attribute is the track that is associated with this
            <code>RTCRtpSender</code> object.</p>
          </dd><dt id="widl-RTCRtpSender-transport"><code>transport</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>, readonly       </dt><dd>
            <p>The <code id="dom-rtpsender-transport">transport</code>
            attribute is the transport over which media from
            <code>track</code> is sent in the form of RTP
            packets.  When BUNDLE is used,
            many <code>RTCRtpSender</code> objects will share
            one <code>transport</code> and will all send
            RTP over the same transport.  When RTCP mux is
            used, <code>rtcpTransport</code> will be
            null, and both RTP and RTCP traffic will flow
            over the transport described by <code>transport</code>.
          </p></dd></dl></section><section property="bibo:hasPart" resource="#methods-4" typeof="bibo:Chapter" id="methods-4"><h4 resource="#h-methods-4" id="h-methods-4"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCRtpSender-getCapabilities-RTCRtpCapabilities-DOMString-kind"><code>getCapabilities</code>, static</dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-rtpsender-getcapabilities"><code>RTCRtpSender.getCapabilities</code></dfn>
            method returns the most optimistic view of the capabilities
            of the system for sending media of the given kind. It does
            not reserve any resources, ports, or other state but is
            meant to provide a way to discover the types of
            capabilities of the browser including which codecs may be
            supported.
            </p>
            <p class="fingerprint">These capabilities provide
            generally persistent cross-origin information on the
            device and thus increases the fingerprinting surface of
            the application. In privacy-sensitive contexts, browsers
            can consider mitigations such as reporting only a common subset
            of the capabilities.<img alt="(This is a fingerprinting vector.)" src="images/fingerprint.png" height="21" width="15"></p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">kind</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCRtpCapabilities"><code>RTCRtpCapabilities</code></a></code></div></dd><dt id="widl-RTCRtpSender-getParameters-RTCRtpParameters"><code>getParameters</code></dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-rtpsender-getparameters"><code>getParameters</code></dfn>
            method returns the <code>RTCRtpSender</code> object's current parameters for how <code>track</code>
            is encoded and transmitted to a remote <code>RTCRtpReceiver</code>.
            It may used with <code>setParameters</code> to change the parameters in the follwing way:</p>

            <div class="example"><div class="example-title marker"><span>Example 2</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> </span><span class="kwd">params</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> sender</span><span class="pun">.</span><span class="pln">getParameters</span><span class="pun">();</span><span class="pln">
</span><span class="com">// ... make changes to RTCRtpParameters</span><span class="pln">
</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">encodings</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">active </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">
sender</span><span class="pun">.</span><span class="pln">setParameters</span><span class="pun">(</span><span class="kwd">params</span><span class="pun">)</span></pre></div>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCRtpParameters"><code>RTCRtpParameters</code></a></code></div></dd><dt id="widl-RTCRtpSender-replaceTrack-Promise-void--MediaStreamTrack-withTrack"><code>replaceTrack</code></dt><dd>
            <p>Attempts to replace the track being sent with another track
            provided, without renegotiation.</p>

            <p>To avoid track identifiers changing on the remote receiving end
            when a track is replaced, the sender <em title="MUST" class="rfc2119">MUST</em> retain the original track
            identifier and stream associations and use these in subsequent
            negotiations.</p>

            <p>When the <dfn data-dfn-type="dfn" id="dom-rtpsender-replacetrack">
            <code>replaceTrack()</code></dfn> method is invoked, the user agent
            <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

            <ol>
              <li>Let <var>sender</var> be the <code>RTCRtpSender</code> object on which <code>replaceTrack</code> is invoked.</li>

              <li>
                <p>Let <var>connection</var> be the <code>
                <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object that created
                <var>sender</var>.</p>
              </li>

              <li>
                <p>If <var>sender</var> is <a href="#sender-stopped">stopped</a>, return a promise rejected with an
                <code>InvalidStateError</code>.</p>
              </li>

              <li>
                <p>Let <var>withTrack</var> be the argument to this method.</p>
              </li>

              <li>
                <p>If <code><var>withTrack</var>.kind</code> differs
                from the <code><var>sender</var>.<a href="#dom-rtpsender-track">track</a>.kind</code>,
                return a promise rejected with a <code>TypeError</code>.</p>
              </li>

              <li>
                <p>Let <var>localDescription</var> be <var>connection</var>'s
                <code><a href="#dom-peerconnection-pendinglocaldesc">pendingLocalDescription</a></code> if not null, otherwise
                <var>connection</var>'s <code><a href="#dom-peerconnection-currentlocaldesc">currentLocalDescription</a></code>.</p>
              </li>

              <li>
                <p>If <var>sender</var> is not represented in
                <var>localDescription</var>, then set <var>sender</var>'s
                <code><a href="#dom-rtpsender-track">track</a></code> attribute
                to <var>withTrack</var>, and resolve <var>p</var> with
                <code>undefined</code>.</p>
              </li>

              <li>
                <p>Let <var>p</var> be a new promise.</p>
              </li>

              <li>
                <p>Run the following steps in parallel:</p>

                <ol>
                  <li>
                    <p>Determine if negotiation is needed to transmit
                    <var>withTrack</var> in place of the sender's existing track.
                    Ignore which <code>MediaStream</code> the track resides in and
                    the <code>id</code> attribute of the track in this
                    determination. If negotiation is needed, then reject
                    <var>p</var> with <code>InvalidModificationError</code>
                    and abort these steps.</p>
                  </li>
                  <li>
                    <p>Have the sender switch seamlessly to transmitting
                    <var>withTrack</var> in place of what it is sending, without
                    negotiating.</p>
                  </li>
                  <li>
                    <p>Queue a task that sets <var>sender</var>'s <code><a href="#dom-rtpsender-track">track</a></code> attribute to
                    <var>withTrack</var>, and resolves <var>p</var> with
                    <code>undefined</code>.</p>
                  </li>
                </ol>
              </li>
              <li>
                <p>Return <var>p</var>.</p>
              </li>
            </ol>

            <div class="note"><div id="h-note7" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><div class="">
              <p>Changing dimensions and/or frame rates might not require
              negotiation. Cases that may require negotiation include:</p>
              <ol>
                <li>Changing a resolution to a value outside of the negotiated
                imageattr bounds, as described in [<cite><a href="#bib-RFC6236" class="bibref">RFC6236</a></cite>].
                </li>
                <li>Changing a frame rate to a value that causes the block rate
                for the codec to be exceeded.
                </li>
                <li>A video track differing in raw vs. pre-encoded format.</li>
                <li>An audio track having a different number of channels.</li>
                <li>Sources that also encode (typically hardware encoders) might
                be unable to produce the negotiated codec; similarly, software
                sources might not implement the codec that was negotiated for an
                encoding source.</li>
              </ol>
            </div></div>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">withTrack</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;void&gt;</code></div></dd><dt id="widl-RTCRtpSender-setParameters-void-RTCRtpParameters-parameters"><code>setParameters</code></dt><dd>
            <p>The <code id="dom-rtpsender-setparameters">setParameters</code>
            method updates how <code>track</code> is encoded and transmitted to a remote peer.

            </p><p>If any parameter in the <var>parameters</var> argument, marked
            as a <dfn id="dfn-read-only-parameter" data-dfn-type="dfn">Read-only parameter</dfn>, has a value that is different
            from the corresponding parameter value returned from <code><a href="#dom-rtpsender-getparameters">getParameters()</a></code>, the user
            agent <em title="MUST" class="rfc2119">MUST</em> throw a <code>ReadOnlyError</code> exception and abort
            this operation without updating the current parameters.</p>

            <p>If codecs are reordered, the new order indicates the
            preference for sending, with the first codec being the
            codec with highest preference.  If a codec is removed,
            that codec will not be used to send.  The effect of
            reordering or removing codecs lasts until the codecs are
            renegotiated.  After the codecs are renegotiated, they are
            set to the value negotiated, and <code>setParameters</code> needs to be
            called again to re-apply codec preferences.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">parameters</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCRtpParameters"><code>RTCRtpParameters</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpParameters">dictionary <span class="idlDictionaryID">RTCRtpParameters</span> {
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpEncodingParameters"><code>RTCRtpEncodingParameters</code></a>&gt;</span>        <span class="idlMemberName"><a href="#widl-RTCRtpParameters-encodings">encodings</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpHeaderExtensionParameters"><code>RTCRtpHeaderExtensionParameters</code></a>&gt;</span> <span class="idlMemberName"><a href="#widl-RTCRtpParameters-headerExtensions">headerExtensions</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtcpParameters"><code>RTCRtcpParameters</code></a></span>                         <span class="idlMemberName"><a href="#widl-RTCRtpParameters-rtcp">rtcp</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpCodecParameters"><code>RTCRtpCodecParameters</code></a>&gt;</span>           <span class="idlMemberName"><a href="#widl-RTCRtpParameters-codecs">codecs</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCDegradationPreference"><code>RTCDegradationPreference</code></a></span>                  <span class="idlMemberName"><a href="#widl-RTCRtpParameters-degradationPreference">degradationPreference</a></span> = <span class="idlMemberValue">"balanced"</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpparameters-members" typeof="bibo:Chapter" id="dictionary-rtcrtpparameters-members"><h4 resource="#h-dictionary-rtcrtpparameters-members" id="h-dictionary-rtcrtpparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.3 </span>Dictionary <a href="#idl-def-RTCRtpParameters" class="idlType"><code>RTCRtpParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpParameters-codecs"><code>codecs</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpCodecParameters"><code>RTCRtpCodecParameters</code></a>&gt;</span></dt><dd>
            <p>A sequence containing the codecs that
              an <a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a> will choose from in
              order to send media.</p>
          </dd><dt id="widl-RTCRtpParameters-degradationPreference"><code>degradationPreference</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCDegradationPreference"><code>RTCDegradationPreference</code></a></span>, defaulting to <code>"balanced"</code></dt><dd>
            <p>When bandwidth is constrained and
              the <code>RtpSender</code> needs to choose between
              degrading resolution or degrading
              framerate, <code>degradationPreference</code> indicates which is preferred.
            </p>
          </dd><dt id="widl-RTCRtpParameters-encodings"><code>encodings</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpEncodingParameters"><code>RTCRtpEncodingParameters</code></a>&gt;</span></dt><dd>
            <p>A sequence containing parameters for RTP encodings of media.</p>
          </dd><dt id="widl-RTCRtpParameters-headerExtensions"><code>headerExtensions</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpHeaderExtensionParameters"><code>RTCRtpHeaderExtensionParameters</code></a>&gt;</span></dt><dd>
            <p>A sequence containing parameters for RTP header extensions.</p>
          </dd><dt id="widl-RTCRtpParameters-rtcp"><code>rtcp</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtcpParameters"><code>RTCRtcpParameters</code></a></span></dt><dd>
            <p>Parameters used for RTCP.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpEncodingParameters">dictionary <span class="idlDictionaryID">RTCRtpEncodingParameters</span> {
<span class="idlMember">             <span class="idlMemberType">unsigned long</span>    <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-ssrc">ssrc</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtxParameters"><code>RTCRtxParameters</code></a></span> <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-rtx">rtx</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCFecParameters"><code>RTCFecParameters</code></a></span> <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-fec">fec</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">boolean</span>          <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-active">active</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCPriorityType"><code>RTCPriorityType</code></a></span>  <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-priority">priority</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned long</span>    <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-maxBitrate">maxBitrate</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned long</span>    <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-maxFramerate">maxFramerate</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>        <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-rid">rid</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">double</span>           <span class="idlMemberName"><a href="#widl-RTCRtpEncodingParameters-scaleResolutionDownBy">scaleResolutionDownBy</a></span> = <span class="idlMemberValue">1.0</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpencodingparameters-members" typeof="bibo:Chapter" id="dictionary-rtcrtpencodingparameters-members"><h4 resource="#h-dictionary-rtcrtpencodingparameters-members" id="h-dictionary-rtcrtpencodingparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.4 </span>Dictionary <a href="#idl-def-RTCRtpEncodingParameters" class="idlType"><code>RTCRtpEncodingParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpEncodingParameters-active"><code>active</code> of type <span class="idlMemberType">boolean</span></dt><dd>
            <p>
              Indicates that this encoding is actively being sent.
              Setting it to false causes this encoding to no longer be sent.
              Setting it to true causes this encoding to be sent.
            </p>
          </dd><dt id="widl-RTCRtpEncodingParameters-fec"><code>fec</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCFecParameters"><code>RTCFecParameters</code></a></span></dt><dd>
            <p>The parameters used for FEC, or unset if FEC is not being used.</p>
          </dd><dt id="widl-RTCRtpEncodingParameters-maxBitrate"><code>maxBitrate</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
            <p>
              Indicates the maximum bitrate that can be used to send
              this encoding.  The encoding may also be further
              constrained by other limits (such as maxFramerate or
              per-transport or per-session bandwidth limits) below the maximum
              specified here.  maxBitrate is the Transport Independent Application Specific Maximum (TIAS)  
              bandwidth defined in [<cite><a href="#bib-RFC3890" class="bibref">RFC3890</a></cite>] Section 6.2.2, which is the maximum bandwidth needed without 
              counting IP or other transport layers like TCP or UDP.
           </p>
          </dd><dt id="widl-RTCRtpEncodingParameters-maxFramerate"><code>maxFramerate</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
            <p>
              Indicates the maximum framerate that can be used to send
              this encoding.
           </p>
          </dd><dt id="widl-RTCRtpEncodingParameters-priority"><code>priority</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCPriorityType"><code>RTCPriorityType</code></a></span></dt><dd>
            <p>
             Indicates the priority of this encoding.  It is specified
             in [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>], Section 4.
            </p>
          </dd><dt id="widl-RTCRtpEncodingParameters-rid"><code>rid</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p> If set, this RTP encoding will be sent with the RID header extension as defined by
              [<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>].
            </p>
          </dd><dt id="widl-RTCRtpEncodingParameters-rtx"><code>rtx</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtxParameters"><code>RTCRtxParameters</code></a></span></dt><dd>
            <p>The parameters used for RTX, or unset if RTX is not being used.</p>
          </dd><dt id="widl-RTCRtpEncodingParameters-scaleResolutionDownBy"><code>scaleResolutionDownBy</code> of type <span class="idlMemberType">double</span>, defaulting to <code>1.0</code></dt><dd>
            <p>If the sender's <code>kind</code> is "video", the video's resolution will
            be scaled down in each dimension by the given value before sending.  For
            example, if the value is 2.0, the video will be scaled down by a factor of 2
            in each dimension, resulting in sending a video of one quarter the size.  If
            the value is 1.0, the video will not be affected.  The value must be greater
            than 0.</p>
          </dd><dt id="widl-RTCRtpEncodingParameters-ssrc"><code>ssrc</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
            <p>
              The SSRC of the RTP source stream of this encoding
              (non-RTX, non-FEC RTP stream). <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
            </p>
          </dd></dl></section>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCDegradationPreference">enum <span class="idlEnumID">RTCDegradationPreference</span> {
    "<a href="#idl-def-RTCDegradationPreference.maintain-framerate" class="idlEnumItem">maintain-framerate</a>",
    "<a href="#idl-def-RTCDegradationPreference.maintain-resolution" class="idlEnumItem">maintain-resolution</a>",
    "<a href="#idl-def-RTCDegradationPreference.balanced" class="idlEnumItem">balanced</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCDegradationPreference.maintain-framerate">maintain-framerate</code></td><td>
            <p>Degrade resolution in order to maintain framerate.</p>
          </td></tr><tr><td><code id="idl-def-RTCDegradationPreference.maintain-resolution">maintain-resolution</code></td><td>
            <p>Degrade framerate in order to maintain resolution.</p>
          </td></tr><tr><td><code id="idl-def-RTCDegradationPreference.balanced">balanced</code></td><td>
            <p>Degrade a balance of framerate and resolution.</p>
          </td></tr></tbody></table>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtxParameters">dictionary <span class="idlDictionaryID">RTCRtxParameters</span> {
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCRtxParameters-ssrc">ssrc</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtxparameters-members" typeof="bibo:Chapter" id="dictionary-rtcrtxparameters-members"><h4 resource="#h-dictionary-rtcrtxparameters-members" id="h-dictionary-rtcrtxparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.5 </span>Dictionary <a href="#idl-def-RTCRtxParameters" class="idlType"><code>RTCRtxParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtxParameters-ssrc"><code>ssrc</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
            <p>
              The SSRC of the RTP stream for RTX. <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
            </p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCFecParameters">dictionary <span class="idlDictionaryID">RTCFecParameters</span> {
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCFecParameters-ssrc">ssrc</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcfecparameters-members" typeof="bibo:Chapter" id="dictionary-rtcfecparameters-members"><h4 resource="#h-dictionary-rtcfecparameters-members" id="h-dictionary-rtcfecparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.6 </span>Dictionary <a href="#idl-def-RTCFecParameters" class="idlType"><code>RTCFecParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCFecParameters-ssrc"><code>ssrc</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
            <p>
              The SSRC of the RTP stream for FEC. <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
            </p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtcpParameters">dictionary <span class="idlDictionaryID">RTCRtcpParameters</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCRtcpParameters-cname">cname</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">boolean</span>   <span class="idlMemberName"><a href="#widl-RTCRtcpParameters-reducedSize">reducedSize</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtcpparameters-members" typeof="bibo:Chapter" id="dictionary-rtcrtcpparameters-members"><h4 resource="#h-dictionary-rtcrtcpparameters-members" id="h-dictionary-rtcrtcpparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.7 </span>Dictionary <a href="#idl-def-RTCRtcpParameters" class="idlType"><code>RTCRtcpParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtcpParameters-cname"><code>cname</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>The Canonical Name (CNAME) used by RTCP (e.g. in SDES
              messages). <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
          </p></dd><dt id="widl-RTCRtcpParameters-reducedSize"><code>reducedSize</code> of type <span class="idlMemberType">boolean</span></dt><dd>
            <p>Whether reduced size RTCP [<cite><a href="#bib-RFC5506" class="bibref">RFC5506</a></cite>] is configured (if
            true) or compound RTCP as specified in [<cite><a href="#bib-RFC3550" class="bibref">RFC3550</a></cite>] (if
            false). <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
          </p></dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpHeaderExtensionParameters">dictionary <span class="idlDictionaryID">RTCRtpHeaderExtensionParameters</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCRtpHeaderExtensionParameters-uri">uri</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCRtpHeaderExtensionParameters-id">id</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">boolean</span>        <span class="idlMemberName"><a href="#widl-RTCRtpHeaderExtensionParameters-encrypted">encrypted</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpheaderextensionparameters-members" typeof="bibo:Chapter" id="dictionary-rtcrtpheaderextensionparameters-members"><h4 resource="#h-dictionary-rtcrtpheaderextensionparameters-members" id="h-dictionary-rtcrtpheaderextensionparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.8 </span>Dictionary <a href="#idl-def-RTCRtpHeaderExtensionParameters" class="idlType"><code>RTCRtpHeaderExtensionParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpHeaderExtensionParameters-encrypted"><code>encrypted</code> of type <span class="idlMemberType">boolean</span></dt><dd>
            <p>
              Whether the header extension is encryted or not.
              <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
            </p>
          </dd><dt id="widl-RTCRtpHeaderExtensionParameters-id"><code>id</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>
            <p>
              The value put in the RTP packet to identify the header
              extension. <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
            </p>
          </dd><dt id="widl-RTCRtpHeaderExtensionParameters-uri"><code>uri</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>
              The URI of the RTP header extension, as defined in
              [<cite><a href="#bib-RFC5285" class="bibref">RFC5285</a></cite>]. <a data-link-type="dfn" class="internalDFN" href="#dfn-read-only-parameter">Read-only parameter</a>.
            </p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpCodecParameters">dictionary <span class="idlDictionaryID">RTCRtpCodecParameters</span> {
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCRtpCodecParameters-payloadType">payloadType</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCRtpCodecParameters-mimeType">mimeType</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned long</span>  <span class="idlMemberName"><a href="#widl-RTCRtpCodecParameters-clockRate">clockRate</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCRtpCodecParameters-channels">channels</a></span> = <span class="idlMemberValue">1</span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCRtpCodecParameters-sdpFmtpLine">sdpFmtpLine</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpcodecparameters-members" typeof="bibo:Chapter" id="dictionary-rtcrtpcodecparameters-members"><h4 resource="#h-dictionary-rtcrtpcodecparameters-members" id="h-dictionary-rtcrtpcodecparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.9 </span>Dictionary <a href="#idl-def-RTCRtpCodecParameters" class="idlType"><code>RTCRtpCodecParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpCodecParameters-channels"><code>channels</code> of type <span class="idlMemberType">unsigned short</span>, defaulting to <code>1</code></dt><dd>
            <p>The number of channels (mono=1, stereo=2).</p>
          </dd><dt id="widl-RTCRtpCodecParameters-clockRate"><code>clockRate</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
            <p>The codec clock rate expressed in Hertz.</p>
          </dd><dt id="widl-RTCRtpCodecParameters-mimeType"><code>mimeType</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>The codec MIME type. Valid types are listed in [<cite><a href="#bib-IANA-RTP-2" class="bibref">IANA-RTP-2</a></cite>].</p>
          </dd><dt id="widl-RTCRtpCodecParameters-payloadType"><code>payloadType</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>
            <p>The RTP payload type.  This value can be set in the
            RTCRtpParameters.encodings[0].payloadType to control which
            codec should be used to send a given encoding.
            </p>
          </dd><dt id="widl-RTCRtpCodecParameters-sdpFmtpLine"><code>sdpFmtpLine</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>The a=fmtp line in the SDP corresponding to the codec,
            as defined by <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.6">section 5.6.</a>)</span>.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpCapabilities">dictionary <span class="idlDictionaryID">RTCRtpCapabilities</span> {
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpCodecCapability"><code>RTCRtpCodecCapability</code></a>&gt;</span>           <span class="idlMemberName"><a href="#widl-RTCRtpCapabilities-codecs">codecs</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpHeaderExtensionCapability"><code>RTCRtpHeaderExtensionCapability</code></a>&gt;</span> <span class="idlMemberName"><a href="#widl-RTCRtpCapabilities-headerExtensions">headerExtensions</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpcapabilities-members" typeof="bibo:Chapter" id="dictionary-rtcrtpcapabilities-members"><h4 resource="#h-dictionary-rtcrtpcapabilities-members" id="h-dictionary-rtcrtpcapabilities-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.10 </span>Dictionary <a href="#idl-def-RTCRtpCapabilities" class="idlType"><code>RTCRtpCapabilities</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpCapabilities-codecs"><code>codecs</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpCodecCapability"><code>RTCRtpCodecCapability</code></a>&gt;</span></dt><dd>
            <p>
              Supported codecs.
            </p>
          </dd><dt id="widl-RTCRtpCapabilities-headerExtensions"><code>headerExtensions</code> of type <span class="idlMemberType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpHeaderExtensionCapability"><code>RTCRtpHeaderExtensionCapability</code></a>&gt;</span></dt><dd>
            <p>
              Supported RTP header extensions.
            </p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpCodecCapability">dictionary <span class="idlDictionaryID">RTCRtpCodecCapability</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCRtpCodecCapability-mimeType">mimeType</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpcodeccapability-members" typeof="bibo:Chapter" id="dictionary-rtcrtpcodeccapability-members"><h4 resource="#h-dictionary-rtcrtpcodeccapability-members" id="h-dictionary-rtcrtpcodeccapability-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.11 </span>Dictionary <a href="#idl-def-RTCRtpCodecCapability" class="idlType"><code>RTCRtpCodecCapability</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpCodecCapability-mimeType"><code>mimeType</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>The codec MIME type. Valid types are listed in [<cite><a href="#bib-IANA-RTP-2" class="bibref">IANA-RTP-2</a></cite>].
            </p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRtpHeaderExtensionCapability">dictionary <span class="idlDictionaryID">RTCRtpHeaderExtensionCapability</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCRtpHeaderExtensionCapability-uri">uri</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpheaderextensioncapability-members" typeof="bibo:Chapter" id="dictionary-rtcrtpheaderextensioncapability-members"><h4 resource="#h-dictionary-rtcrtpheaderextensioncapability-members" id="h-dictionary-rtcrtpheaderextensioncapability-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.12 </span>Dictionary <a href="#idl-def-RTCRtpHeaderExtensionCapability" class="idlType"><code>RTCRtpHeaderExtensionCapability</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRtpHeaderExtensionCapability-uri"><code>uri</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
            <p>The URI of the RTP header extension, as defined in [<cite><a href="#bib-RFC5285" class="bibref">RFC5285</a></cite>].
            </p>
          </dd></dl></section>

      </section>

      <section property="bibo:hasPart" resource="#rtcrtpreceiver-interface" typeof="bibo:Chapter" id="rtcrtpreceiver-interface">
        <h3 resource="#h-rtcrtpreceiver-interface" id="h-rtcrtpreceiver-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.3 </span>RTCRtpReceiver Interface</span></h3>

        <p>The <code>RTCRtpReceiver</code> interface allows an
        application to control the receipt of a
        <code>MediaStreamTrack</code>. When attributes on an
        <code>RTCRtpReceiver</code> are modified, a negotiation is
        triggered to signal the changes regarding what the application
        wants to receive to the other side.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCRtpReceiver">interface <span class="idlInterfaceID">RTCRtpReceiver</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>  <span class="idlAttrName"><a href="#widl-RTCRtpReceiver-track">track</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>  <span class="idlAttrName"><a href="#widl-RTCRtpReceiver-transport">transport</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCRtpReceiver-rtcpTransport">rtcpTransport</a></span>;</span>
<span class="idlMethod">    static <span class="idlMethType"><a class="idlType" href="#idl-def-RTCRtpCapabilities"><code>RTCRtpCapabilities</code></a></span>          <span class="idlMethName"><a href="#widl-RTCRtpReceiver-getCapabilities-RTCRtpCapabilities-DOMString-kind">getCapabilities</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">kind</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpContributingSource"><code>RTCRtpContributingSource</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCRtpReceiver-getContributingSources-sequence-RTCRtpContributingSource">getContributingSources</a></span> ();</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-9" typeof="bibo:Chapter" id="attributes-9"><h4 resource="#h-attributes-9" id="h-attributes-9"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.3.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCRtpReceiver-rtcpTransport"><code>rtcpTransport</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>, readonly       , nullable</dt><dd> <p>The <dfn data-dfn-type="dfn" id="dom-rtpreceiver-rtcptransport"><code>RTCRtpReceiver.rtcpTransport</code></dfn>
            attribute is the transport over which RTCP is sent and
            received.  When BUNDLE is used, many
            <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> objects will share one
            <code>RTCRtpReceiver.rtcpTransport</code> and will all
            send and receive RTCP over the same transport.  When RTCP
            mux is used, <code>RTCRtpReceiver.rtcpTransport</code>
            will be null, and both RTP and RTCP traffic will flow over
            <code>RTCRtpReceiver.transport</code>.  </p></dd><dt id="widl-RTCRtpReceiver-track"><code>track</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-rtpreceiver-track"><code>RTCRtpReceiver.track</code></dfn>
            attribute is the track that is immutably associated with this
            <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> object.</p>
          </dd><dt id="widl-RTCRtpReceiver-transport"><code>transport</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>, readonly       </dt><dd> <p>The <dfn data-dfn-type="dfn" id="dom-rtpreceiver-transport"><code>RTCRtpReceiver.transport</code></dfn>
            attribute is the transport over which media for
            <code>RTCRtpReceiver.track</code> is received in the form
            of RTP packets.  When BUNDLE is used, many
            <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> objects will share one
            <code>RTCRtpReceiver.transport</code> and will all receive
            RTP over the same transport.  When RTCP mux is used,
            <code>RTCRtpReceiver.rtcpTransport</code> will be null,
            and both RTP and RTCP traffic will flow over
            <code>RTCRtpReceiver.transport</code>.  </p></dd></dl></section><section property="bibo:hasPart" resource="#methods-5" typeof="bibo:Chapter" id="methods-5"><h4 resource="#h-methods-5" id="h-methods-5"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.3.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCRtpReceiver-getCapabilities-RTCRtpCapabilities-DOMString-kind"><code>getCapabilities</code>, static</dt><dd> <p>The <dfn data-dfn-type="dfn" id="dom-rtpreceiver-getcapabilities"><code>RTCRtpReceiver.getCapabilities</code></dfn>
          method returns the most optimistic view of the capabilities of
          the system for receiving media of the given kind. It does
          not reserve any resources, ports, or other state but is
          meant to provide a way to discover the types of capabilities
          of the browser including which codecs may be supported.
          </p>

            <p class="fingerprint">These capabilities provide
              generally persistent cross-origin information on the
              device and thus increases the fingerprinting surface of
            the application. In privacy-sensitive contexts, browsers
            can consider mitigations such as reporting only a common subset
            of the capabilities.<img alt="(This is a fingerprinting vector.)" src="images/fingerprint.png" height="21" width="15"></p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">kind</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCRtpCapabilities"><code>RTCRtpCapabilities</code></a></code></div></dd><dt id="widl-RTCRtpReceiver-getContributingSources-sequence-RTCRtpContributingSource"><code>getContributingSources</code></dt><dd> <p>Returns an
            <code><a class="idlType" href="#idl-def-RTCRtpContributingSource"><code>RTCRtpContributingSource</code></a></code> for each
            unique CSRC or SSRC received by this RTCRtpReceiver in the
            last 10 seconds.</p> <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-RTCRtpContributingSource"><code>RTCRtpContributingSource</code></a>&gt;</code></div></dd></dl></section>

    <p> The <dfn id="dfn-rtcrtpcontributingsource" data-dfn-type="dfn">RTCRtpContributingSource</dfn> objects contain
    information about a given contributing source, including the time
    the most recent time a packet was received from the source. The
    browser <em title="MUST" class="rfc2119">MUST</em> keep information from RTP packets received in the
    previous 10 seconds.  Each time an RTP packet is received, the
    <code><a class="idlType" href="#idl-def-RTCRtpContributingSource"><code>RTCRtpContributingSource</code></a></code> objects are updated.
    If the RTP packet contains CSRCs, then the
    <code><a class="idlType" href="#idl-def-RTCRtpContributingSource"><code>RTCRtpContributingSource</code></a></code> objects corresponding
    to those CSRCs are updated.  If the RTP packet contains no CSRCs,
    then the <code><a class="idlType" href="#idl-def-RTCRtpContributingSource"><code>RTCRtpContributingSource</code></a></code> object
    corresponding to the SSRC is updated.</p>

	 <pre class="idl"><span class="idlInterface" id="idl-def-RTCRtpContributingSource">interface <span class="idlInterfaceID">RTCRtpContributingSource</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMHighResTimeStamp</span> <span class="idlAttrName"><a href="#widl-RTCRtpContributingSource-timestamp">timestamp</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned long</span>       <span class="idlAttrName"><a href="#widl-RTCRtpContributingSource-source">source</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">byte?</span>               <span class="idlAttrName"><a href="#widl-RTCRtpContributingSource-audioLevel">audioLevel</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">boolean?</span>            <span class="idlAttrName"><a href="#widl-RTCRtpContributingSource-voiceActivityFlag">voiceActivityFlag</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-10" typeof="bibo:Chapter" id="attributes-10"><h4 resource="#h-attributes-10" id="h-attributes-10"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.3.3 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCRtpContributingSource-audioLevel"><code>audioLevel</code> of type <span class="idlAttrType">byte</span>, readonly       , nullable</dt><dd> <p> The
       audio level contained in the last RTP packet received from
       this source.  If the source was set from an SSRC, this will be
       the level value defined in [<cite><a href="#bib-RFC6464" class="bibref">RFC6464</a></cite>].  If an RFC 6464
       extension header is not present, the browser will compute the
       value as if it had come from RFC 6464 and use that.  If the
       source was set from a CSRC, this will be the level value
       defined in [<cite><a href="#bib-RFC6465" class="bibref">RFC6465</a></cite>].  RFC 6464 and 6465 define the level as
       a integral value from 0 to 127 representing the audio level in
       negative decibels relative to the loudest signal that they system could
       possibly encode. Thus, 0 represents the loudest signal the system could 
       possibly encode, and 127 represents silence.</p></dd><dt id="widl-RTCRtpContributingSource-source"><code>source</code> of type <span class="idlAttrType">unsigned long</span>, readonly       </dt><dd> <p>
	   The CSRC or SSRC value of the contributing source. </p>
	   </dd><dt id="widl-RTCRtpContributingSource-timestamp"><code>timestamp</code> of type <span class="idlAttrType">DOMHighResTimeStamp</span>, readonly       </dt><dd> <p>The timestamp of type DOMHighResTimeStamp
	   [<cite><a href="#bib-HIGHRES-TIME" class="bibref">HIGHRES-TIME</a></cite>], indicating the time of reception of the
	   most recent RTP packet containing the source.  The
	   timestamp is defined in [<cite><a href="#bib-HIGHRES-TIME" class="bibref">HIGHRES-TIME</a></cite>] and corresponds to
	   a local clock.</p> </dd><dt id="widl-RTCRtpContributingSource-voiceActivityFlag"><code>voiceActivityFlag</code> of type <span class="idlAttrType">boolean</span>, readonly       , nullable</dt><dd> <p>
          Whether the last RTP packet received from this source contains
          voice activity (true) or not (false). Since the "V" bit is supported
          in [<cite><a href="#bib-RFC6464" class="bibref">RFC6464</a></cite>] but not [<cite><a href="#bib-RFC6465" class="bibref">RFC6465</a></cite>], the <var>voiceActivityFlag</var> attribute
          will only be set for RTP packets received from peers enabling the 
          client-mixer header extension with the "vad" extension set to "on".</p></dd></dl></section>
	
      </section>

      <section property="bibo:hasPart" resource="#rtcrtptransceiver-interface" typeof="bibo:Chapter" id="rtcrtptransceiver-interface">
        <h3 resource="#h-rtcrtptransceiver-interface" id="h-rtcrtptransceiver-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.4 </span>RTCRtpTransceiver Interface</span></h3>

        <p>The <a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a> interface
        represents a combination of an <a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a> and
        an <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a> that share a
        common <code>mid</code>.

        </p><pre class="idl"><span class="idlInterface" id="idl-def-RTCRtpTransceiver">interface <span class="idlInterfaceID">RTCRtpTransceiver</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString?</span>     <span class="idlAttrName"><a href="#widl-RTCRtpTransceiver-mid">mid</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">SameObject</span>]
    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></span>   <span class="idlAttrName"><a href="#widl-RTCRtpTransceiver-sender">sender</a></span>;</span>
<span class="idlAttribute">    [<span class="extAttr">SameObject</span>]
    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></span> <span class="idlAttrName"><a href="#widl-RTCRtpTransceiver-receiver">receiver</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">boolean</span>        <span class="idlAttrName"><a href="#widl-RTCRtpTransceiver-stopped">stopped</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCRtpTransceiver-stop-void">stop</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCRtpTransceiver-setCodecPreferences-void-sequence-RTCRtpCodecCapability--codecs">setCodecPreferences</a></span> (<span class="idlParam"><span class="idlParamType">sequence&lt;<a class="idlType" href="#idl-def-RTCRtpCodecCapability"><code>RTCRtpCodecCapability</code></a>&gt;</span> <span class="idlParamName">codecs</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-11" typeof="bibo:Chapter" id="attributes-11"><h4 resource="#h-attributes-11" id="h-attributes-11"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.4.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCRtpTransceiver-mid"><code>mid</code> of type <span class="idlAttrType">DOMString</span>, readonly       , nullable</dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-rtptransceiver-mid"><code>mid</code></dfn>
            attribute is the <code>mid</code> negotatiated and present
            in the local and remote descriptions as defined in
            <span>[<cite><a href="#bib-JSEP" class="bibref">JSEP</a></cite>] (<a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.2.1">section 5.2.1.</a> and <a href="https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-12#section-5.3.1">section 5.3.1.</a>)</span>.  Before negotiation is complete,
            the <code>mid</code> value may be null.  After rollbacks,
            the value may change from a non-null value to null.</p>
          </dd><dt id="widl-RTCRtpTransceiver-receiver"><code>receiver</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></span>, readonly       </dt><dd>
            <p>The <code id="dom-rtptransceiver-receiver">receiver</code>
            attribute is the <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a>
            corresponding to the RTP media that may be received with
            mid = <a data-link-type="dfn" class="internalDFN" href="#dom-rtptransceiver-mid"><code><code>mid</code></code></a>.</p>
          </dd><dt id="widl-RTCRtpTransceiver-sender"><code>sender</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></span>, readonly       </dt><dd>
            <p>The <code id="dom-rtptransceiver-sender">sender</code>
            attribute is the <a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a>
            corresponding to the RTP media that may be sent with mid
            = <a data-link-type="dfn" class="internalDFN" href="#dom-rtptransceiver-mid"><code><code>mid</code></code></a>.</p>
          </dd><dt id="widl-RTCRtpTransceiver-stopped"><code>stopped</code> of type <span class="idlAttrType">boolean</span>, readonly       </dt><dd>
            <p>The <code>stopped</code>
            attribute indicates that the sender of this transceiver
            will no longer send, and that the receiver will no longer
            receive. It is true if
            either <code>stop</code> has been called or
            if setting the local or remote description has caused
            the <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a> to be stopped.</p>
          </dd></dl></section><section property="bibo:hasPart" resource="#methods-6" typeof="bibo:Chapter" id="methods-6"><h4 resource="#h-methods-6" id="h-methods-6"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.4.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCRtpTransceiver-setCodecPreferences-void-sequence-RTCRtpCodecCapability--codecs"><code>setCodecPreferences</code></dt><dd>
            <p>The <code>setCodecPreferences</code> method overrides the default codec
            preferences used by the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a>.  When generating a session
            description using either <code>createOffer</code> or <code>createAnswer</code>,
            the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> <em title="MUST" class="rfc2119">MUST</em> use the indicated codecs, in the order
            specified in the <var>codecs</var> argument, for the media section
            corresponding to this <code>RTCRtpTransceiver</code>.  Note that calls to
            <code>createAnswer</code> will use only the common subset of these codecs
            and the codecs that appear in the offer.
            </p>
            <p>This method allows applications to disable the negotiation of specific
            codecs.  It also allows an application to cause a remote peer to prefer the
            codec that appears first in the list for sending.
            </p>
            <p>Codec preferences remain in effect for all calls to
            <code>createOffer</code> and <code>createAnswer</code> that include this
            <code>RTCRtpTransceiver</code> until this method is called again.
            Setting <var>codecs</var> to an empty sequence resets codec preferences
            to any default value.
            </p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">codecs</td><td class="prmType"><code>sequence&lt;<a class="idlType" href="#idl-def-RTCRtpCodecCapability"><code>RTCRtpCodecCapability</code></a>&gt;</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCRtpTransceiver-stop-void"><code>stop</code></dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-rtptransceiver-stop"><code>stop</code></dfn>
            method stops the <a class="idlType" href="#idl-def-RTCRtpTransceiver"><code>RTCRtpTransceiver</code></a>.
            The sender of this transceiver will no longer send, and
            the receiver will no longer receive.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>void</code></div></dd></dl></section>


      </section>

      <section property="bibo:hasPart" resource="#rtcdtlstransport-interface" typeof="bibo:Chapter" id="rtcdtlstransport-interface">
        <h3 resource="#h-rtcdtlstransport-interface" id="h-rtcdtlstransport-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.5 </span>RTCDtlsTransport Interface</span></h3>

        <p>The <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code> interface allows an
        application access to information about the Datagram Transport
        Layer Security (DTLS) transport over which RTP and RTCP
        packets are sent and received by <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code>
        and <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> objects, as well other data
        such as SCTP packets sent and received by data channels.  In
        particular, DTLS adds security to an underlying transport, and
        the <code>RTCDtlsTransport</code> interface allows access to
        information about the underlying transport and the security
        added.

        </p><pre class="idl"><span class="idlInterface" id="idl-def-RTCDtlsTransport">interface <span class="idlInterfaceID">RTCDtlsTransport</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></span>       <span class="idlAttrName"><a href="#widl-RTCDtlsTransport-transport">transport</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransportState"><code>RTCDtlsTransportState</code></a></span> <span class="idlAttrName"><a href="#widl-RTCDtlsTransport-state">state</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;ArrayBuffer&gt;</span> <span class="idlMethName"><a href="#widl-RTCDtlsTransport-getRemoteCertificates-sequence-ArrayBuffer">getRemoteCertificates</a></span> ();</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-RTCDtlsTransport-onstatechange">onstatechange</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-12" typeof="bibo:Chapter" id="attributes-12"><h4 resource="#h-attributes-12" id="h-attributes-12"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.5.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCDtlsTransport-onstatechange"><code>onstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            This event handler, of event handler event
            type <code><a href="#event-dtlstransport-statechange">statechange</a></code>,
            <em title="MUST" class="rfc2119">MUST</em> be fired any time the <a href="#dom-dtlstransport-state"><code>RTCDtlsTransport</code>
            state</a> changes.
          </dd><dt id="widl-RTCDtlsTransport-state"><code>state</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransportState"><code>RTCDtlsTransportState</code></a></span>, readonly       </dt><dd>
            <p>The <code id="dom-dtlstransport-state">state</code>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the state of the transport.
          </p></dd><dt id="widl-RTCDtlsTransport-transport"><code>transport</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></span>, readonly       </dt><dd>
            <p>The <code>transport</code>
            attribute is the underlying transport that is used to send
            and receive packets.  The underlying transport may not be
            shared between multiple active <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>
            objects.
          </p></dd></dl></section><section property="bibo:hasPart" resource="#methods-7" typeof="bibo:Chapter" id="methods-7"><h4 resource="#h-methods-7" id="h-methods-7"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.5.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCDtlsTransport-getRemoteCertificates-sequence-ArrayBuffer"><code>getRemoteCertificates</code></dt><dd>
            <p>Returns the certificate chain in use by the remote side, with each certificate encoded
            in binary Distinguished Encoding Rules (DER) [<cite><a href="#bib-X690" class="bibref">X690</a></cite>]. <code>getRemoteCertificates()</code> 
            will return an empty list prior to selection of the remote certificate, which will be
            completed by the time <code><a class="idlType" href="#idl-def-RTCDtlsTransportState"><code>RTCDtlsTransportState</code></a></code> transitions to "connected".</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;ArrayBuffer&gt;</code></div></dd></dl></section>

        <h3 id="rtcdtlstransportstate-enum">RTCDtlsTransportState Enum</h3>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCDtlsTransportState">enum <span class="idlEnumID">RTCDtlsTransportState</span> {
    "<a href="#idl-def-RTCDtlsTransportState.new" class="idlEnumItem">new</a>",
    "<a href="#idl-def-RTCDtlsTransportState.connecting" class="idlEnumItem">connecting</a>",
    "<a href="#idl-def-RTCDtlsTransportState.connected" class="idlEnumItem">connected</a>",
    "<a href="#idl-def-RTCDtlsTransportState.closed" class="idlEnumItem">closed</a>",
    "<a href="#idl-def-RTCDtlsTransportState.failed" class="idlEnumItem">failed</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCDtlsTransportState.new">new</code></td><td>DTLS has not started negotiating yet.</td></tr><tr><td><code id="idl-def-RTCDtlsTransportState.connecting">connecting</code></td><td>DTLS is in the process of negotiating a secure connection.</td></tr><tr><td><code id="idl-def-RTCDtlsTransportState.connected">connected</code></td><td>DTLS has completed negotiation of a secure connection.</td></tr><tr><td><code id="idl-def-RTCDtlsTransportState.closed">closed</code></td><td>The transport has been closed.</td></tr><tr><td><code id="idl-def-RTCDtlsTransportState.failed">failed</code></td><td>The transport has failed as the result of an error (such
          as a failure to validate the remote fingerprint).</td></tr></tbody></table>
      </section>

      <section property="bibo:hasPart" resource="#rtcicetransport-interface" typeof="bibo:Chapter" id="rtcicetransport-interface">
        <h3 resource="#h-rtcicetransport-interface" id="h-rtcicetransport-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.6 </span>RTCIceTransport Interface</span></h3>

        <p>The <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code> interface allows an
        application access to information about the ICE transport over
        which packets are sent and received.  In particular, ICE manages
        peer-to-peer connections which involve state which the
        application may want to access.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCIceTransport">interface <span class="idlInterfaceID">RTCIceTransport</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceRole"><code>RTCIceRole</code></a></span>            <span class="idlAttrName"><a href="#widl-RTCIceTransport-role">role</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceComponent"><code>RTCIceComponent</code></a></span>       <span class="idlAttrName"><a href="#widl-RTCIceTransport-component">component</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceConnectionState"><code>RTCIceConnectionState</code></a></span> <span class="idlAttrName"><a href="#widl-RTCIceTransport-state">state</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceGatheringState"><code>RTCIceGatheringState</code></a></span>  <span class="idlAttrName"><a href="#widl-RTCIceTransport-gatheringState">gatheringState</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCIceTransport-getLocalCandidates-sequence-RTCIceCandidate">getLocalCandidates</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCIceTransport-getRemoteCandidates-sequence-RTCIceCandidate">getRemoteCandidates</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCIceCandidatePair"><code>RTCIceCandidatePair</code></a>?</span>      <span class="idlMethName"><a href="#widl-RTCIceTransport-getSelectedCandidatePair-RTCIceCandidatePair">getSelectedCandidatePair</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCIceParameters"><code>RTCIceParameters</code></a>?</span>         <span class="idlMethName"><a href="#widl-RTCIceTransport-getLocalParameters-RTCIceParameters">getLocalParameters</a></span> ();</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCIceParameters"><code>RTCIceParameters</code></a>?</span>         <span class="idlMethName"><a href="#widl-RTCIceTransport-getRemoteParameters-RTCIceParameters">getRemoteParameters</a></span> ();</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-RTCIceTransport-onstatechange">onstatechange</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-RTCIceTransport-ongatheringstatechange">ongatheringstatechange</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>          <span class="idlAttrName"><a href="#widl-RTCIceTransport-onselectedcandidatepairchange">onselectedcandidatepairchange</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-13" typeof="bibo:Chapter" id="attributes-13"><h4 resource="#h-attributes-13" id="h-attributes-13"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.6.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCIceTransport-component"><code>component</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceComponent"><code>RTCIceComponent</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-icetransport-component"><code>component</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the ICE component of the transport.
            When RTP/RTCP mux is used, a single <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>
            transports both RTP and RTCP and <code>component</code> is set to "RTP". 
          </p></dd><dt id="widl-RTCIceTransport-gatheringState"><code>gatheringState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceGatheringState"><code>RTCIceGatheringState</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-icetransport-gatheringstate"><code>gathering
            state</code></dfn> attribute <em title="MUST" class="rfc2119">MUST</em> return the gathering
            state of the transport.
          </p></dd><dt id="widl-RTCIceTransport-ongatheringstatechange"><code>ongatheringstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            This event handler, of event handler event
            type <code><a href="#event-icetransport-gatheringstatechange">gatheringstatechange</a></code>,
            <em title="MUST" class="rfc2119">MUST</em> be fired any time the <a href="#dom-icetransport-gatheringstate"><code>RTCIceTransport</code>gathering
            state</a> changes.
          </dd><dt id="widl-RTCIceTransport-onselectedcandidatepairchange"><code>onselectedcandidatepairchange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            This event handler, of event handler event
            type <code><a href="#event-icetransport-selectedcandidatepairchange">selectedcandidatepairchange</a></code>,
            <em title="MUST" class="rfc2119">MUST</em> be fired any time
            the <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>'s selected
            candidate pair changes.
          </dd><dt id="widl-RTCIceTransport-onstatechange"><code>onstatechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            This event handler, of event handler event type <code><a href="#event-icetransport-statechange">statechange</a></code>,
            <em title="MUST" class="rfc2119">MUST</em> be fired any time the <a href="#dom-icetransport-state"><code>RTCIceTransport</code> state</a> changes.
          </dd><dt id="widl-RTCIceTransport-role"><code>role</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceRole"><code>RTCIceRole</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-icetransport-role"><code>role</code></dfn> attribute
            <em title="MUST" class="rfc2119">MUST</em> return the ICE role of the transport.
          </p></dd><dt id="widl-RTCIceTransport-state"><code>state</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceConnectionState"><code>RTCIceConnectionState</code></a></span>, readonly       </dt><dd>
            <p>The <dfn data-dfn-type="dfn" id="dom-icetransport-state"><code>state</code></dfn>
            attribute <em title="MUST" class="rfc2119">MUST</em> return the state of the transport.
          </p></dd></dl></section><section property="bibo:hasPart" resource="#methods-8" typeof="bibo:Chapter" id="methods-8"><h4 resource="#h-methods-8" id="h-methods-8"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.6.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCIceTransport-getLocalCandidates-sequence-RTCIceCandidate"><code>getLocalCandidates</code></dt><dd>
            <p>Returns a sequence describing the local ICE candidates gathered
            for this <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code> and sent in
            <code><a href="#widl-RTCPeerConnection-onicecandidate">onicecandidate</a></code></p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>&gt;</code></div></dd><dt id="widl-RTCIceTransport-getLocalParameters-RTCIceParameters"><code>getLocalParameters</code></dt><dd><p>Returns the local ICE parameters received by
            this <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>
            via <code><a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a></code>,
            or <code>null</code> if the parameters have not yet been
            received.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCIceParameters"><code>RTCIceParameters</code></a></code>, nullable</div></dd><dt id="widl-RTCIceTransport-getRemoteCandidates-sequence-RTCIceCandidate"><code>getRemoteCandidates</code></dt><dd>
            <p>Returns a sequence describing the remote ICE candidates received by
            this <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>
            via <code><a href="#dom-peerconnection-addicecandidate">addIceCandidate()</a></code></p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code>sequence&lt;<a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a>&gt;</code></div></dd><dt id="widl-RTCIceTransport-getRemoteParameters-RTCIceParameters"><code>getRemoteParameters</code></dt><dd><p>Returns the remote ICE parameters received by
            this <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>
            via <code><a href="#dom-peerconnection-setremotedescription">setRemoteDescription()</a></code>
            or <code>null</code> if the parameters have not yet been
            received.</p>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCIceParameters"><code>RTCIceParameters</code></a></code>, nullable</div></dd><dt id="widl-RTCIceTransport-getSelectedCandidatePair-RTCIceCandidatePair"><code>getSelectedCandidatePair</code></dt><dd><p>Returns the selected candidate pair on which packets
          are sent, or <code>null</code> if there is no such pair.</p><div><em>No parameters.</em></div><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCIceCandidatePair"><code>RTCIceCandidatePair</code></a></code>, nullable</div></dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIceParameters">dictionary <span class="idlDictionaryID">RTCIceParameters</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCIceParameters-usernameFragment">usernameFragment</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCIceParameters-password">password</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtciceparameters-members" typeof="bibo:Chapter" id="dictionary-rtciceparameters-members"><h4 resource="#h-dictionary-rtciceparameters-members" id="h-dictionary-rtciceparameters-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.6.3 </span>Dictionary <a href="#idl-def-RTCIceParameters" class="idlType"><code>RTCIceParameters</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCIceParameters-password"><code>password</code> of type <span class="idlMemberType">DOMString</span></dt><dd><p>The ICE password as defined in [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>], Section 7.1.2.3.</p></dd><dt id="widl-RTCIceParameters-usernameFragment"><code>usernameFragment</code> of type <span class="idlMemberType">DOMString</span></dt><dd><p>The ICE username fragment as defined in [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>], Section 7.1.2.3.</p></dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIceCandidatePair">dictionary <span class="idlDictionaryID">RTCIceCandidatePair</span> {
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span> <span class="idlMemberName"><a href="#widl-RTCIceCandidatePair-local">local</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span> <span class="idlMemberName"><a href="#widl-RTCIceCandidatePair-remote">remote</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcicecandidatepair-members" typeof="bibo:Chapter" id="dictionary-rtcicecandidatepair-members"><h4 resource="#h-dictionary-rtcicecandidatepair-members" id="h-dictionary-rtcicecandidatepair-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.6.4 </span>Dictionary <a href="#idl-def-RTCIceCandidatePair" class="idlType"><code>RTCIceCandidatePair</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCIceCandidatePair-local"><code>local</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span></dt><dd><p>The local ICE candidate.</p></dd><dt id="widl-RTCIceCandidatePair-remote"><code>remote</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span></dt><dd><p>The remote ICE candidate.</p></dd></dl></section>

        <h3 id="rtcicerole-enum">RTCIceRole Enum</h3>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceRole">enum <span class="idlEnumID">RTCIceRole</span> {
    "<a href="#idl-def-RTCIceRole.controlling" class="idlEnumItem">controlling</a>",
    "<a href="#idl-def-RTCIceRole.controlled" class="idlEnumItem">controlled</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceRole.controlling">controlling</code></td><td>A controlling agent as defined by [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>], Section 3.</td></tr><tr><td><code id="idl-def-RTCIceRole.controlled">controlled</code></td><td>A controlled agent as defined by [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>], Section 3.</td></tr></tbody></table>

        <h3 id="rtcicecomponent-enum">RTCIceComponent Enum</h3>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceComponent">enum <span class="idlEnumID">RTCIceComponent</span> {
    "<a href="#idl-def-RTCIceComponent.xRTP" class="idlEnumItem">RTP</a>",
    "<a href="#idl-def-RTCIceComponent.xRTCP" class="idlEnumItem">RTCP</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCIceComponent.xRTP">RTP</code></td><td>The ICE Transport is used for RTP (or RTP/RTCP-multiplexing), as defined in [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>], Section 4.1.1.1.
          Protocols multiplexed with RTP (e.g. data channel) share its component ID.</td></tr><tr><td><code id="idl-def-RTCIceComponent.xRTCP">RTCP</code></td><td>The ICE Transport is used for RTCP as defined by [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>], Section 4.1.1.1.</td></tr></tbody></table>
      </section>

        <section property="bibo:hasPart" resource="#rtctrackevent" typeof="bibo:Chapter" id="rtctrackevent">
      <h3 resource="#h-rtctrackevent" id="h-rtctrackevent"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.7 </span>RTCTrackEvent</span></h3>

      <p>The <code><a href="#event-track">track</a></code>
      event uses the
      <code><a class="idlType" href="#idl-def-RTCTrackEvent"><code>RTCTrackEvent</code></a></code> interface.</p>

      <p><dfn data-dfn-type="dfn" id="fire-track-event">Firing an
      RTCTrackEvent event named <var>e</var></dfn> with an <code>
      <a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> <var>receiver</var>, a
      <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> <var>track</var> and a
      <code>MediaStream</code>[] <var>streams</var>, means that an event
      with the name <var>e</var>, which does not bubble (except where otherwise
      stated) and is not cancelable (except where otherwise stated), and which
      uses the <code><a class="idlType" href="#idl-def-RTCTrackEvent"><code>RTCTrackEvent</code></a></code> interface with the
      <code><a href="#dom-trackevent-receiver">receiver</a></code> attribute
      set to <var>receiver</var>,
      <code><a href="#dom-trackevent-track">track</a></code> attribute
      set to <var>track</var>,
      <code><a href="#dom-trackevent-streams">streams</a></code> attribute
      set to <var>streams</var>, <em title="MUST" class="rfc2119">MUST</em> be created and dispatched at the
      given target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCTrackEvent"><span class="idlDictionary" id="idl-def-RTCTrackEventInit">dictionary <span class="idlDictionaryID">RTCTrackEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">    required <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></span>        <span class="idlMemberName"><a href="#widl-RTCTrackEventInit-receiver">receiver</a></span>;</span>
<span class="idlMember">    required <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>      <span class="idlMemberName"><a href="#widl-RTCTrackEventInit-track">track</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">sequence&lt;<a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>&gt;</span> <span class="idlMemberName"><a href="#widl-RTCTrackEventInit-streams">streams</a></span> = <span class="idlMemberValue">[]</span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCTrackEvent--DOMString-type-RTCTrackEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCTrackEventInit"><code>RTCTrackEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCTrackEvent</span> : <span class="idlSuperclass"><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></span>           <span class="idlAttrName"><a href="#widl-RTCTrackEvent-receiver">receiver</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>         <span class="idlAttrName"><a href="#widl-RTCTrackEvent-track">track</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">FrozenArray&lt;<a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>&gt;</span> <span class="idlAttrName"><a href="#widl-RTCTrackEvent-streams">streams</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-5" typeof="bibo:Chapter" id="constructors-5"><h4 resource="#h-constructors-5" id="h-constructors-5"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.7.1 </span>Constructors</span></h4><dl class="constructors"><dt id="widl-ctor-RTCTrackEvent--DOMString-type-RTCTrackEventInit-eventInitDict"><code>RTCTrackEvent</code></dt><dd>readonly attribute RTCRtpReceiver receiver<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCTrackEventInit"><code>RTCTrackEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-14" typeof="bibo:Chapter" id="attributes-14"><h4 resource="#h-attributes-14" id="h-attributes-14"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.7.2 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCTrackEvent-receiver"><code>receiver</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-trackevent-receiver"><code>receiver</code></dfn> attribute
          represents the <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> object associated with
          the event.</p>
        </dd><dt id="widl-RTCTrackEvent-streams"><code>streams</code> of type <span class="idlAttrType">FrozenArray&lt;<a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>&gt;</span>, readonly       </dt><dd>
           <p>The <dfn data-dfn-type="dfn" id="dom-trackevent-streams"><code>streams</code></dfn>
           attribute returns an array of <code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code> objects
           representing the <code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code>s that this event's
          <code>track</code> is a part of.</p>
        </dd><dt id="widl-RTCTrackEvent-track"><code>track</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>, readonly       </dt><dd>
          <p>The <code id="dom-trackevent-track">track</code> attribute
          represents the <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> object that is
          associated with the <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> identified by
          <code>receiver</code>.</p>
        </dd></dl></section>

      <section property="bibo:hasPart" resource="#dictionary-rtctrackeventinit-members" typeof="bibo:Chapter" id="dictionary-rtctrackeventinit-members"><h4 resource="#h-dictionary-rtctrackeventinit-members" id="h-dictionary-rtctrackeventinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.7.3 </span>Dictionary <a href="#idl-def-RTCTrackEventInit" class="idlType"><code>RTCTrackEventInit</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCTrackEventInit-receiver"><code>receiver</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></span>, required</dt><dd>
          <p>The <code>receiver</code> attribute
          represents the <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> object associated with
          the event.</p>
        </dd><dt id="widl-RTCTrackEventInit-streams"><code>streams</code> of type <span class="idlMemberType">sequence&lt;<a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a>&gt;</span>, defaulting to <code>[]</code></dt><dd>
          <p>The <code>streams</code>
           attribute returns an array of <code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code> objects
           representing the <code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code>s that this event's
          <code>track</code> is a part of.</p>
        </dd><dt id="widl-RTCTrackEventInit-track"><code>track</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></span>, required</dt><dd>
          <p>The <code>track</code> attribute
          represents the <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> object that is
          associated with the <code><a class="idlType" href="#idl-def-RTCRtpReceiver"><code>RTCRtpReceiver</code></a></code> identified by
          <code>receiver</code>.</p>
        </dd></dl></section>
    </section>

  </section>

  <section property="bibo:hasPart" resource="#peer-to-peer-data-api" typeof="bibo:Chapter" id="peer-to-peer-data-api">
    <!--OddPage--><h2 resource="#h-peer-to-peer-data-api" id="h-peer-to-peer-data-api"><span property="xhv:role" resource="xhv:heading"><span class="secno">6. </span>Peer-to-peer Data API</span></h2>

    <p>The Peer-to-peer Data API lets a web application send and receive
    generic application data peer-to-peer. The API for sending and receiving
    data models the behavior of WebSockets [<cite><a href="#bib-WEBSOCKETS-API" class="bibref">WEBSOCKETS-API</a></cite>].</p>

    <section property="bibo:hasPart" resource="#rtcpeerconnection-interface-extensions-1" typeof="bibo:Chapter" id="rtcpeerconnection-interface-extensions-1">
      <h3 resource="#h-rtcpeerconnection-interface-extensions-1" id="h-rtcpeerconnection-interface-extensions-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.1 </span>RTCPeerConnection Interface Extensions</span></h3>

      <p>The Peer-to-peer data API extends the
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface as described below.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection-4">partial interface <span class="idlInterfaceID">RTCPeerConnection</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSctpTransport"><code>RTCSctpTransport</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCPeerConnection-sctp">sctp</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-createDataChannel-RTCDataChannel-DOMString-label-RTCDataChannelInit-dataChannelDict">createDataChannel</a></span> (<span class="idlParam">[<span class="extAttr">TreatNullAs=EmptyString</span>] <span class="idlParamType">DOMString</span> <span class="idlParamName">label</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCDataChannelInit"><code>RTCDataChannelInit</code></a></span> <span class="idlParamName">dataChannelDict</span></span>);</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnection-ondatachannel">ondatachannel</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-15" typeof="bibo:Chapter" id="attributes-15"><h4 resource="#h-attributes-15" id="h-attributes-15"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.1.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCPeerConnection-ondatachannel"><code>ondatachannel</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-datachannel">datachannel</a></code>.</dd><dt id="widl-RTCPeerConnection-sctp"><code>sctp</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSctpTransport"><code>RTCSctpTransport</code></a></span>, readonly       , nullable</dt><dd>
            <p>The SCTP transport over which SCTP data is sent and
            received. If SCTP has not been negotiated, the value
            is null.</p>
          </dd></dl></section><section property="bibo:hasPart" resource="#methods-9" typeof="bibo:Chapter" id="methods-9"><h4 resource="#h-methods-9" id="h-methods-9"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.1.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCPeerConnection-createDataChannel-RTCDataChannel-DOMString-label-RTCDataChannelInit-dataChannelDict"><code>createDataChannel</code></dt><dd>
          <p>Creates a new <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object with the
          given label. The <code><a class="idlType" href="#idl-def-RTCDataChannelInit"><code>RTCDataChannelInit</code></a></code> dictionary
          can be used to configure properties of the underlying channel such as
          <!--priority and--> data reliability.</p>

          <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection-createdatachannel"><code>createDataChannel()</code></dfn>
          method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps.</p>

          <ol>
            <li>
              <p>If the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
              <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, throw an
              <code>InvalidStateError</code> exception and abort these
              steps.</p>
            </li>

            <li>
              <p>Let <var>channel</var> be a newly created
              <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object.</p>
            </li>

            <li>
              <p>Initialize <var>channel</var>'s <code><a href="#dom-datachannel-label">label</a></code> attribute to the value
              of the first argument.</p>
            </li>

            <li>
              <p>If the second (dictionary) argument is present, set
              <var>channel</var>'s <code><a href="#dom-datachannel-ordered">ordered</a></code>, <code><a href="#dom-datachannel-maxpacketlifetime">maxPacketLifeTime</a></code>,
              <code><a href="#dom-datachannel-maxretransmits">maxRetransmits</a></code>,
              <code><a href="#dom-datachannel-protocol">protocol</a></code>,
              <code><a href="#dom-datachannel-negotiated">negotiated</a></code>
              and <code><a href="#dom-datachannel-id">id</a></code> attributes
              to the values of their corresponding dictionary members (if
              present in the dictionary).</p>
            </li>

            <li>If <code>negotiated</code> is false
            and <code>label</code> is longer than 65535 bytes
            long, <a href="http://heycam.github.io/webidl/#dfn-throw">throw</a>
            a <code>TypeError</code>.</li>

            <li>If <code>negotiated</code> is false
            and <code>protocol</code> is longer than 65535 bytes
            long, <a href="http://heycam.github.io/webidl/#dfn-throw">throw</a>
            a <code>TypeError</code>.</li>

            <li>
              <p>If both the <code><a href="#dom-datachannel-maxpacketlifetime">maxPacketLifeTime</a></code>
              and <code><a href="#dom-datachannel-maxretransmits">maxRetransmits</a></code>
              attributes are set (not null), then throw a
              <code>SyntaxError</code> exception and abort these steps.</p>
            </li>

            <li>
              <p>If an attribute, either <code><a href="#dom-datachannel-maxpacketlifetime">maxPacketLifeTime</a></code>
              or <code><a href="#dom-datachannel-maxretransmits">maxRetransmits</a></code>, has
              been set to indicate unreliable mode, and that value exceeds the
              maximum value supported by the user agent, the value <em title="MUST" class="rfc2119">MUST</em> be set
              to the user agents maximum value.</p>
            </li>

            <li>
              <p>If <code><a href="#dom-datachannel-id">id</a></code> attribute
              is uninitialized (not set via the dictionary), initialize it to a
              value generated by the user agent, according to the WebRTC
              DataChannel Protocol specification, and skip to the next step.
              Otherwise, if the value of the <code><a href="#dom-datachannel-id">id</a></code> attribute is taken by an
              existing <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>, throw a
              <code>ResourceInUse</code> exception and abort these steps.</p>
            </li>

            <li>
              <p>Return <var>channel</var> and continue the following steps in
              the background.</p>
            </li>

            <li>
              <p>Create <var>channel</var>'s associated <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
              transport</a> and configure it according to the relevant
              properties of <var>channel</var>.</p>
            </li>

            <li>
              <p>If <var>channel</var> was the first RTCDataChannel created on
              this connection, mark the connection as needing negotiation.
              </p>
          </li></ol>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">label</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">dataChannelDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCDataChannelInit"><code>RTCDataChannelInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code></div></dd></dl></section>
      <section property="bibo:hasPart" resource="#rtcsctptransport-interface" typeof="bibo:Chapter" id="rtcsctptransport-interface">
        <h4 resource="#h-rtcsctptransport-interface" id="h-rtcsctptransport-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.1.3 </span>RTCSctpTransport Interface</span></h4>

        <p>The <code><a class="idlType" href="#idl-def-RTCSctpTransport"><code>RTCSctpTransport</code></a></code> interface allows an
        application access to information about the SCTP data channels
        tied to a particular SCTP association.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCSctpTransport">interface <span class="idlInterfaceID">RTCSctpTransport</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span> <span class="idlAttrName"><a href="#widl-RTCSctpTransport-transport">transport</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned long</span>    <span class="idlAttrName"><a href="#widl-RTCSctpTransport-maxMessageSize">maxMessageSize</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-16" typeof="bibo:Chapter" id="attributes-16"><h5 resource="#h-attributes-16" id="h-attributes-16"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.1.3.1 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCSctpTransport-maxMessageSize"><code>maxMessageSize</code> of type <span class="idlAttrType">unsigned long</span>, readonly       </dt><dd>
            <p>The maximum size of data that can be passed
            to <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>'s <code><a href="#dom-datachannel-send">send()</a></code> method.</p>
          </dd><dt id="widl-RTCSctpTransport-transport"><code>transport</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></span>, readonly       </dt><dd>
            <p>The transport over which all SCTP packets for data
              channels will be sent and received.</p>
          </dd></dl></section>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#rtcdatachannel" typeof="bibo:Chapter" id="rtcdatachannel">
      <h3 resource="#h-rtcdatachannel" id="h-rtcdatachannel"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.2 </span>RTCDataChannel</span></h3>

      <p>The <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> interface represents a
      bi-directional data channel between two peers. A
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> is created via a factory method on an
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object. The messages sent between
      the browsers are described in [<cite><a href="#bib-RTCWEB-DATA" class="bibref">RTCWEB-DATA</a></cite>] and
      [<cite><a href="#bib-RTCWEB-DATA-PROTOCOL" class="bibref">RTCWEB-DATA-PROTOCOL</a></cite>].</p>

      <p>There are two ways to establish a connection with
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>. The first way is to simply create a
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> at one of the peers with the
      <code><a href="#widl-RTCDataChannelInit-negotiated">negotiated</a></code>
      <code><a class="idlType" href="#idl-def-RTCDataChannelInit"><code>RTCDataChannelInit</code></a></code> dictionary member unset or set to
      its default value false. This will announce the new channel in-band and
      trigger a <code><a class="idlType" href="#idl-def-RTCDataChannelEvent"><code>RTCDataChannelEvent</code></a></code> with the corresponding
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object at the other peer. The second
      way is to let the application negotiate the
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>. To do this, create a
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object with the <code><a href="#widl-RTCDataChannelInit-negotiated">negotiated</a></code>
      <code><a class="idlType" href="#idl-def-RTCDataChannelInit"><code>RTCDataChannelInit</code></a></code> dictionary member set to true, and
      signal out-of-band (e.g. via a web server) to the other side that it
      <em title="SHOULD" class="rfc2119">SHOULD</em> create a corresponding <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> with the
      <code><a href="#widl-RTCDataChannelInit-negotiated">negotiated</a></code>
      <code><a class="idlType" href="#idl-def-RTCDataChannelInit"><code>RTCDataChannelInit</code></a></code> dictionary member set to true and
      the same <code><a href="#dom-datachannel-id">id</a></code>. This will
      connect the two separately created <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
      objects. The second way makes it possible to create channels with
      asymmetric properties and to create channels in a declarative way by
      specifying matching <code><a href="#widl-RTCDataChannelInit-id">ids</a></code>.</p>

      <p>Each <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> has an associated
      <dfn id="dfn-underlying-data-transport" data-dfn-type="dfn">underlying data transport</dfn> that is used to transport actual
      data to the other peer. The transport properties of the <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying
      data transport</a>, such as in order delivery settings and reliability
      mode, are configured by the peer as the channel is created. The
      properties of a channel cannot change after the channel has been created.
      The actual wire protocol between the peers is specified by the WebRTC
      DataChannel Protocol specification [<cite><a href="#bib-RTCWEB-DATA" class="bibref">RTCWEB-DATA</a></cite>].</p>

      <p>A <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> can be configured to operate in
      different reliability modes. A reliable channel ensures that the data is
      delivered at the other peer through retransmissions. An unreliable
      channel is configured to either limit the number of retransmissions (
      <code><a href="#widl-RTCDataChannelInit-maxRetransmits">maxRetransmits</a></code> ) or
      set a time during which transmissions (including retransmissions) are
      allowed ( <code><a href="#widl-RTCDataChannelInit-maxPacketLifeTime">maxPacketLifeTime</a></code>
      ). These properties can not be used simultaneously and an attempt to do
      so will result in an error. Not setting any of these properties results
      in a reliable channel.</p>

      <p>A <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>, created with <code><a href="#dom-peerconnection-createdatachannel">createDataChannel()</a></code> or
      dispatched via a <code><a class="idlType" href="#idl-def-RTCDataChannelEvent"><code>RTCDataChannelEvent</code></a></code>, <em title="MUST" class="rfc2119">MUST</em> initially
      be in the <code>connecting</code> state. When the
      <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object's <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
      transport</a> is ready, the user agent <em title="MUST" class="rfc2119">MUST</em> <a href="#announce-datachannel-open">announce the <code>RTCDataChannel</code> as
      open</a>.</p>

      <p>When the user agent is to <dfn data-dfn-type="dfn" id="announce-datachannel-open">announce
      a <code>RTCDataChannel</code> as open</dfn>, the user agent <em title="MUST" class="rfc2119">MUST</em> queue a
      task to run the following steps:</p>

      <ol>
        <li>
          <p>If the associated <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
          <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, abort these steps.</p>
        </li>

        <li>
          <p>Let <var>channel</var> be the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
          object to be announced.</p>
        </li>

        <li>
          <p>Set <var>channel</var>'s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
          <code>open</code>.</p>
        </li>

        <li>
          <p>Fire a simple event named <code><a href="#event-datachannel-open">open</a></code> at <var>channel</var>.</p>
        </li>
      </ol>

      <p>When an <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> is to be announced (the other
      peer created a channel with <code><a href="#widl-RTCDataChannelInit-negotiated">negotiated</a></code> unset or set
      to false), the user agent of the peer that did not initiate the creation
      process <em title="MUST" class="rfc2119">MUST</em> queue a task to run the following steps:</p>

      <ol>
        <li>
          <p>If the associated <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
          <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, abort these steps.</p>
        </li>

        <li>
          <p>Let <var>channel</var> be a newly created
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object.</p>
        </li>

        <li>
          <p>Let <var>configuration</var> be an information bundle received
          from the other peer as a part of the process to establish the
          <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> described by the WebRTC DataChannel
          Protocol specification [<cite><a href="#bib-RTCWEB-DATA-PROTOCOL" class="bibref">RTCWEB-DATA-PROTOCOL</a></cite>].</p>
        </li>

        <li>
          <p>Initialize <var>channel</var>'s <code><a href="#dom-datachannel-label">label</a></code>, <code><a href="#dom-datachannel-ordered">ordered</a></code>, <code><a href="#dom-datachannel-maxpacketlifetime">maxPacketLifeTime</a></code>,
          <code><a href="#dom-datachannel-maxretransmits">maxRetransmits</a></code>,
          <code><a href="#dom-datachannel-protocol">protocol</a></code>,
          <code><a href="#dom-datachannel-negotiated">negotiated</a></code> and
          <code><a href="#dom-datachannel-id">id</a></code> attributes to their
          corresponding values in <var>configuration</var>.</p>
        </li>

        <li>
          <p>Set <var>channel</var>'s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
          <code>connecting</code>.</p>
        </li>

        <li>
          <p><a data-link-type="dfn" class="internalDFN" href="#fire-a-datachannel-event">Fire a datachannel event</a> named <code><a href="#event-datachannel">datachannel</a></code> with <var>channel</var>
          at the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>
        </li>
      </ol>

      <p>An <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object's <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
      transport</a> may be torn down in a non-abrupt manner by running the
      <dfn data-dfn-type="dfn" id="data-transport-closing-procedure">closing procedure</dfn>. When
      that happens the user agent <em title="MUST" class="rfc2119">MUST</em>, unless the procedure was initiated by
      the <code><a href="#dom-datachannel-close">close()</a></code> method,
      queue a task that sets the object's <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
      <code>closing</code>. This will eventually render the <a href="#dfn-underlying-data-transport">data transport</a> <a href="#data-transport-closed">closed</a>.</p>

      <p>When a <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object's <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
      transport</a> has been <dfn data-dfn-type="dfn" id="data-transport-closed">closed</dfn>, the
      user agent <em title="MUST" class="rfc2119">MUST</em> queue a task to run the following steps:</p>

      <ol>
        <li>
          <p>Let <var>channel</var> be the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
          object whose <a href="#dfn-underlying-data-transport">transport</a>
          was closed.</p>

          <div class="issue"><div id="h-issue9" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><div class="">
            The data transport protocol will specify what happens to, e.g.
            buffered data, when the data transport is closed.
          </div></div>
        </li>

        <li>
          <p>Set <var>channel</var>'s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
          <code>closed</code>.</p>
        </li>

        <li>
          <p>If the <a href="#dfn-underlying-data-transport">transport</a> was
          closed <dfn data-dfn-type="dfn" id="data-transport-closed-error">with an error</dfn>,
          fire an NetworkError event at <var>channel</var>.</p>
        </li>

        <li>
          <p>Fire a simple event named <code title="event-RTCDataChannel-close"><a href="#event-datachannel-close">close</a></code> at
          <var>channel</var>.</p>
        </li>
      </ol>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCDataChannel"><span class="idlDictionary" id="idl-def-RTCDataChannelInit">dictionary <span class="idlDictionaryID">RTCDataChannelInit</span> {
<span class="idlMember">             <span class="idlMemberType">boolean</span>        <span class="idlMemberName"><a href="#widl-RTCDataChannelInit-ordered">ordered</a></span> = <span class="idlMemberValue">true</span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCDataChannelInit-maxPacketLifeTime">maxPacketLifeTime</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCDataChannelInit-maxRetransmits">maxRetransmits</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>      <span class="idlMemberName"><a href="#widl-RTCDataChannelInit-protocol">protocol</a></span> = <span class="idlMemberValue">""</span>;</span>
<span class="idlMember">             <span class="idlMemberType">boolean</span>        <span class="idlMemberName"><a href="#widl-RTCDataChannelInit-negotiated">negotiated</a></span> = <span class="idlMemberValue">false</span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned short</span> <span class="idlMemberName"><a href="#widl-RTCDataChannelInit-id">id</a></span>;</span>
};</span><br><br>interface <span class="idlInterfaceID">RTCDataChannel</span> : <span class="idlSuperclass">EventTarget</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>           <span class="idlAttrName"><a href="#widl-RTCDataChannel-label">label</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">boolean</span>             <span class="idlAttrName"><a href="#widl-RTCDataChannel-ordered">ordered</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short?</span>     <span class="idlAttrName"><a href="#widl-RTCDataChannel-maxPacketLifeTime">maxPacketLifeTime</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short?</span>     <span class="idlAttrName"><a href="#widl-RTCDataChannel-maxRetransmits">maxRetransmits</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>           <span class="idlAttrName"><a href="#widl-RTCDataChannel-protocol">protocol</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">boolean</span>             <span class="idlAttrName"><a href="#widl-RTCDataChannel-negotiated">negotiated</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned short</span>      <span class="idlAttrName"><a href="#widl-RTCDataChannel-id">id</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDataChannelState"><code>RTCDataChannelState</code></a></span> <span class="idlAttrName"><a href="#widl-RTCDataChannel-readyState">readyState</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">unsigned long</span>       <span class="idlAttrName"><a href="#widl-RTCDataChannel-bufferedAmount">bufferedAmount</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">unsigned long</span>       <span class="idlAttrName"><a href="#widl-RTCDataChannel-bufferedAmountLowThreshold">bufferedAmountLowThreshold</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>        <span class="idlAttrName"><a href="#widl-RTCDataChannel-onopen">onopen</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>        <span class="idlAttrName"><a href="#widl-RTCDataChannel-onbufferedamountlow">onbufferedamountlow</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>        <span class="idlAttrName"><a href="#widl-RTCDataChannel-onerror">onerror</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>        <span class="idlAttrName"><a href="#widl-RTCDataChannel-onclose">onclose</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCDataChannel-close-void">close</a></span> ();</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span>        <span class="idlAttrName"><a href="#widl-RTCDataChannel-onmessage">onmessage</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span>           <span class="idlAttrName"><a href="#widl-RTCDataChannel-binaryType">binaryType</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCDataChannel-send-void-USVString-data">send</a></span> (<span class="idlParam"><span class="idlParamType">USVString</span> <span class="idlParamName">data</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCDataChannel-send-void-Blob-data">send</a></span> (<span class="idlParam"><span class="idlParamType">Blob</span> <span class="idlParamName">data</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCDataChannel-send-void-ArrayBuffer-data">send</a></span> (<span class="idlParam"><span class="idlParamType">ArrayBuffer</span> <span class="idlParamName">data</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCDataChannel-send-void-ArrayBufferView-data">send</a></span> (<span class="idlParam"><span class="idlParamType">ArrayBufferView</span> <span class="idlParamName">data</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-17" typeof="bibo:Chapter" id="attributes-17"><h4 resource="#h-attributes-17" id="h-attributes-17"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.2.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCDataChannel-binaryType"><code>binaryType</code> of type <span class="idlAttrType">DOMString</span></dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-binarytype"><code>binaryType</code></dfn> attribute
          <em title="MUST" class="rfc2119">MUST</em>, on getting, return the value to which it was last set. On
          setting, the user agent <em title="MUST" class="rfc2119">MUST</em> set the IDL attribute to the new value.
          When a <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object is created, the
          <code><a href="#dom-datachannel-binarytype">binaryType</a></code>
          attribute <em title="MUST" class="rfc2119">MUST</em> be initialized to the string "<code>blob</code>".</p>

          <p>This attribute controls how binary data is exposed to scripts. See
          the [<cite><a href="#bib-WEBSOCKETS-API" class="bibref">WEBSOCKETS-API</a></cite>] for more information.</p>
        </dd><dt id="widl-RTCDataChannel-bufferedAmount"><code>bufferedAmount</code> of type <span class="idlAttrType">unsigned long</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-bufferedamount"><code>bufferedAmount</code></dfn>
          attribute <em title="MUST" class="rfc2119">MUST</em> return the number of bytes of application data (UTF-8
          text and binary data) that have been queued using <code><a href="#dom-datachannel-send">send()</a></code> but that, as of the last
          time the event loop started executing a task, had not yet been
          transmitted to the network. (This thus includes any text sent during
          the execution of the current task, regardless of whether the user
          agent is able to transmit text asynchronously with script execution.)
          This does not include framing overhead incurred by the protocol, or
          buffering done by the operating system or network hardware. If the
          channel is closed, this attribute's value will only increase with
          each call to the <code><a href="#dom-datachannel-send">send()</a></code> method (the attribute does
          not reset to zero once the channel closes).</p>
        </dd><dt id="widl-RTCDataChannel-bufferedAmountLowThreshold"><code>bufferedAmountLowThreshold</code> of type <span class="idlAttrType">unsigned long</span></dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-bufferedamountlowthreshold">
          <code>bufferedAmountLowThreshold</code></dfn> attribute sets the
          threshold at which the <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code> is
          considered to be low.  When the <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code>
          decreases from above this threshold to equal or below it, the
          <code title="event-RTCDataChannel-bufferedamountlow"><a href="#event-datachannel-bufferedamountlow">bufferedamountlow</a></code>
          event fires. The
          <code><a href="#dom-datachannel-bufferedamountlowthreshold">
          bufferedAmountLowThreshold</a></code> is
          initially zero on each new <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>, but
          the application may change its value at any time.</p>
        </dd><dt id="widl-RTCDataChannel-id"><code>id</code> of type <span class="idlAttrType">unsigned short</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-id"><code>RTCDataChannel.id</code></dfn> attribute
          returns the id for this <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>. The id
          was either assigned by the user agent at channel creation time or
          selected by the script. The attribute <em title="MUST" class="rfc2119">MUST</em> return the value to which
          it was set when the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> was
          created.</p>
        </dd><dt id="widl-RTCDataChannel-label"><code>label</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-label"><code>RTCDataChannel.label</code></dfn>
          attribute represents a label that can be used to distinguish this
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object from other
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> objects. Scripts are allowed to
          create multiple <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> objects with the
          same label. The attribute <em title="MUST" class="rfc2119">MUST</em> return the value to which it was set
          when the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object was created.</p>
        </dd><dt id="widl-RTCDataChannel-maxPacketLifeTime"><code>maxPacketLifeTime</code> of type <span class="idlAttrType">unsigned short</span>, readonly       , nullable</dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-maxpacketlifetime"><code>RTCDataChannel.maxPacketLifeTime</code></dfn>
          attribute returns the length of the time window (in milliseconds)
          during which transmissions and retransmissions may occur in
          unreliable mode, or null if unset. The attribute <em title="MUST" class="rfc2119">MUST</em> be initialized
          to null by default and <em title="MUST" class="rfc2119">MUST</em> return the value to which it was set when
          the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> was created.</p>
        </dd><dt id="widl-RTCDataChannel-maxRetransmits"><code>maxRetransmits</code> of type <span class="idlAttrType">unsigned short</span>, readonly       , nullable</dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-maxretransmits"><code>RTCDataChannel.maxRetransmits</code></dfn>
          attribute returns the maximum number of retransmissions that are
          attempted in unreliable mode, or null if unset. The attribute <em title="MUST" class="rfc2119">MUST</em> be
          initialized to null by default and <em title="MUST" class="rfc2119">MUST</em> return the value to which it
          was set when the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> was created.</p>
        </dd><dt id="widl-RTCDataChannel-negotiated"><code>negotiated</code> of type <span class="idlAttrType">boolean</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-negotiated"><code>RTCDataChannel.negotiated</code></dfn>
          attribute returns true if this <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> was
          negotiated by the application, or false otherwise. The attribute <em title="MUST" class="rfc2119">MUST</em>
          be initialized to false by default and <em title="MUST" class="rfc2119">MUST</em> return the value to which
          it was set when the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> was
          created.</p>
        </dd><dt id="widl-RTCDataChannel-onbufferedamountlow"><code>onbufferedamountlow</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-datachannel-bufferedamountlow">bufferedamountlow</a></code>.</dd><dt id="widl-RTCDataChannel-onclose"><code>onclose</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-datachannel-close">close</a></code>.</dd><dt id="widl-RTCDataChannel-onerror"><code>onerror</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-datachannel-error">error</a></code>.</dd><dt id="widl-RTCDataChannel-onmessage"><code>onmessage</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-datachannel-message">message</a></code>.</dd><dt id="widl-RTCDataChannel-onopen"><code>onopen</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>The event type of this event handler is <code><a href="#event-datachannel-open">open</a></code>.</dd><dt id="widl-RTCDataChannel-ordered"><code>ordered</code> of type <span class="idlAttrType">boolean</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-ordered"><code>RTCDataChannel.ordered</code></dfn>
          attribute returns true if the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> is
          ordered, and false if other of order delivery is allowed. The
          attribute <em title="MUST" class="rfc2119">MUST</em> be initialized to true by default and <em title="MUST" class="rfc2119">MUST</em> return the
          value to which it was set when the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
          was created.</p>
        </dd><dt id="widl-RTCDataChannel-protocol"><code>protocol</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-protocol"><code>RTCDataChannel.protocol</code></dfn>
          attribute returns the name of the sub-protocol used with this
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> if any, or the empty string
          otherwise. The attribute <em title="MUST" class="rfc2119">MUST</em> be initialized to the empty string by
          default and <em title="MUST" class="rfc2119">MUST</em> return the value to which it was set when the
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> was created.</p>
        </dd><dt id="widl-RTCDataChannel-readyState"><code>readyState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDataChannelState"><code>RTCDataChannelState</code></a></span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-readystate"><code>RTCDataChannel.readyState</code></dfn>
          attribute represents the state of the <code>RTCDataChannel</code>
          object. It <em title="MUST" class="rfc2119">MUST</em> return the value to which the user agent last set it
          (as defined by the processing model algorithms).</p>
        </dd></dl></section><section property="bibo:hasPart" resource="#methods-10" typeof="bibo:Chapter" id="methods-10"><h4 resource="#h-methods-10" id="h-methods-10"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.2.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCDataChannel-close-void"><code>close</code></dt><dd>
          <p>Closes the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>. It may be called
          regardless of whether the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object
          was created by this peer or the remote peer.</p>

          <p>When the <dfn data-dfn-type="dfn" id="dom-datachannel-close"><code>RTCDataChannel
          close()</code></dfn> method is called, the user agent <em title="MUST" class="rfc2119">MUST</em> run the
          following steps:</p>

          <ol>
            <li>
              <p>Let <var>channel</var> be the
              <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object which is about to be
              closed.</p>
            </li>

            <li>
              <p>If <var>channel</var>'s <code><a href="#dom-datachannel-readystate">readyState</a></code> is
              <code>closing</code> or <code>closed</code>, then abort these
              steps.</p>
            </li>

            <li>
              <p>Set <var>channel</var>'s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
              <code>closing</code>.</p>
            </li>

            <li>
              <p>If the <code><a href="#data-transport-closing-procedure">closing procedure</a></code>
              has not started yet, start it.</p>
            </li>
          </ol>
        <div><em>No parameters.</em></div><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCDataChannel-send-void-USVString-data"><code>send</code></dt><dd>
          <p>Run the steps described by the <code><a href="#dom-datachannel-send">send()</a></code> algorithm with argument
          type <code>string</code> object.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code>USVString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCDataChannel-send-void-Blob-data"><code>send</code></dt><dd>
          <p>Run the steps described by the <code><a href="#dom-datachannel-send">send()</a></code> algorithm with argument
          type <code>Blob</code> object.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code>Blob</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCDataChannel-send-void-ArrayBuffer-data"><code>send</code></dt><dd>
          <p>Run the steps described by the <code><a href="#dom-datachannel-send">send()</a></code> algorithm with argument
          type <code>ArrayBuffer</code> object.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code>ArrayBuffer</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd><dt id="widl-RTCDataChannel-send-void-ArrayBufferView-data"><code>send</code></dt><dd>
          <p>Run the steps described by the <code><a href="#dom-datachannel-send">send()</a></code> algorithm with argument
          type <code>ArrayBufferView</code> object.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code>ArrayBufferView</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>

      <section property="bibo:hasPart" resource="#dictionary-rtcdatachannelinit-members" typeof="bibo:Chapter" id="dictionary-rtcdatachannelinit-members"><h4 resource="#h-dictionary-rtcdatachannelinit-members" id="h-dictionary-rtcdatachannelinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.2.3 </span>Dictionary <a href="#idl-def-RTCDataChannelInit" class="idlType"><code>RTCDataChannelInit</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCDataChannelInit-id"><code>id</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>
          <p>Overrides the default selection of id for this channel.</p>
        </dd><dt id="widl-RTCDataChannelInit-maxPacketLifeTime"><code>maxPacketLifeTime</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>
          <p>Limits the time during which the channel will transmit or
          retransmit data if not acknowledged. This value may be clamped if it
          exceeds the maximum value supported by the user agent.</p>
        </dd><dt id="widl-RTCDataChannelInit-maxRetransmits"><code>maxRetransmits</code> of type <span class="idlMemberType">unsigned short</span></dt><dd>
          <p>Limits the number of times a channel will retransmit data if not
          successfully delivered. This value may be clamped if it exceeds the
          maximum value supported by the user agent..</p>
        </dd><dt id="widl-RTCDataChannelInit-negotiated"><code>negotiated</code> of type <span class="idlMemberType">boolean</span>, defaulting to <code>false</code></dt><dd>
          <p>The default value of false tells the user agent to announce the
          channel in-band and instruct the other peer to dispatch a
          corresponding <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object. If set to
          true, it is up to the application to negotiate the channel and create
          a <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object with the same
          <code><a href="#dom-datachannel-id">id</a></code> at the other
          peer.</p>
        </dd><dt id="widl-RTCDataChannelInit-ordered"><code>ordered</code> of type <span class="idlMemberType">boolean</span>, defaulting to <code>true</code></dt><dd>
          <p>If set to false, data is allowed to be delivered out of order. The
          default value of true, guarantees that data will be delivered in
          order.</p>
        </dd><dt id="widl-RTCDataChannelInit-protocol"><code>protocol</code> of type <span class="idlMemberType">DOMString</span>, defaulting to <code>""</code></dt><dd>
          <p>Subprotocol name used for this channel.</p>
        </dd></dl></section>

      <p>The <dfn data-dfn-type="dfn" id="dom-datachannel-send"><code>send()</code></dfn> method is
      overloaded to handle different data argument types. When any version of
      the method is called, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

      <ol>
        <li>
          <p>Let <var>channel</var> be the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
          object on which data is to be sent.</p>
        </li>

        <li>
          <p>If <var>channel</var>'s <a href="#dom-datachannel-readystate"><code>readyState</code></a> attribute
          is <code>connecting</code>, throw an <code>InvalidStateError</code>
          exception and abort these steps.</p>
        </li>

        <li>
          <p>Execute the sub step that corresponds to the type of the methods
          argument:</p>

          <ul>
            <li>
              <p><code>string</code> object:</p>

              <p>Let <var>data</var> be the object and increase the
              <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code>
              attribute by the number of bytes needed to express
              <var>data</var> as UTF-8.</p>
            </li>

            <li>
              <p><code>Blob</code> object:</p>

              <p>Let <var>data</var> be the raw data represented by the
              <code>Blob</code> object and increase the <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code>
              attribute by the size of data, in bytes.</p>
            </li>

            <li>
              <p><code>ArrayBuffer</code> object:</p>

              <p>Let <var>data</var> be the data stored in the buffer described
              by the <code>ArrayBuffer</code> object and increase the
              <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code>
              attribute by the length of the <code>ArrayBuffer</code> in
              bytes.</p>
            </li>

            <li>
              <p><code>ArrayBufferView</code> object:</p>

              <p>Let <var>data</var> be the data stored in the section of the
              buffer described by the <code>ArrayBuffer</code> object that the
              <code>ArrayBufferView</code> object references and increase the
              <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code>
              attribute by the length of the <code>ArrayBufferView</code> in
              bytes.</p>
            </li>
          </ul>
        </li>

        <li>
          <p>If <var>channel</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> is
          not established yet, or if the <code><a href="#data-transport-closing-procedure">closing procedure</a></code> has
          started, then abort these steps.</p>
        </li>

        <li>
          <p>Attempt to send <var>data</var> on <var>channel</var>'s
          <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a>; if the data cannot be sent, e.g.
          because it would need to be buffered but the buffer is full, the user
          agent <em title="MUST" class="rfc2119">MUST</em> abruptly <a href="#data-transport-closed">close</a>
          <var>channel</var>'s <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> <a href="#data-transport-closed-error">with an error</a>.</p>
        </li>
      </ol>

      <pre class="idl"><span class="idlEnum" id="idl-def-RTCDataChannelState">enum <span class="idlEnumID">RTCDataChannelState</span> {
    "<a href="#idl-def-RTCDataChannelState.connecting" class="idlEnumItem">connecting</a>",
    "<a href="#idl-def-RTCDataChannelState.open" class="idlEnumItem">open</a>",
    "<a href="#idl-def-RTCDataChannelState.closing" class="idlEnumItem">closing</a>",
    "<a href="#idl-def-RTCDataChannelState.closed" class="idlEnumItem">closed</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCDataChannelState.connecting">connecting</code></td><td>
          <p>The user agent is attempting to establish the <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
          transport</a>. This is the initial state of a
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object created with <code><a href="#dom-peerconnection-createdatachannel">createDataChannel()</a></code>.</p>
        </td></tr><tr><td><code id="idl-def-RTCDataChannelState.open">open</code></td><td>
          <p>The <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> is established and
          communication is possible. This is the initial state of a
          <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object dispatched as a part of a
          <code><a class="idlType" href="#idl-def-RTCDataChannelEvent"><code>RTCDataChannelEvent</code></a></code>.</p>
        </td></tr><tr><td><code id="idl-def-RTCDataChannelState.closing">closing</code></td><td>
          <p>The <code><a href="#data-transport-closing-procedure">procedure</a></code> to close
          down the <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> has started.</p>
        </td></tr><tr><td><code id="idl-def-RTCDataChannelState.closed">closed</code></td><td>
          <p>The <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> has been <code><a href="#data-transport-closed">closed</a></code> or could not be
          established.</p>
        </td></tr></tbody></table>
    </section>

    <section property="bibo:hasPart" resource="#rtcdatachannelevent" typeof="bibo:Chapter" id="rtcdatachannelevent">
      <h3 resource="#h-rtcdatachannelevent" id="h-rtcdatachannelevent"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.3 </span>RTCDataChannelEvent</span></h3>

      <p>The <code><a href="#event-datachannel">datachannel</a></code> event
      uses the <code><a class="idlType" href="#idl-def-RTCDataChannelEvent"><code>RTCDataChannelEvent</code></a></code> interface.</p>

      <p><dfn data-dfn-type="dfn" id="fire-a-datachannel-event">Firing a datachannel event named
      <var>e</var></dfn> with a <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
      <var>channel</var> means that an event with the name <var>e</var>, which
      does not bubble (except where otherwise stated) and is not cancelable
      (except where otherwise stated), and which uses the
      <code><a class="idlType" href="#idl-def-RTCDataChannelEvent"><code>RTCDataChannelEvent</code></a></code> interface with the <code><a href="#dom-datachannelevent-channel">channel</a></code> attribute set to
      <var>channel</var>, <em title="MUST" class="rfc2119">MUST</em> be created and dispatched at the given
      target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCDataChannelEvent"><span class="idlDictionary" id="idl-def-RTCDataChannelEventInit">dictionary <span class="idlDictionaryID">RTCDataChannelEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></span> <span class="idlMemberName"><a href="#widl-RTCDataChannelEventInit-channel">channel</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCDataChannelEvent--DOMString-type-RTCDataChannelEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCDataChannelEventInit"><code>RTCDataChannelEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCDataChannelEvent</span> : <span class="idlSuperclass"><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></span> <span class="idlAttrName"><a href="#widl-RTCDataChannelEvent-channel">channel</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-6" typeof="bibo:Chapter" id="constructors-6"><h4 resource="#h-constructors-6" id="h-constructors-6"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.3.1 </span>Constructors</span></h4><dl class="constructors"><dt id="widl-ctor-RTCDataChannelEvent--DOMString-type-RTCDataChannelEventInit-eventInitDict"><code>RTCDataChannelEvent</code></dt><dd>readonly attribute RTCDataChannel channel<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCDataChannelEventInit"><code>RTCDataChannelEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-18" typeof="bibo:Chapter" id="attributes-18"><h4 resource="#h-attributes-18" id="h-attributes-18"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.3.2 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCDataChannelEvent-channel"><code>channel</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-datachannelevent-channel"><code>channel</code></dfn> attribute
          represents the <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object associated
          with the event.</p>
        </dd></dl></section>

      <section property="bibo:hasPart" resource="#dictionary-rtcdatachanneleventinit-members" typeof="bibo:Chapter" id="dictionary-rtcdatachanneleventinit-members"><h4 resource="#h-dictionary-rtcdatachanneleventinit-members" id="h-dictionary-rtcdatachanneleventinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.3.3 </span>Dictionary <a href="#idl-def-RTCDataChannelEventInit" class="idlType"><code>RTCDataChannelEventInit</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCDataChannelEventInit-channel"><code>channel</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></span></dt><dd>
          <div class="issue"><div id="h-issue10" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><p class="">TODO</p></div>
        </dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#garbage-collection-1" typeof="bibo:Chapter" id="garbage-collection-1">
      <h3 resource="#h-garbage-collection-1" id="h-garbage-collection-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">6.4 </span>Garbage Collection</span></h3>

      <p>A <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object <em title="MUST" class="rfc2119">MUST</em> not be garbage
      collected if its</p>

      <ul>
        <li>
          <p><code><a href="#dom-datachannel-readystate">readyState</a></code>
          is <code>connecting</code> and at least one event listener is
          registered for <code>open</code> events, <code>message</code> events,
          <code>error</code> events, or <code>close</code> events.</p>
        </li>

        <li>
          <p><code><a href="#dom-datachannel-readystate">readyState</a></code>
          is <code>open</code> and at least one event listener is registered
          for <code>message</code> events, <code>error</code> events, or
          <code>close</code> events.</p>
        </li>

        <li>
          <p><code><a href="#dom-datachannel-readystate">readyState</a></code>
          is <code>closing</code> and at least one event listener is registered
          for <code>error</code> events, or <code>close</code> events.</p>
        </li>

        <li>
          <p><a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> is established and data is queued
          to be transmitted.</p>
        </li>
      </ul>
    </section>
  </section>

  <section property="bibo:hasPart" resource="#peer-to-peer-dtmf" typeof="bibo:Chapter" id="peer-to-peer-dtmf">
    <!--OddPage--><h2 resource="#h-peer-to-peer-dtmf" id="h-peer-to-peer-dtmf"><span property="xhv:role" resource="xhv:heading"><span class="secno">7. </span>Peer-to-peer DTMF</span></h2>

    <p>This section describes an interface on <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code>
    to send DTMF (phone keypad) values across an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>.
    Details of how DTMF is sent to the other peer are described in [<cite><a href="#bib-RTCWEB-AUDIO" class="bibref">RTCWEB-AUDIO</a></cite>].</p>

    <section property="bibo:hasPart" resource="#rtcrtpsender-interface-extensions" typeof="bibo:Chapter" id="rtcrtpsender-interface-extensions">
      <h3 resource="#h-rtcrtpsender-interface-extensions" id="h-rtcrtpsender-interface-extensions"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.1 </span>RTCRtpSender Interface Extensions</span></h3>

      <p>The Peer-to-peer DTMF API extends the
      <code><a class="idlType" href="#idl-def-RTCRtpSender"><code>RTCRtpSender</code></a></code> interface as described below.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCRtpSender-1">partial interface <span class="idlInterfaceID">RTCRtpSender</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCRtpSender-dtmf">dtmf</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-19" typeof="bibo:Chapter" id="attributes-19"><h4 resource="#h-attributes-19" id="h-attributes-19"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.1.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCRtpSender-dtmf"><code>dtmf</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a></span>, readonly       , nullable</dt><dd>
          <p>The <dfn id="dfn-dtmf" data-dfn-type="dfn">dtmf</dfn> attribute returns a RTCDTMFSender
          which can be used to send DTMF.  A null value indicates that
          this RTCRtpSender cannot send DTMF.</p>
        </dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#rtcdtmfsender" typeof="bibo:Chapter" id="rtcdtmfsender">
      <h3 resource="#h-rtcdtmfsender" id="h-rtcdtmfsender"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.2 </span>RTCDTMFSender</span></h3>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCDTMFSender">[<span class="extAttr">NoInterfaceObject</span>]
interface <span class="idlInterfaceID">RTCDTMFSender</span> {
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCDTMFSender-insertDTMF-void-DOMString-tones-unsigned-long-duration-unsigned-long-interToneGap">insertDTMF</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">tones</span></span>, <span class="idlParam">optional <span class="idlParamType">unsigned long</span> <span class="idlParamName">duration</span> = <span class="idlDefaultValue">100</span></span>, <span class="idlParam">optional <span class="idlParamType">unsigned long</span> <span class="idlParamName">interToneGap</span> = <span class="idlDefaultValue">70</span></span>);</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-RTCDTMFSender-ontonechange">ontonechange</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span>    <span class="idlAttrName"><a href="#widl-RTCDTMFSender-toneBuffer">toneBuffer</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">long</span>         <span class="idlAttrName"><a href="#widl-RTCDTMFSender-duration">duration</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">long</span>         <span class="idlAttrName"><a href="#widl-RTCDTMFSender-interToneGap">interToneGap</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-20" typeof="bibo:Chapter" id="attributes-20"><h4 resource="#h-attributes-20" id="h-attributes-20"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.2.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCDTMFSender-duration"><code>duration</code> of type <span class="idlAttrType">long</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-RTCDTMFSender-duration"><code>duration</code></dfn> attribute
          <em title="MUST" class="rfc2119">MUST</em> return the current tone duration value. This value will be the
          value last set via the <code><a data-link-type="dfn" class="internalDFN" href="#dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></a></code> method, or
          the default value of 100 ms if <code><a data-link-type="dfn" class="internalDFN" href="#dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></a></code> was
          called without specifying the duration.</p>
        </dd><dt id="widl-RTCDTMFSender-interToneGap"><code>interToneGap</code> of type <span class="idlAttrType">long</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-RTCDTMFSender-intertonegap"><code>interToneGap</code></dfn>
          attribute <em title="MUST" class="rfc2119">MUST</em> return the current value of the between-tone gap. This
          value will be the value last set via the
          <code><a data-link-type="dfn" class="internalDFN" href="#dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></a></code> method, or the default value of 70
          ms if <code><a data-link-type="dfn" class="internalDFN" href="#dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></a></code> was called without specifying
          the interToneGap.</p>
        </dd><dt id="widl-RTCDTMFSender-ontonechange"><code>ontonechange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
          <p>The event type of this event handler is <code>
          <a data-link-type="dfn" class="internalDFN" href="#event-RTCDTMFSender-tonechange"><code>tonechange</code></a></code>.</p>
        </dd><dt id="widl-RTCDTMFSender-toneBuffer"><code>toneBuffer</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-RTCDTMFSender-tonebuffer"><code>toneBuffer</code></dfn>
          attribute <em title="MUST" class="rfc2119">MUST</em> return a list of the tones remaining to be played out.
          For the syntax, content, and interpretation of this list, see
          <code>insertDTMF</code>.</p>
        </dd></dl></section><section property="bibo:hasPart" resource="#methods-11" typeof="bibo:Chapter" id="methods-11"><h4 resource="#h-methods-11" id="h-methods-11"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.2.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCDTMFSender-insertDTMF-void-DOMString-tones-unsigned-long-duration-unsigned-long-interToneGap"><code>insertDTMF</code></dt><dd>
          <p>An <code><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a></code> object's <dfn data-dfn-type="dfn" id="dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></dfn> method
          is used to send DTMF tones.</p>

          <p>The tones parameter is treated as a series of characters. The
          characters 0 through 9, A through D, #, and * generate the associated
          DTMF tones. The characters a to d are equivalent to A to D. The
          character ',' indicates a delay of 2 seconds before processing the
          next character in the tones parameter. All other characters <em title="MUST" class="rfc2119">MUST</em> be
          considered <dfn data-dfn-type="dfn" id="dtmf-unrecognized">unrecognized</dfn>.
          As noted in [<cite><a href="#bib-RTCWEB-AUDIO" class="bibref">RTCWEB-AUDIO</a></cite>] Section 3, support for the characters 0 through 9, #, and *
          are required.</p>

          <p>The duration parameter indicates the duration in ms to use for
          each character passed in the tones parameters. The duration cannot be
          more than 6000 ms or less than 40 ms. The default duration is 100 ms
          for each tone.</p>

          <p>The interToneGap parameter indicates the gap between tones. It
          <em title="MUST" class="rfc2119">MUST</em> be at least 30 ms. The default value is 70 ms.</p>

          <p>The browser <em title="MAY" class="rfc2119">MAY</em> increase the duration and interToneGap times to
          cause the times that DTMF start and stop to align with the boundaries
          of RTP packets but it <em title="MUST" class="rfc2119">MUST</em> not increase either of them by more than
          the duration of a single RTP audio packet.</p>

          <div class="issue"><div id="h-issue11" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><p class="">How are invalid values handled? (see also <a href="https://github.com/w3c/webrtc-pc/issues/319">Issue 319</a>)</p></div>

          <p>When the <code><a data-link-type="dfn" class="internalDFN" href="#dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></a></code> method is invoked, the
          user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

          <ol>
            <li>Set the object's <code><a href="#dom-RTCDTMFSender-tonebuffer">toneBuffer</a></code> attribute to
            the value of the first argument, the <code><a href="#dom-RTCDTMFSender-duration">duration</a></code> attribute to the
            value of the second argument, and the <code><a href="#dom-RTCDTMFSender-intertonegap">interToneGap</a></code> attribute
            to the value of the third argument.</li>

            <li>If <code><a href="#dom-RTCDTMFSender-tonebuffer">toneBuffer</a></code> contains any
            <a href="#dtmf-unrecognized">unrecognized</a> characters, throw an
            <code>InvalidCharacterError</code> exception and abort these steps.
            </li>

            <li>If <code><a href="#dom-RTCDTMFSender-tonebuffer">toneBuffer</a></code> is an empty
            string, return.</li>

            <li>If the value of the <code><a href="#dom-RTCDTMFSender-duration">duration</a></code> attribute is less
            than 40, set it to 40. If, on the other hand, the value is greater
            than 6000, set it to 6000.</li>

            <li>If the value of the <code><a href="#dom-RTCDTMFSender-intertonegap">interToneGap</a></code> attribute
            is less than 30, set it to 30.</li>

            <li>If a <em>Playout task</em> is scheduled to be run; abort these
            steps; otherwise queue a task that runs the following steps
            (<em>Playout task</em>):

              <ol>
                <li>If <code><a href="#dom-RTCDTMFSender-tonebuffer">toneBuffer</a></code> is an
                empty string, fire an event named <code><a href="#event-RTCDTMFSender-tonechange">tonechange</a></code> with an
                empty string at the <code><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a></code> object
                and abort these steps.</li>

                <li>Remove the first character from <code><a href="#dom-RTCDTMFSender-tonebuffer">toneBuffer</a></code> and let
                that character be <var>tone</var>.</li>

                <li>Start playout of <var>tone</var> for <code><a href="#dom-RTCDTMFSender-duration">duration</a></code> ms on the
                associated RTP media stream, using the appropriate codec.</li>

                <li>Queue a task to be executed in <code><a href="#dom-RTCDTMFSender-duration">duration</a></code> +
                <code><a href="#dom-RTCDTMFSender-intertonegap">interToneGap</a></code> ms
                from now that runs the steps labelled <em>Playout
                task</em>.</li>

                <li>Fire an event named <code><a href="#event-RTCDTMFSender-tonechange">tonechange</a></code> with a
                string consisting of <var>tone</var> at the
                <code><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a></code> object.</li>
              </ol>
            </li>
          </ol>

          <p>Calling <code><a href="#dom-RTCDTMFSender-insertDTMF">insertDTMF()</a></code> with an empty
          tones parameter can be used to cancel all tones queued to play after
          the currently playing tone.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">tones</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">duration</td><td class="prmType"><code>unsigned long = 100</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">interToneGap</td><td class="prmType"><code>unsigned long = 70</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#rtcdtmftonechangeevent" typeof="bibo:Chapter" id="rtcdtmftonechangeevent">
      <h3 resource="#h-rtcdtmftonechangeevent" id="h-rtcdtmftonechangeevent"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.3 </span>RTCDTMFToneChangeEvent</span></h3>

      <p>The <code><a href="#event-RTCDTMFSender-tonechange">tonechange</a></code> event uses the
      <code><a class="idlType" href="#idl-def-RTCDTMFToneChangeEvent"><code>RTCDTMFToneChangeEvent</code></a></code> interface.</p>

      <p><dfn data-dfn-type="dfn" id="fire-a-tonechange-event">Firing a tonechange event named
      <var>e</var></dfn> with a <code>DOMString</code> <var>tone</var> means
      that an event with the name <var>e</var>, which does not bubble (except
      where otherwise stated) and is not cancelable (except where otherwise
      stated), and which uses the <code><a class="idlType" href="#idl-def-RTCDTMFToneChangeEvent"><code>RTCDTMFToneChangeEvent</code></a></code>
      interface with the <code><a href="#dom-tonechangeevent-tone">tone</a></code> attribute set to
      <var>tone</var>, <em title="MUST" class="rfc2119">MUST</em> be created and dispatched at the given target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCDTMFToneChangeEvent"><span class="idlDictionary" id="idl-def-RTCDTMFToneChangeEventInit">dictionary <span class="idlDictionaryID">RTCDTMFToneChangeEventInit</span> : <span class="idlSuperclass">EventInit</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCDTMFToneChangeEventInit-tone">tone</a></span>;</span>
};</span><br><br>[<span class="idlCtor"> <span class="idlCtorKeyword"></span><span class="idlCtorName"><a href="#widl-ctor-RTCDTMFToneChangeEvent--DOMString-type-RTCDTMFToneChangeEventInit-eventInitDict">Constructor</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">type</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCDTMFToneChangeEventInit"><code>RTCDTMFToneChangeEventInit</code></a></span> <span class="idlParamName">eventInitDict</span></span>)</span>]
interface <span class="idlInterfaceID">RTCDTMFToneChangeEvent</span> : <span class="idlSuperclass"><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-RTCDTMFToneChangeEvent-tone">tone</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#constructors-7" typeof="bibo:Chapter" id="constructors-7"><h4 resource="#h-constructors-7" id="h-constructors-7"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.3.1 </span>Constructors</span></h4><dl class="constructors"><dt id="widl-ctor-RTCDTMFToneChangeEvent--DOMString-type-RTCDTMFToneChangeEventInit-eventInitDict"><code>RTCDTMFToneChangeEvent</code></dt><dd>readonly attribute DOMString tone<table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">type</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">eventInitDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCDTMFToneChangeEventInit"><code>RTCDTMFToneChangeEventInit</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table></dd></dl></section><section property="bibo:hasPart" resource="#attributes-21" typeof="bibo:Chapter" id="attributes-21"><h4 resource="#h-attributes-21" id="h-attributes-21"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.3.2 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCDTMFToneChangeEvent-tone"><code>tone</code> of type <span class="idlAttrType">DOMString</span>, readonly       </dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-tonechangeevent-tone"><code>tone</code></dfn>
          attribute contains the character for the tone that has just begun
          playout (see <code><a data-link-type="dfn" class="internalDFN" href="#dom-RTCDTMFSender-insertDTMF"><code>insertDTMF()</code></a></code> ). If the value is the
          empty string, it indicates that the previous tone has completed
          playback.</p>
        </dd></dl></section>

      <section property="bibo:hasPart" resource="#dictionary-rtcdtmftonechangeeventinit-members" typeof="bibo:Chapter" id="dictionary-rtcdtmftonechangeeventinit-members"><h4 resource="#h-dictionary-rtcdtmftonechangeeventinit-members" id="h-dictionary-rtcdtmftonechangeeventinit-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">7.3.3 </span>Dictionary <a href="#idl-def-RTCDTMFToneChangeEventInit" class="idlType"><code>RTCDTMFToneChangeEventInit</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCDTMFToneChangeEventInit-tone"><code>tone</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
          <div class="issue"><div id="h-issue12" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><p class="">TODO</p></div>
        </dd></dl></section>
    </section>
  </section>

  <section property="bibo:hasPart" resource="#sec.stats-model" typeof="bibo:Chapter">
    <!--OddPage--><h2 resource="#sec.stats-model" id="sec.stats-model"><span property="xhv:role" resource="xhv:heading"><span class="secno">8. </span>Statistics Model</span></h2>

    <section property="bibo:hasPart" resource="#introduction-1" typeof="bibo:Chapter" id="introduction-1">
      <h3 resource="#h-introduction-1" id="h-introduction-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.1 </span>Introduction</span></h3>

      <p>The basic statistics model is that the browser maintains a set of
      statistics referenced by a <dfn data-dfn-type="dfn" id="stats-selector">selector</dfn>. The
      selector may, for example, be a <code>MediaStreamTrack</code>. For a
      track to be a valid selector, it <em title="MUST" class="rfc2119">MUST</em> be a
      <code>MediaStreamTrack</code> that is sent or received by the
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object on which the stats request
      was issued. The calling Web application provides the selector to the
      <code><a href="#widl-RTCPeerConnection-getStats-Promise-RTCStatsReport--MediaStreamTrack-selector">
        getStats()</a></code> method
      and the browser emits (in the JavaScript) a set of statistics that it
      believes is relevant to the selector.</p>

      <div class="issue"><div id="h-issue13" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><div class="">
        Evaluate the need for other selectors than MediaStreamTrack.
      </div></div>

      <p>The statistics returned are designed in such a way that repeated
      queries can be linked by the <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> <a href="#dom-rtcstats-id">id</a> dictionary member. Thus, a Web application can
      make measurements over a given time period by requesting measurements at
      the beginning and end of that period.</p>
    </section>

    <section property="bibo:hasPart" resource="#rtcpeerconnection-interface-extensions-2" typeof="bibo:Chapter" id="rtcpeerconnection-interface-extensions-2">
      <h3 resource="#h-rtcpeerconnection-interface-extensions-2" id="h-rtcpeerconnection-interface-extensions-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.2 </span>RTCPeerConnection Interface Extensions</span></h3>

      <p>The Statistics API extends the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
      interface as described below.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection-5">partial interface <span class="idlInterfaceID">RTCPeerConnection</span> {
<span class="idlMethod">    <span class="idlMethType">Promise&lt;<a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-getStats-Promise-RTCStatsReport--MediaStreamTrack-selector">getStats</a></span> (<span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>?</span> <span class="idlParamName">selector</span> = <span class="idlDefaultValue">null</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#methods-12" typeof="bibo:Chapter" id="methods-12"><h4 resource="#h-methods-12" id="h-methods-12"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.2.1 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCPeerConnection-getStats-Promise-RTCStatsReport--MediaStreamTrack-selector"><code>getStats</code></dt><dd>
          <p>Gathers stats for the given <a href="#stats-selector">selector</a>
          and reports the result asynchronously.</p>

          <p>When the <dfn data-dfn-type="dfn" id="#widl-RTCPeerConnection-getStats-Promise-RTCStatsReport--MediaStreamTrack-selector">
            <code>getStats()</code></dfn> method is
          invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

          <ol>
            <li>
              <p>Let <var>selectorArg</var> be the methods first argument.</p>
            </li>

            <li>
              <p>If <var>selectorArg</var> is neither <code>null</code> nor a
              valid <a href="#stats-selector">selector</a>,
              return a promise rejected with a <code>TypeError</code>.</p>
            </li>

            <li>
              <p>Let <var>p</var> be a new promise.</p>
            </li>

            <li>
              <p>Run the following steps in parallel:</p>

              <ol>
                <li>
                  <p>Start gathering the stats indicated by <var>selectorArg</var>.
                  If <var>selectorArg</var> is null, stats <em title="MUST" class="rfc2119">MUST</em> be gathered
                  for the whole <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>
                </li>

                <li>
                  <p>When the relevant stats have been gathered, resolve
                  <var>p</var> with a new <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code>
                  object, representing the gathered stats.</p>
                </li>
              </ol>
            </li>

            <li>
              <p>Return <var>p</var>.</p>
            </li>
          </ol>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">selector</td><td class="prmType"><code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a> = null</code></td><td class="prmNullTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;<a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a>&gt;</code></div></dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#rtcstatscallback" typeof="bibo:Chapter" id="rtcstatscallback">
      <h3 resource="#h-rtcstatscallback" id="h-rtcstatscallback"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.3 </span>RTCStatsCallback</span></h3>

      <pre class="idl"><span class="idlCallback" id="idl-def-RTCStatsCallback">callback <span class="idlCallbackID">RTCStatsCallback</span> = <span class="idlCallbackType">void</span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></span> <span class="idlParamName">report</span></span>);</span></pre><section property="bibo:hasPart" resource="#callback-rtcstatscallback-parameters" typeof="bibo:Chapter" id="callback-rtcstatscallback-parameters"><h4 resource="#h-callback-rtcstatscallback-parameters" id="h-callback-rtcstatscallback-parameters"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.3.1 </span>Callback <a href="#idl-def-RTCStatsCallback" class="idlType"><code>RTCStatsCallback</code></a> Parameters</span></h4><dl class="callback-members"><dt id="widl-RTCStatsCallback-report"><code>report</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></span></dt><dd>
          <p>A <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code> representing the gathered
          stats.</p>
        </dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#rtcstatsreport-object" typeof="bibo:Chapter" id="rtcstatsreport-object">
      <h3 resource="#h-rtcstatsreport-object" id="h-rtcstatsreport-object"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.4 </span>RTCStatsReport Object</span></h3>

      <p>The <code><a href="#widl-RTCPeerConnection-getStats-Promise-RTCStatsReport--MediaStreamTrack-selector">
        getStats()</a></code>
      method delivers a successful result in the form of an
      <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code> object. An
      <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code> object is a map between
      strings that identify the inspected objects (<a href="#dom-rtcstats-id">RTCStats.id</a>), and their corresponding
      <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code>-derived dictionaries.</p>

      <p>An <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code> may be composed of several
      <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code>-derived dictionaries, each reporting stats for one
      underlying object that the implementation thinks is relevant for the
      <a href="#stats-selector">selector</a>. One achieves the total for the
      <a href="#stats-selector">selector</a> by summing over all the stats of a
      certain type; for instance, if a <code>MediaStreamTrack</code> is carried
      by multiple SSRCs over the network, the
      <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code> may contain one <code>RTCStats</code>-derived
      dictionary per SSRC (which can be distinguished by the value of the "ssrc"
      stats attribute).</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCStatsReport">interface <span class="idlInterfaceID">RTCStatsReport</span> {
<span class="idlMaplike">    readonly maplike&lt;<span class="idlMaplikeKeyType">DOMString</span>, <span class="idlMaplikeValueType">object</span>&gt;;</span>
};</span></pre><p>This interface has "entries", "forEach", "get", "has", "keys", "values", @@iterator methods and a "size" getter brought by <code>readonly maplike</code>.</p><p>
          Use these to retrieve the various dictionaries
          descended from <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> that
          this stats report is composed of.
          The set of supported property names [<cite><a href="#bib-WEBIDL-1" class="bibref">WEBIDL-1</a></cite>] is defined as the
          ids of all the <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code>-derived dictionaries that
          have been generated for this stats report.
        </p>
    </section>

    <section property="bibo:hasPart" resource="#rtcstats-dictionary" typeof="bibo:Chapter" id="rtcstats-dictionary">
      <h3 resource="#h-rtcstats-dictionary" id="h-rtcstats-dictionary"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.5 </span>RTCStats Dictionary</span></h3>

      <p>An <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> dictionary represents the stats
      gathered by inspecting a specific object relevant to a <a href="#stats-selector">selector</a>. The <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code>
      dictionary is a base type that specifies as set of default attributes,
      such as <a href="#dom-rtcstats-timestamp">timestamp</a> and <a href="#dom-rtcstats-type">type</a>. Specific stats are added by extending the
      <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> dictionary.</p>

      <p>Note that while stats names are standardized, any given implementation
      may be using experimental values or values not yet known to the Web
      application. Thus, applications <em title="MUST" class="rfc2119">MUST</em> be prepared to deal with unknown
      stats.</p>

      <div class="issue"><div id="h-issue14" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><div class="">
        Need to define an IANA registry for this and populate with
        pointers to existing things such as the RTCP statistics.
      </div></div>

      <p>Statistics need to be synchronized with each other in order to yield
      reasonable values in computation; for instance, if "bytesSent" and
      "packetsSent" are both reported, they both need to be reported over the
      same interval, so that "average packet size" can be computed as "bytes /
      packets" - if the intervals are different, this will yield errors. Thus
      implementations <em title="MUST" class="rfc2119">MUST</em> return synchronized values for all stats in an
      <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code>-derived dictionary.</p>

      <pre class="idl"><span class="idlDictionary" id="idl-def-RTCStats">dictionary <span class="idlDictionaryID">RTCStats</span> {
<span class="idlMember">             <span class="idlMemberType">DOMHighResTimeStamp</span> <span class="idlMemberName"><a href="#widl-RTCStats-timestamp">timestamp</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCStatsType"><code>RTCStatsType</code></a></span>        <span class="idlMemberName"><a href="#widl-RTCStats-type">type</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>           <span class="idlMemberName"><a href="#widl-RTCStats-id">id</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcstats-members" typeof="bibo:Chapter" id="dictionary-rtcstats-members"><h4 resource="#h-dictionary-rtcstats-members" id="h-dictionary-rtcstats-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.5.1 </span>Dictionary <a href="#idl-def-RTCStats" class="idlType"><code>RTCStats</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCStats-id"><code>id</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
          <p>A unique <dfn data-dfn-type="dfn" id="dom-rtcstats-id"><code>id</code></dfn> that is
          associated with the object that was inspected to produce this
          <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> object. Two <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code>
          objects, extracted from two different
          <code><a class="idlType" href="#idl-def-RTCStatsReport"><code>RTCStatsReport</code></a></code> objects, <em title="MUST" class="rfc2119">MUST</em> have the same id if
          they were produced by inspecting the same underlying object. User
          agents are free to pick any format for the id as long as it meets the
          requirements above.</p>

          <div class="issue"><div id="h-issue15" role="heading" aria-level="5" class="issue-title marker"><span>Issue</span></div><div class="">
            Consider naming id something that indicates that the id refers to
            the underlying object that was inspected to produce the stats,
            instead of being an id for the JavaScript object. Suggestions:
            statsObjectId, reporterId, srcId.
          </div></div>
        </dd><dt id="widl-RTCStats-timestamp"><code>timestamp</code> of type <span class="idlMemberType">DOMHighResTimeStamp</span></dt><dd>
          <p>The <dfn data-dfn-type="dfn" id="dom-rtcstats-timestamp"><code>timestamp</code></dfn>,
          of type <code>DOMHighResTimeStamp</code> [<cite><a href="#bib-HIGHRES-TIME" class="bibref">HIGHRES-TIME</a></cite>],
          associated with this object. The time is relative to the UNIX epoch
          (Jan 1, 1970, UTC).</p>
        </dd><dt id="widl-RTCStats-type"><code>type</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCStatsType"><code>RTCStatsType</code></a></span></dt><dd>
          <p>The type of this object.</p>

          <p>The <dfn data-dfn-type="dfn" id="dom-rtcstats-type"><code>type</code></dfn> attribute
          <em title="MUST" class="rfc2119">MUST</em> be initialized to the name of the most specific type this
          <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> dictionary represents.</p>
        </dd></dl></section>

      <pre class="idl"><span class="idlEnum" id="idl-def-RTCStatsType">enum <span class="idlEnumID">RTCStatsType</span> {
    "<a href="#idl-def-RTCStatsType.inboundrtp" class="idlEnumItem">inboundrtp</a>",
    "<a href="#idl-def-RTCStatsType.outboundrtp" class="idlEnumItem">outboundrtp</a>"
};</span></pre><table class="simple"><tbody><tr><th colspan="2">Enumeration description</th></tr><tr><td><code id="idl-def-RTCStatsType.inboundrtp">inboundrtp</code></td><td>Inbound RTP.</td></tr><tr><td><code id="idl-def-RTCStatsType.outboundrtp">outboundrtp</code></td><td>Outbound RTP.</td></tr></tbody></table>
    </section>

    <section property="bibo:hasPart" resource="#derived-stats-dictionaries" typeof="bibo:Chapter" id="derived-stats-dictionaries">
      <h3 resource="#h-derived-stats-dictionaries" id="h-derived-stats-dictionaries"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.6 </span>Derived Stats Dictionaries</span></h3>

      <pre class="idl"><span class="idlDictionary" id="idl-def-RTCRTPStreamStats">dictionary <span class="idlDictionaryID">RTCRTPStreamStats</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></span> {
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCRTPStreamStats-ssrc">ssrc</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span>     <span class="idlMemberName"><a href="#widl-RTCRTPStreamStats-remoteId">remoteId</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcrtpstreamstats-members" typeof="bibo:Chapter" id="dictionary-rtcrtpstreamstats-members"><h4 resource="#h-dictionary-rtcrtpstreamstats-members" id="h-dictionary-rtcrtpstreamstats-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.6.1 </span>Dictionary <a href="#idl-def-RTCRTPStreamStats" class="idlType"><code>RTCRTPStreamStats</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCRTPStreamStats-remoteId"><code>remoteId</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
          <p>The <code>remoteId</code> can be used to look up the corresponding
          <code><a class="idlType" href="#idl-def-RTCStats"><code>RTCStats</code></a></code> object that represents stats reported by
          the other peer.</p>
        </dd><dt id="widl-RTCRTPStreamStats-ssrc"><code>ssrc</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
          <p>...</p>
        </dd></dl></section>

      <pre class="idl"><span class="idlDictionary" id="idl-def-RTCInboundRTPStreamStats">dictionary <span class="idlDictionaryID">RTCInboundRTPStreamStats</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-RTCRTPStreamStats"><code>RTCRTPStreamStats</code></a></span> {
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCInboundRTPStreamStats-packetsReceived">packetsReceived</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCInboundRTPStreamStats-bytesReceived">bytesReceived</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcinboundrtpstreamstats-members" typeof="bibo:Chapter" id="dictionary-rtcinboundrtpstreamstats-members"><h4 resource="#h-dictionary-rtcinboundrtpstreamstats-members" id="h-dictionary-rtcinboundrtpstreamstats-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.6.2 </span>Dictionary <a href="#idl-def-RTCInboundRTPStreamStats" class="idlType"><code>RTCInboundRTPStreamStats</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCInboundRTPStreamStats-bytesReceived"><code>bytesReceived</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
          <p>...</p>
        </dd><dt id="widl-RTCInboundRTPStreamStats-packetsReceived"><code>packetsReceived</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
          <p>...</p>
        </dd></dl></section>

      <pre class="idl"><span class="idlDictionary" id="idl-def-RTCOutboundRTPStreamStats">dictionary <span class="idlDictionaryID">RTCOutboundRTPStreamStats</span> : <span class="idlSuperclass"><a class="idlType" href="#idl-def-RTCRTPStreamStats"><code>RTCRTPStreamStats</code></a></span> {
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCOutboundRTPStreamStats-packetsSent">packetsSent</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">unsigned long</span> <span class="idlMemberName"><a href="#widl-RTCOutboundRTPStreamStats-bytesSent">bytesSent</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcoutboundrtpstreamstats-members" typeof="bibo:Chapter" id="dictionary-rtcoutboundrtpstreamstats-members"><h4 resource="#h-dictionary-rtcoutboundrtpstreamstats-members" id="h-dictionary-rtcoutboundrtpstreamstats-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.6.3 </span>Dictionary <a href="#idl-def-RTCOutboundRTPStreamStats" class="idlType"><code>RTCOutboundRTPStreamStats</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-RTCOutboundRTPStreamStats-bytesSent"><code>bytesSent</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
          <p>...</p>
        </dd><dt id="widl-RTCOutboundRTPStreamStats-packetsSent"><code>packetsSent</code> of type <span class="idlMemberType">unsigned long</span></dt><dd>
          <p>...</p>
        </dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#example" typeof="bibo:Chapter" id="example">
      <h3 resource="#h-example" id="h-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">8.7 </span>Example</span></h3>

      <p>Consider the case where the user is experiencing bad sound and the
      application wants to determine if the cause of it is packet loss. The
      following example code might be used:</p>
      <div class="example"><div class="example-title marker"><span>Example 3</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> baselineReport</span><span class="pun">,</span><span class="pln"> currentReport</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> selector </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">getSenders</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">].</span><span class="pln">track</span><span class="pun">;</span><span class="pln">

pc</span><span class="pun">.</span><span class="pln">getStats</span><span class="pun">(</span><span class="pln">selector</span><span class="pun">).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">report</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    baselineReport </span><span class="pun">=</span><span class="pln"> report</span><span class="pun">;</span><span class="pln">
</span><span class="pun">})</span><span class="pln">
</span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Promise</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">resolve</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        setTimeout</span><span class="pun">(</span><span class="pln">resolve</span><span class="pun">,</span><span class="pln"> aBit</span><span class="pun">);</span><span class="pln"> </span><span class="com">// ... wait a bit</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">})</span><span class="pln">
</span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">getStats</span><span class="pun">(</span><span class="pln">selector</span><span class="pun">);</span><span class="pln">
</span><span class="pun">})</span><span class="pln">
</span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">report</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    currentReport </span><span class="pun">=</span><span class="pln"> report</span><span class="pun">;</span><span class="pln">
    processStats</span><span class="pun">();</span><span class="pln">
</span><span class="pun">})</span><span class="pln">
</span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">());</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> processStats</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="com">// compare the elements from the current report with the baseline</span><span class="pln">
    currentReport</span><span class="pun">.</span><span class="pln">forEach </span><span class="pun">(</span><span class="pln">now </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">now</span><span class="pun">.</span><span class="pln">type </span><span class="pun">!=</span><span class="pln"> </span><span class="str">"outboundrtp"</span><span class="pun">)</span><span class="pln">
            </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">

        </span><span class="com">// get the corresponding stats from the baseline report</span><span class="pln">
        </span><span class="kwd">base</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> baselineReport</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">now</span><span class="pun">.</span><span class="pln">id</span><span class="pun">);</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">base</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            remoteNow </span><span class="pun">=</span><span class="pln"> currentReport</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">now</span><span class="pun">.</span><span class="pln">remoteId</span><span class="pun">);</span><span class="pln">
            remoteBase </span><span class="pun">=</span><span class="pln"> baselineReport</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="kwd">base</span><span class="pun">.</span><span class="pln">remoteId</span><span class="pun">);</span><span class="pln">

            </span><span class="kwd">var</span><span class="pln"> packetsSent </span><span class="pun">=</span><span class="pln"> now</span><span class="pun">.</span><span class="pln">packetsSent </span><span class="pun">-</span><span class="pln"> </span><span class="kwd">base</span><span class="pun">.</span><span class="pln">packetsSent</span><span class="pun">;</span><span class="pln">
            </span><span class="kwd">var</span><span class="pln"> packetsReceived </span><span class="pun">=</span><span class="pln"> remoteNow</span><span class="pun">.</span><span class="pln">packetsReceived </span><span class="pun">-</span><span class="pln"> remoteBase</span><span class="pun">.</span><span class="pln">packetsReceived</span><span class="pun">;</span><span class="pln">

            </span><span class="com">// if fractionLost is &gt; 0.3, we have probably found the culprit</span><span class="pln">
            </span><span class="kwd">var</span><span class="pln"> fractionLost </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">packetsSent </span><span class="pun">-</span><span class="pln"> packetsReceived</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> packetsSent</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></pre></div>
    </section>
  </section>

  <section property="bibo:hasPart" resource="#sec.identity-proxy" typeof="bibo:Chapter">
    <!--OddPage--><h2 resource="#sec.identity-proxy" id="sec.identity-proxy"><span property="xhv:role" resource="xhv:heading"><span class="secno">9. </span>Identity</span></h2>

    <section property="bibo:hasPart" resource="#identity-provider-interaction" typeof="bibo:Chapter" id="identity-provider-interaction">
      <h3 resource="#h-identity-provider-interaction" id="h-identity-provider-interaction"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.1 </span>Identity Provider Interaction</span></h3>

      <p>WebRTC offers and answers (and hence the channels established by
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> objects) can be authenticated by
      using a web-based Identity Provider (IdP). The idea is that the entity
      sending an offer or answer acts as the Authenticating Party (AP) and
      obtains an identity assertion from the IdP which it attaches to the
      session description. The consumer of the session description (i.e., the
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> on which
      <code>setRemoteDescription()</code> is called) acts as the Relying Party
      (RP) and verifies the assertion.</p>

      <p>The interaction with the IdP is designed to decouple the browser from
      any particular identity provider; the browser need only know how to load
      the IdP's JavaScript, the location of which is determined by the IdP's
      identity, and the generic interface to generating and validating
      assertions. The IdP provides whatever logic is necessary to bridge the
      generic protocol to the IdP's specific requirements. Thus, a single
      browser can support any number of identity protocols, including being
      forward compatible with IdPs which did not exist at the time the browser
      was written.</p>

      <section property="bibo:hasPart" resource="#sec.identity-proxy-communications" typeof="bibo:Chapter">
        <h4 resource="#sec.identity-proxy-communications" id="sec.identity-proxy-communications"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.1.1 </span>Identity Provider
        Selection</span></h4>

        <p>An IdP is used to generate an identity assertion as
        follows:</p>

        <ol>
          <li>If the <code>setIdentityProvider()</code> method has been called,
          the IdP provided shall be used.</li>

          <li>If the <code>setIdentityProvider()</code> method has not been
          called, then the user agent <em title="MAY" class="rfc2119">MAY</em> use an IdP configured into the
          browser.</li>
        </ol>

        <p>In order to verify assertions, the IdP domain name and protocol are
        taken from the <code>domain</code> and <code>protocol</code> fields of
        the identity assertion.</p>
      </section>

      <section property="bibo:hasPart" resource="#sec.create-identity-proxy" typeof="bibo:Chapter">
        <h4 resource="#sec.create-identity-proxy" id="sec.create-identity-proxy"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.1.2 </span>Instantiating an IdP Proxy</span></h4>

        <p>In order to communicate with the IdP, the user agent loads the IdP
        JavaScript from the IdP.   The URI for the IdP script is a
        well-known URI formed from the <q>domain</q> and <q>protocol</q>
        fields, as specified in [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].</p>

        <p>The IdP <em title="MAY" class="rfc2119">MAY</em> generate an HTTP redirect to another "https" origin, the
        browser <em title="MUST" class="rfc2119">MUST</em> treat a redirect to any other scheme as a fatal error.</p>

        <p>The user agent instantiates an isolated interpreted context, a
        JavaScript <a href="http://people.mozilla.org/~jorendorff/es6-draft.html#sec-code-realms"><dfn id="dfn-realm" data-dfn-type="dfn">realm</dfn></a>
        that operates in the origin of the loaded JavaScript. Note that a
        redirect will change the origin of the loaded script.</p>

        <p>The <a data-link-type="dfn" class="internalDFN" href="#dfn-realm">realm</a> is populated with a global that implements
        <code>WorkerGlobalScope</code> [<cite><a href="#bib-WEBWORKERS" class="bibref">WEBWORKERS</a></cite>].</p>

        <p>The user agent provides an instance of
        <code><a class="idlType" href="#idl-def-RTCIdentityProviderRegistrar"><code>RTCIdentityProviderRegistrar</code></a></code> named
        <var>rtcIdentityProvider</var> in the global scope of the <a data-link-type="dfn" class="internalDFN" href="#dfn-realm">realm</a>.
        This object is used by the IdP to interact with the user agent.</p>

        <p>A global property can only be set by the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> or the IdP
        proxy itself.  Therefore, the IdP proxy can be assured that requests it
        receives originate from the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a>.  This ensures that an
        arbitrary origin is unable to instantiate an IdP proxy and impersonate
        this API in order obtain identity assertions.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCIdentityProviderGlobalScope">interface <span class="idlInterfaceID">RTCIdentityProviderGlobalScope</span> : <span class="idlSuperclass">WorkerGlobalScope</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIdentityProviderRegistrar"><code>RTCIdentityProviderRegistrar</code></a></span> <span class="idlAttrName"><a href="#widl-RTCIdentityProviderGlobalScope-rtcIdentityProvider">rtcIdentityProvider</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-22" typeof="bibo:Chapter" id="attributes-22"><h5 resource="#h-attributes-22" id="h-attributes-22"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.1.2.1 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-RTCIdentityProviderGlobalScope-rtcIdentityProvider"><code>rtcIdentityProvider</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIdentityProviderRegistrar"><code>RTCIdentityProviderRegistrar</code></a></span>, readonly       </dt><dd>
            This object is used by the IdP to register an
            <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code> instance with the browser.
          </dd></dl></section>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#sec.register-idp" typeof="bibo:Chapter">
      <h3 resource="#sec.register-idp" id="sec.register-idp"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2 </span>Registering an IdP Proxy</span></h3>

      <p>An IdP proxy implements the <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code>
      callback interface, which is the means by which the user agent is able to
      request that an identity assertion be generated or validated.</p>

      <p>Once instantiated, the IdP script is executed.  The IdP <em title="MUST" class="rfc2119">MUST</em> call the
      <code>register()</code> function on the
      <code><a class="idlType" href="#idl-def-RTCIdentityProviderRegistrar"><code>RTCIdentityProviderRegistrar</code></a></code> instance during script
      execution.  If an IdP is not registered during this script execution, the
      user agent cannot use the IdP proxy and <em title="MUST" class="rfc2119">MUST</em> fail any future attempt to
      interact with the IdP.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCIdentityProviderRegistrar">interface <span class="idlInterfaceID">RTCIdentityProviderRegistrar</span> {
<span class="idlMethod">    <span class="idlMethType">void</span> <span class="idlMethName"><a href="#widl-RTCIdentityProviderRegistrar-register-void-RTCIdentityProvider-idp">register</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></span> <span class="idlParamName">idp</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#methods-13" typeof="bibo:Chapter" id="methods-13"><h4 resource="#h-methods-13" id="h-methods-13"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.1 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCIdentityProviderRegistrar-register-void-RTCIdentityProvider-idp"><code>register</code></dt><dd>
          <p>This method is invoked by the IdP when its script is first
          executed.  This registers an instance of
          <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code> with the user agent.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">idp</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>

      <section property="bibo:hasPart" resource="#interface-exposed-by-identity-providers" typeof="bibo:Chapter" id="interface-exposed-by-identity-providers">
        <h4 resource="#h-interface-exposed-by-identity-providers" id="h-interface-exposed-by-identity-providers"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.2 </span>Interface Exposed by Identity Providers</span></h4>

        <p>The <code>RTCIdentityProvider</code> interface is exposed by identity
        providers and is called by <code>RTCPeerConnection</code> to acquire or
        validate identity assertions.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCIdentityProvider">callback interface <span class="idlInterfaceID">RTCIdentityProvider</span> {
<span class="idlMethod">    <span class="idlMethType">Promise&lt;<a class="idlType" href="#idl-def-RTCIdentityAssertionResult"><code>RTCIdentityAssertionResult</code></a>&gt;</span>  <span class="idlMethName"><a href="#widl-RTCIdentityProvider-generateAssertion-Promise-RTCIdentityAssertionResult--DOMString-contents-DOMString-origin-DOMString-usernameHint">generateAssertion</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">contents</span></span>, <span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">origin</span></span>, <span class="idlParam">optional <span class="idlParamType">DOMString</span> <span class="idlParamName">usernameHint</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;<a class="idlType" href="#idl-def-RTCIdentityValidationResult"><code>RTCIdentityValidationResult</code></a>&gt;</span> <span class="idlMethName"><a href="#widl-RTCIdentityProvider-validateAssertion-Promise-RTCIdentityValidationResult--DOMString-assertion-DOMString-origin">validateAssertion</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">assertion</span></span>, <span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">origin</span></span>);</span>
};</span></pre><section property="bibo:hasPart" resource="#methods-14" typeof="bibo:Chapter" id="methods-14"><h5 resource="#h-methods-14" id="h-methods-14"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.2.1 </span>Methods</span></h5><dl class="methods"><dt id="widl-RTCIdentityProvider-generateAssertion-Promise-RTCIdentityAssertionResult--DOMString-contents-DOMString-origin-DOMString-usernameHint"><code>generateAssertion</code></dt><dd>
            <p>A user agent invokes this method on the IdP to request the
            generation of an identity assertion.</p>

            <p>The <var>contents</var> parameter includes the information that the
            user agent wants covered by the identity assertion.  A successful
            validation of the provided assertion <em title="MUST" class="rfc2119">MUST</em> produce this string.</p>

            <p>The <var>origin</var> parameter identifies the origin of the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> that triggered this request.
            An IdP can use this information as input to policy decisions about
            use.  This value is generated by the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> based on the
            origin of the document that created
            the <code>RTCPeerConnection</code> and therefore can be trusted to
            be correct.</p>

            <p>The IdP selects the identity to assert.  The optional
            <var>usernameHint</var> parameter is the same value that was passed to
            <code>setIdentityProvider</code>.</p>

            <p>The IdP provides a promise that resolves to an
            <code><a class="idlType" href="#idl-def-RTCIdentityAssertionResult"><code>RTCIdentityAssertionResult</code></a></code> to successfully
            generate an identity assertion. Any other value, or a rejected
            promise, is treated as an error.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">contents</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">origin</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">usernameHint</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;<a class="idlType" href="#idl-def-RTCIdentityAssertionResult"><code>RTCIdentityAssertionResult</code></a>&gt;</code></div></dd><dt id="widl-RTCIdentityProvider-validateAssertion-Promise-RTCIdentityValidationResult--DOMString-assertion-DOMString-origin"><code>validateAssertion</code></dt><dd>
            <p>A user agent invokes this method on the IdP to request the
            validation of an identity assertion.</p>

            <p>The <var>assertion</var> parameter includes the assertion that was
            recovered from an <code>a=identity</code> in the session description;
            that is, the value that was part of the
            <code><a class="idlType" href="#idl-def-RTCIdentityAssertionResult"><code>RTCIdentityAssertionResult</code></a></code> provided by the IdP
            that generated the assertion.</p>

            <p>The <var>origin</var> parameter identifies the origin of the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> that triggered this request.  An
            IdP can use this information as input to policy decisions about
            use.</p>

            <p>The IdP returns a Promise that resolves to an
            <code><a class="idlType" href="#idl-def-RTCIdentityValidationResult"><code>RTCIdentityValidationResult</code></a></code> to successfully
            validate an identity assertion and to provide the actual identity.
            Any other value, or a rejected promise, is treated as an error.</p>
          <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">assertion</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">origin</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>Promise&lt;<a class="idlType" href="#idl-def-RTCIdentityValidationResult"><code>RTCIdentityValidationResult</code></a>&gt;</code></div></dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#identity-assertion-and-validation-results" typeof="bibo:Chapter" id="identity-assertion-and-validation-results">
        <h4 resource="#h-identity-assertion-and-validation-results" id="h-identity-assertion-and-validation-results"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.3 </span>Identity Assertion and Validation Results</span></h4>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIdentityAssertionResult">dictionary <span class="idlDictionaryID">RTCIdentityAssertionResult</span> {
<span class="idlMember">    required <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIdentityProviderDetails"><code>RTCIdentityProviderDetails</code></a></span> <span class="idlMemberName"><a href="#widl-RTCIdentityAssertionResult-idp">idp</a></span>;</span>
<span class="idlMember">    required <span class="idlMemberType">DOMString</span>                  <span class="idlMemberName"><a href="#widl-RTCIdentityAssertionResult-assertion">assertion</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcidentityassertionresult-members" typeof="bibo:Chapter" id="dictionary-rtcidentityassertionresult-members"><h5 resource="#h-dictionary-rtcidentityassertionresult-members" id="h-dictionary-rtcidentityassertionresult-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.3.1 </span>Dictionary <a href="#idl-def-RTCIdentityAssertionResult" class="idlType"><code>RTCIdentityAssertionResult</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCIdentityAssertionResult-assertion"><code>assertion</code> of type <span class="idlMemberType">DOMString</span>, required</dt><dd>
            <p>An identity assertion.  This is an opaque string that <em title="MUST" class="rfc2119">MUST</em>
            contain all information necessary to assert identity.  This value is
            consumed by the validating IdP.</p>
          </dd><dt id="widl-RTCIdentityAssertionResult-idp"><code>idp</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIdentityProviderDetails"><code>RTCIdentityProviderDetails</code></a></span>, required</dt><dd>
            <p>An IdP provides these details to identify the IdP that validates
            the identity assertion.  This struct contains the same information
            that is provided to <code>setIdentityProvider</code>.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIdentityProviderDetails">dictionary <span class="idlDictionaryID">RTCIdentityProviderDetails</span> {
<span class="idlMember">    required <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCIdentityProviderDetails-domain">domain</a></span>;</span>
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCIdentityProviderDetails-protocol">protocol</a></span> = <span class="idlMemberValue">"default"</span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcidentityproviderdetails-members" typeof="bibo:Chapter" id="dictionary-rtcidentityproviderdetails-members"><h5 resource="#h-dictionary-rtcidentityproviderdetails-members" id="h-dictionary-rtcidentityproviderdetails-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.3.2 </span>Dictionary <a href="#idl-def-RTCIdentityProviderDetails" class="idlType"><code>RTCIdentityProviderDetails</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCIdentityProviderDetails-domain"><code>domain</code> of type <span class="idlMemberType">DOMString</span>, required</dt><dd>
            <p>The domain name of the IdP that validated the associated identity
            assertion.</p>
          </dd><dt id="widl-RTCIdentityProviderDetails-protocol"><code>protocol</code> of type <span class="idlMemberType">DOMString</span>, defaulting to <code>"default"</code></dt><dd>
            <p>The protocol parameter used for the IdP.</p>
          </dd></dl></section>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIdentityValidationResult">dictionary <span class="idlDictionaryID">RTCIdentityValidationResult</span> {
<span class="idlMember">    required <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCIdentityValidationResult-identity">identity</a></span>;</span>
<span class="idlMember">    required <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-RTCIdentityValidationResult-contents">contents</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-rtcidentityvalidationresult-members" typeof="bibo:Chapter" id="dictionary-rtcidentityvalidationresult-members"><h5 resource="#h-dictionary-rtcidentityvalidationresult-members" id="h-dictionary-rtcidentityvalidationresult-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.2.3.3 </span>Dictionary <a href="#idl-def-RTCIdentityValidationResult" class="idlType"><code>RTCIdentityValidationResult</code></a> Members</span></h5><dl class="dictionary-members"><dt id="widl-RTCIdentityValidationResult-contents"><code>contents</code> of type <span class="idlMemberType">DOMString</span>, required</dt><dd>
            <p>The payload of the identity assertion.  An IdP that validates an
            identity assertion <em title="MUST" class="rfc2119">MUST</em> return the same string that was provided to
            the original IdP that generated the assertion.</p>

            <p>The user agent uses the <var>contents</var> string to determine if
            the identity assertion matches the session description.
          </p></dd><dt id="widl-RTCIdentityValidationResult-identity"><code>identity</code> of type <span class="idlMemberType">DOMString</span>, required</dt><dd>
            <p>The validated identity of the peer.</p>
          </dd></dl></section>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#sec.identity-proxy-assertion-request" typeof="bibo:Chapter">
      <h3 resource="#sec.identity-proxy-assertion-request" id="sec.identity-proxy-assertion-request"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.3 </span>Requesting Identity
      Assertions</span></h3>

      <p>The identity assertion request process is triggered by a call to
      <code>createOffer</code>, <code>createAnswer</code>, or
      <code>getIdentityAssertion</code>.  When these calls are invoked and an
      identity provider has been set, the following steps are executed:</p>

      <ol>
        <li>
          <p>The <code>RTCPeerConnection</code> instantiates an IdP as described
          in <a href="#sec.identity-proxy-communications">Identity Provider Selection</a> and <a href="#sec.register-idp">Registering an IdP Proxy</a>.  If the IdP cannot be loaded,
          instantiated, or the IdP proxy is not registered, this process
          fails.</p>
        </li>

        <li>
          <p>The <code>RTCPeerConnection</code> invokes the <code><a href="#widl-RTCIdentityProvider-generateAssertion-Promise-RTCIdentityAssertionResult--DOMString-contents-DOMString-origin-DOMString-usernameHint">generateAssertion</a></code>
          method on the <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code> instance
          registered by the IdP.</p>

          <p>The <code>RTCPeerConnection</code> generates the
          <var>contents</var> parameter to this method as described in
          [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].  The value of <var>contents</var> includes
          the fingerprint of the certificate that was selected or generated
          during the construction of the <code>RTCPeerConnection</code>.
          The <var>origin</var> parameter contains the origin of the script that
          calls the <code>RTCPeerConnection</code> method that triggers this
          behavior.  The <var>usernameHint</var> value is the same value that is
          provided to
          <code>setIdentityProvider</code>, if any such value was provided.</p>
        </li>

        <li>
          <p>The IdP returns a Promise to the <code>RTCPeerConnection</code>.
          If the user has been authenticated by the IdP, and the IdP is willing
          to generate an identity assertion, the IdP resolves the promise with
          an identity assertion in the form of an
          <code><a class="idlType" href="#idl-def-RTCIdentityAssertionResult"><code>RTCIdentityAssertionResult</code></a></code>.</p>

          <p>This step depends entirely on the IdP. The methods by which an IdP
          authenticates users or generates assertions is not specified, though
          they could involve interacting with the IdP server or other
          servers.</p>
        </li>

        <li>
          <p>The <code>RTCPeerConnection</code> <em title="MAY" class="rfc2119">MAY</em> store the identity assertion
          for use with future offers or answers.  If a fresh identity assertion
          is needed for any reason, applications can create a
          new <code>RTCPeerConnection</code>.</p>
        </li>

        <li>
          <p>If the identity request was triggered by a
          <code>createOffer()</code> or <code>createAnswer()</code>, then the
          assertion is converted to a JSON string, base64-encoded and inserted
          into an <code>a=identity</code> attribute in the session
          description.</p>
        </li>
      </ol>

      <p>This process can fail.  The IdP proxy <em title="MAY" class="rfc2119">MAY</em> reject the promise, or the
      process of loading and registering the IdP could fail.  If assertion
      generation fails, then the promise for the corresponding function call is
      rejected.</p>

      <p>The browser <em title="SHOULD" class="rfc2119">SHOULD</em> limit the time that it will allow for this process.
      This includes both the loading of the <a href="#sec.identity-proxy-communications">IdP proxy</a> and the identity
      assertion generation. Failure to do so potentially causes the
      corresponding operation to take an indefinite amount of time. This timer
      can be cancelled when the IdP produces a response. The timer running to
      completion can be treated as equivalent to an error from the IdP.</p>

      <section property="bibo:hasPart" resource="#sec.idp-loginneeded" typeof="bibo:Chapter">
        <h4 resource="#sec.idp-loginneeded" id="sec.idp-loginneeded"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.3.1 </span>User Login Procedure</span></h4>

        <p>An IdP <em title="MAY" class="rfc2119">MAY</em> reject an attempt to generate an identity assertion if it
        is unable to verify that a user is authenticated. This might be due to
        the IdP not having the necessary authentication information available to
        it (such as cookies).</p>

        <p>Rejecting the promise returned by <code><a href="#widl-RTCIdentityProvider-generateAssertion-Promise-RTCIdentityAssertionResult--DOMString-contents-DOMString-origin-DOMString-usernameHint">generateAssertion</a></code>
        will cause the error to propagate to the application.  Login errors are
        indicated by rejecting the promise with an object that has a
        <code>name</code> attribute set to "IdpLoginError".</p>

        <p>If the rejection object also contains a <code>loginUrl</code>
        attribute, this value will be passed to the application in
        the <code>idpLoginUrl</code> attribute. This URL might link to page
        where a user can enter their (IdP) username and password, or otherwise
        provide any information the IdP needs to authorize a assertion
        request.</p>

        <p>An application can load the login URL in an IFRAME or popup window;
        the resulting page then <em title="SHOULD" class="rfc2119">SHOULD</em> provide the user with an opportunity to
        enter any information necessary to complete the authorization process.</p>

        <p>Once the authorization process is complete, the page loaded in the
        IFRAME or popup sends a message using <var>postMessage</var>
        [<cite><a href="#bib-webmessaging" class="bibref">webmessaging</a></cite>] to the page that loaded it (through the <var><a href="http://www.w3.org/html/wg/drafts/html/master/browsers.html#dom-opener">
        window.opener</a></var> attribute for popups, or through <var><a href="http://www.w3.org/html/wg/drafts/html/master/browsers.html#dom-parent">
        window.parent</a></var> for pages loaded in an IFRAME). The message <em title="MUST" class="rfc2119">MUST</em>
        consist of the <var>DOMString</var> "LOGINDONE". This message informs
        the application that another attempt at generating an identity assertion
        is likely to be successful.</p>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#sec.identity-verify-assertion" typeof="bibo:Chapter">
      <h3 resource="#sec.identity-verify-assertion" id="sec.identity-verify-assertion"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.4 </span>Verifying Identity Assertions</span></h3>

      <p>Identity assertion validation happens when <code><a href="#dom-peerconnection-setremotedescription">setRemoteDescription</a></code>
      is invoked on <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>. The process runs
      asynchronously, meaning that validation of an identity assertion might not
      block the completion of <code>setRemoteDescription</code>.</p>

      <p>The identity assertion request process involves the following
      asynchronous steps:</p>

      <ol>
        <li>
          <p>The <code>RTCPeerConnection</code> awaits any prior identity
          validation.  Only one identity validation can run at a time for an
          <code>RTCPeerConnection</code>.  This can happen because the
          resolution of <code>setRemoteDescription</code> is not blocked by
          identity validation unless there is
          a <a href="#target-peer-identity">target peer identity</a>.
        </p></li>
        <li>
          <p>The <code>RTCPeerConnection</code> loads the identity assertion
          from the session description and decodes the base64 value, then parses
          the resulting JSON.  The <var>idp</var> parameter of the resulting
          dictionary contains a <var>domain</var> and an optional
          <var>protocol</var> value that identifies the IdP, as described in
          [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].</p>
        </li>
        <li>
          <p>The <code>RTCPeerConnection</code> instantiates the identified IdP
          as described in <a class="sec-ref" href="#sec.identity-proxy-communications"><span class="secno">9.1.1</span> <span class="sec-title">Identity Provider
        Selection</span></a> and
          <a class="sec-ref" href="#sec.register-idp"><span class="secno">9.2</span> <span class="sec-title">Registering an IdP Proxy</span></a>.  If the IdP cannot be loaded,
          instantiated or the IdP proxy is not registered, this process
          fails.</p>
        </li>

        <li>
          <p>The <code>RTCPeerConnection</code> invokes the <code><a href="#widl-RTCIdentityProvider-validateAssertion-Promise-RTCIdentityValidationResult--DOMString-assertion-DOMString-origin">validateAssertion</a></code>
          method on the <code><a class="idlType" href="#idl-def-RTCIdentityProvider"><code>RTCIdentityProvider</code></a></code> instance
          registered by the IdP.</p>

          <p>The <var>assertion</var> parameter is taken from the decoded
          identity assertion.  The <var>origin</var> parameter contains the
          origin of the script that calls the <code>RTCPeerConnection</code>
          method that triggers this behavior.
        </p></li>

        <li>
          <p>The IdP proxy returns a promise and performs the validation process
          asynchronously.</p>
          <p>The IdP proxy verifies the identity assertion using whatever means
          necessary.  Depending on the authentication protocol this could
          involve interacting with the IDP server.</p>
        </li>

        <li>
          <p>Once the assertion is successfully verified, the IdP proxy resolves
          the promise with an <code><a class="idlType" href="#idl-def-RTCIdentityValidationResult"><code>RTCIdentityValidationResult</code></a></code>
          containing the validated identity and the original contents that are
          the payload of the assertion.</p>
        </li>

        <li>
          <p>The <code>RTCPeerConnection</code> decodes the contents and
          validates that it contains a fingerprint value for every
          <code>a=fingerprint</code> attribute in the session description.  This
          ensures that the certificate used by the remote peer for
          communications is covered by the identity assertion.</p>

          <p>If a peer offers a certificate that doesn't match
          an <code>a=fingerprint</code> line in the negotiated session
          description, the <a data-link-type="dfn" class="internalDFN" href="#dfn-user-agent">user agent</a> <em title="MUST NOT" class="rfc2119">MUST NOT</em> permit communication with
          that peer.</p>
        </li>

        <li>
          <p>The <code>RTCPeerConnection</code> validates that the domain
          portion of the identity matches the domain of the IdP as described in
          [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].</p>
        </li>

        <li>
          <p>The <code>RTCPeerConnection</code> resolves the <code><a href="#widl-RTCPeerConnection-peerIdentity">peerIdentity</a></code>
          attribute with a new instance of <code>RTCIdentityAssertion</code>
          that includes the IdP domain and peer identity.</p>
        </li>

        <li>
          <p>The browser <em title="MAY" class="rfc2119">MAY</em> display identity information to a user in browser
          UI. Any user identity information that is displayed in this fashion
          <em title="MUST" class="rfc2119">MUST</em> use a mechanism that cannot be spoofed by content.</p>
        </li>
      </ol>

      <p>This process can fail at any step above.  If identity validation fails,
      the <code><a href="#widl-RTCPeerConnection-peerIdentity">peerIdentity</a></code> promise is
      rejected with a <code>DOMError</code> that has a name of
      <code>IdpError</code>.</p>

      <p>If identity validation fails and there is
      a <a href="#target-peer-identity">target peer identity</a> for the
      <code>RTCPeerConnection</code>, the promise returned by
      <code>setRemoteDescription</code> <em title="MUST" class="rfc2119">MUST</em> be rejected.</p>

      <p>If identity validation fails and there is no a <a href="#target-peer-identity">target peer identity</a>, the value of the
      <code><a href="#widl-RTCPeerConnection-peerIdentity">peerIdentity</a></code> <em title="MUST" class="rfc2119">MUST</em> be set
      to a new, unresolved promise instance.  This permits the use of
      renegotiation (or a subsequent answer, if the session description was a
      provisional answer) to resolve or reject the identity.</p>

      <p>The browser <em title="SHOULD" class="rfc2119">SHOULD</em> limit the time that it will allow for identity
      validation.  This includes both the loading of the <a href="#sec.identity-proxy-communications">IdP proxy</a> and the identity
      assertion validation. Failure to do so potentially causes the operation to
      take an indefinite amount of time. This timer can be cancelled when the
      IdP produces a response. The timer running to completion is treated as
      equivalent to an error from the IdP.</p>
    </section>

    <section property="bibo:hasPart" resource="#rtcpeerconnection-interface-extensions-3" typeof="bibo:Chapter" id="rtcpeerconnection-interface-extensions-3">
      <h3 resource="#h-rtcpeerconnection-interface-extensions-3" id="h-rtcpeerconnection-interface-extensions-3"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.5 </span>RTCPeerConnection Interface Extensions</span></h3>

      <p>The Identity API extends the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
      interface as described below.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection-6">partial interface <span class="idlInterfaceID">RTCPeerConnection</span> {
<span class="idlMethod">    <span class="idlMethType">void</span>               <span class="idlMethName"><a href="#widl-RTCPeerConnection-setIdentityProvider-void-DOMString-provider-DOMString-protocol-DOMString-usernameHint">setIdentityProvider</a></span> (<span class="idlParam"><span class="idlParamType">DOMString</span> <span class="idlParamName">provider</span></span>, <span class="idlParam">optional <span class="idlParamType">DOMString</span> <span class="idlParamName">protocol</span></span>, <span class="idlParam">optional <span class="idlParamType">DOMString</span> <span class="idlParamName">usernameHint</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType">Promise&lt;DOMString&gt;</span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-getIdentityAssertion-Promise-DOMString">getIdentityAssertion</a></span> ();</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">Promise&lt;<a class="idlType" href="#idl-def-RTCIdentityAssertion"><code>RTCIdentityAssertion</code></a>&gt;</span> <span class="idlAttrName"><a href="#widl-RTCPeerConnection-peerIdentity">peerIdentity</a></span>;</span>
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">DOMString?</span>                    <span class="idlAttrName"><a href="#widl-RTCPeerConnection-idpLoginUrl">idpLoginUrl</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-23" typeof="bibo:Chapter" id="attributes-23"><h4 resource="#h-attributes-23" id="h-attributes-23"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.5.1 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCPeerConnection-idpLoginUrl"><code>idpLoginUrl</code> of type <span class="idlAttrType">DOMString</span>, readonly       , nullable</dt><dd>
          <p>The URL that an application can navigate to so that the user can
          login to the IdP, as described
          in <a class="sec-ref" href="#sec.idp-loginneeded"><span class="secno">9.3.1</span> <span class="sec-title">User Login Procedure</span></a>.</p>
        </dd><dt id="widl-RTCPeerConnection-peerIdentity"><code>peerIdentity</code> of type <span class="idlAttrType">Promise&lt;<a class="idlType" href="#idl-def-RTCIdentityAssertion"><code>RTCIdentityAssertion</code></a>&gt;</span>, readonly       </dt><dd>
          <p>A promise that resolves with the identity of the peer if the
          identity is successfully validated.</p>

          <p>This promise is rejected if an identity assertion is present in a
          remote session description and validation of that assertion fails for
          any reason.  If the promise is rejected, a new unresolved value is
          created, unless there a <a href="#target-peer-identity">target peer
          identity</a> has been established.  If this promise successfully
          resolves, the value will not change.</p>
        </dd></dl></section><section property="bibo:hasPart" resource="#methods-15" typeof="bibo:Chapter" id="methods-15"><h4 resource="#h-methods-15" id="h-methods-15"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.5.2 </span>Methods</span></h4><dl class="methods"><dt id="widl-RTCPeerConnection-getIdentityAssertion-Promise-DOMString"><code>getIdentityAssertion</code></dt><dd>
          <p>Initiates the process of obtaining an identity assertion.
          Applications need not make this call. It is merely intended to allow
          them to start the process of obtaining identity assertions before a
          call is initiated. If an identity is needed, either because the
          browser has been configured with a default identity provider or
          because the <code>setIdentityProvider()</code> method was called,
          then an identity will be automatically requested when an offer or
          answer is created.</p>

          <p>When <code>getIdentityAssertion</code> is invoked, queue a task to
          run the following steps:</p>

          <ol>
            <li>
              <p>If the <var>connection</var>'s
              <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, abort these steps.</p>
            </li>

            <li>
              <p><a href="#sec.identity-proxy-assertion-request">Request an
              identity assertion</a> from the IdP.</p>
            </li>
            <li>
              <p>Resolve the promise with the base64 and JSON encoded
              assertion.</p>
            </li>
          </ol>
        <div><em>No parameters.</em></div><div><em>Return type: </em><code>Promise&lt;DOMString&gt;</code></div></dd><dt id="widl-RTCPeerConnection-setIdentityProvider-void-DOMString-provider-DOMString-protocol-DOMString-usernameHint"><code>setIdentityProvider</code></dt><dd>
          <p>Sets the identity provider to be used for a given
          <code>RTCPeerConnection</code> object. Applications need not make this
          call; if the browser is already configured for an IdP, then that
          configured IdP might be used to get an assertion.</p>

          <p>When the <dfn data-dfn-type="dfn" id="dom-peerconnection-setidentityprovider"><code>setIdentityProvider()</code></dfn>
          method is invoked, the user agent <em title="MUST" class="rfc2119">MUST</em> run the following steps:</p>

          <ol>
            <li>
              <p>If the <var>connection</var>'s
              <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> is <code>closed</code>, throw an
              <code>InvalidStateError</code> exception and abort these
              steps.</p>
            </li>

            <li>
              <p>Set the current identity provider values to the triplet
              (<code>provider</code>, <code>protocol</code>,
              <code>usernameHint</code>).</p>
            </li>

            <li>
              <p>If any identity provider value has changed, discard any stored
              identity assertion.</p>
            </li>
          </ol>

          <p>Identity provider information is not used until an identity
          assertion is required, either in response to a call to
          <code>getIdentityAssertion</code>, or a session description is
          requested with a call to either <code>createOffer</code> or
          <code>createAnswer</code>.</p>
        <table class="parameters"><tbody><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">provider</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">protocol</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr><tr><td class="prmName">usernameHint</td><td class="prmType"><code>DOMString</code></td><td class="prmNullFalse"><span role="img" aria-label="False">âœ˜</span></td><td class="prmOptTrue"><span role="img" aria-label="True">âœ”</span></td><td class="prmDesc"></td></tr></tbody></table><div><em>Return type: </em><code>void</code></div></dd></dl></section>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCIdentityAssertion">[<span class="extAttr">Constructor(DOMString idp, DOMString name)</span>]
interface <span class="idlInterfaceID">RTCIdentityAssertion</span> {
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-RTCIdentityAssertion-idp">idp</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">DOMString</span> <span class="idlAttrName"><a href="#widl-RTCIdentityAssertion-name">name</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-24" typeof="bibo:Chapter" id="attributes-24"><h4 resource="#h-attributes-24" id="h-attributes-24"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.5.3 </span>Attributes</span></h4><dl class="attributes"><dt id="widl-RTCIdentityAssertion-idp"><code>idp</code> of type <span class="idlAttrType">DOMString</span></dt><dd>
          <p>The domain name of the identity provider that validated this identity.</p>
        </dd><dt id="widl-RTCIdentityAssertion-name"><code>name</code> of type <span class="idlAttrType">DOMString</span></dt><dd>
          <p>An RFC5322-conformant [<cite><a href="#bib-RFC5322" class="bibref">RFC5322</a></cite>] representation of the verified
          peer identity. This identity will have been verified via the
          procedures described in [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].</p>
        </dd></dl></section>
    </section>

    <section property="bibo:hasPart" resource="#examples" typeof="bibo:Chapter" id="examples">
      <h3 resource="#h-examples" id="h-examples"><span property="xhv:role" resource="xhv:heading"><span class="secno">9.6 </span>Examples</span></h3>

      <p>The identity system is designed so that applications need not take any
      special action in order for users to generate and verify identity
      assertions; if a user has configured an IdP into their browser, then the
      browser will automatically request/generate assertions and the other side
      will automatically verify them and display the results. However,
      applications may wish to exercise tighter control over the identity
      system as shown by the following examples.</p>

      <div>
        <p>This example shows how to configure the identity provider and
        protocol.</p>
        <div class="example"><div class="example-title marker"><span>Example 4</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="pln">pc</span><span class="pun">.</span><span class="pln">setIdentityProvider</span><span class="pun">(</span><span class="str">"example.com"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"default"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"alice@example.com"</span><span class="pun">);</span></pre></div>
      </div>

      <div>
        <p>This example shows how to consume identity assertions inside a Web
        application.</p>
        <div class="example"><div class="example-title marker"><span>Example 5</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="pln">pc</span><span class="pun">.</span><span class="pln">peerIdentity</span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="pln">identity </span><span class="pun">=&gt;</span><span class="pln">
  console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">"IdP= "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> identity</span><span class="pun">.</span><span class="pln">idp </span><span class="pun">+</span><span class="pln"> </span><span class="str">" identity="</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> identity</span><span class="pun">.</span><span class="pln">name</span><span class="pun">));</span></pre></div>
      </div>
    </section>
  </section>

  <section property="bibo:hasPart" resource="#media-stream-api-extensions-for-network-use" typeof="bibo:Chapter" id="media-stream-api-extensions-for-network-use">
    <!--OddPage--><h2 resource="#h-media-stream-api-extensions-for-network-use" id="h-media-stream-api-extensions-for-network-use"><span property="xhv:role" resource="xhv:heading"><span class="secno">10. </span>Media Stream API Extensions for Network Use</span></h2>

    <section property="bibo:hasPart" resource="#introduction-2" typeof="bibo:Chapter" id="introduction-2">
      <h3 resource="#h-introduction-2" id="h-introduction-2"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.1 </span>Introduction</span></h3>

      <p>The <code>MediaStreamTrack</code> interface, as defined in the
      [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] specification, typically represents a stream of data of
      audio or video. One or more <code>MediaStreamTrack</code>s can be
      collected in a <code>MediaStream</code> (strictly speaking, a <code>
      MediaStream</code> as defined in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] may contain
      zero or more <code>MediaStreamTrack</code> objects).</p>

      <p>A <code>MediaStreamTrack</code> may be extended to
      represent a media flow that either comes from or is sent to a remote peer
      (and not just the local camera, for instance). The extensions required to
      enable this capability on the <code>MediaStreamTrack</code> object will be
      described in this section. How the media is transmitted to the peer is
      described in [<cite><a href="#bib-RTCWEB-RTP" class="bibref">RTCWEB-RTP</a></cite>], [<cite><a href="#bib-RTCWEB-AUDIO" class="bibref">RTCWEB-AUDIO</a></cite>], and
      [<cite><a href="#bib-RTCWEB-TRANSPORT" class="bibref">RTCWEB-TRANSPORT</a></cite>].</p>

      <p>A <code>MediaStreamTrack</code> sent to another peer will appear as one and
      only one <code>MediaStreamTrack</code> to the recipient. A peer is
      defined as a user agent that supports this specification.
      In addition, the sending side application can indicate what <code>
      MediaStream</code> object(s) the <code>MediaStreamTrack</code> is member
      of. The corresponding <code>MediaStream</code> object(s) on the receiver
      side will be created (if not already present) and populated accordingly.</p>

      <p>As also described earlier in this document, the objects <code>
      RTCRtpSender</code> and <code>RTCRtpReceiver</code> can be used by the
      application to get more fine grained control over the transmission and
      reception of <code>MediaStreamTrack</code>s.</p>

      <p>Channels are the smallest unit considered in the
      <code>MediaStream</code> specification. Channels are intended to be
      encoded together for transmission as, for instance, an RTP payload type.
      All of the channels that a codec needs to encode jointly <em title="MUST" class="rfc2119">MUST</em> be in the
      same <code>MediaStreamTrack</code> and the codecs <em title="SHOULD" class="rfc2119">SHOULD</em> be able to
      encode, or discard, all the channels in the track.</p>

      <p>The concepts of an input and output to a given
      <code>MediaStreamTrack</code> apply in the case of <code>MediaStreamTrack</code>
      objects transmitted over the network as well. A
      <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> created by an
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object (as described previously in this
      document) will take as input the data received from a remote peer.
      Similarly, a <code>MediaStreamTrack</code> from a local source, for instance a
      camera via [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>], will have an output that represents what is
      transmitted to a remote peer if the object is used with an
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

      <p>The concept of duplicating <code>MediaStream</code> and
      <code>MediaStreamTrack</code> objects as described in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] is
      also applicable here. This feature can be used, for instance, in a
      video-conferencing scenario to display the
      local video from the user's camera and microphone in a local
      monitor, while only transmitting the audio to the remote peer (e.g. in
      response to the user using a "video mute" feature). Combining
      different <code>MediaStreamTrack</code> objects into new <code>MediaStream</code>
      objects is useful in certain situations.</p>

      <div class="note"><div id="h-note8" role="heading" aria-level="4" class="note-title marker"><span>Note</span></div><p class="">In this document, we only specify aspects of the
      following objects that are relevant when used along with an
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>. Please refer to the original
      definitions of the objects in the [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] document for general
      information on using <code>MediaStream</code> and
      <code>MediaStreamTrack</code>.</p></div>
    </section>

    <section property="bibo:hasPart" resource="#mediastream" typeof="bibo:Chapter" id="mediastream">
      <h3 resource="#h-mediastream" id="h-mediastream"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.2 </span>MediaStream</span></h3>

      <section property="bibo:hasPart" resource="#id" typeof="bibo:Chapter" id="id">
        <h4 resource="#h-id" id="h-id"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.2.1 </span>id</span></h4>

        <p>The <code><a href="https://w3c.github.io/mediacapture-main/#dom-mediastream-id">id</a></code> attribute
        specified in <code>MediaStream</code> returns an id that is unique to
        this stream, so that streams can be recognized at the
        remote end of the <code><a href="#rtcpeerconnection-interface">RTCPeerConnection</a></code> API.</p>

        <p>When a <code><a href="#mediastream">MediaStream</a></code> is
        created to represent a stream obtained from a remote peer, the
        <code><a href="https://w3c.github.io/mediacapture-main/#dom-mediastream-id">id</a></code>
        attribute is initialized from information provided by the remote
        source.</p>

        <div class="note"><div id="h-note9" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><p class="">The id of a <code><a data-link-type="dfn" class="internalDFN" href="#dfn-mediastream">MediaStream</a></code> object is
        unique to the source of the stream, but that does not mean it is not
        possible to end up with duplicates. For example, the tracks of a locally generated
        stream could be sent from one user agent to a remote peer using
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> and then sent back to the
        original user agent in the same manner, in which case the original user
        agent will have multiple streams with the same id (the
        locally-generated one and the one received from the remote peer).</p></div>
      </section>
    </section>

    <section property="bibo:hasPart" resource="#mediastreamtrack" typeof="bibo:Chapter" id="mediastreamtrack">
      <h3 resource="#h-mediastreamtrack" id="h-mediastreamtrack"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.3 </span>MediaStreamTrack</span></h3>

      <p>A <code>MediaStreamTrack</code> object's reference to its
      <code>MediaStream</code> in the non-local media source case (an RTP
      source, as is the case for <code>MediaStreamTrack</code>s received over an
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> ) is always strong.</p>

      <p>When an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> receives data on an RTP
      source for the first time, it <em title="MUST" class="rfc2119">MUST</em> <a href="#update-track-muted">update
      the muted state</a> of the corresponding <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a>
      </code> with the value <code>false</code>.</p>

      <p>When an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>'s RTP source is
      temporarily unable to receive media due to a loss of connection or if a
      mute signal has been received, it <em title="MUST" class="rfc2119">MUST</em> <a href="#update-track-muted">update the muted state</a> of the corresponding
      <code><a class="idlType" href="#idl-def-MediaStreamTrack"><code>MediaStreamTrack</code></a></code> with the value <code>true</code>.
      When media data is available again, the <a href="#update-track-muted">muted state <em title="MUST" class="rfc2119">MUST</em> be updated</a> with the value
      <code>false</code>.</p>

      <div class="issue"><div id="h-issue16" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><p class="">The mute signal mentioned in the previous paragraph
      is yet to be defined.</p></div>

      <p>The procedure <dfn data-dfn-type="dfn" id="update-track-muted">update a track's muted
      state</dfn> is specified in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>].</p>

      <p>When a track comes
      from a remote peer and the remote peer has permanently stopped sending
      data the <code>ended</code> event <em title="MUST" class="rfc2119">MUST</em> be fired on the track, as
      specified in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>].</p>

      <div class="issue"><div id="h-issue17" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><p class="">How do you know when it has stopped? This seems
      like an SDP question, not a media-level question. (Suggestion: when the
      track is ended, either through port 0, or removing the a=msid attrib)</p></div>
    </section>

    <section property="bibo:hasPart" resource="#isolated-media-streams" typeof="bibo:Chapter" id="isolated-media-streams">
      <h3 resource="#h-isolated-media-streams" id="h-isolated-media-streams"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.4 </span>Isolated Media Streams</span></h3>

      <p>A MediaStream acquired using <code>getUserMedia()</code> is, by
      default, accessible to an application. This means that the application is
      able to access the contents of tracks, modify their content, and send
      that media to any peer it chooses.</p>

      <p>WebRTC supports calling scenarios where media is sent to a
      specifically identified peer, without the contents of media streams being
      accessible to applications. This is enabled by use of the
      <code>peerIdentity</code> parameter to
      <code>getUserMedia()</code>.</p>

      <p>An application willingly relinquishes access to media by including a
      <code>peerIdentity</code> parameter in the
      <code>MediaStreamConstraints</code>. This attribute is set to a
      <code>DOMString</code> containing the identity of a specific peer.</p>

      <p>The <code>MediaStreamConstraints</code> dictionary is
      expanded to include the <code>peerIdentity</code> parameter.</p>

      <pre class="idl"><span class="idlDictionary" id="idl-def-MediaStreamConstraints">partial dictionary <span class="idlDictionaryID">MediaStreamConstraints</span> {
<span class="idlMember">             <span class="idlMemberType">DOMString</span> <span class="idlMemberName"><a href="#widl-MediaStreamConstraints-peerIdentity">peerIdentity</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#dictionary-mediastreamconstraints-members" typeof="bibo:Chapter" id="dictionary-mediastreamconstraints-members"><h4 resource="#h-dictionary-mediastreamconstraints-members" id="h-dictionary-mediastreamconstraints-members"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.4.1 </span>Dictionary <a href="#idl-def-MediaStreamConstraints" class="idlType"><code>MediaStreamConstraints</code></a> Members</span></h4><dl class="dictionary-members"><dt id="widl-MediaStreamConstraints-peerIdentity"><code>peerIdentity</code> of type <span class="idlMemberType">DOMString</span></dt><dd>
          <p>If set, <code>peerIdentity</code> isolates media from the
          application. Media can only be sent to the identified peer.</p>
        </dd></dl></section>

      <p>A user that is prompted to provide consent for access to a camera or
      microphone can be shown the value of the <code>peerIdentity</code>
      parameter, so that they can be informed that the consent is more narrowly
      restricted.</p>

      <p>When the <code><dfn id="dfn-peeridentity" data-dfn-type="dfn">peerIdentity</dfn></code> option is supplied to
      <code>getUserMedia()</code>, all of the <code>MediaStreamTrack</code>s in
      the resulting <code>MediaStream</code> are isolated so that content is
      not accessible to any application. Isolated
      <code>MediaStreamTrack</code>s can be used for two purposes:</p>

      <ul>
        <li>
          <p>Displayed in an appropriate media tag (e.g., a video or audio
          element). The browser <em title="MUST" class="rfc2119">MUST</em> ensure that content is inaccessible to the
          application by ensuring that the resulting content is given the same
          protections as content that is <a href="http://www.w3.org/html/wg/drafts/html/master/infrastructure.html#cors-cross-origin">
          CORS cross-origin</a>, as described in the relevant <a href="http://www.w3.org/html/wg/drafts/html/master/semantics.html#security-and-privacy-considerations">
          Security and privacy considerations section</a> of [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>
        </li>

        <li>
          <p>Used as the argument to <a href="#widl-RTCPeerConnection-addTrack-RTCRtpSender-MediaStreamTrack-track-MediaStream-streams">addTrack()</a>
          on an <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> instance, subject to the
          restrictions in <a href="#isolated-pc">isolated streams and RTCPeerConnection</a>.</p>
        </li>
      </ul>

      <p>A <code>MediaStreamTrack</code> that is added to another
      <code>MediaStream</code> remains isolated. When an isolated
      <code>MediaStreamTrack</code> is added to a <code>MediaStream</code> with
      a different peerIdentity, the <code>MediaStream</code> gets a combination
      of isolation restrictions. A <code>MediaStream</code> containing
      <code>MediaStreamTrack</code> instances with mixed isolation properties
      can be displayed, but cannot be sent using
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>.</p>

      <p>Any <code>peerIdentity</code> property <em title="MUST" class="rfc2119">MUST</em> be retained on cloned
      copies of <code>MediaStreamTrack</code>s.</p>
      <!-- Any stream or track that might be derived from an isolated stream,
           such as
           through <a href="https://www.w3.org/TR/streamproc/#media-element-extensions">captureStreamUntilEnded
           or captureStream</a>, MUST also retain any isolation protections.
        -->

      <section property="bibo:hasPart" resource="#isolated-track" typeof="bibo:Chapter" id="isolated-track">
        <h4 resource="#h-isolated-track" id="h-isolated-track"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.4.2 </span>Extended MediaStreamTrack Properties</span></h4>

        <p><code>MediaStreamTrack</code> is expanded to include an
        <var>isolated</var> attribute and a corresponding event. This allows an
        application to quickly and easily determine whether a track is
        accessible.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamTrack">partial interface <span class="idlInterfaceID">MediaStreamTrack</span> {
<span class="idlAttribute">    readonly        attribute <span class="idlAttrType">boolean</span>      <span class="idlAttrName"><a href="#widl-MediaStreamTrack-isolated">isolated</a></span>;</span>
<span class="idlAttribute">                    attribute <span class="idlAttrType">EventHandler</span> <span class="idlAttrName"><a href="#widl-MediaStreamTrack-onisolationchange">onisolationchange</a></span>;</span>
};</span></pre><section property="bibo:hasPart" resource="#attributes-25" typeof="bibo:Chapter" id="attributes-25"><h5 resource="#h-attributes-25" id="h-attributes-25"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.4.2.1 </span>Attributes</span></h5><dl class="attributes"><dt id="widl-MediaStreamTrack-isolated"><code>isolated</code> of type <span class="idlAttrType">boolean</span>, readonly       </dt><dd>
            <p>A <code>MediaStreamTrack</code> is isolated (and the
            corresponding <var>isolated</var> attribute set to <var>true</var>)
            when content is inaccessible to the owning document. This occurs as
            a result of setting the <var>peerIdentity</var> option. A track is
            also isolated if it comes from a cross origin source.</p>
          </dd><dt id="widl-MediaStreamTrack-onisolationchange"><code>onisolationchange</code> of type <span class="idlAttrType">EventHandler</span></dt><dd>
            <p>This event handler, of type <a href="#event-isolationchange">isolationchange</a>, is fired when the
            value of the <var>isolated</var> attribute changes.</p>
          </dd></dl></section>
      </section>

      <section property="bibo:hasPart" resource="#isolated-pc" typeof="bibo:Chapter" id="isolated-pc">
        <h4 resource="#h-isolated-pc" id="h-isolated-pc"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.4.3 </span>Isolated Streams and RTCPeerConnection</span></h4>

        <p>A <code>MediaStreamTrack</code> with a <var>peerIdentity</var>
        option set can be added to any <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>.
        However, the content of an isolated track <em title="MUST NOT" class="rfc2119">MUST NOT</em> be transmitted
        unless all of the following constraints are met:</p>

        <ul>
          <li>
            <p>A <code>MediaStreamTrack</code> from a stream acquired using the
            <var>peerIdentity</var> option can be transmitted if the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> has successfully <a href="#sec.identity-verify-assertion">validated the identity</a> of the
            peer AND that identity is the same identity that was used in the
            <var>peerIdentity</var> option associated with the track. That is,
            the <code>name</code> attribute of the <code>peerIdentity</code>
            attribute of the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> instance
            <em title="MUST" class="rfc2119">MUST</em> match the value of the <code>peerIdentity</code> option passed
            to <code>getUserMedia()</code>.</p>

            <p>Rules for matching identity are described in
            [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].</p>
          </li>

          <li>
            <p>The peer has indicated that it will respect the isolation
            properties of streams. That is, a DTLS connection with a promise to
            respect stream confidentiality, as defined in [<cite><a href="#bib-RTCWEB-ALPN" class="bibref">RTCWEB-ALPN</a></cite>] has
            been established.</p>
          </li>
        </ul>

        <p>Failing to meet these conditions means that no media can be sent for
        the affected <code>MediaStreamTrack</code>. Video <em title="MUST" class="rfc2119">MUST</em> be replaced by
        black frames, audio <em title="MUST" class="rfc2119">MUST</em> be replaced by silence, and equivalently
        information-free content <em title="MUST" class="rfc2119">MUST</em> be provided for other media types.</p>

        <p>Remotely sourced <code>MediaStreamTrack</code>s <em title="MUST" class="rfc2119">MUST</em> be isolated if
        they are received over a DTLS connection that has been negotiated with
        track isolation. This protects isolated media from the application in
        the receiving browser. These tracks <em title="MUST" class="rfc2119">MUST</em> only be displayed to a user
        using the appropriate media element (e.g., &lt;video&gt; or
        &lt;audio&gt;).</p>

        <p>Any <code>MediaStreamTrack</code> that has the
        <var>peerIdentity</var> option set causes all tracks sent using the
        same <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> to be isolated at the
        receiving peer. All DTLS connections created for a
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> with isolated local streams <em title="MUST" class="rfc2119">MUST</em>
        be negotiated so that media remains isolated at the remote peer. This
        causes non-isolated media to become isolated at the receiving peer if
        any isolated tracks are added to the same
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>.</p>

        <div class="note"><div id="h-note10" role="heading" aria-level="5" class="note-title marker"><span>Note</span></div><p class="">Tracks that are not bound to a particular
        <var>peerIdentity</var> do not cause other streams to be isolated,
        these tracks simply do not have their content transmitted.</p></div>

        <p>If a stream becomes isolated after initially being accessible, or an
        isolated stream is added to an active session, then media for that
        stream is replaced by information-free content (e.g., black frames or
        silence).</p>
      </section>

      <section property="bibo:hasPart" resource="#isolation-protection" typeof="bibo:Chapter" id="isolation-protection">
        <h4 resource="#h-isolation-protection" id="h-isolation-protection"><span property="xhv:role" resource="xhv:heading"><span class="secno">10.4.4 </span>Protection Afforded by Media Isolation</span></h4>

        <p>Media isolation ensures that the content of a
        <code>MediaStreamTrack</code> is not accessible to web applications.
        However, to ensure that media with a <var>peerIdentity</var> option set
        can be sent to peers, some meta-information about the media will be
        exposed to applications.</p>

        <p>Applications will be able to observe the parameters of the media
        that affect session negotiation and conversion into RTP. This includes
        the codecs that might be supported by the track, the bitrate, the
        number of packets, and the current settings that are set on the
        <code>MediaStreamTrack</code>.</p>

        <p>In particular, the <a href="#sec.stats-model">statistics</a> that
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> records are not reduced in
        capability. New statistics that might compromise isolation <em title="MUST" class="rfc2119">MUST</em> be
        avoided, or explicitly suppressed for isolated streams.</p>

        <p>Most of these data are exposed to the network when the media is
        transmitted. Only the settings for the <code>MediaStreamTrack</code>
        present a new source of information. This can includes the frame rate
        and resolution of video tracks, the bandwidth of audio tracks, and
        other information about the source, which would not otherwise be
        revealed to a network observer. Since settings don't change at a high
        frequency or in response to changes in media content, settings only
        reveal limited reveal information about the content of a track.
        However, any setting that might change dynamically in response to the
        content of an isolated <code>MediaStreamTrack</code> <em title="MUST" class="rfc2119">MUST</em> have changes
        suppressed.</p>
      </section>
    </section>
  </section>

  <section property="bibo:hasPart" resource="#examples-and-call-flows" typeof="bibo:Chapter" id="examples-and-call-flows" class="informative">
    <!--OddPage--><h2 resource="#h-examples-and-call-flows" id="h-examples-and-call-flows"><span property="xhv:role" resource="xhv:heading"><span class="secno">11. </span>Examples and Call Flows</span></h2><p><em>This section is non-normative.</em></p>

    <section property="bibo:hasPart" resource="#simple-peer-to-peer-example" typeof="bibo:Chapter" id="simple-peer-to-peer-example">
      <h3 resource="#h-simple-peer-to-peer-example" id="h-simple-peer-to-peer-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.1 </span>Simple Peer-to-peer Example</span></h3>

      <div>
        <p>When two peers decide they are going to set up a connection to each
        other, they both go through these steps. The STUN/TURN server
        configuration describes a server they can use to get things like their
        public IP address or to set up NAT traversal. They also have to send
        data for the signaling channel to each other using the same out-of-band
        mechanism they used to establish that they were going to communicate in
        the first place.</p>
        <div class="example"><div class="example-title marker"><span>Example 6</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> signalingChannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SignalingChannel</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> configuration </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">"iceServers"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln"> </span><span class="str">"urls"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"stuns:stun.example.org"</span><span class="pln"> </span><span class="pun">}]</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> pc</span><span class="pun">;</span><span class="pln">

</span><span class="com">// call start() to initiate</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCPeerConnection</span><span class="pun">(</span><span class="pln">configuration</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// send any ice candidates to the other peer</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onicecandidate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">)</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"candidate"</span><span class="pun">:</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">candidate </span><span class="pun">}));</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// let the "negotiationneeded" event trigger offer generation</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onnegotiationneeded </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">createOffer</span><span class="pun">().</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">offer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">offer</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="com">// send the offer to the other peer</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// once remote video track arrives, show it in the remote video element</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">ontrack </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">track</span><span class="pun">.</span><span class="pln">kind </span><span class="pun">===</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">)</span><span class="pln">
          remoteView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">streams</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// get a local stream, show it in a self-view and add it to be sent</span><span class="pln">
    navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln"> </span><span class="str">"audio"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        selfView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">addTrack</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> stream</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">addTrack</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> stream</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

signalingChannel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pc</span><span class="pun">)</span><span class="pln">
        start</span><span class="pun">();</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> message </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> desc </span><span class="pun">=</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">;</span><span class="pln">

        </span><span class="com">// if we get an offer, we need to reply with an answer</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">desc</span><span class="pun">.</span><span class="pln">type </span><span class="pun">==</span><span class="pln"> </span><span class="str">"offer"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">createAnswer</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">answer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">answer</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">desc</span><span class="pun">.</span><span class="pln">type </span><span class="pun">==</span><span class="pln"> </span><span class="str">"answer"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            log</span><span class="pun">(</span><span class="str">"Unsupported SDP type. Your code may differ here."</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addIceCandidate</span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> logError</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </div>
    </section>

    <section property="bibo:hasPart" resource="#simple-peer-to-peer-example-with-warm-up" typeof="bibo:Chapter" id="simple-peer-to-peer-example-with-warm-up">
      <h3 resource="#h-simple-peer-to-peer-example-with-warm-up" id="h-simple-peer-to-peer-example-with-warm-up"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.2 </span>Simple Peer-to-peer Example with Warm-up</span></h3>

      <div>
        <p>When two peers decide they are going to set up a connection
        to each other and want to have the ICE, DTLS, and media
        connections "warmed up" such that they are ready to send and
        receive media immediately, they both go through these
        steps. </p>
        <div class="example"><div class="example-title marker"><span>Example 7</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> signalingChannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SignalingChannel</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> configuration </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">"iceServers"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln"> </span><span class="str">"urls"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"stuns:stun.example.org"</span><span class="pln"> </span><span class="pun">}]</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> pc</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> audio </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> audioSendTrack </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> video </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> videoSendTrack </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> started </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln">

</span><span class="com">// Call warmp() to warm-up ICE, DTLS, and media, but not send media yet.</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> warmup</span><span class="pun">(</span><span class="pln">answerer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCPeerConnection</span><span class="pun">(</span><span class="pln">configuration</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">answerer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      audio </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">addTransceiver</span><span class="pun">(</span><span class="str">"audio"</span><span class="pun">);</span><span class="pln">
      video </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">addTransceiver</span><span class="pun">(</span><span class="str">"video"</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">

    </span><span class="com">// send any ice candidates to the other peer</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onicecandidate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">)</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"candidate"</span><span class="pun">:</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">candidate </span><span class="pun">}));</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// let the "negotiationneeded" event trigger offer generation</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onnegotiationneeded </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">createOffer</span><span class="pun">().</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">offer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">offer</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="com">// send the offer to the other peer</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// once remote video track arrives, show it in the remote video element</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">ontrack </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">track</span><span class="pun">.</span><span class="pln">kind </span><span class="pun">===</span><span class="pln"> </span><span class="str">"audio"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">answerer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="com">// TODO: Figure out how to reuse an existing m-line with something like:</span><span class="pln">
            </span><span class="com">// audio = evt.transceiver;</span><span class="pln">
            </span><span class="com">// audio.sender.activate();</span><span class="pln">
            </span><span class="com">// This avoids the need for an extra re-offer.</span><span class="pln">
            </span><span class="com">// Similarly for video.</span><span class="pln">
            audio </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">addTransceiver</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">track</span><span class="pun">.</span><span class="pln">kind</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">started </span><span class="pun">&amp;&amp;</span><span class="pln"> audioSendTrack</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
              audio</span><span class="pun">.</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">replaceTrack</span><span class="pun">(</span><span class="pln">audioSendTrack</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
          </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">track</span><span class="pun">.</span><span class="pln">kind </span><span class="pun">===</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">answerer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            audio </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">addTransceiver</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">track</span><span class="pun">.</span><span class="pln">kind</span><span class="pun">);</span><span class="pln">
            </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">started </span><span class="pun">&amp;&amp;</span><span class="pln"> videoSendTrack</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
              video</span><span class="pun">.</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">replaceTrack</span><span class="pun">(</span><span class="pln">audioSendTrack</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">}</span><span class="pln">
          </span><span class="pun">}</span><span class="pln">
          remoteView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">streams</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// get a local stream, show it in a self-view and add it to be sent</span><span class="pln">
    navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln"> </span><span class="str">"audio"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        selfView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          sendAudioTrack </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">started</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            audio</span><span class="pun">.</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">replaceTrack</span><span class="pun">(</span><span class="pln">sendAudioTrack</span><span class="pun">);</span><span class="pln">
          </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          sendVideoTrack </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
          </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">started</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            video</span><span class="pun">.</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">replaceTrack</span><span class="pun">(</span><span class="pln">sendVideoTrack</span><span class="pun">);</span><span class="pln">
          </span><span class="pun">}</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// Call start() to start sending media.</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  started </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
  signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"start"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">}));</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

signalingChannel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pc</span><span class="pun">)</span><span class="pln">
        warmup</span><span class="pun">(</span><span class="kwd">true</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> message </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> desc </span><span class="pun">=</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">;</span><span class="pln">

        </span><span class="com">// if we get an offer, we need to reply with an answer</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">desc</span><span class="pun">.</span><span class="pln">type </span><span class="pun">==</span><span class="pln"> </span><span class="str">"offer"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">createAnswer</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">answer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">answer</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">start</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      started </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">audio </span><span class="pun">&amp;&amp;</span><span class="pln"> sendAudioTrack</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        audio</span><span class="pun">.</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">replaceTrack</span><span class="pun">(</span><span class="pln">sendVideoTrack</span><span class="pun">);</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">video </span><span class="pun">&amp;&amp;</span><span class="pln"> sendVideoTrack</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        video</span><span class="pun">.</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">replaceTrack</span><span class="pun">(</span><span class="pln">sendVideoTrack</span><span class="pun">);</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addIceCandidate</span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> logError</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </div>
    </section>

    <section property="bibo:hasPart" resource="#simple-peer-to-peer-example-with-media-before-signaling" typeof="bibo:Chapter" id="simple-peer-to-peer-example-with-media-before-signaling">
      <h3 resource="#h-simple-peer-to-peer-example-with-media-before-signaling" id="h-simple-peer-to-peer-example-with-media-before-signaling"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.3 </span>Simple Peer-to-peer Example with media before signaling</span></h3>

      <div>
        <p>The answerer may wish to send media in parallel with sending the answer, and
        the offerer may wish to render the media before the answer arrives.</p>
        <div class="example"><div class="example-title marker"><span>Example 8</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> signalingChannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SignalingChannel</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> configuration </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">"iceServers"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln"> </span><span class="str">"urls"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"stuns:stun.example.org"</span><span class="pln"> </span><span class="pun">}]</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> pc</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> findReceiver</span><span class="pun">(</span><span class="pln">mid</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> receivers</span><span class="pun">.</span><span class="pln">length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> receiver </span><span class="pun">=</span><span class="pln"> receiver</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">receiver</span><span class="pun">.</span><span class="pln">mid </span><span class="pun">==</span><span class="pln"> videoSender</span><span class="pun">.</span><span class="pln">mid</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
             </span><span class="kwd">return</span><span class="pln"> receiver</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
    </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">// call start() to initiate</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCPeerConnection</span><span class="pun">(</span><span class="pln">configuration</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// send any ice candidates to the other peer</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onicecandidate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">)</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"candidate"</span><span class="pun">:</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">candidate </span><span class="pun">}));</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// let the "negotiationneeded" event trigger offer generation</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onnegotiationneeded </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">createOffer</span><span class="pun">().</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">offer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">offer</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="com">// send the offer to the other peer</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// get a local stream, show it in a self-view and add it to be sent</span><span class="pln">
    navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln"> </span><span class="str">"audio"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        selfView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> remoteStream </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MediaStream</span><span class="pun">();</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">var</span><span class="pln"> audioSender </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">addTrack</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> stream</span><span class="pun">);</span><span class="pln">
            remoteStream</span><span class="pun">.</span><span class="pln">addTrack</span><span class="pun">(</span><span class="pln">findReceiver</span><span class="pun">(</span><span class="pln">audioSender</span><span class="pun">.</span><span class="pln">mid</span><span class="pun">).</span><span class="pln">track</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">var</span><span class="pln"> videoSender </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">addTrack</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> stream</span><span class="pun">);</span><span class="pln">
            remoteStream</span><span class="pun">.</span><span class="pln">addTrack</span><span class="pun">(</span><span class="pln">findReceiver</span><span class="pun">(</span><span class="pln">videoSender</span><span class="pun">.</span><span class="pln">mid</span><span class="pun">).</span><span class="pln">track</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
        </span><span class="com">// Render the media even before ontrack fires.</span><span class="pln">
        removeView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> remoteStream</span><span class="pun">;</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

signalingChannel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pc</span><span class="pun">)</span><span class="pln">
        start</span><span class="pun">();</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> message </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> desc </span><span class="pun">=</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">;</span><span class="pln">

        </span><span class="com">// if we get an offer, we need to reply with an answer</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">desc</span><span class="pun">.</span><span class="pln">type </span><span class="pun">==</span><span class="pln"> </span><span class="str">"offer"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">createAnswer</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">answer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">answer</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addIceCandidate</span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> logError</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </div>
    </section>

    <section property="bibo:hasPart" resource="#simple-simulcast-example" typeof="bibo:Chapter" id="simple-simulcast-example">
      <h3 resource="#h-simple-simulcast-example" id="h-simple-simulcast-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.4 </span>Simple Simulcast Example</span></h3>

      <div>
        <p>A client wants to send multiple RTP encodings (simulcast) to a server.</p>
        <div class="example"><div class="example-title marker"><span>Example 9</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> signalingChannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SignalingChannel</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> pc</span><span class="pun">;</span><span class="pln">

</span><span class="com">// call start() to initiate</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCPeerConnection</span><span class="pun">({});</span><span class="pln">

    </span><span class="com">// let the "negotiationneeded" event trigger offer generation</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onnegotiationneeded </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">createOffer</span><span class="pun">().</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">offer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">offer</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="com">// send the offer to the other peer</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// get a local stream, show it in a self-view and add it to be sent</span><span class="pln">
    navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln"> </span><span class="str">"audio"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        selfView</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">addTransceiver</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getAudioTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> </span><span class="pun">{</span><span class="pln">send</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> receive</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">});</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">().</span><span class="pln">length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">addTransceiver</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getVideoTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                send</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
                receive</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">,</span><span class="pln">
                sendEncodings</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln">
                    </span><span class="pun">{</span><span class="pln">
                      rid</span><span class="pun">:</span><span class="pln"> </span><span class="str">"f"</span><span class="pun">,</span><span class="pln">
                    </span><span class="pun">},</span><span class="pln">
                    </span><span class="pun">{</span><span class="pln">
                      rid</span><span class="pun">:</span><span class="pln"> </span><span class="str">"h"</span><span class="pun">,</span><span class="pln">
                      scaleDownResolutionBy</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2.0</span><span class="pln">
                    </span><span class="pun">},</span><span class="pln">
                    </span><span class="pun">{</span><span class="pln">
                      rid</span><span class="pun">:</span><span class="pln"> </span><span class="str">"q"</span><span class="pun">,</span><span class="pln">
                      scaleDownResolutionBy</span><span class="pun">:</span><span class="pln"> </span><span class="lit">4.0</span><span class="pln">
                    </span><span class="pun">}</span><span class="pln">
                </span><span class="pun">]</span><span class="pln">
            </span><span class="pun">});</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

signalingChannel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> message </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> desc </span><span class="pun">=</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">;</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addIceCandidate</span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> logError</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </div>
    </section>

    <section property="bibo:hasPart" resource="#advanced-peer-to-peer-example" typeof="bibo:Chapter" id="advanced-peer-to-peer-example">
      <h3 resource="#h-advanced-peer-to-peer-example" id="h-advanced-peer-to-peer-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.5 </span>Advanced Peer-to-peer Example</span></h3>

      <div>
        <p>This example shows the more complete functionality.</p>
        <div class="issue"><div id="h-issue18" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><p class="">TODO</p></div>
        <div class="example"><div class="example-title marker"><span>Example 10</span></div><pre style="" class="highlight prettyprint prettyprinted"></pre></div>
      </div>
    </section>

    <section property="bibo:hasPart" resource="#peer-to-peer-data-example" typeof="bibo:Chapter" id="peer-to-peer-data-example">
      <h3 resource="#h-peer-to-peer-data-example" id="h-peer-to-peer-data-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.6 </span>Peer-to-peer Data Example</span></h3>

      <div>
        <p>This example shows how to create a
        <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object and perform the offer/answer
        exchange required to connect the channel to the other peer. The
        <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> is used in the context of a simple
        chat application and listeners are attached to monitor when the channel
        is ready, messages are received and when the channel is closed.</p>

        <div class="example"><div class="example-title marker"><span>Example 11</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">var</span><span class="pln"> signalingChannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SignalingChannel</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> configuration </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="str">"iceServers"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[{</span><span class="pln"> </span><span class="str">"urls"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"stuns:stun.example.org"</span><span class="pln"> </span><span class="pun">}]</span><span class="pln"> </span><span class="pun">};</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> pc</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> channel</span><span class="pun">;</span><span class="pln">

</span><span class="com">// call start(true) to initiate</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">(</span><span class="pln">isInitiator</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCPeerConnection</span><span class="pun">(</span><span class="pln">configuration</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// send any ice candidates to the other peer</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onicecandidate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">)</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"candidate"</span><span class="pun">:</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">candidate </span><span class="pun">}));</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// let the "negotiationneeded" event trigger offer generation</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onnegotiationneeded </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">createOffer</span><span class="pun">().</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">offer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">offer</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            </span><span class="com">// send the offer to the other peer</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
        </span><span class="pun">})</span><span class="pln">
        </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">isInitiator</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="com">// create data channel and setup chat</span><span class="pln">
        channel </span><span class="pun">=</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">createDataChannel</span><span class="pun">(</span><span class="str">"chat"</span><span class="pun">);</span><span class="pln">
        setupChat</span><span class="pun">();</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="com">// setup chat on incoming data channel</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">ondatachannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            channel </span><span class="pun">=</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">channel</span><span class="pun">;</span><span class="pln">
            setupChat</span><span class="pun">();</span><span class="pln">
        </span><span class="pun">};</span><span class="pln">
    </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

signalingChannel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pc</span><span class="pun">)</span><span class="pln">
        start</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> message </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">var</span><span class="pln"> desc </span><span class="pun">=</span><span class="pln"> message</span><span class="pun">.</span><span class="pln">desc</span><span class="pun">;</span><span class="pln">

        </span><span class="com">// if we get an offer, we need to reply with an answer</span><span class="pln">
        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">desc</span><span class="pun">.</span><span class="pln">type </span><span class="pun">==</span><span class="pln"> </span><span class="str">"offer"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">createAnswer</span><span class="pun">();</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">answer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                </span><span class="kwd">return</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">answer</span><span class="pun">);</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
                signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"desc"</span><span class="pun">:</span><span class="pln"> pc</span><span class="pun">.</span><span class="pln">localDescription </span><span class="pun">}));</span><span class="pln">
            </span><span class="pun">})</span><span class="pln">
            </span><span class="pun">.</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
        </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addIceCandidate</span><span class="pun">(</span><span class="pln">message</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">).</span><span class="kwd">catch</span><span class="pun">(</span><span class="pln">logError</span><span class="pun">);</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> setupChat</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    channel</span><span class="pun">.</span><span class="pln">onopen </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="com">// e.g. enable send button</span><span class="pln">
        enableChat</span><span class="pun">(</span><span class="pln">channel</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    channel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        showChatMessage</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> sendChatMessage</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    channel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">function</span><span class="pln"> logError</span><span class="pun">(</span><span class="pln">error</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    log</span><span class="pun">(</span><span class="pln">error</span><span class="pun">.</span><span class="pln">name </span><span class="pun">+</span><span class="pln"> </span><span class="str">": "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> error</span><span class="pun">.</span><span class="pln">message</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </div><!--div>
    <p>This simple example shows how configure two RTCDataChannel objects for different purposes.</p>
<p><pre   class='example highlight'>
// the chat channel is reliable and not as prioritized as game data
var chatChan = peerConn.createDataChannel("chat", { "priority": 1 });

// the game data channel is prioritized and unreliable low latency channel for high performance
var gameDataChan = peerConn.createDataChannel("data", { "reliable": false, "priority": 10 });
    </pre></p>
  </div-->
    </section>

    <section property="bibo:hasPart" resource="#call-flow-browser-to-browser" typeof="bibo:Chapter" id="call-flow-browser-to-browser">
      <h3 resource="#h-call-flow-browser-to-browser" id="h-call-flow-browser-to-browser"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.7 </span>Call Flow Browser to Browser</span></h3>

      <div class="issue"><div id="h-issue19" role="heading" aria-level="4" class="issue-title marker"><span>Issue</span></div><p class="">Editors' Note: This example flow needs to be discussed on
      the list and is likely wrong in many ways.</p></div>

      <p>This shows an example of one possible call flow between two browsers.
      This does not show the procedure to get access to local media or every
      callback that gets fired but instead tries to reduce it down to only show
      the key events and messages.</p>

      <p><img alt="A message sequence chart detailing a call flow between two browsers" src="images/ladder-2party-simple.svg" style="width:100%"></p><!--
      <p>The following flow shows a more complete set of the callbacks and
      events that happen.</p>

      <p><img alt=
      "A more complete message sequence chart detailing a call flow between two browsers"
      src="images/ladder-2party-full.svg" style="width:100%"></p>
      -->
    </section>

    <section property="bibo:hasPart" resource="#dtmf-example" typeof="bibo:Chapter" id="dtmf-example">
      <h3 resource="#h-dtmf-example" id="h-dtmf-example"><span property="xhv:role" resource="xhv:heading"><span class="secno">11.8 </span>DTMF Example</span></h3>

      <p>Examples assume that <var>sender</var> is an RTCRtpSender.

      </p><p>Sending the DTMF signal "1234" with 500 ms duration per tone:</p>
      <div class="example"><div class="example-title marker"><span>Example 12</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">var</span><span class="pln"> duration </span><span class="pun">=</span><span class="pln"> </span><span class="lit">500</span><span class="pun">;</span><span class="pln">
    sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="str">"1234"</span><span class="pun">,</span><span class="pln"> duration</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
    log</span><span class="pun">(</span><span class="str">"DTMF function not available"</span><span class="pun">);</span></pre></div>

      <p>Send the DTMF signal "1234", and light up the active key using
      <code>lightKey(key)</code> while the tone is playing (assuming that
      <code>lightKey("")</code> will darken all the keys):</p>
      <div class="example"><div class="example-title marker"><span>Example 13</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">ontonechange </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">e</span><span class="pun">.</span><span class="pln">tone</span><span class="pun">)</span><span class="pln">
          </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">
      </span><span class="com">// light up the key when playout starts</span><span class="pln">
      lightKey</span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">tone</span><span class="pun">);</span><span class="pln">
      </span><span class="com">// turn off the light after tone duration</span><span class="pln">
      setTimeout</span><span class="pun">(</span><span class="pln">lightKey</span><span class="pun">,</span><span class="pln"> sender</span><span class="pun">.</span><span class="pln">duration</span><span class="pun">,</span><span class="pln"> </span><span class="str">""</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">};</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="str">"1234"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
    log</span><span class="pun">(</span><span class="str">"DTMF function not available"</span><span class="pun">);</span></pre></div>

      <p>Send a 1-second "1" tone followed by a 2-second "2" tone:</p>
      <div class="example"><div class="example-title marker"><span>Example 14</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">ontonechange </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">tone </span><span class="pun">==</span><span class="pln"> </span><span class="str">"1"</span><span class="pun">)</span><span class="pln">
          sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="str">"2"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2000</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">};</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">isertDTMF</span><span class="pun">(</span><span class="str">"1"</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
    log</span><span class="pun">(</span><span class="str">"DTMF function not available"</span><span class="pun">);</span></pre></div>

      <p>It is always safe to append to the tone buffer. This example appends
      before any tone playout has started as well as during playout.</p>
      <div class="example"><div class="example-title marker"><span>Example 15</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="str">"123"</span><span class="pun">);</span><span class="pln">
  </span><span class="com">// append more tones to the tone buffer before playout has begun</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">toneBuffer </span><span class="pun">+</span><span class="pln"> </span><span class="str">"456"</span><span class="pun">);</span><span class="pln">

  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">ontonechange </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">tone </span><span class="pun">==</span><span class="pln"> </span><span class="str">"1"</span><span class="pun">)</span><span class="pln">
          </span><span class="com">// append more tones when playout has begun</span><span class="pln">
          sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">toneBuffer </span><span class="pun">+</span><span class="pln"> </span><span class="str">"789"</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
    log</span><span class="pun">(</span><span class="str">"DTMF function not available"</span><span class="pun">);</span></pre></div>

      <p>Send the DTMF signal "123" and abort after sending "2".</p>
      <div class="example"><div class="example-title marker"><span>Example 16</span></div><pre style="" class="highlight prettyprint prettyprinted"><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">ontonechange </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">e</span><span class="pun">.</span><span class="pln">tone </span><span class="pun">==</span><span class="pln"> </span><span class="str">"2"</span><span class="pun">)</span><span class="pln">
          </span><span class="com">// empty the buffer to not play any tone after "2"</span><span class="pln">
          sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="str">""</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">};</span><span class="pln">
  sender</span><span class="pun">.</span><span class="pln">dtmf</span><span class="pun">.</span><span class="pln">insertDTMF</span><span class="pun">(</span><span class="str">"123"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln">
    log</span><span class="pun">(</span><span class="str">"DTMF function not available"</span><span class="pun">);</span></pre></div>
    </section><!--
    <section>
      <h3>Call Flow Browser to MCU</h3>

      <p class="note">Editors' Note: This example flow needs to be discussed on
      the list and is likely wrong in many ways.</p>

      <p>This shows an example of one possible call flow between a centralized
      conferencing server and a browser. This does not show every callback that
      gets fired but instead tries to reduce it down to only show the key
      events and messages.</p>

      <p><img alt=
      "A message sequence chart detailing a call flow between a browser and a centralized conferencing server"
      src="images/ladder-mcu-simple.svg" style="width:100%"></p>
    </section>
-->
  </section>

  <section property="bibo:hasPart" resource="#event-summary" typeof="bibo:Chapter" id="event-summary" class="informative">
    <!--OddPage--><h2 resource="#h-event-summary" id="h-event-summary"><span property="xhv:role" resource="xhv:heading"><span class="secno">12. </span>Event summary</span></h2><p><em>This section is non-normative.</em></p>

    <p>The following events fire on <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code>
    objects:</p>

    <table>
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn data-dfn-type="dfn" id="event-datachannel-open"><code>open</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object's <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
            transport</a> has been established (or re-established).
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-datachannel-message"><code>message</code></dfn></td>

          <td><code><a href="http://www.w3.org/TR/webmessaging/#the-messageevent-interfaces">MessageEvent</a></code> [<cite><a href="#bib-webmessaging" class="bibref">webmessaging</a></cite>]</td>

          <td>A message was successfully received.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-datachannel-bufferedamountlow">
            <code>bufferedamountlow</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object's <code><a href="#dom-datachannel-bufferedamount">bufferedAmount</a></code>
            decreases from above its <code><a href="#dom-datachannel-bufferedamountlowthreshold">
            bufferedAmountLowThreshold</a></code> to less
            than or equal to its <code><a href="#dom-datachannel-bufferedamountlowthreshold">
            bufferedAmountLowThreshold</a></code>.
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-datachannel-error"><code>error</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-errorevent"><code>ErrorEvent</code></a></code></td>

          <td>Any error occured from the data channel.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-datachannel-close"><code>close</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> object's <a data-link-type="dfn" class="internalDFN" href="#dfn-underlying-data-transport">underlying data
            transport</a> has bee closed.
          </td>
        </tr>
      </tbody>
    </table>

    <p>The following events fire on <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
    objects:</p>

    <table>
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn data-dfn-type="dfn" id="event-mediastream-connecting"><code>connecting</code></dfn></td>

          <td><code>Event</code></td>

          <td><div class="issue"><div id="h-issue20" role="heading" aria-level="3" class="issue-title marker"><span>Issue</span></div><p class="">TODO</p></div></td>
        </tr><!--
        <tr>
          <td><dfn title="event-MediaStream-error"><code>error</code></dfn></td>
          <td><code>Event</code></td>
          <td></td>
        </tr>
        <tr>
          <td><dfn title="event-MediaStream-close"><code>close</code></dfn></td>
          <td><code>Event</code></td>
          <td>The <code title="dom-RTCPeerConnection-close">close()</code> method was
            called. </td>
        </tr>
        <tr>
          <td>
            <dfn id="event-mediastream-message">
              <code>message</code>
            </dfn>
          </td>

          <td>
            <code>MessageEvent</code>
          </td>

          <td>A <a href="#data-udp-media-stream">data UDP media
          stream</a> message was received.</td>
        </tr>
        -->

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-track"><code>track</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-RTCTrackEvent"><code>RTCTrackEvent</code></a></code></td>

          <td>
            A new incoming <code>MediaStreamTrack</code> has been created, and an associated
            <code>RTCRtpReceiver</code> has been added to the <a href="#receivers-set">set of receivers</a>.
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-negotiation"><code>negotiationneeded</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>The browser wishes to inform the application that session
          negotiation needs to be done (i.e. a createOffer call followed by
          setLocalDescription).</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-signalingstatechange"><code>signalingstatechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The 
            <a data-link-type="dfn" class="internalDFN" href="#dfn-signaling-state">signaling state</a> has changed. This state change is the result of
            either <code><a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a></code>
            or <code><a href="#dom-peerconnection-setremotedescription">setRemoteDescription()</a></code>
            being invoked.
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-iceconnectionstatechange"><code>iceconnectionstatechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The <code>RTCPeerConnection</code>'s
            <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-connection-state">ICE connection state</a> has changed.
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-icegatheringstatechange"><code>icegatheringstatechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The <code>RTCPeerConnection</code>'s
            <a data-link-type="dfn" class="internalDFN" href="#dfn-ice-gathering-state">ICE gathering state</a> has changed.
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-icecandidate"><code>icecandidate</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code></td>

          <td>A new <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> is made available to
          the script.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-connectionstatechange"><code>connectionstatechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>
            The <a href="#dom-peerconnection-connection-state"><code>RTCPeerConnection</code>
            .connectionstate</a> has changed.
          </td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-icecandidateerror"><code>icecandidateerror</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-RTCPeerConnectionIceErrorEvent"><code>RTCPeerConnectionIceErrorEvent</code></a></code></td>

          <td>A failure occured when gathering ICE candidates.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-datachannel"><code>datachannel</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-RTCDataChannelEvent"><code>RTCDataChannelEvent</code></a></code></td>

          <td>A new <code><a class="idlType" href="#idl-def-RTCDataChannel"><code>RTCDataChannel</code></a></code> is dispatched to the
          script in response to the other peer creating a channel.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-isolationchange"><code>isolationchange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>A new <code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code> is dispatched to the script when
          the <var>isolated</var> attribute on a <code>MediaStreamTrack</code>
          changes.</td>
        </tr>
      </tbody>
    </table>

    <p>The following events fire on <code><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a></code>
    objects:</p>

    <table>
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn data-dfn-type="dfn" id="event-RTCDTMFSender-tonechange"><code>tonechange</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-RTCDTMFToneChangeEvent"><code>RTCDTMFToneChangeEvent</code></a></code></td>

          <td>The <code><a class="idlType" href="#idl-def-RTCDTMFSender"><code>RTCDTMFSender</code></a></code> object has either just
          begun playout of a tone (returned as the <code><a data-link-type="dfn" class="internalDFN" href="#dom-tonechangeevent-tone"><code>tone</code></a></code>
          attribute) or just ended playout of a tone (returned as an empty
          value in the <code><a data-link-type="dfn" class="internalDFN" href="#dom-tonechangeevent-tone"><code>tone</code></a></code> attribute).</td>
        </tr>
      </tbody>
    </table>

    <p>The following events fire on <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>
    objects:</p>

    <table>
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn data-dfn-type="dfn" id="event-icetransport-statechange">
              <code>statechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>The <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code> state changes.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-icetransport-gatheringstatechange"><code>gatheringstatechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>The <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code> gathering state
          changes.</td>
        </tr>

        <tr>
          <td><dfn data-dfn-type="dfn" id="event-icetransport-selectedcandidatepairchange"><code>selectedcandidatepairchange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>The <code><a class="idlType" href="#idl-def-RTCIceTransport"><code>RTCIceTransport</code></a></code>'s selected
            candidate pair changes. </td>
        </tr>
      </tbody>
    </table>

    <p>The following events fire on <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code>
    objects:</p>

    <table>
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn data-dfn-type="dfn" id="event-dtlstransport-statechange" data-lt-nodefault="">
              <code>statechange</code></dfn></td>

          <td><code><a data-link-type="dfn" class="internalDFN" href="#dfn-event">Event</a></code></td>

          <td>The <code><a class="idlType" href="#idl-def-RTCDtlsTransport"><code>RTCDtlsTransport</code></a></code> state changes.</td>
        </tr>
      </tbody>
    </table>

  </section>

  <section property="bibo:hasPart" resource="#privacy-and-security-considerations" typeof="bibo:Chapter" id="privacy-and-security-considerations" class="informative">
    <!--OddPage--><h2 resource="#h-privacy-and-security-considerations" id="h-privacy-and-security-considerations"><span property="xhv:role" resource="xhv:heading"><span class="secno">13. </span>Privacy and Security Considerations</span></h2><p><em>This section is non-normative.</em></p>
    <p>This section is non-normative; it specifies no new behaviour,
    but instead summarizes information already present in other parts
    of the specification. The overall security considerations of the
    general set of APIs and protocols used in WebRTC are described in
    [<cite><a href="#bib-RTCWEB-SECURITY-ARCH" class="bibref">RTCWEB-SECURITY-ARCH</a></cite>].</p>


    <section property="bibo:hasPart" resource="#impact-on-same-origin-policy" typeof="bibo:Chapter" id="impact-on-same-origin-policy">
      <h3 resource="#h-impact-on-same-origin-policy" id="h-impact-on-same-origin-policy"><span property="xhv:role" resource="xhv:heading"><span class="secno">13.1 </span>Impact on same origin policy</span></h3>
    <p>This document extends the Web platform with the ability to set
    up real time, direct communication between browsers and other
    devices, including other browsers.</p>

    <p>This means that data and media can be shared between
    applications running in different browsers, or between an
    application running in the same browser and something that is not a
    browser, something that is an extension to the usual barriers in
    the Web model against sending data between entities with different
    origins.</p>

    <p>The WebRTC specification provides no user prompts or chrome
    indicators for communication; it assumes that once the Web page
    has been allowed to access media, it is free to share that media
    with other entities as it chooses. Peer-to-peer exchanges of data
    view WebRTC datachannels can thus occur without any user explicit
    consent or involvement, similarly as a server-mediated exchange
    (e.g. via Web Sockets) could occur without user involvement.</p>

    <p>The <code><a data-link-type="dfn" class="internalDFN" href="#dfn-peeridentity"><code>peerIdentity</code></a></code> mechanism
    loads and executes JavaScript code from a third-party server
    acting as an identity provider. That code is executed in a
    separate JavaScript realm and does not affect the protections
    afforded by the same origin policy.</p>
    </section>
    <section property="bibo:hasPart" resource="#revealing-ip-addresses" typeof="bibo:Chapter" id="revealing-ip-addresses">
      <h3 resource="#h-revealing-ip-addresses" id="h-revealing-ip-addresses"><span property="xhv:role" resource="xhv:heading"><span class="secno">13.2 </span>Revealing IP addresses</span></h3>

    <p>Even without WebRTC, the Web server providing a Web application
    will know the public IP
    address to which the application is delivered. Setting up
    communications exposes additional information about the browserâ€™s
    network context to the web application, and may include the set of
    (possibly private) IP addresses available to the browser for WebRTC
    use. Some of this information has to be passed to the
    corresponding party to enable the establishment of a communication
    session.</p>

    <p>Revealing IP addresses can leak location and means of
    connection; this can be sensitive. Depending on the network environment,
    it can also increase the fingerprinting surface and create persistent
    cross-origin state that cannot easily be cleared by the user.</p>

    <p>A connection will always reveal the IP addresses proposed for
    communication to the corresponding party. The application can limit
    this exposure by choosing not to use certain addresses using the
    settings exposed by the <a class="idlType" href="#idl-def-RTCIceTransportPolicy"><code>RTCIceTransportPolicy</code></a> dictionary, and by
    using relays (for instance TURN servers) rather than direct
    connections between participants. One will normally assume that
    the IP address of TURN servers is not sensitive
    information. These choices can for instance be made by the application based
    on whether the user has indicated consent to start a media
    connection with the other party.</p>

    <p>Mitigating the exposure of IP addresses to the application
    itself requires
    limiting the IP addresses that can be used, which will impact the
    ability to communicate on the most direct path between endpoints.
    Browsers are encouraged to provide appropriate controls for deciding
    which IP addresses are made available to applications, based on the
    security posture desired by the user. The choice
    of which addresses to expose is controlled by local policy (see
    [<cite><a href="#bib-RTCWEB-IP-HANDLING" class="bibref">RTCWEB-IP-HANDLING</a></cite>] for details).</p>
    </section>
    <section property="bibo:hasPart" resource="#impact-on-local-network" typeof="bibo:Chapter" id="impact-on-local-network">
      <h3 resource="#h-impact-on-local-network" id="h-impact-on-local-network"><span property="xhv:role" resource="xhv:heading"><span class="secno">13.3 </span>Impact on local network</span></h3>

    <p>Since the browser is an active platform executing in a trusted
    network environment (inside the firewall), it is important to
    limit the damage that the browser can do to other elements on the
    local network, and it is important to protect data from
    interception, manipulation and modification by untrusted
    participants.</p>

    <p>Mitigations include:</p>
    <ul>
      <li>An UA will always request permission from the correspondent
      UA to communicate using ICE. This
      ensures that the UA can only send to partners who you have
      shared credentials with.</li>
      <li>An UA will always request ongoing permission to continue sending
      using ICE continued
      consent. This enables a receiver to withdraw consent to
      receive.</li>
      <li>An UA will always encrypt data, with strong per-session keying
      (DTLS-SRTP).</li>
      <li>An UA wil always use congestion control. This ensures that
      WebRTC cannot be used to flood the network.</li>
    </ul>
    <p>These measures are specified in the relevant IETF documents.</p>
    </section>
    <section property="bibo:hasPart" resource="#confidentiality-of-communications" typeof="bibo:Chapter" id="confidentiality-of-communications">
      <h3 resource="#h-confidentiality-of-communications" id="h-confidentiality-of-communications"><span property="xhv:role" resource="xhv:heading"><span class="secno">13.4 </span>Confidentiality of Communications</span></h3>
    <p>The fact that communication is taking place cannot be hidden from
    adversaries that can observe the network, so this has to be
    regarded as public information.</p>

    <p>A mechanism, <code><a data-link-type="dfn" class="internalDFN" href="#dfn-peeridentity"><code>peerIdentity</code></a></code>, is provided that gives
    Javascript the option of requesting media that the same javascript
    cannot access, but can only be sent to certain other entities.</p>
    </section>

  <section property="bibo:hasPart" resource="#persistent-information-exposed-by-webrtc" typeof="bibo:Chapter" id="persistent-information-exposed-by-webrtc">
    <h3 resource="#h-persistent-information-exposed-by-webrtc" id="h-persistent-information-exposed-by-webrtc"><span property="xhv:role" resource="xhv:heading"><span class="secno">13.5 </span>Persistent information exposed by WebRTC</span></h3>
    <p>As described above, the list of IP addresses exposed by the
    WebRTC API can be used as a persistent cross-origin state.</p>

    <p>Beyond IP addresses, the WebRTC API exposes information about
    the underlying media system via
    the <code>RTCRtpSender.getCapabilities</code>
    and <code>RTCRtpReceiver.getCapabilities</code> methods, including
    detailed and ordered information about the codecs that the system is able to
    produce and consume. A subset of that information is likely to be
    represented in the SDP session descriptions generated, exposed and
    transmitted during <a href="#session-negotiation-model">session
    negotiation</a>. That
    information is in most cases persistent across time and origins,
    and increases the fingerprint surface of a given device.</p>

    <p>When establishing DTLS connections, the WebRTC API can generate
    certificates that can be persisted by the application (e.g. in
    IndexedDB). These certificates are not shared across origins, and
    get cleared when persistent storage is cleared for the origin.</p>
  </section>
    </section>

<!--section>
    <h2 id="sec-iana">IANA Registrations</h2>



    <p>IANA is requested to register the constraints defined in <a href=
    "#sec-constraints">Constraints Section</a> as specified in
    [[!RTCWEB-CONSTRAINTS]].</p>


    <section>
      <h3 id="sec-constraints">Constraints</h3>


      <p>TOOD: Need to change the naming and declaration of these constraints
      to match the constraints draft once that is a bit further along. The
      names here now are likely not quite right but they serve as a place
      holder.</p>


      <p class="issue">ISSUE: there are multiple ways to add constraints. How
      are multiple values reconciled?</p>


      <p>The following new constraints are defined that can be used with an
      <code>RTCPeerConnection</code> object:</p>


      <p>TODO items - need to register with IANA.</p>
    </section>
  </section-->

  <section property="bibo:hasPart" resource="#change-log" typeof="bibo:Chapter" id="change-log">
    <!--OddPage--><h2 resource="#h-change-log" id="h-change-log"><span property="xhv:role" resource="xhv:heading"><span class="secno">14. </span>Change Log</span></h2>

    <p>This section will be removed before publication.</p>
    <!-- Why do the first two headings automatically convert to <h2>? -->
    <!-- Because you haven't added a <section> element around them
         and respec rewrites h? elements based on the section depth -->

    <h2 id="changes-since-november-23-2015">Changes since November 23, 2015</h2>
    <ol>
      <li>[#179, #439] Document IP address leakage in RTCIceCandidate</li>

      <li>[#439] Complete security considerations based on security
      questionnaire and IP address discussions #439</li>

      <li>[#446] Non-nullable RTCTrackEvent args means Init dict members are
      required</li>

      <li>[#449] Clarify flow of SDP exchanges (Update simple p2p example)</li>

      <li>[#451] Clean up event handler attribute descriptions</li>

      <li>[#452, #438] Make replaceTrack() handle "not sending yet" case</li>

      <li>[#454] Add contributing source voice activity flag</li>

      <li>[#455, #439] Add references to parsing stun/turn URLs section</li>

      <li>[#456, #338] SDP changes between the createOffer and
      setLocalDescription (add JSEP reference)</li>

      <li>[#459] Add non-normative ICE state transitions</li>

      <li>[#460, #461] getRemoteCertificates() behavior in "new" and
      "connecting" states</li>

      <li>[#465, #140] Use ErrorEvent as interface for events emitted by
      RTCDataChannel.onerror</li>

      <li>[#469, #382, #373] Reject changes to peerIdentity and certificates in
      setConfiguration</li>

      <li>[#474, #406] Define RTCIceTransport.component when RTP/RTCP mux is in
      use</li>
    </ol>

    <h2 id="changes-since-november-23-2015-1">Changes since November 23, 2015</h2>

    <ol>
      <li>[#353] Plan X: Add an API for using RID to do simulcast</li>

      <li>[#365] Adding an accessor for the browser-configured ICE servers</li>

      <li>[#398] Make RtpTransceiver.mid nullable and remove RtpSender.mid and
      RtpReceiver.mid</li>

      <li>[#402, #391] Remove requirement about DTMF tones A-D</li>

      <li>[#403, #377] Use positive values for AudioLevel</li>

      <li>[#401, #267] Add bitrate definition</li>

      <li>[#404] Remove 'Events on MediaStream' section (duplicates new text in
      Media Capture spec)</li>

      <li>[#410, #328] Make RTCBundlePolicy Enum section normative</li>

      <li>[#411, #408] Clarify component for IceTransport when RTP/RTCP mux is
      used</li>

      <li>[#414] Define ReSpec processor for cross-reference to JSEP</li>

      <li>[#418] Make degradationPreference per-sender instead of
      per-encoding</li>

      <li>[#416] RTCRtpSender.replaceTrack() fixes (e.g. handle closed
      RTCPeerConnection)</li>

      <li>[#421] Require sdp in RTCSessionDescription{,Init}</li>

      <li>[#422]  Remove confusing paragraph on fourth party interception</li>

      <li>[#423] Add specific references to JSEP where possible</li>

      <li>[#428] Don't create a default stream in 'dispatch a receiver'
      steps</li>

      <li>[#429] Adding expires attribute to generateCertificate</li>

      <li>[#430] Add maxFramerate knob for simulcast</li>

      <li>[#432] Update RTCIceTransportPolicy</li>

      <li>[#433] Use unsigned long ssrc in stats</li>

      <li>[#424] Editorial: Distinguish states from their attribute
      representation</li>
    </ol>

    <h3 id="changes-since-october-6-2015">Changes since October 6, 2015</h3>

    <ol>
      <li>[#325] Adding additional members to RTCIceCandidate dictionary</li>

      <li>[#327] Adding sha-256 to the certificate management options for RSA</li>

      <li>[#342] Using DOMTimestamp for RTCCertificate::expires</li>

      <li>[#293] Add RTCRtpTransceiver and PeerConnection.addMedia</li>

      <li>[#366, #343] Use RTCDegradationPreference</li>

      <li>[#374] Throw on too long label/protocol in createDataChannel()</li>

      <li>[#266] Tidy up setLocal/RemoteDescription processing model</li>

      <li>[#361] Adding setCodecPreferences to RTCRtpTransceiver</li>

      <li>[#371] Add RtcpMuxPolicy</li>

      <li>[#385, #312] Don't invoke public API in legacy function section</li>

      <li>[#394, #393] don't throw on empty iceServers list</li>
    </ol>

    <h3 id="changes-since-september-22-2015">Changes since September 22, 2015</h3>

    <ol>
      <li>[#289, #153] Add way to set size of ICE candidate pool</li>

      <li>[#256] Fix prose on getStats() wo/selector + move type check to sync
      section</li>

      <li>[#242] Remove SyntaxError on malformed ICE candidate</li>

      <li>[#284] Add icecandidateerror event for indicating ICE gathering
      errors</li>

      <li>[#298] Add support for codec reordering and removal in
      RtpParameters</li>

      <li>[#311] Fixing syntax for required RTCCertificate arguments</li>

      <li>[#280] Add extra IceTransport read-only attributes and methods</li>

      <li>[#291] Add PeerConnection.connectionState</li>

      <li>[#300, #4, #6, #276] Add API to get SSRC and audio levels</li>

      <li>[#301] Fix RTCStatsReport with object and maplike instead of
      getter</li>

      <li>[#302] (Partly) removing interface use for RTCSessionDescription and
      RTCIceCandidate</li>

      <li>[#314, #299] Update the operations queue to handle promises and closed
      signalling</li>

      <li>[#273] Add a bunch of fields to RtpParameters and
      RtpEncodingParameters</li>
    </ol>

    <h3 id="changes-since-june-11-2015">Changes since June 11, 2015</h3>

    <ol>
      <li>[#234] Add RTCRtpParameters, RTCRtpSender.getParameters, and
      RTCRtpSender.setParameters</li>

      <li>[#225] Support for pending and current SDP</li>

      <li>[#229] Removing the weird optionality from RTCSessionDescription and
      its constructor.</li>

      <li>[#235] Modernize getStats() with promises</li>

      <li>[#243] Mark candidate property of RTCIceCandidateInit required</li>

      <li>[#248] Fix error handling for certificate management</li>

      <li>[#259] Change type of RtpEncodingParameters.priority to an enum</li>

      <li>[#21, #262] Sort out 2119 MUSTs and SHOULDs</li>

      <li>[#268] Add RtpEncodingParameters.maxBitrate</li>

      <li>[#241] Add RtpSender.transport, RtpReceiver.transport,
      RTCDtlsTransport, RTCIceTransport, etc</li>

      <li>[#224, #261] Sort out when responding PeerConnection reaches
      iceConnetionState completed</li>

      <li>[#303] Replace track without renegotiation</li>

      <li>[#269] Add RTCRtpSender.getCapabilities and
      RTCRtpReceiver.getCapabilities</li>
    </ol>

    <h3 id="changes-since-march-6-2015">Changes since March 6, 2015</h3>

    <ol>
      <li>[PR #167] Removed RTCPeerConnection.createDTMFSender and added
      RTCRtpSender.dtmf, along with corresponding examples.</li>

      <li>[PR #184] RTCPeerConnection will NOT connect unless identity is
      verified.</li>

      <li>[PR #27] Documenting practice with candidate events</li>

      <li>[PR #203] Rewrote mitigations text for security considerations
      section</li>

      <li>[PR #192] Added support for auth tokens. Fixes #190</li>

      <li>[PR #207] Update ice config examples to use multiple urls and *s
      schemes</li>

      <li>[PR #210] Optional RTCConfiguration in RTCPC constructor</li>

      <li>[PR #171] Add RTCAnswerOptions (with common RTCOfferAnswerOptions
      dictionary)</li>

      <li>[PR #178] Identity provider interface redesign</li>

      <li>[PR #193] Add .mid property to sender/receiver. Fixes #191</li>

      <li>[PR #218] Enqueue addIceCandidate</li>

      <li>[PR #213 (1)] Rename updateIce() to setConfiguration()</li>

      <li>[PR #213 (2)] Make RTCPeerConnection.setConfiguration() replace the
      existing configuration</li>

      <li>[PR #214] Certificate management API (Bug 21880)</li>

      <li>[PR #220] Clarify muted state (proposed fix for issue #139)</li>

      <li>[PR #221] Define when RTCRtpReceivers are created and dispatced
      (issue #198)</li>

      <li>[PR #215] Adding expires attribute to certificate management</li>

      <li>[PR #233] Add a "bufferedamountlow" event</li>
    </ol>

    <h3 id="changes-since-december-5-2014">Changes since December 5, 2014</h3>

    <ol>
      <li>Properly define the negotiationneeded event, and its interactions with
      other API calls.</li>
      <li>Add support for RTCRtpSender and RTCRtpReceiver.</li>
      <li>Update misleading local/RemoteDescription attribute text.</li>

      <li>Add RTCBundlePolicy.</li>

      <li>All callback-based methods have been moved to a legacy section, and
      replaced by same-named overloads using Promises instead.</li>

      <li>[PR #194] Added first version of Security Considerations (more work
        needed)</li>

      <li>Updated identity provider structure.</li>
    </ol>

    <h3 id="changes-since-june-4-2014">Changes since June 4, 2014</h3>

    <ol>
      <li>Bug 25724: Allow garbage collection of closed PeerConnections</li>

      <li>Bug 27214: Add onicegatheringstatechange event</li>
      <li>Bug 26644: Fixing end of candidates event</li>
    </ol>

    <h3 id="changes-since-april-10-2014">Changes since April 10, 2014</h3>

    <ol>
      <li>Bug 25774: Mixed isolation</li>
    </ol>

    <h3 id="changes-since-april-10-2014-1">Changes since April 10, 2014</h3>

    <ol>
      <li>Bug 25855: Clarification about conformance requirements phrased as
      algorithms</li>

      <li>Bug 25892: SignalingStateChange event should be fired only if there
      is a change in signaling state.</li>

      <li>Bug 25152: createObjectURL used in examples is no longer supported by
      Media Capture and Streams.</li>

      <li>Bug 25976: DTMFSender.insertDTMF steps should validate the values of
      duration and interToneGap.</li>

      <li>Bug 25189: Mandatory errorCallback is missing in examples for
      getStats.</li>

      <li>Bug 25840: Creating DataChannel with same label.</li>

      <li>Updated comment above example ice state transitions (discussed in Bug
      25257).</li>

      <li>Updated insertDTMF() algorithm to ignore unrecognized characters (as
      discussed in bug 25977).</li>

      <li>Made formatting of references to ice connection state
      consistent.</li>

      <li>Made insertDTMF() throw on unrecognized characters (used to
      ignore).</li>

      <li>Removed requestIdentity from RTCConfiguration and
      RTCOfferAnswerOptions. Removed RTCOfferAnswerOptions as a result.</li>

      <li>Adding isolated property and associated event to
      MediaStreamTrack.</li>
    </ol>

    <h3 id="changes-since-march-21-2014">Changes since March 21, 2014</h3>

    <ol>
      <li>Changes to identity-related text:

        <ul>
          <li>Removed noaccess constraint</li>

          <li>Add the ability to peerIdentity constrain RTCPeerConnection,
          which limits communication to a single peer</li>

          <li>Change the way that the browser communicates with IdP to a
          message channel
          (http://www.w3.org/TR/webmessaging/#message-channels)</li>

          <li>Improved error feedback from IdP interactions (added new events
          with more detailed context)</li>

          <li>Changed the way that an IdP is able to request user login
          (LOGINNEEDED message)</li>
        </ul>
      </li>

      <li>Bug 25155: maxRetransmitTime is not the name of the SCTP concept it
      points to.</li>
    </ol>

    <h3 id="changes-since-january-27-2014">Changes since January 27, 2014</h3>

    <ol>
      <li>Refined identity assertion generation and validation.</li>

      <li>Default DTMF gap changed from 50 to 70 ms.</li>

      <li>Bug 24875: Examples in the WebRTC spec are not updated As per the
      modified API.</li>
    </ol>

    <h3 id="changes-since-august-30-2013">Changes since August 30, 2013</h3>

    <ol>
      <li>Make RTCPeerConnection close method be idempotent.</li>

      <li>Clarified ICE server configuration could contain URI types other than
      STUN and TURN.</li>

      <li>Changed the DTMF timing values.</li>

      <li>Allow offerToReceiveAudio/video indicate number of streams to
      offer.</li>

      <li>ACTION-98: Added text about clamping of maxRetransmitTime and
      maxRetransmits.</li>

      <li>ACTION-88: Removed nullable types from dictionaries (added attribute
      default values for attributes that would be left uninitialized without
      the init dictionary present.</li>

      <li>InvalidMediaStreamTrackError changed to InvalidParameter.</li>

      <li>Fire NetworkError when the data transport is closed with an
      error.</li>

      <li>Add an exception for data channel with trying to use existing
      code.</li>

      <li>Change maxRetransmits to be an unsigned type.</li>

      <li>Clarify state changes when ICE restarts.</li>

      <li>Added InvalidStateError exception for operations on a
      RTCPeerConnection that is closed.</li>

      <li>Major changes to Identity Proxy section.</li>

      <li>(ACTION: 95) Moved IceTransports (constraint) to RTCConfiguration
      dictionary.</li>

      <li>(ACTION: 95) Introduced RTCOfferAnswerOptions and RTCOfferOptions
      dictionaries.</li>

      <li>(ACTION: 95) Removed constraints argument from addStream() (and
      removed IANA Constraints section).</li>

      <li>Added validation of the RTCConfiguration dictionary argument(s).</li>

      <li>Added getConfiguration() on RTCPeerConnection.</li>
    </ol>

    <h3 id="changes-since-june-3-2013">Changes since June 3, 2013</h3>

    <ol>
      <li>Removed synchronous section left-overs.</li>

      <li>RTCIceServer now accepts multiple URLs.</li>

      <li>Redefined the meaning of negotiated for DataChannel.</li>

      <li>Made iceServers a sequence (instead of an Array).</li>

      <li>Updated error reporting (to use DOMError and camel cased names).</li>

      <li>Added success and failure callbacks to addIceCandidate().</li>

      <li>Made local/remoteDescription attributes nullable.</li>

      <li>Added username member to RTCIceServer dictionary.</li>
    </ol>

    <h3 id="changes-since-march-22-2013">Changes since March 22, 2013</h3>

    <ol>
      <li>Added IceRestart constraint.</li>

      <li>Big updates on DataChannel API to use new channel setup
      procedures.</li>
    </ol>

    <h3 id="changes-since-feb-22-2013">Changes since Feb 22, 2013</h3>

    <ol>
      <li>Example review: Updated DTMF and Stats examples. Added text about
      when to fire "negotiationneeded" event to align with examples.</li>

      <li>Updated RTCPeerConnection state machine. Added a shared processing
      model for setLocalDescription()/setRemoteDescription().</li>

      <li>Updated simple callflow to match the current API.</li>
    </ol>

    <h3 id="changes-since-jan-16-2013">Changes since Jan 16, 2013</h3>

    <ol>
      <li>Initial import of Statistics API to version 2.</li>

      <li>Integration of Statistics API version 2.5 started.</li>

      <li>Updated Statistics API to match Boston/list discussions.</li>

      <li>Extracted API extensions introduced by features, such as the P2P Data
      API, from the RTCPeerConnection API.</li>

      <li>Updated DTMF algorithm to dispatch an event when insertDTMF() is
      called with an empty string to cancel future tones.</li>

      <li>Updated DTMF algorithm to not cancel and reschedule if a playout task
      is running (only update toneBuffer and other values).</li>
    </ol>

    <h3 id="changes-since-dec-12-2012">Changes since Dec 12, 2012</h3>

    <ol>
      <li>Changed AudioMediaStreamTrack to RTCDTMFSender and gave it its own
      section. Updated text to reflect most recent agreements. Also added
      examples section.</li>

      <li>Replaced the localStreams and remoteStreams attributes with functions
      returning sequences of MediaStream objects.</li>

      <li>Added spec text for attributes and methods adopted from the WebSocket
      interface.</li>

      <li>Changed the state ENUMs and transition diagrams.</li>

      <li>Aligned the data channel processing model a bit more with WebSockets
      (mainly closing the underlying transport).</li>
    </ol>

    <h3 id="changes-since-nov-13-2012">Changes since Nov 13, 2012</h3>

    <ol>
      <li>Made some clarifications as to how operation queuing works, and fixed
      a few errors with the error handling description.</li>

      <li>Introduced new representation of tracks in a stream (removed
      MediaStreamTrackList). Added algorithm for creating a track to represent
      an incoming network media component.</li>

      <li>Renamed MediaStream.label to MediaStream.id (the definition needs
      some more work).</li>
    </ol>

    <h3 id="changes-since-nov-03-2012">Changes since Nov 03, 2012</h3>

    <ol>
      <li>Added text describing the queuing mechanism for
      RTCPeerConnection.</li>

      <li>Updated simple P2P example to include all mandatory (error)
      callbacks.</li>

      <li>Updated P2P data example to include all mandatory (error) callbacks.
      Also added some missing RTC prefixes.</li>
    </ol>

    <h3 id="changes-since-oct-19-2012">Changes since Oct 19, 2012</h3>

    <ol>
      <li>Clarified how createOffer() and createAnswer() use their
      callbacks.</li>

      <li>Made all failure callbacks mandatory.</li>

      <li>Added error object types, general error handling principles, and
      rules for when errors should be thrown.</li>
    </ol>

    <h3 id="changes-since-sept-23-2012">Changes since Sept 23, 2012</h3>

    <ol>
      <li>Restructured the document layout and created separate sections for
      features like Peer-to-peer Data API, Statistics and Identity.</li>
    </ol>

    <h3 id="changes-since-aug-16-2012">Changes since Aug 16, 2012</h3>

    <ol>
      <li>Replaced stringifier with serializer on RTCSessionDescription and
      RTCIceCandidate (used when JSON.stringify() is called).</li>

      <li>Removed offer and createProvisionalAnswer arguments from the
      createAnswer() method.</li>

      <li>Removed restart argument from the updateIce() method.</li>

      <li>Made RTCDataChannel an EventTarget</li>

      <li>Updated simple RTCPeerConnection example to match spec changes.</li>

      <li>Added section about RTCDataChannel garbage collection.</li>

      <li>Added stuff for identity proxy.</li>

      <li>Added stuff for stats.</li>

      <li>Added stuff peer and ice state reporting.</li>

      <li>Minor changes to sequence diagrams.</li>

      <li>Added a more complete RTCDataChannel example</li>

      <li>Various fixes from Dan's Idp API review.</li>

      <li>Patched the Stats API.</li>
    </ol>

    <h3 id="changes-since-aug-13-2012">Changes since Aug 13, 2012</h3>

    <ol>
      <li>Made the RTCSessionDescription and RTCIceCandidate constructors take
      dictionaries instead of a strings. Also added detailed stringifier
      algorithm.</li>

      <li>Went through the list of issues (issue numbers are only valid with
      HEAD at fcda53c460). Closed (fixed/wontfix): 1, 8, 10, 13, 14, 16, 18,
      19, 22, 23, 24. Converted to notes: 4, 12. Updated: 9.</li>

      <li>Incorporate <a href="http://lists.w3.org/Archives/Public/www-archive/2012Aug/0015.html">changes
      proposed</a> by Li Li.
      </li>

      <li>Use an enum for DataChannelState and fix IDLs where using an optional
      argument also requires all previous optional arguments to have a default
      value.</li>
    </ol>

    <h3 id="changes-since-jul-20-2012">Changes since Jul 20, 2012</h3>

    <ol>
      <li>Added RTC Prefix to names (including the notes below).</li>

      <li>Moved to new definition of configuration and ice servers object.</li>

      <li>Added correlating lines to candidate structure.</li>

      <li>Converted setLocalDescription and setRemoteDescription to be
      asynchronous.</li>

      <li>Added call flows.</li>
    </ol>

    <h3 id="changes-since-jul-13-2012">Changes since Jul 13, 2012</h3>

    <ol>
      <li>Removed peer attribute from RTCPeerConnectionIceEvent (duplicates
      functionality of Event.target attribute).</li>

      <li>Removed RTCIceCandidateCallback (no longer used).</li>

      <li>Removed RTCPeerConnectionEvent (we use a simple event instead).</li>

      <li>Removed RTCSdpType argument from setLocalDescription() and
      setRemoteDescription(). Updated simple example to match.</li>
    </ol>

    <h3 id="changes-since-may-28-2012">Changes since May 28, 2012</h3>

    <ol>
      <li>Changed names to use RTC Prefix.</li>

      <li>Changed the data structure used to pass in STUN and TURN servers in
      configuration.</li>

      <li>Updated simple RTCPeerConnection example (RTCPeerConnection
      constructor arguments; use icecandidate event).</li>

      <li>Initial import of new Data API.</li>

      <li>Removed some left-overs from the old Data Stream API.</li>

      <li>Renamed "underlying data channel" to "underlying data transport".
      Fixed closing procedures. Fixed some typos.</li>
    </ol>

    <h3 id="changes-since-april-27-2012">Changes since April 27, 2012</h3>

    <ol>
      <li>Major rewrite of RTCPeerConnection section to line up with IETF JSEP
      draft.</li>

      <li>Added simple RTCPeerConnection example. Initial update of
      RTCSessionDescription and RTCIceCandidate to support serialization and
      construction.</li>
    </ol>

    <h3 id="changes-since-21-april-2012">Changes since 21 April 2012</h3>

    <ol>
      <li>Moved MediaStream and related definitions to getUserMedia.</li>

      <li>Removed section "Obtaining local multimedia content".</li>

      <li>Updated getUserMedia() calls in examples (changes in Media Capture TF
      spec).</li>

      <li>Introduced MediaStreamTrackList interface with support for adding and
      removing tracks.</li>

      <li>Updated the algorithm that is run when RTCPeerConnection receives a
      stream (create new stream when negotiated instead of when data
      arrives).</li>
    </ol>

    <h3 id="changes-since-12-january-2012">Changes since 12 January 2012</h3>

    <ol>
      <li>Clarified the relation of Stream, Track, and Channel.</li>
    </ol>

    <h3 id="changes-since-17-october-2011">Changes since 17 October 2011</h3>

    <ol>
      <li>Tweak the introduction text and add a reference to the IETF RTCWEB
      group.</li>

      <li>Changed the first argument to getUserMedia to be an object.</li>

      <li>Added a MediaStreamHints object as a second argument to
      RTCPeerConnection.addStream.</li>

      <li>Added AudioMediaStreamTrack class and DTMF interface.</li>
    </ol>

    <h3 id="changes-since-23-august-2011">Changes since 23 August 2011</h3>

    <ol>
      <li>Separated the SDP and ICE Agent into separate agents and added
      explicit state attributes for each.</li>

      <li>Removed the send method from PeerConenction and associated callback
      function.</li>

      <li>Modified MediaStream() constructor to take a list of MediaStreamTrack
      objects instead of a MediaStream. Removed text about MediaStream parent
      and child relationship.</li>

      <li>Added abstract.</li>

      <li>Moved a few paragraphs from the MediaStreamTrack.label section to the
      MediaStream.label section (where they belong).</li>

      <li>Split MediaStream.tracks into MediaStream.audioTracks and
      MediaStream.videoTracks.</li>

      <li>Removed a sentence that implied that track access is limited to
      LocalMediaStream.</li>

      <li>Updated a few getUserMedia()-examples to use MediaStreamOptions.</li>

      <li>Replaced calls to URL.getObjectURL() with URL.createObjectURL() in
      example code.</li>

      <li>Fixed some broken getUserMedia() links.</li>

      <li>Introduced state handling on MediaStreamTrack (removed state handling
      from MediaStream).</li>

      <li>Reintroduced onended on MediaStream to simplify checking if all
      tracks are ended.</li>

      <li>Aligned the MediaStreamTrack ended event dispatching behavior with
      that of MediaStream.</li>

      <li>Updated the LocalMediaStream.stop() algorithm to implicitly use the
      end track algorithm.</li>

      <li>Replaced an occurrence the term finished track with ended track (to
      align with rest of spec).</li>

      <li>Moved (and extended) the explanation about track references and media
      sources from LocalMediaStream to MediaStreamTrack.</li>
    </ol>
  </section>

  <section property="bibo:hasPart" resource="#acknowledgements" typeof="bibo:Chapter" id="acknowledgements" class="appendix">
    <!--OddPage--><h2 resource="#h-acknowledgements" id="h-acknowledgements"><span property="xhv:role" resource="xhv:heading"><span class="secno">A. </span>Acknowledgements</span></h2>

    <p>The editors wish to thank the Working Group chairs and Team Contact,
    Harald Alvestrand, Stefan HÃ¥kansson, Erik Lagerway and Dominique
    HazaÃ«l-Massieux, for their support. Substantial text in this
    specification was provided by many people including Martin Thomson, Harald
    Alvestrand, Justin Uberti, Eric Rescorla, Peter Thatcher, Jan-Ivar Bruaroey
    and Peter Saint-Andre. Dan Burnett would like to acknowledge the
    significant support received from Voxeo and Aspect during the
    development of this specification.</p>

    <p>The RTCRtpSender and RTCRtpReceiver objects were initially described in the
      <a href="https://www.w3.org/community/ortc/"><abbr title="World Wide Web Consortium">W3C</abbr> ORTC CG</a>, and have been
      adapted for use in this specification.</p>
  </section>


<section property="bibo:hasPart" resource="#references" typeof="bibo:Chapter" id="references" class="appendix"><!--OddPage--><h2 resource="#h-references" id="h-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B. </span>References</span></h2><section property="bibo:hasPart" resource="#normative-references" typeof="bibo:Chapter" id="normative-references"><h3 resource="#h-normative-references" id="h-normative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B.1 </span>Normative references</span></h3><dl resource="" class="bibliography"><dt id="bib-FIPS-180-4">[FIPS-180-4]</dt><dd><a property="dc:requires" href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"><cite>FIPS PUB 180-4 Secure Hash Standard</cite></a>. URL: <a property="dc:requires" href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
</dd><dt id="bib-GETUSERMEDIA">[GETUSERMEDIA]</dt><dd>Daniel Burnett; Adam Bergkvist; Cullen Jennings; Anant Narayanan. <a property="dc:requires" href="http://www.w3.org/TR/mediacapture-streams/"><cite>Media Capture and Streams</cite></a>. 14 April 2015. W3C Last Call Working Draft. URL: <a property="dc:requires" href="http://www.w3.org/TR/mediacapture-streams/">http://www.w3.org/TR/mediacapture-streams/</a>
</dd><dt id="bib-HIGHRES-TIME">[HIGHRES-TIME]</dt><dd>Ilya Grigorik; James Simonsen; Jatinder Mann. <a property="dc:requires" href="http://www.w3.org/TR/hr-time-2/"><cite>High Resolution Time Level 2</cite></a>. 16 November 2015. W3C Working Draft. URL: <a property="dc:requires" href="http://www.w3.org/TR/hr-time-2/">http://www.w3.org/TR/hr-time-2/</a>
</dd><dt id="bib-HTML">[HTML]</dt><dd>Ian Hickson. <a property="dc:requires" href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a property="dc:requires" href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
</dd><dt id="bib-HTML5">[HTML5]</dt><dd>Ian Hickson; Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Edward O'Connor; Silvia Pfeiffer. <a property="dc:requires" href="http://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. 28 October 2014. W3C Recommendation. URL: <a property="dc:requires" href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
</dd><dt id="bib-ICE">[ICE]</dt><dd>J. Rosenberg. <a property="dc:requires" href="https://tools.ietf.org/html/rfc5245"><cite>Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</cite></a>. April 2010. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc5245">https://tools.ietf.org/html/rfc5245</a>
</dd><dt id="bib-JSEP">[JSEP]</dt><dd>Justin Uberti; Cullen Jennings; Eric Rescorla. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/"><cite>Javascript Session Establishment Protocol</cite></a>. 18 October 2015. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd>S. Bradner. <a property="dc:requires" href="https://tools.ietf.org/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-RFC4566">[RFC4566]</dt><dd>M. Handley; V. Jacobson; C. Perkins. <a property="dc:requires" href="https://tools.ietf.org/html/rfc4566"><cite>SDP: Session Description Protocol</cite></a>. July 2006. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc4566">https://tools.ietf.org/html/rfc4566</a>
</dd><dt id="bib-RFC5389">[RFC5389]</dt><dd>J. Rosenberg; R. Mahy; P. Matthews; D. Wing. <a property="dc:requires" href="https://tools.ietf.org/html/rfc5389"><cite>Session Traversal Utilities for NAT (STUN)</cite></a>. October 2008. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc5389">https://tools.ietf.org/html/rfc5389</a>
</dd><dt id="bib-RFC5888">[RFC5888]</dt><dd>G. Camarillo; H. Schulzrinne. <a property="dc:requires" href="https://tools.ietf.org/html/rfc5888"><cite>The Session Description Protocol (SDP) Grouping Framework</cite></a>. June 2010. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc5888">https://tools.ietf.org/html/rfc5888</a>
</dd><dt id="bib-RFC6236">[RFC6236]</dt><dd>I. Johansson; K. Jung. <a property="dc:requires" href="https://tools.ietf.org/html/rfc6236"><cite>Negotiation of Generic Image Attributes in the Session Description Protocol (SDP)</cite></a>. May 2011. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc6236">https://tools.ietf.org/html/rfc6236</a>
</dd><dt id="bib-RFC6464">[RFC6464]</dt><dd>J. Lennox, Ed.; E. Ivov; E. Marocco. <a property="dc:requires" href="https://tools.ietf.org/html/rfc6464"><cite>A Real-time Transport Protocol (RTP) Header Extension for Client-to-Mixer Audio Level Indication</cite></a>. December 2011. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc6464">https://tools.ietf.org/html/rfc6464</a>
</dd><dt id="bib-RFC6465">[RFC6465]</dt><dd>E. Ivov, Ed.; E. Marocco, Ed.; J. Lennox. <a property="dc:requires" href="https://tools.ietf.org/html/rfc6465"><cite>A Real-time Transport Protocol (RTP) Header Extension for Mixer-to-Client Audio Level Indication</cite></a>. December 2011. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc6465">https://tools.ietf.org/html/rfc6465</a>
</dd><dt id="bib-RFC6544">[RFC6544]</dt><dd>J. Rosenberg; A. Keranen; B. B. Lowekamp; A. B. Roach. <a property="dc:requires" href="https://tools.ietf.org/html/rfc6544"><cite>TCP Candidates with Interactive Connectivity Establishment (ICE)</cite></a>. March 2012. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc6544">https://tools.ietf.org/html/rfc6544</a>
</dd><dt id="bib-RFC7064">[RFC7064]</dt><dd>S. Nandakumar; G. Salgueiro; P. Jones; M. Petit-Huguenin. <a property="dc:requires" href="https://tools.ietf.org/html/rfc7064"><cite>URI Scheme for the Session Traversal Utilities for NAT (STUN) Protocol</cite></a>. November 2013. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc7064">https://tools.ietf.org/html/rfc7064</a>
</dd><dt id="bib-RFC7065">[RFC7065]</dt><dd>M. Petit-Huguenin; S. Nandakumar; G. Salgueiro; P. Jones. <a property="dc:requires" href="https://tools.ietf.org/html/rfc7065"><cite>Traversal Using Relays around NAT (TURN) Uniform Resource Identifiers</cite></a>. November 2013. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc7065">https://tools.ietf.org/html/rfc7065</a>
</dd><dt id="bib-RTCWEB-ALPN">[RTCWEB-ALPN]</dt><dd>M. Thomson. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-alpn/"><cite>Application Layer Protocol Negotiation for Web Real-Time Communications</cite></a>. 23 July 2014. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-alpn/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-alpn/</a>
</dd><dt id="bib-RTCWEB-AUDIO">[RTCWEB-AUDIO]</dt><dd>JM. Valin; C. Bran. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-audio/"><cite>WebRTC Audio Codec and Processing Requirements</cite></a>. 27 January 2014. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-audio/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-audio/</a>
</dd><dt id="bib-RTCWEB-DATA">[RTCWEB-DATA]</dt><dd>R. Jesup; S. Loreto; M. Tuexen. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-data-channel/"><cite>RTCWeb Data Channels</cite></a>. 21 October 2013. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-data-channel/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-data-channel/</a>
</dd><dt id="bib-RTCWEB-DATA-PROTOCOL">[RTCWEB-DATA-PROTOCOL]</dt><dd>R. Jesup; S. Loreto; M. Tuexen. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-data-protocol/"><cite>RTCWeb Data Channel Protocol</cite></a>. 21 October 2013. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-data-protocol/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-data-protocol/</a>
</dd><dt id="bib-RTCWEB-RTP">[RTCWEB-RTP]</dt><dd>C. Perkins; M. Westerlund; J. Ott. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-rtp-usage/"><cite>Web Real-Time Communication (WebRTC): Media Transport and Use of RTP</cite></a>. 16 December 2013. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-rtp-usage/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-rtp-usage/</a>
</dd><dt id="bib-RTCWEB-SECURITY-ARCH">[RTCWEB-SECURITY-ARCH]</dt><dd>Eric Rescorla. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-security-arch/"><cite>WebRTC Security Architecture</cite></a>. 22 January 2014. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-security-arch/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-security-arch/</a>
</dd><dt id="bib-RTCWEB-TRANSPORT">[RTCWEB-TRANSPORT]</dt><dd>H. Alvestrand. <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-transports/"><cite>Transports for RTCWEB</cite></a>. 22 January 2014. Active Internet-Draft. URL: <a property="dc:requires" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-transports/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-transports/</a>
</dd><dt id="bib-SDP">[SDP]</dt><dd>J. Rosenberg; H. Schulzrinne. <a property="dc:requires" href="https://tools.ietf.org/html/rfc3264"><cite>An Offer/Answer Model with Session Description Protocol (SDP)</cite></a>. June 2002. Proposed Standard. URL: <a property="dc:requires" href="https://tools.ietf.org/html/rfc3264">https://tools.ietf.org/html/rfc3264</a>
</dd><dt id="bib-TRAM-TURN-THIRD-PARTY-AUTHZ">[TRAM-TURN-THIRD-PARTY-AUTHZ]</dt><dd>T. Reddy; P. Patil; R. Ravindranath; J. Uberti. <a property="dc:requires" href="https://datatracker.ietf.org/doc/draft-ietf-tram-turn-third-party-authz/"><cite>Session Traversal Utilities for NAT (STUN) Extension for Third Party Authorization</cite></a>. 25 February 2015. Internet Draft (work in progress). URL: <a property="dc:requires" href="https://datatracker.ietf.org/doc/draft-ietf-tram-turn-third-party-authz/">https://datatracker.ietf.org/doc/draft-ietf-tram-turn-third-party-authz/</a>
</dd><dt id="bib-TSVWG-RTCWEB-QOS">[TSVWG-RTCWEB-QOS]</dt><dd>S. Dhesikan; C. Jennings; D. Druta; P. Jones; J. Polk. <a property="dc:requires" href="https://datatracker.ietf.org/doc/draft-ietf-tsvwg-rtcweb-qos"><cite>DSCP and other packet markings for RTCWeb QoS</cite></a>. 12 November 2014. Internet Draft (work in progress). URL: <a property="dc:requires" href="https://datatracker.ietf.org/doc/draft-ietf-tsvwg-rtcweb-qos">https://datatracker.ietf.org/doc/draft-ietf-tsvwg-rtcweb-qos</a>
</dd><dt id="bib-WEBIDL-1">[WEBIDL-1]</dt><dd>Cameron McCormack; Boris Zbarsky. <a property="dc:requires" href="http://www.w3.org/TR/WebIDL-1/"><cite>WebIDL Level 1</cite></a>. 4 August 2015. W3C Working Draft. URL: <a property="dc:requires" href="http://www.w3.org/TR/WebIDL-1/">http://www.w3.org/TR/WebIDL-1/</a>
</dd><dt id="bib-WEBWORKERS">[WEBWORKERS]</dt><dd>Ian Hickson. <a property="dc:requires" href="http://www.w3.org/TR/workers/"><cite>Web Workers</cite></a>. 24 September 2015. W3C Working Draft. URL: <a property="dc:requires" href="http://www.w3.org/TR/workers/">http://www.w3.org/TR/workers/</a>
</dd><dt id="bib-WebCryptoAPI">[WebCryptoAPI]</dt><dd>Ryan Sleevi; Mark Watson. <a property="dc:requires" href="http://www.w3.org/TR/WebCryptoAPI/"><cite>Web Cryptography API</cite></a>. 11 December 2014. W3C Candidate Recommendation. URL: <a property="dc:requires" href="http://www.w3.org/TR/WebCryptoAPI/">http://www.w3.org/TR/WebCryptoAPI/</a>
</dd><dt id="bib-X509V3">[X509V3]</dt><dd><cite>ITU-T Recommendation X.509 version 3 (1997). "Information Technology - Open Systems Interconnection - The Directory Authentication Framework"&nbsp; ISO/IEC 9594-8:1997</cite>.
</dd><dt id="bib-X690">[X690]</dt><dd><cite><a href="http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf">Recommendation X.690 â€” Information Technology â€” ASN.1 Encoding Rules â€” Specification of Basic Encoding Rules (BER), Canonical Encoding Rules (CER), and Distinguished Encoding Rules (DER)</a></cite>. International Telecommunication Union.
</dd><dt id="bib-webmessaging">[webmessaging]</dt><dd>Ian Hickson. <a property="dc:requires" href="http://www.w3.org/TR/webmessaging/"><cite>HTML5 Web Messaging</cite></a>. 19 May 2015. W3C Recommendation. URL: <a property="dc:requires" href="http://www.w3.org/TR/webmessaging/">http://www.w3.org/TR/webmessaging/</a>
</dd></dl></section><section property="bibo:hasPart" resource="#informative-references" typeof="bibo:Chapter" id="informative-references"><h3 resource="#h-informative-references" id="h-informative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B.2 </span>Informative references</span></h3><dl resource="" class="bibliography"><dt id="bib-IANA-RTP-2">[IANA-RTP-2]</dt><dd><a property="dc:references" href="http://www.iana.org/assignments/rtp-parameters/rtp-parameters.xhtml#rtp-parameters-2"><cite>RTP Payload Format media types</cite></a>. URL: <a property="dc:references" href="http://www.iana.org/assignments/rtp-parameters/rtp-parameters.xhtml#rtp-parameters-2">http://www.iana.org/assignments/rtp-parameters/rtp-parameters.xhtml#rtp-parameters-2</a>
</dd><dt id="bib-INDEXEDDB">[INDEXEDDB]</dt><dd>Nikunj Mehta; Jonas Sicking; Eliot Graff; Andrei Popescu; Jeremy Orlow; Joshua Bell. <a property="dc:references" href="http://www.w3.org/TR/IndexedDB/"><cite>Indexed Database API</cite></a>. 8 January 2015. W3C Recommendation. URL: <a property="dc:references" href="http://www.w3.org/TR/IndexedDB/">http://www.w3.org/TR/IndexedDB/</a>
</dd><dt id="bib-RFC1918">[RFC1918]</dt><dd>Y. Rekhter; B. Moskowitz; D. Karrenberg; G. J. de Groot; E. Lear. <a property="dc:references" href="https://tools.ietf.org/html/rfc1918"><cite>Address Allocation for Private Internets</cite></a>. February 1996. Best Current Practice. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc1918">https://tools.ietf.org/html/rfc1918</a>
</dd><dt id="bib-RFC3550">[RFC3550]</dt><dd>H. Schulzrinne; S. Casner; R. Frederick; V. Jacobson. <a property="dc:references" href="https://tools.ietf.org/html/rfc3550"><cite>RTP: A Transport Protocol for Real-Time Applications</cite></a>. July 2003. Internet Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc3550">https://tools.ietf.org/html/rfc3550</a>
</dd><dt id="bib-RFC3890">[RFC3890]</dt><dd>M. Westerlund. <a property="dc:references" href="https://tools.ietf.org/html/rfc3890"><cite>A Transport Independent Bandwidth Modifier for the Session Description Protocol (SDP)</cite></a>. September 2004. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc3890">https://tools.ietf.org/html/rfc3890</a>
</dd><dt id="bib-RFC5285">[RFC5285]</dt><dd>D. Singer; H. Desineni. <a property="dc:references" href="https://tools.ietf.org/html/rfc5285"><cite>A General Mechanism for RTP Header Extensions</cite></a>. July 2008. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc5285">https://tools.ietf.org/html/rfc5285</a>
</dd><dt id="bib-RFC5322">[RFC5322]</dt><dd>P. Resnick, Ed.. <a property="dc:references" href="https://tools.ietf.org/html/rfc5322"><cite>Internet Message Format</cite></a>. October 2008. Draft Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc5322">https://tools.ietf.org/html/rfc5322</a>
</dd><dt id="bib-RFC5506">[RFC5506]</dt><dd>I. Johansson; M. Westerlund. <a property="dc:references" href="https://tools.ietf.org/html/rfc5506"><cite>Support for Reduced-Size Real-Time Transport Control Protocol (RTCP): Opportunities and Consequences</cite></a>. April 2009. Proposed Standard. URL: <a property="dc:references" href="https://tools.ietf.org/html/rfc5506">https://tools.ietf.org/html/rfc5506</a>
</dd><dt id="bib-RTCWEB-IP-HANDLING">[RTCWEB-IP-HANDLING]</dt><dd>Guo-wei Shieh; Justin Uberti. <a property="dc:references" href="https://datatracker.ietf.org/doc/draft-shieh-rtcweb-ip-handling/"><cite>WebRTC IP Address Handling Recommendations</cite></a>. 19 October 2015. Active Internet-Draft. URL: <a property="dc:references" href="https://datatracker.ietf.org/doc/draft-shieh-rtcweb-ip-handling/">https://datatracker.ietf.org/doc/draft-shieh-rtcweb-ip-handling/</a>
</dd><dt id="bib-RTCWEB-OVERVIEW">[RTCWEB-OVERVIEW]</dt><dd>H. Alvestrand. <a property="dc:references" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-overview/"><cite>Overview: Real Time Protocols for Brower-based Applications</cite></a>. 14 February 2014. Active Internet-Draft. URL: <a property="dc:references" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-overview/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-overview/</a>
</dd><dt id="bib-RTCWEB-SECURITY">[RTCWEB-SECURITY]</dt><dd>Eric Rescorla. <a property="dc:references" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-security/"><cite>Security Considerations for WebRTC</cite></a>. 22 January 2014. Active Internet-Draft. URL: <a property="dc:references" href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-security/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-security/</a>
</dd><dt id="bib-TRICKLE-ICE">[TRICKLE-ICE]</dt><dd>E. Ivov; E. Rescorla; J. Uberti. <a property="dc:references" href="http://datatracker.ietf.org/doc/draft-ietf-mmusic-trickle-ice"><cite>Trickle ICE: Incremental Provisioning of Candidates for the Interactive Connectivity Establishment (ICE) Protocol</cite></a>. 7 February 2014. Internet Draft (work in progress). URL: <a property="dc:references" href="http://datatracker.ietf.org/doc/draft-ietf-mmusic-trickle-ice">http://datatracker.ietf.org/doc/draft-ietf-mmusic-trickle-ice</a>
</dd><dt id="bib-WEBSOCKETS-API">[WEBSOCKETS-API]</dt><dd>Ian Hickson. <a property="dc:references" href="http://www.w3.org/TR/websockets/"><cite>The WebSocket API</cite></a>. 20 September 2012. W3C Candidate Recommendation. URL: <a property="dc:references" href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>
</dd><dt id="bib-XMLHttpRequest">[XMLHttpRequest]</dt><dd>Anne van Kesteren; Julian Aubourg; Jungkee Song; Hallvord Steen et al. <a property="dc:references" href="http://www.w3.org/TR/XMLHttpRequest/"><cite>XMLHttpRequest Level 1</cite></a>. 30 January 2014. W3C Working Draft. URL: <a property="dc:references" href="http://www.w3.org/TR/XMLHttpRequest/">http://www.w3.org/TR/XMLHttpRequest/</a>
</dd></dl></section></section><p role="navigation" id="back-to-top"><a href="#toc"><abbr title="Back to Top">â†‘</abbr></a></p></body></html>