<p>{{APIRef(“Web Crypto API”)}}{{SecureContext_header}}</p>
<p>The <strong><code>unwrapKey()</code></strong> method of the {{domxref(“SubtleCrypto”)}} interface “unwraps” a key. This means that it takes as its input a key that has been exported and then encrypted (also called “wrapped”). It decrypts the key and then imports it, returning a {{domxref(“CryptoKey”)}} object that can be used in the <a href="/en-US/docs/Web/API/Web_Crypto_API">Web Crypto API</a>.</p>
<p>As with <a href="/en-US/docs/Web/API/SubtleCrypto/importKey"><code>SubtleCrypto.importKey()</code></a>, you specify the key’s <a href="/en-US/docs/Web/API/SubtleCrypto/importKey#supported_formats">import format</a> and other attributes of the key to import details such as whether it is extractable, and which operations it can be used for.</p>
<p>But because <code>unwrapKey()</code> also decrypts the key to be imported, you also need to pass in the key that must be used to decrypt it. This is sometimes called the “unwrapping key”.</p>
<p>The inverse of <code>unwrapKey()</code> is {{domxref(“SubtleCrypto.wrapKey()”)}}: while <code>unwrapKey</code> is composed of decrypt + import, <code>wrapKey</code> is composed of encrypt + export.</p>
<h2 id="syntax">Syntax</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> result <span class="op">=</span> <span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">unwrapKey</span>(</a>
<a class="sourceLine" id="cb1-2" title="2">    format<span class="op">,</span></a>
<a class="sourceLine" id="cb1-3" title="3">    wrappedKey<span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">    unwrappingKey<span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">    unwrapAlgo<span class="op">,</span></a>
<a class="sourceLine" id="cb1-6" title="6">    unwrappedKeyAlgo<span class="op">,</span></a>
<a class="sourceLine" id="cb1-7" title="7">    extractable<span class="op">,</span></a>
<a class="sourceLine" id="cb1-8" title="8">    keyUsages</a>
<a class="sourceLine" id="cb1-9" title="9">)<span class="op">;</span></a></code></pre></div>
<h3 id="parameters">Parameters</h3>
<ul>
<li><p><em><code>format</code></em> is a string describing the data format of the key to unwrap. It can be one of the following:</p>
<ul>
<li><code>raw</code>: <a href="/en-US/docs/Web/API/SubtleCrypto/importKey#raw">Raw</a> format.</li>
<li><code>pkcs8</code>: <a href="/en-US/docs/Web/API/SubtleCrypto/importKey#pkcs_8">PKCS #8</a> format.</li>
<li><code>spki</code>: <a href="/en-US/docs/Web/API/SubtleCrypto/importKey#subjectpublickeyinfo">SubjectPublicKeyInfo</a> format.</li>
<li><code>jwk</code>: <a href="/en-US/docs/Web/API/SubtleCrypto/importKey#json_web_key">JSON Web Key</a> format.</li>
</ul></li>
<li><code>wrappedKey</code> is an {{jsxref(“ArrayBuffer”)}} containing the wrapped key in the given format.</li>
<li><code>unwrappingKey</code> is the {{domxref(“CryptoKey”)}} to use to decrypt the wrapped key. The key must have the <code>unwrapKey</code> usage set.</li>
<li><p><code>unwrapAlgo</code> is an object specifying the <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#supported_algorithms">algorithm</a> to be used to encrypt the exported key, and any extra parameters as required:</p>
<ul>
<li>To use <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#rsa-oaep">RSA-OAEP</a>, pass an <a href="/en-US/docs/Web/API/RsaOaepParams" title="This dictionary represents the object that should be passed as the algorithm parameter into SubtleCrypto.encrypt(), SubtleCrypto.decrypt(), SubtleCrypto.wrapKey(), or SubtleCrypto.unwrapKey(), when using the RSA_OAEP algorithm."><code>RsaOaepParams</code></a> object.</li>
<li>To use <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-ctr">AES-CTR</a>, pass an <a href="/en-US/docs/Web/API/AesCtrParams" title="This dictionary represents the object that should be passed as the algorithm parameter into SubtleCrypto.encrypt(), SubtleCrypto.decrypt(), SubtleCrypto.wrapKey(), or SubtleCrypto.unwrapKey(), when using the AES-CTR algorithm."><code>AesCtrParams</code></a> object.</li>
<li>To use <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-cbc">AES-CBC</a>, pass an <a href="/en-US/docs/Web/API/AesCbcParams" title="This dictionary represents the object that should be passed as the algorithm parameter into SubtleCrypto.encrypt(), SubtleCrypto.decrypt(), SubtleCrypto.wrapKey(), or SubtleCrypto.unwrapKey(), when using the AES-CBC algorithm."><code>AesCbcParams</code></a> object.</li>
<li>To use <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-gcm">AES-GCM</a>, pass an <a href="/en-US/docs/Web/API/AesGcmParams" title="This dictionary represents the object that should be passed as the algorithm parameter into SubtleCrypto.encrypt(), SubtleCrypto.decrypt(), SubtleCrypto.wrapKey(), or SubtleCrypto.unwrapKey(), when using the AES-GCM algorithm."><code>AesGcmParams</code></a> object.</li>
<li>To use <a href="/en-US/docs/Web/API/SubtleCrypto/wrapKey#aes-kw">AES-KW</a>, pass the string <code>"AES-KW"</code> or an object of the form <code>{ "name": "AES-KW }</code>.</li>
</ul></li>
<li><p><code>unwrappedKeyAlgo</code> is a dictionary object defining the type of key to unwrap and providing extra algorithm-specific parameters as required.</p>
<ul>
<li>For <a href="/en-US/docs/Web/API/SubtleCrypto/sign#rsassa-pkcs1-v1_5">RSASSA-PKCS1-v1_5</a>, <a href="/en-US/docs/Web/API/SubtleCrypto/sign#rsa-pss">RSA-PSS</a>, or <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#rsa-oaep">RSA-OAEP</a>: Pass an <a href="/en-US/docs/Web/API/RsaHashedImportParams"><code>RsaHashedImportParams</code></a> object.</li>
<li>For <a href="/en-US/docs/Web/API/SubtleCrypto/sign#ecdsa">ECDSA</a> or <a href="/en-US/docs/Web/API/SubtleCrypto/deriveKey#ecdh">ECDH</a>: Pass an <a href="/en-US/docs/Web/API/EcKeyImportParams"><code>EcKeyImportParams</code></a> object.</li>
<li>For <a href="/en-US/docs/Web/API/SubtleCrypto/sign#hmac">HMAC</a>: Pass an <a href="/en-US/docs/Web/API/HmacImportParams"><code>HmacImportParams</code></a> object.</li>
<li>For <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-ctr">AES-CTR</a>, <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-cbc">AES-CBC</a>, <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-gcm">AES-GCM</a>, or <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt#aes-kw">AES-KW</a>: Pass the string identifying the algorithm or an object of the form <code>{ "name": ALGORITHM }</code>, where <code>ALGORITHM</code> is the name of the algorithm.</li>
</ul></li>
<li><code>extractable</code> is a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean" title="The Boolean object is an object wrapper for a boolean value."><code>Boolean</code></a> indicating whether it will be possible to export  the key using <a href="/en-US/docs/Web/API/SubtleCrypto/exportKey" title="The SubtleCrypto.exportKey() method exports a key: that is, it takes as input a CryptoKey object and gives you the key in an external, portable format."><code>SubtleCrypto.exportKey()</code></a> or <a href="/en-US/docs/Web/API/SubtleCrypto/wrapKey" title="The SubtleCrypto.wrapKey() method &quot;wraps&quot; a key. This means that it exports the key in an external, portable format, then encrypts the exported key. Wrapping a key helps protect it in untrusted environments, such as an otherwise unprotected data store or in transmission over an unprotected network."><code>SubtleCrypto.wrapKey()</code></a>.</li>
<li><p><code>keyUsages</code> is an <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array" title="The JavaScript Array object is a global object that is used in the construction of arrays; which are high-level, list-like objects."><code>Array</code></a> indicating what can be done with the key. Possible values of the array are:</p>
<ul>
<li><code>encrypt</code>: The key may be used to <a href="/en-US/docs/Web/API/SubtleCrypto/encrypt" title="The SubtleCrypto.encrypt() method encrypts data."><code>encrypt</code></a> messages.</li>
<li><code>decrypt</code>: The key may be used to <a href="/en-US/docs/Web/API/SubtleCrypto/decrypt" title="The SubtleCrypto.decrypt() method decrypts some encrypted data. It takes as arguments a key to decrypt with, some optional extra parameters, and the data to decrypt (also known as ciphertext). It returns a Promise which will be resolved with the decrypted data (also known as &quot;plaintext&quot;)."><code>decrypt</code></a> messages.</li>
<li><code>sign</code>: The key may be used to <a href="/en-US/docs/Web/API/SubtleCrypto/sign" title="The SubtleCrypto.sign() method generates a digital signature."><code>sign</code></a> messages.</li>
<li><code>verify</code>: The key may be used to <a href="/en-US/docs/Web/API/SubtleCrypto/verify" title="The SubtleCrypto.verify() method verifies a digital signature."><code>verify</code></a> signatures.</li>
<li><code>deriveKey</code>: The key may be used in <a href="/en-US/docs/Web/API/SubtleCrypto/deriveKey" title="The SubtleCrypto.deriveKey() method can be used to derive a secret key from a master key."><code>deriving a new key</code></a>.</li>
<li><code>deriveBits</code>: The key may be used in <a href="/en-US/docs/Web/API/SubtleCrypto/deriveBits" title="The SubtleCrypto.deriveBits() method can be used to derive a collection of bits from a base key."><code>deriving bits</code></a>.</li>
<li><code>wrapKey</code>: The key may be used to <a href="/en-US/docs/Web/API/SubtleCrypto/wrapKey" title="The SubtleCrypto.wrapKey() method &quot;wraps&quot; a key. This means that it exports the key in an external, portable format, then encrypts the exported key. Wrapping a key helps protect it in untrusted environments, such as an otherwise unprotected data store or in transmission over an unprotected network."><code>wrap a key</code></a>.</li>
<li><code>unwrapKey</code>: The key may be used to unwrap a key.</li>
</ul></li>
</ul>
<h3 id="return-value">Return value</h3>
<ul>
<li><code>result</code> is a <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise" title="The Promise object represents the eventual completion (or failure) of an asynchronous operation, and its resulting value."><code>Promise</code></a> that fulfills with the unwrapped key as a <a href="/en-US/docs/Web/API/CryptoKey" title="The CryptoKey interface represents a cryptographic key derived from a specific key algorithm."><code>CryptoKey</code></a> object.</li>
</ul>
<h3 id="exceptions">Exceptions</h3>
<p>The promise is rejected when one of the following exceptions is encountered:</p>
<ul>
<li>{{exception(“InvalidAccessError”)}}
<ul>
<li>: Raised when the unwrapping key is not a key for the requested unwrap algorithm or if the <code>keyUsages</code> value of that key doesn’t contain <code>unwrap</code>.</li>
</ul></li>
<li>{{exception(“NotSupported”)}}
<ul>
<li>: Raised when trying to use an algorithm that is either unknown or isn’t suitable for encryption or wrapping.</li>
</ul></li>
<li>{{exception(“SyntaxError”)}}
<ul>
<li>: Raised when <em><code>keyUsages</code></em> is empty but the unwrapped key is of type <code>secret</code> or <code>private</code>.</li>
</ul></li>
<li>{{jsxref(“TypeError”)}}
<ul>
<li>: Raised when trying to use an invalid format.</li>
</ul></li>
</ul>
<h2 id="supported-algorithms">Supported algorithms</h2>
<p>The <code>unwrapKey()</code> method supports the same algorithms as the <a href="/en-US/docs/Web/API/SubtleCrypto/wrapKey#supported_algorithms"><code>wrapKey()</code></a> method.</p>
<h2 id="examples">Examples</h2>
<blockquote>
<p><strong>Note:</strong> You can <a href="https://mdn.github.io/dom-examples/web-crypto/unwrap-key/index.html">try the working examples</a> on Github.</p>
</blockquote>
<h3 id="unwrapping-a-raw-key">Unwrapping a “raw” key</h3>
<p>In this example we unwrap an AES-GCM symmetric key. The key was exported in “raw” format and encrypted using the AES-KW algorithm, with a key derived from a password.</p>
<p>To unwrap, we ask the user for the password and use PBKDF2 and some salt to derive the AES-KW unwrapping key. The salt needs to be the same as the salt that was used to derive the original AES-KW key wrapping key.</p>
<p>Once we have the unwrapping key we pass it into <code>unwrapKey()</code> with the wrapped key and other parameters. <a href="https://github.com/mdn/dom-examples/blob/master/web-crypto/unwrap-key/raw.js">See the complete code on GitHub.</a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">/*</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">Salt that is to be used in derivation of the key-wrapping key,</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">alongside the password the user supplies.</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">This must match the salt value that was originally used to derive</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">the key.</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">*/</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw">const</span> saltBytes <span class="op">=</span> [<span class="dv">89</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">135</span><span class="op">,</span><span class="dv">234</span><span class="op">,</span><span class="dv">168</span><span class="op">,</span><span class="dv">204</span><span class="op">,</span><span class="dv">21</span><span class="op">,</span><span class="dv">36</span><span class="op">,</span><span class="dv">55</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">132</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">156</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">/*</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">The wrapped key itself.</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">*/</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="kw">const</span> wrappedKeyBytes <span class="op">=</span> [<span class="dv">171</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">36</span><span class="op">,</span><span class="dv">201</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">120</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">217</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">226</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="dv">224</span><span class="op">,</span><span class="dv">39</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">235</span><span class="op">,</span><span class="dv">239</span><span class="op">,</span><span class="dv">60</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">100</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">61</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">244</span><span class="op">,</span><span class="dv">197</span><span class="op">,</span><span class="dv">160</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">230</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="dv">225</span><span class="op">,</span><span class="dv">57</span><span class="op">,</span><span class="dv">197</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">71</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">209</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">/*</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">Convert an array of byte values to an ArrayBuffer.</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">*/</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="kw">function</span> <span class="at">bytesToArrayBuffer</span>(bytes) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-20" title="20">  <span class="kw">const</span> bytesAsArrayBuffer <span class="op">=</span> <span class="kw">new</span> <span class="at">ArrayBuffer</span>(<span class="va">bytes</span>.<span class="at">length</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="kw">const</span> bytesUint8 <span class="op">=</span> <span class="kw">new</span> <span class="at">Uint8Array</span>(bytesAsArrayBuffer)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-22" title="22">  <span class="va">bytesUint8</span>.<span class="at">set</span>(bytes)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-23" title="23">  <span class="cf">return</span> bytesAsArrayBuffer<span class="op">;</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-25" title="25"></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">/*</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">Get some key material to use as input to the deriveKey method.</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">The key material is a password supplied by the user.</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co">*/</span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="kw">function</span> <span class="at">getKeyMaterial</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb2-31" title="31">  <span class="kw">let</span> password <span class="op">=</span> <span class="va">window</span>.<span class="at">prompt</span>(<span class="st">&quot;Enter your password&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-32" title="32">  <span class="kw">let</span> enc <span class="op">=</span> <span class="kw">new</span> <span class="at">TextEncoder</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-33" title="33">  <span class="cf">return</span> <span class="va">window</span>.<span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">importKey</span>(</a>
<a class="sourceLine" id="cb2-34" title="34">    <span class="st">&quot;raw&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-35" title="35">    <span class="va">enc</span>.<span class="at">encode</span>(password)<span class="op">,</span></a>
<a class="sourceLine" id="cb2-36" title="36">    <span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&quot;PBKDF2&quot;</span><span class="op">},</span></a>
<a class="sourceLine" id="cb2-37" title="37">    <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-38" title="38">    [<span class="st">&quot;deriveBits&quot;</span><span class="op">,</span> <span class="st">&quot;deriveKey&quot;</span>]</a>
<a class="sourceLine" id="cb2-39" title="39">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb2-40" title="40"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-41" title="41"></a>
<a class="sourceLine" id="cb2-42" title="42"><span class="co">/*</span></a>
<a class="sourceLine" id="cb2-43" title="43"><span class="co">Derive an AES-KW key using PBKDF2.</span></a>
<a class="sourceLine" id="cb2-44" title="44"><span class="co">*/</span></a>
<a class="sourceLine" id="cb2-45" title="45"><span class="kw">async</span> <span class="kw">function</span> <span class="at">getUnwrappingKey</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb2-46" title="46">  <span class="co">// 1. get the key material (user-supplied password)</span></a>
<a class="sourceLine" id="cb2-47" title="47">  <span class="kw">const</span> keyMaterial <span class="op">=</span> <span class="cf">await</span> <span class="at">getKeyMaterial</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-48" title="48">  <span class="co">// 2 initialize the salt parameter.</span></a>
<a class="sourceLine" id="cb2-49" title="49">  <span class="co">// The salt must match the salt originally used to derive the key.</span></a>
<a class="sourceLine" id="cb2-50" title="50">  <span class="co">// In this example it&#39;s supplied as a constant &quot;saltBytes&quot;.</span></a>
<a class="sourceLine" id="cb2-51" title="51">  <span class="kw">const</span> saltBuffer <span class="op">=</span> <span class="at">bytesToArrayBuffer</span>(saltBytes)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-52" title="52">  <span class="co">// 3 derive the key from key material and salt</span></a>
<a class="sourceLine" id="cb2-53" title="53">  <span class="cf">return</span> <span class="va">window</span>.<span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">deriveKey</span>(</a>
<a class="sourceLine" id="cb2-54" title="54">    <span class="op">{</span></a>
<a class="sourceLine" id="cb2-55" title="55">      <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;PBKDF2&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-56" title="56">      <span class="dt">salt</span><span class="op">:</span> saltBuffer<span class="op">,</span></a>
<a class="sourceLine" id="cb2-57" title="57">      <span class="st">&quot;iterations&quot;</span><span class="op">:</span> <span class="dv">100000</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-58" title="58">      <span class="st">&quot;hash&quot;</span><span class="op">:</span> <span class="st">&quot;SHA-256&quot;</span></a>
<a class="sourceLine" id="cb2-59" title="59">    <span class="op">},</span></a>
<a class="sourceLine" id="cb2-60" title="60">    keyMaterial<span class="op">,</span></a>
<a class="sourceLine" id="cb2-61" title="61">    <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;AES-KW&quot;</span><span class="op">,</span> <span class="st">&quot;length&quot;</span><span class="op">:</span> <span class="dv">256</span><span class="op">},</span></a>
<a class="sourceLine" id="cb2-62" title="62">    <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-63" title="63">    [ <span class="st">&quot;wrapKey&quot;</span><span class="op">,</span> <span class="st">&quot;unwrapKey&quot;</span> ]</a>
<a class="sourceLine" id="cb2-64" title="64">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb2-65" title="65"><span class="op">}</span></a>
<a class="sourceLine" id="cb2-66" title="66"></a>
<a class="sourceLine" id="cb2-67" title="67"><span class="co">/*</span></a>
<a class="sourceLine" id="cb2-68" title="68"><span class="co">Unwrap an AES secret key from an ArrayBuffer containing the raw bytes.</span></a>
<a class="sourceLine" id="cb2-69" title="69"><span class="co">Takes an array containing the bytes, and returns a Promise</span></a>
<a class="sourceLine" id="cb2-70" title="70"><span class="co">that will resolve to a CryptoKey representing the secret key.</span></a>
<a class="sourceLine" id="cb2-71" title="71"><span class="co">*/</span></a>
<a class="sourceLine" id="cb2-72" title="72"><span class="kw">async</span> <span class="kw">function</span> <span class="at">unwrapSecretKey</span>(wrappedKey) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-73" title="73">  <span class="co">// 1. get the unwrapping key</span></a>
<a class="sourceLine" id="cb2-74" title="74">  <span class="kw">const</span> unwrappingKey <span class="op">=</span> <span class="cf">await</span> <span class="at">getUnwrappingKey</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-75" title="75">  <span class="co">// 2. initialize the wrapped key</span></a>
<a class="sourceLine" id="cb2-76" title="76">  <span class="kw">const</span> wrappedKeyBuffer <span class="op">=</span> <span class="at">bytesToArrayBuffer</span>(wrappedKey)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-77" title="77">  <span class="co">// 3. unwrap the key</span></a>
<a class="sourceLine" id="cb2-78" title="78">  <span class="cf">return</span> <span class="va">window</span>.<span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">unwrapKey</span>(</a>
<a class="sourceLine" id="cb2-79" title="79">    <span class="st">&quot;raw&quot;</span><span class="op">,</span>                 <span class="co">// import format</span></a>
<a class="sourceLine" id="cb2-80" title="80">    wrappedKeyBuffer<span class="op">,</span>      <span class="co">// ArrayBuffer representing key to unwrap</span></a>
<a class="sourceLine" id="cb2-81" title="81">    unwrappingKey<span class="op">,</span>         <span class="co">// CryptoKey representing key encryption key</span></a>
<a class="sourceLine" id="cb2-82" title="82">    <span class="st">&quot;AES-KW&quot;</span><span class="op">,</span>              <span class="co">// algorithm identifier for key encryption key</span></a>
<a class="sourceLine" id="cb2-83" title="83">    <span class="st">&quot;AES-GCM&quot;</span><span class="op">,</span>             <span class="co">// algorithm identifier for key to unwrap</span></a>
<a class="sourceLine" id="cb2-84" title="84">    <span class="kw">true</span><span class="op">,</span>                  <span class="co">// extractability of key to unwrap</span></a>
<a class="sourceLine" id="cb2-85" title="85">    [<span class="st">&quot;encrypt&quot;</span><span class="op">,</span> <span class="st">&quot;decrypt&quot;</span>] <span class="co">// key usages for key to unwrap</span></a>
<a class="sourceLine" id="cb2-86" title="86">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb2-87" title="87"><span class="op">}</span></a></code></pre></div>
<h3 id="unwrapping-a-pkcs8-key">Unwrapping a “pkcs8” key</h3>
<p>In this example we unwrap an RSA-PSS private signing key. The key was exported in “pkcs8” format and encrypted using the AES-GCM algorithm, with a key derived from a password.</p>
<p>To unwrap, we ask the user for the password and use PBKDF2 and some salt to derive the AES-GCM unwrapping key. The salt needs to be the same as the salt that was used to derive the original AES-GCM key wrapping key.</p>
<p>Once we have the unwrapping key we pass it into <code>unwrapKey()</code> with the wrapped key and other parameters. Note that when using AES-GCM we have to pass the iv value into <code>unwrapKey()</code>, and this must be the same as the iv that was used in the corresponding <code>wrapKey()</code> operation. <a href="https://github.com/mdn/dom-examples/blob/master/web-crypto/unwrap-key/pkcs8.js">See the complete code on GitHub.</a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">Salt that is to be used in derivation of the key-wrapping key,</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">alongside the password the user supplies.</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">This must match the salt value that was originally used to derive</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">the key.</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">const</span> saltBytes <span class="op">=</span> [<span class="dv">180</span><span class="op">,</span><span class="dv">253</span><span class="op">,</span><span class="dv">62</span><span class="op">,</span><span class="dv">216</span><span class="op">,</span><span class="dv">47</span><span class="op">,</span><span class="dv">35</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">55</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">103</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">161</span><span class="op">,</span><span class="dv">177</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">IV that is to be used in decrypting the key to unwrap.</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">This must the same IV that was originally used to encrypt</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">the key.</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="kw">const</span> ivBytes <span class="op">=</span> [<span class="dv">212</span><span class="op">,</span><span class="dv">187</span><span class="op">,</span><span class="dv">26</span><span class="op">,</span><span class="dv">247</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">51</span><span class="op">,</span><span class="dv">37</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">27</span><span class="op">,</span><span class="dv">177</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">142</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">The wrapped key itself.</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="kw">const</span> wrappedKeyBytes <span class="op">=</span> [<span class="dv">6</span><span class="op">,</span><span class="dv">155</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">208</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">141</span><span class="op">,</span><span class="dv">44</span><span class="op">,</span><span class="dv">18</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">126</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">100</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-20" title="20">  <span class="dv">225</span><span class="op">,</span><span class="dv">241</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">201</span><span class="op">,</span><span class="dv">153</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">174</span><span class="op">,</span><span class="dv">150</span><span class="op">,</span><span class="dv">29</span><span class="op">,</span><span class="dv">62</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span><span class="dv">106</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">108</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-21" title="21">  <span class="dv">148</span><span class="op">,</span><span class="dv">104</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span><span class="dv">22</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span><span class="dv">146</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">65</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">140</span><span class="op">,</span><span class="dv">79</span><span class="op">,</span><span class="dv">194</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span><span class="dv">163</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">250</span><span class="op">,</span><span class="dv">108</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-22" title="22">  <span class="dv">11</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">220</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span><span class="dv">194</span><span class="op">,</span><span class="dv">161</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">57</span><span class="op">,</span><span class="dv">121</span><span class="op">,</span><span class="dv">70</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">28</span><span class="op">,</span><span class="dv">220</span><span class="op">,</span><span class="dv">210</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span><span class="dv">32</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">217</span><span class="op">,</span><span class="dv">36</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">220</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-23" title="23">  <span class="dv">170</span><span class="op">,</span><span class="dv">244</span><span class="op">,</span><span class="dv">152</span><span class="op">,</span><span class="dv">214</span><span class="op">,</span><span class="dv">150</span><span class="op">,</span><span class="dv">83</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span><span class="dv">128</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">227</span><span class="op">,</span><span class="dv">213</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">100</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">162</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-24" title="24">  <span class="dv">60</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">77</span><span class="op">,</span><span class="dv">37</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">213</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">67</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">73</span><span class="op">,</span><span class="dv">231</span><span class="op">,</span><span class="dv">31</span><span class="op">,</span><span class="dv">63</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">176</span><span class="op">,</span><span class="dv">103</span><span class="op">,</span><span class="dv">206</span><span class="op">,</span><span class="dv">187</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-25" title="25">  <span class="dv">214</span><span class="op">,</span><span class="dv">250</span><span class="op">,</span><span class="dv">49</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span><span class="dv">185</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">48</span><span class="op">,</span><span class="dv">241</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">253</span><span class="op">,</span><span class="dv">59</span><span class="op">,</span><span class="dv">185</span><span class="op">,</span><span class="dv">181</span><span class="op">,</span><span class="dv">209</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-26" title="26">  <span class="dv">174</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">205</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">120</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">135</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">226</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">119</span><span class="op">,</span><span class="dv">27</span><span class="op">,</span><span class="dv">97</span><span class="op">,</span><span class="dv">183</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">197</span><span class="op">,</span><span class="dv">227</span><span class="op">,</span><span class="dv">85</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-27" title="27">  <span class="dv">235</span><span class="op">,</span><span class="dv">79</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">167</span><span class="op">,</span><span class="dv">59</span><span class="op">,</span><span class="dv">62</span><span class="op">,</span><span class="dv">194</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">210</span><span class="op">,</span><span class="dv">214</span><span class="op">,</span><span class="dv">240</span><span class="op">,</span><span class="dv">215</span><span class="op">,</span><span class="dv">101</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">63</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span><span class="dv">53</span><span class="op">,</span><span class="dv">87</span><span class="op">,</span><span class="dv">253</span><span class="op">,</span><span class="dv">189</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-28" title="28">  <span class="dv">27</span><span class="op">,</span><span class="dv">66</span><span class="op">,</span><span class="dv">150</span><span class="op">,</span><span class="dv">76</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">76</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">174</span><span class="op">,</span><span class="dv">179</span><span class="op">,</span><span class="dv">163</span><span class="op">,</span><span class="dv">184</span><span class="op">,</span><span class="dv">205</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">161</span><span class="op">,</span><span class="dv">224</span><span class="op">,</span><span class="dv">19</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-29" title="29">  <span class="dv">101</span><span class="op">,</span><span class="dv">117</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">86</span><span class="op">,</span><span class="dv">66</span><span class="op">,</span><span class="dv">56</span><span class="op">,</span><span class="dv">241</span><span class="op">,</span><span class="dv">128</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">125</span><span class="op">,</span><span class="dv">139</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">108</span><span class="op">,</span><span class="dv">129</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">137</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-30" title="30">  <span class="dv">26</span><span class="op">,</span><span class="dv">186</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">117</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span><span class="dv">179</span><span class="op">,</span><span class="dv">59</span><span class="op">,</span><span class="dv">213</span><span class="op">,</span><span class="dv">18</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">203</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">97</span><span class="op">,</span><span class="dv">131</span><span class="op">,</span><span class="dv">125</span><span class="op">,</span><span class="dv">167</span><span class="op">,</span><span class="dv">227</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-31" title="31">  <span class="dv">182</span><span class="op">,</span><span class="dv">87</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">123</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">60</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">224</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">126</span><span class="op">,</span><span class="dv">245</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">247</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">173</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-32" title="32">  <span class="dv">82</span><span class="op">,</span><span class="dv">106</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">210</span><span class="op">,</span><span class="dv">55</span><span class="op">,</span><span class="dv">71</span><span class="op">,</span><span class="dv">127</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">41</span><span class="op">,</span><span class="dv">37</span><span class="op">,</span><span class="dv">181</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">106</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">220</span><span class="op">,</span><span class="dv">136</span><span class="op">,</span><span class="dv">43</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-33" title="33">  <span class="dv">240</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">116</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">44</span><span class="op">,</span><span class="dv">254</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">32</span><span class="op">,</span><span class="dv">74</span><span class="op">,</span><span class="dv">226</span><span class="op">,</span><span class="dv">193</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">48</span><span class="op">,</span><span class="dv">211</span><span class="op">,</span><span class="dv">71</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">163</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">30</span><span class="op">,</span><span class="dv">92</span><span class="op">,</span><span class="dv">28</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-34" title="34">  <span class="dv">30</span><span class="op">,</span><span class="dv">183</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">176</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span><span class="dv">77</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">139</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">114</span><span class="op">,</span><span class="dv">91</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">126</span><span class="op">,</span><span class="dv">123</span><span class="op">,</span><span class="dv">234</span><span class="op">,</span><span class="dv">18</span><span class="op">,</span><span class="dv">9</span><span class="op">,</span><span class="dv">245</span><span class="op">,</span><span class="dv">53</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-35" title="35">  <span class="dv">172</span><span class="op">,</span><span class="dv">215</span><span class="op">,</span><span class="dv">62</span><span class="op">,</span><span class="dv">92</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">191</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">27</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">33</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">177</span><span class="op">,</span><span class="dv">253</span><span class="op">,</span><span class="dv">152</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">196</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-36" title="36">  <span class="dv">226</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">202</span><span class="op">,</span><span class="dv">166</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">250</span><span class="op">,</span><span class="dv">127</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span><span class="dv">196</span><span class="op">,</span><span class="dv">121</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">235</span><span class="op">,</span><span class="dv">30</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">95</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">107</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-37" title="37">  <span class="dv">175</span><span class="op">,</span><span class="dv">137</span><span class="op">,</span><span class="dv">177</span><span class="op">,</span><span class="dv">49</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">63</span><span class="op">,</span><span class="dv">131</span><span class="op">,</span><span class="dv">162</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">186</span><span class="op">,</span><span class="dv">22</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">230</span><span class="op">,</span><span class="dv">237</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">56</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">177</span><span class="op">,</span><span class="dv">101</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-38" title="38">  <span class="dv">227</span><span class="op">,</span><span class="dv">125</span><span class="op">,</span><span class="dv">32</span><span class="op">,</span><span class="dv">180</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">47</span><span class="op">,</span><span class="dv">92</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">148</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">107</span><span class="op">,</span><span class="dv">125</span><span class="op">,</span><span class="dv">137</span><span class="op">,</span><span class="dv">123</span><span class="op">,</span><span class="dv">15</span><span class="op">,</span><span class="dv">51</span><span class="op">,</span><span class="dv">107</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">228</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-39" title="39">  <span class="dv">238</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">60</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">184</span><span class="op">,</span><span class="dv">48</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span><span class="dv">208</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">149</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">201</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">193</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-40" title="40">  <span class="dv">156</span><span class="op">,</span><span class="dv">227</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">61</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span><span class="dv">124</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span><span class="dv">98</span><span class="op">,</span><span class="dv">79</span><span class="op">,</span><span class="dv">37</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">139</span><span class="op">,</span><span class="dv">162</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">183</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-41" title="41">  <span class="dv">235</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">18</span><span class="op">,</span><span class="dv">84</span><span class="op">,</span><span class="dv">160</span><span class="op">,</span><span class="dv">120</span><span class="op">,</span><span class="dv">173</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">187</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">213</span><span class="op">,</span><span class="dv">148</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">193</span><span class="op">,</span><span class="dv">111</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-42" title="42">  <span class="dv">10</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span><span class="dv">148</span><span class="op">,</span><span class="dv">84</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">19</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">74</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">244</span><span class="op">,</span><span class="dv">123</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-43" title="43">  <span class="dv">175</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">166</span><span class="op">,</span><span class="dv">101</span><span class="op">,</span><span class="dv">51</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">141</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">87</span><span class="op">,</span><span class="dv">9</span><span class="op">,</span><span class="dv">146</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">22</span><span class="op">,</span><span class="dv">125</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">15</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-44" title="44">  <span class="dv">99</span><span class="op">,</span><span class="dv">26</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">26</span><span class="op">,</span><span class="dv">236</span><span class="op">,</span><span class="dv">44</span><span class="op">,</span><span class="dv">86</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">162</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">15</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">15</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-45" title="45">  <span class="dv">205</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">19</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">183</span><span class="op">,</span><span class="dv">33</span><span class="op">,</span><span class="dv">183</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">117</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">27</span><span class="op">,</span><span class="dv">43</span><span class="op">,</span><span class="dv">254</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-46" title="46">  <span class="dv">137</span><span class="op">,</span><span class="dv">154</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span><span class="dv">77</span><span class="op">,</span><span class="dv">85</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">85</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">200</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span><span class="dv">76</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">43</span><span class="op">,</span><span class="dv">124</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">191</span><span class="op">,</span><span class="dv">150</span><span class="op">,</span><span class="dv">70</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">178</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-47" title="47">  <span class="dv">198</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">225</span><span class="op">,</span><span class="dv">146</span><span class="op">,</span><span class="dv">231</span><span class="op">,</span><span class="dv">209</span><span class="op">,</span><span class="dv">254</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">216</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">97</span><span class="op">,</span><span class="dv">105</span><span class="op">,</span><span class="dv">204</span><span class="op">,</span><span class="dv">82</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">92</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-48" title="48">  <span class="dv">159</span><span class="op">,</span><span class="dv">116</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span><span class="dv">148</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">197</span><span class="op">,</span><span class="dv">211</span><span class="op">,</span><span class="dv">187</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">98</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span><span class="dv">201</span><span class="op">,</span><span class="dv">154</span><span class="op">,</span><span class="dv">184</span><span class="op">,</span><span class="dv">65</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">47</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-49" title="49">  <span class="dv">13</span><span class="op">,</span><span class="dv">106</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">168</span><span class="op">,</span><span class="dv">208</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">74</span><span class="op">,</span><span class="dv">204</span><span class="op">,</span><span class="dv">36</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span><span class="dv">98</span><span class="op">,</span><span class="dv">104</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">103</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">194</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">26</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">101</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-50" title="50">  <span class="dv">60</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">215</span><span class="op">,</span><span class="dv">20</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">176</span><span class="op">,</span><span class="dv">63</span><span class="op">,</span><span class="dv">28</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">121</span><span class="op">,</span><span class="dv">190</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">228</span><span class="op">,</span><span class="dv">196</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span><span class="dv">38</span><span class="op">,</span><span class="dv">82</span><span class="op">,</span><span class="dv">37</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-51" title="51">  <span class="dv">248</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">150</span><span class="op">,</span><span class="dv">115</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">22</span><span class="op">,</span><span class="dv">101</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">237</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">69</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">231</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">193</span><span class="op">,</span><span class="dv">70</span><span class="op">,</span><span class="dv">211</span><span class="op">,</span><span class="dv">245</span><span class="op">,</span><span class="dv">106</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-52" title="52">  <span class="dv">231</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">150</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">105</span><span class="op">,</span><span class="dv">170</span><span class="op">,</span><span class="dv">139</span><span class="op">,</span><span class="dv">238</span><span class="op">,</span><span class="dv">196</span><span class="op">,</span><span class="dv">64</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">250</span><span class="op">,</span><span class="dv">47</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">22</span><span class="op">,</span><span class="dv">36</span><span class="op">,</span><span class="dv">196</span><span class="op">,</span><span class="dv">161</span><span class="op">,</span><span class="dv">30</span><span class="op">,</span><span class="dv">79</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-53" title="53">  <span class="dv">175</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">129</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">56</span><span class="op">,</span><span class="dv">140</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">168</span><span class="op">,</span><span class="dv">134</span><span class="op">,</span><span class="dv">91</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">134</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-54" title="54">  <span class="dv">249</span><span class="op">,</span><span class="dv">215</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">250</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">70</span><span class="op">,</span><span class="dv">59</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">84</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">206</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">130</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">66</span><span class="op">,</span><span class="dv">210</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-55" title="55">  <span class="dv">82</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span><span class="dv">53</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">84</span><span class="op">,</span><span class="dv">59</span><span class="op">,</span><span class="dv">226</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">154</span><span class="op">,</span><span class="dv">15</span><span class="op">,</span><span class="dv">20</span><span class="op">,</span><span class="dv">163</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">228</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">53</span><span class="op">,</span><span class="dv">214</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">237</span><span class="op">,</span><span class="dv">10</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-56" title="56">  <span class="dv">107</span><span class="op">,</span><span class="dv">180</span><span class="op">,</span><span class="dv">123</span><span class="op">,</span><span class="dv">174</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">240</span><span class="op">,</span><span class="dv">115</span><span class="op">,</span><span class="dv">115</span><span class="op">,</span><span class="dv">220</span><span class="op">,</span><span class="dv">131</span><span class="op">,</span><span class="dv">128</span><span class="op">,</span><span class="dv">79</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">61</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">98</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-57" title="57">  <span class="dv">193</span><span class="op">,</span><span class="dv">225</span><span class="op">,</span><span class="dv">56</span><span class="op">,</span><span class="dv">36</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">254</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">49</span><span class="op">,</span><span class="dv">44</span><span class="op">,</span><span class="dv">160</span><span class="op">,</span><span class="dv">28</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span><span class="dv">140</span><span class="op">,</span><span class="dv">163</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">114</span><span class="op">,</span><span class="dv">31</span><span class="op">,</span><span class="dv">237</span><span class="op">,</span><span class="dv">235</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-58" title="58">  <span class="dv">250</span><span class="op">,</span><span class="dv">83</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">215</span><span class="op">,</span><span class="dv">44</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">45</span><span class="op">,</span><span class="dv">39</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">193</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">65</span><span class="op">,</span><span class="dv">174</span><span class="op">,</span><span class="dv">186</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span><span class="dv">219</span><span class="op">,</span><span class="dv">30</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">48</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-59" title="59">  <span class="dv">134</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span><span class="dv">114</span><span class="op">,</span><span class="dv">38</span><span class="op">,</span><span class="dv">124</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">213</span><span class="op">,</span><span class="dv">205</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span><span class="dv">28</span><span class="op">,</span><span class="dv">22</span><span class="op">,</span><span class="dv">216</span><span class="op">,</span><span class="dv">76</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">224</span><span class="op">,</span><span class="dv">241</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">62</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-60" title="60">  <span class="dv">23</span><span class="op">,</span><span class="dv">104</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">182</span><span class="op">,</span><span class="dv">61</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">244</span><span class="op">,</span><span class="dv">234</span><span class="op">,</span><span class="dv">53</span><span class="op">,</span><span class="dv">132</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">140</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-61" title="61">  <span class="dv">72</span><span class="op">,</span><span class="dv">146</span><span class="op">,</span><span class="dv">127</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">227</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">243</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">222</span><span class="op">,</span><span class="dv">47</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">18</span><span class="op">,</span><span class="dv">173</span><span class="op">,</span><span class="dv">203</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">133</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">214</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-62" title="62">  <span class="dv">77</span><span class="op">,</span><span class="dv">20</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">231</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span><span class="dv">55</span><span class="op">,</span><span class="dv">69</span><span class="op">,</span><span class="dv">132</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">131</span><span class="op">,</span><span class="dv">212</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">153</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">179</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-63" title="63">  <span class="dv">127</span><span class="op">,</span><span class="dv">83</span><span class="op">,</span><span class="dv">57</span><span class="op">,</span><span class="dv">29</span><span class="op">,</span><span class="dv">195</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">64</span><span class="op">,</span><span class="dv">211</span><span class="op">,</span><span class="dv">115</span><span class="op">,</span><span class="dv">202</span><span class="op">,</span><span class="dv">188</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">188</span><span class="op">,</span><span class="dv">142</span><span class="op">,</span><span class="dv">203</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">231</span><span class="op">,</span><span class="dv">53</span><span class="op">,</span><span class="dv">206</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-64" title="64">  <span class="dv">220</span><span class="op">,</span><span class="dv">90</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">178</span><span class="op">,</span><span class="dv">122</span><span class="op">,</span><span class="dv">60</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">154</span><span class="op">,</span><span class="dv">108</span><span class="op">,</span><span class="dv">203</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">142</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">55</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-65" title="65">  <span class="dv">110</span><span class="op">,</span><span class="dv">214</span><span class="op">,</span><span class="dv">33</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span><span class="dv">181</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">79</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span><span class="dv">200</span><span class="op">,</span><span class="dv">83</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">105</span><span class="op">,</span><span class="dv">223</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">115</span><span class="op">,</span><span class="dv">240</span><span class="op">,</span><span class="dv">146</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-66" title="66">  <span class="dv">122</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">204</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">38</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">154</span><span class="op">,</span><span class="dv">31</span><span class="op">,</span><span class="dv">29</span><span class="op">,</span><span class="dv">23</span><span class="op">,</span><span class="dv">236</span><span class="op">,</span><span class="dv">39</span><span class="op">,</span><span class="dv">35</span><span class="op">,</span><span class="dv">131</span><span class="op">,</span><span class="dv">147</span><span class="op">,</span><span class="dv">242</span><span class="op">,</span><span class="dv">163</span><span class="op">,</span><span class="dv">138</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">236</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-67" title="67">  <span class="dv">117</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">108</span><span class="op">,</span><span class="dv">33</span><span class="op">,</span><span class="dv">132</span><span class="op">,</span><span class="dv">98</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">111</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">146</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">82</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">85</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">130</span><span class="op">,</span><span class="dv">237</span><span class="op">,</span><span class="dv">67</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">170</span><span class="op">,</span><span class="dv">235</span><span class="op">,</span><span class="dv">124</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-68" title="68">  <span class="dv">92</span><span class="op">,</span><span class="dv">66</span><span class="op">,</span><span class="dv">71</span><span class="op">,</span><span class="dv">239</span><span class="op">,</span><span class="dv">12</span><span class="op">,</span><span class="dv">97</span><span class="op">,</span><span class="dv">136</span><span class="op">,</span><span class="dv">251</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">206</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">51</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">92</span><span class="op">,</span><span class="dv">46</span><span class="op">,</span><span class="dv">35</span><span class="op">,</span><span class="dv">95</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">123</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">183</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">243</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-69" title="69">  <span class="dv">124</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">155</span><span class="op">,</span><span class="dv">89</span><span class="op">,</span><span class="dv">66</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">72</span><span class="op">,</span><span class="dv">17</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">99</span><span class="op">,</span><span class="dv">137</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">204</span><span class="op">,</span><span class="dv">9</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">78</span><span class="op">,</span><span class="dv">35</span><span class="op">,</span><span class="dv">218</span><span class="op">,</span><span class="dv">136</span><span class="op">,</span><span class="dv">117</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-70" title="70">  <span class="dv">239</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">240</span><span class="op">,</span><span class="dv">187</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">89</span><span class="op">,</span><span class="dv">244</span><span class="op">,</span><span class="dv">140</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">229</span><span class="op">,</span><span class="dv">120</span><span class="op">,</span><span class="dv">116</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">207</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">11</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">190</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">81</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-71" title="71">  <span class="dv">53</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">188</span><span class="op">,</span><span class="dv">51</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">34</span><span class="op">,</span><span class="dv">255</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">191</span><span class="op">,</span><span class="dv">198</span><span class="op">,</span><span class="dv">130</span><span class="op">,</span><span class="dv">220</span><span class="op">,</span><span class="dv">41</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">166</span><span class="op">,</span><span class="dv">194</span><span class="op">,</span><span class="dv">69</span><span class="op">,</span><span class="dv">104</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-72" title="72">  <span class="dv">124</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">122</span><span class="op">,</span><span class="dv">236</span><span class="op">,</span><span class="dv">176</span><span class="op">,</span><span class="dv">24</span><span class="op">,</span><span class="dv">60</span><span class="op">,</span><span class="dv">87</span><span class="op">,</span><span class="dv">240</span><span class="op">,</span><span class="dv">42</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">37</span><span class="op">,</span><span class="dv">143</span><span class="op">,</span><span class="dv">208</span><span class="op">,</span><span class="dv">155</span><span class="op">,</span><span class="dv">249</span><span class="op">,</span><span class="dv">230</span><span class="op">,</span><span class="dv">21</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-73" title="73">  <span class="dv">230</span><span class="op">,</span><span class="dv">56</span><span class="op">,</span><span class="dv">194</span><span class="op">,</span><span class="dv">62</span><span class="op">,</span><span class="dv">235</span><span class="op">,</span><span class="dv">132</span><span class="op">,</span><span class="dv">14</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">180</span><span class="op">,</span><span class="dv">216</span><span class="op">,</span><span class="dv">134</span><span class="op">,</span><span class="dv">28</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">159</span><span class="op">,</span><span class="dv">64</span><span class="op">,</span><span class="dv">199</span><span class="op">,</span><span class="dv">161</span><span class="op">,</span><span class="dv">236</span><span class="op">,</span><span class="dv">60</span><span class="op">,</span><span class="dv">233</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-74" title="74">  <span class="dv">160</span><span class="op">,</span><span class="dv">172</span><span class="op">,</span><span class="dv">68</span><span class="op">,</span><span class="dv">169</span><span class="op">,</span><span class="dv">2</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">252</span><span class="op">,</span><span class="dv">190</span><span class="op">,</span><span class="dv">20</span><span class="op">,</span><span class="dv">54</span><span class="op">,</span><span class="dv">115</span><span class="op">,</span><span class="dv">248</span><span class="op">,</span><span class="dv">63</span><span class="op">,</span><span class="dv">93</span><span class="op">,</span><span class="dv">107</span><span class="op">,</span><span class="dv">156</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span><span class="dv">85</span><span class="op">,</span><span class="dv">32</span><span class="op">,</span><span class="dv">189</span><span class="op">,</span><span class="dv">118</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-75" title="75">  <span class="dv">66</span><span class="op">,</span><span class="dv">114</span><span class="op">,</span><span class="dv">126</span><span class="op">,</span><span class="dv">64</span><span class="op">,</span><span class="dv">203</span><span class="op">,</span><span class="dv">97</span><span class="op">,</span><span class="dv">235</span><span class="op">,</span><span class="dv">13</span><span class="op">,</span><span class="dv">18</span><span class="op">,</span><span class="dv">102</span><span class="op">,</span><span class="dv">192</span><span class="op">,</span><span class="dv">51</span><span class="op">,</span><span class="dv">59</span><span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">122</span><span class="op">,</span><span class="dv">171</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span><span class="dv">129</span><span class="op">,</span><span class="dv">40</span><span class="op">,</span><span class="dv">32</span><span class="op">,</span><span class="dv">154</span><span class="op">,</span><span class="dv">4</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-76" title="76">  <span class="dv">191</span><span class="op">,</span><span class="dv">234</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">184</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span><span class="dv">201</span><span class="op">,</span><span class="dv">244</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">50</span><span class="op">,</span><span class="dv">216</span><span class="op">,</span><span class="dv">44</span><span class="op">,</span><span class="dv">88</span><span class="op">,</span><span class="dv">139</span><span class="op">,</span><span class="dv">175</span><span class="op">,</span><span class="dv">58</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span><span class="dv">7</span><span class="op">,</span><span class="dv">52</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">64</span><span class="op">,</span><span class="dv">112</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-77" title="77">  <span class="dv">40</span><span class="op">,</span><span class="dv">148</span><span class="op">,</span><span class="dv">187</span><span class="op">,</span><span class="dv">39</span><span class="op">,</span><span class="dv">234</span><span class="op">,</span><span class="dv">96</span><span class="op">,</span><span class="dv">151</span><span class="op">,</span><span class="dv">16</span><span class="op">,</span><span class="dv">158</span><span class="op">,</span><span class="dv">114</span><span class="op">,</span><span class="dv">113</span><span class="op">,</span><span class="dv">109</span><span class="op">,</span><span class="dv">164</span><span class="op">,</span><span class="dv">47</span><span class="op">,</span><span class="dv">108</span><span class="op">,</span><span class="dv">94</span><span class="op">,</span><span class="dv">148</span><span class="op">,</span><span class="dv">35</span><span class="op">,</span><span class="dv">232</span><span class="op">,</span><span class="dv">221</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-78" title="78">  <span class="dv">33</span><span class="op">,</span><span class="dv">110</span><span class="op">,</span><span class="dv">126</span><span class="op">,</span><span class="dv">170</span><span class="op">,</span><span class="dv">25</span><span class="op">,</span><span class="dv">234</span><span class="op">,</span><span class="dv">45</span><span class="op">,</span><span class="dv">165</span><span class="op">,</span><span class="dv">180</span><span class="op">,</span><span class="dv">210</span><span class="op">,</span><span class="dv">193</span><span class="op">,</span><span class="dv">120</span><span class="op">,</span><span class="dv">247</span><span class="op">,</span><span class="dv">155</span><span class="op">,</span><span class="dv">127</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb3-79" title="79"></a>
<a class="sourceLine" id="cb3-80" title="80"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-81" title="81"><span class="co">The unwrapped signing key.</span></a>
<a class="sourceLine" id="cb3-82" title="82"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-83" title="83"><span class="kw">let</span> signingKey<span class="op">;</span></a>
<a class="sourceLine" id="cb3-84" title="84"></a>
<a class="sourceLine" id="cb3-85" title="85"><span class="kw">const</span> signButton <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&quot;.pkcs8 .sign-button&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-86" title="86"></a>
<a class="sourceLine" id="cb3-87" title="87"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-88" title="88"><span class="co">Convert an array of byte values to an ArrayBuffer.</span></a>
<a class="sourceLine" id="cb3-89" title="89"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-90" title="90"><span class="kw">function</span> <span class="at">bytesToArrayBuffer</span>(bytes) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-91" title="91">  <span class="kw">const</span> bytesAsArrayBuffer <span class="op">=</span> <span class="kw">new</span> <span class="at">ArrayBuffer</span>(<span class="va">bytes</span>.<span class="at">length</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-92" title="92">  <span class="kw">const</span> bytesUint8 <span class="op">=</span> <span class="kw">new</span> <span class="at">Uint8Array</span>(bytesAsArrayBuffer)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-93" title="93">  <span class="va">bytesUint8</span>.<span class="at">set</span>(bytes)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-94" title="94">  <span class="cf">return</span> bytesAsArrayBuffer<span class="op">;</span></a>
<a class="sourceLine" id="cb3-95" title="95"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-96" title="96"></a>
<a class="sourceLine" id="cb3-97" title="97"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-98" title="98"><span class="co">Get some key material to use as input to the deriveKey method.</span></a>
<a class="sourceLine" id="cb3-99" title="99"><span class="co">The key material is a password supplied by the user.</span></a>
<a class="sourceLine" id="cb3-100" title="100"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-101" title="101"><span class="kw">function</span> <span class="at">getKeyMaterial</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb3-102" title="102">  <span class="kw">let</span> password <span class="op">=</span> <span class="va">window</span>.<span class="at">prompt</span>(<span class="st">&quot;Enter your password&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-103" title="103">  <span class="kw">let</span> enc <span class="op">=</span> <span class="kw">new</span> <span class="at">TextEncoder</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-104" title="104">  <span class="cf">return</span> <span class="va">window</span>.<span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">importKey</span>(</a>
<a class="sourceLine" id="cb3-105" title="105">    <span class="st">&quot;raw&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-106" title="106">    <span class="va">enc</span>.<span class="at">encode</span>(password)<span class="op">,</span></a>
<a class="sourceLine" id="cb3-107" title="107">    <span class="op">{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&quot;PBKDF2&quot;</span><span class="op">},</span></a>
<a class="sourceLine" id="cb3-108" title="108">    <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-109" title="109">    [<span class="st">&quot;deriveBits&quot;</span><span class="op">,</span> <span class="st">&quot;deriveKey&quot;</span>]</a>
<a class="sourceLine" id="cb3-110" title="110">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb3-111" title="111"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-112" title="112"></a>
<a class="sourceLine" id="cb3-113" title="113"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-114" title="114"><span class="co">Derive an AES-GCM key using PBKDF2.</span></a>
<a class="sourceLine" id="cb3-115" title="115"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-116" title="116"><span class="kw">async</span> <span class="kw">function</span> <span class="at">getUnwrappingKey</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb3-117" title="117">  <span class="co">// 1. get the key material (user-supplied password)</span></a>
<a class="sourceLine" id="cb3-118" title="118">  <span class="kw">const</span> keyMaterial <span class="op">=</span> <span class="cf">await</span> <span class="at">getKeyMaterial</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-119" title="119">  <span class="co">// 2 initialize the salt parameter.</span></a>
<a class="sourceLine" id="cb3-120" title="120">  <span class="co">// The salt must match the salt originally used to derive the key.</span></a>
<a class="sourceLine" id="cb3-121" title="121">  <span class="co">// In this example it&#39;s supplied as a constant &quot;saltBytes&quot;.</span></a>
<a class="sourceLine" id="cb3-122" title="122">  <span class="kw">const</span> saltBuffer <span class="op">=</span> <span class="at">bytesToArrayBuffer</span>(saltBytes)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-123" title="123">  <span class="co">// 3 derive the key from key material and salt</span></a>
<a class="sourceLine" id="cb3-124" title="124">  <span class="cf">return</span> <span class="va">window</span>.<span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">deriveKey</span>(</a>
<a class="sourceLine" id="cb3-125" title="125">    <span class="op">{</span></a>
<a class="sourceLine" id="cb3-126" title="126">      <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;PBKDF2&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-127" title="127">      <span class="dt">salt</span><span class="op">:</span> saltBuffer<span class="op">,</span></a>
<a class="sourceLine" id="cb3-128" title="128">      <span class="st">&quot;iterations&quot;</span><span class="op">:</span> <span class="dv">100000</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-129" title="129">      <span class="st">&quot;hash&quot;</span><span class="op">:</span> <span class="st">&quot;SHA-256&quot;</span></a>
<a class="sourceLine" id="cb3-130" title="130">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-131" title="131">    keyMaterial<span class="op">,</span></a>
<a class="sourceLine" id="cb3-132" title="132">    <span class="op">{</span> <span class="st">&quot;name&quot;</span><span class="op">:</span> <span class="st">&quot;AES-GCM&quot;</span><span class="op">,</span> <span class="st">&quot;length&quot;</span><span class="op">:</span> <span class="dv">256</span><span class="op">},</span></a>
<a class="sourceLine" id="cb3-133" title="133">    <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-134" title="134">    [ <span class="st">&quot;wrapKey&quot;</span><span class="op">,</span> <span class="st">&quot;unwrapKey&quot;</span> ]</a>
<a class="sourceLine" id="cb3-135" title="135">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb3-136" title="136"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-137" title="137"></a>
<a class="sourceLine" id="cb3-138" title="138"><span class="co">/*</span></a>
<a class="sourceLine" id="cb3-139" title="139"><span class="co">Unwrap an RSA-PSS private signing key from an ArrayBuffer containing</span></a>
<a class="sourceLine" id="cb3-140" title="140"><span class="co">the raw bytes.</span></a>
<a class="sourceLine" id="cb3-141" title="141"><span class="co">Takes an array containing the bytes, and returns a Promise</span></a>
<a class="sourceLine" id="cb3-142" title="142"><span class="co">that will resolve to a CryptoKey representing the private key.</span></a>
<a class="sourceLine" id="cb3-143" title="143"><span class="co">*/</span></a>
<a class="sourceLine" id="cb3-144" title="144"><span class="kw">async</span> <span class="kw">function</span> <span class="at">unwrapPrivateKey</span>(wrappedKey) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-145" title="145">  <span class="co">// 1. get the unwrapping key</span></a>
<a class="sourceLine" id="cb3-146" title="146">  <span class="kw">const</span> unwrappingKey <span class="op">=</span> <span class="cf">await</span> <span class="at">getUnwrappingKey</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-147" title="147">  <span class="co">// 2. initialize the wrapped key</span></a>
<a class="sourceLine" id="cb3-148" title="148">  <span class="kw">const</span> wrappedKeyBuffer <span class="op">=</span> <span class="at">bytesToArrayBuffer</span>(wrappedKey)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-149" title="149">  <span class="co">// 3. initialize the iv</span></a>
<a class="sourceLine" id="cb3-150" title="150">  <span class="kw">const</span> ivBuffer <span class="op">=</span> <span class="at">bytesToArrayBuffer</span>(ivBytes)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-151" title="151">  <span class="co">// 4. unwrap the key</span></a>
<a class="sourceLine" id="cb3-152" title="152">  <span class="cf">return</span> <span class="va">window</span>.<span class="va">crypto</span>.<span class="va">subtle</span>.<span class="at">unwrapKey</span>(</a>
<a class="sourceLine" id="cb3-153" title="153">    <span class="st">&quot;pkcs8&quot;</span><span class="op">,</span>               <span class="co">// import format</span></a>
<a class="sourceLine" id="cb3-154" title="154">    wrappedKeyBuffer<span class="op">,</span>      <span class="co">// ArrayBuffer representing key to unwrap</span></a>
<a class="sourceLine" id="cb3-155" title="155">    unwrappingKey<span class="op">,</span>         <span class="co">// CryptoKey representing key encryption key</span></a>
<a class="sourceLine" id="cb3-156" title="156">    <span class="op">{</span>                      <span class="co">// algorithm params for key encryption key</span></a>
<a class="sourceLine" id="cb3-157" title="157">      <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;AES-GCM&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-158" title="158">      <span class="dt">iv</span><span class="op">:</span> ivBuffer</a>
<a class="sourceLine" id="cb3-159" title="159">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-160" title="160">    <span class="op">{</span>                      <span class="co">// algorithm params for key to unwrap</span></a>
<a class="sourceLine" id="cb3-161" title="161">      <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;RSA-PSS&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-162" title="162">      <span class="dt">hash</span><span class="op">:</span> <span class="st">&quot;SHA-256&quot;</span></a>
<a class="sourceLine" id="cb3-163" title="163">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-164" title="164">    <span class="kw">true</span><span class="op">,</span>                  <span class="co">// extractability of key to unwrap</span></a>
<a class="sourceLine" id="cb3-165" title="165">    [<span class="st">&quot;sign&quot;</span>]               <span class="co">// key usages for key to unwrap</span></a>
<a class="sourceLine" id="cb3-166" title="166">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb3-167" title="167"><span class="op">}</span></a></code></pre></div>
<h2 id="specifications">Specifications</h2>
<p>{{Specifications}}</p>
<h2 id="browser-compatibility">Browser compatibility</h2>
<p>{{Compat}}</p>
<h2 id="see-also">See also</h2>
<ul>
<li><a href="/en-US/docs/Web/API/SubtleCrypto/importKey"><code>SubtleCrypto.importKey()</code></a></li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc5208">PKCS #8 format</a>.</li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1">SubjectPublicKeyInfo format</a>.</li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc7517">JSON Web Key format</a>.</li>
<li><a href="https://datatracker.ietf.org/doc/html/rfc3394">AES-KW specification</a>.</li>
</ul>
