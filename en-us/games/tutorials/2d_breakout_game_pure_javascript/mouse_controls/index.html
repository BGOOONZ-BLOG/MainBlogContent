<p>{{GamesSidebar}}</p>
<p>{{PreviousNext(“Games/Workflows/2D_Breakout_game_pure_JavaScript/Track_the_score_and_win”, “Games/Workflows/2D_Breakout_game_pure_JavaScript/Finishing_up”)}}</p>
<p>This is the <strong>9th step</strong> out of 10 of the <a href="/en-US/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript">Gamedev Canvas tutorial</a>. You can find the source code as it should look after completing this lesson at <a href="https://github.com/end3r/Gamedev-Canvas-workshop/blob/gh-pages/lesson09.html">Gamedev-Canvas-workshop/lesson9.html</a>.</p>
<p>The game itself is actually finished, so let’s work on polishing it up. We have already added keyboard controls, but we could easily add mouse controls too.</p>
<h2 id="listening-for-mouse-movement">Listening for mouse movement</h2>
<p>Listening for mouse movement is even easier than listening for key presses: all we need is the listener for the {{event(“mousemove”)}} event. Add the following line in the same place as the other event listeners, just below the <code>keyup event</code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="va">document</span>.<span class="at">addEventListener</span>(<span class="st">&quot;mousemove&quot;</span><span class="op">,</span> mouseMoveHandler<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="anchoring-the-paddle-movement-to-the-mouse-movement">Anchoring the paddle movement to the mouse movement</h2>
<p>We can update the paddle position based on the pointer coordinates — the following handler function will do exactly that. Add the following function to your code, below the previous line you added:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">function</span> <span class="at">mouseMoveHandler</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="kw">var</span> relativeX <span class="op">=</span> <span class="va">e</span>.<span class="at">clientX</span> <span class="op">-</span> <span class="va">canvas</span>.<span class="at">offsetLeft</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="cf">if</span>(relativeX <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> relativeX <span class="op">&lt;</span> <span class="va">canvas</span>.<span class="at">width</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">        paddleX <span class="op">=</span> relativeX <span class="op">-</span> paddleWidth/<span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="op">}</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>In this function we first work out a <code>relativeX</code> value, which is equal to the horizontal mouse position in the viewport (<code>e.clientX</code>) minus the distance between the left edge of the canvas and left edge of the viewport (<code>canvas.offsetLeft</code>) — effectively this is equal to the distance between the canvas left edge and the mouse pointer. If the relative X pointer position is greater than zero and lower than the Canvas width, the pointer is within the Canvas boundaries, and the <code>paddleX</code> position (anchored on the left edge of the paddle) is set to the <code>relativeX</code> value minus half the width of the paddle, so that the movement will actually be relative to the middle of the paddle.</p>
<p>The paddle will now follow the position of the mouse cursor, but since we’re restricting the movement to the size of the Canvas, it won’t disappear completely off either side.</p>
<h2 id="compare-your-code">Compare your code</h2>
<p>This is the latest state of the code to compare against:</p>
<p>{{JSFiddleEmbed(“https://jsfiddle.net/raymondjplante/vt7y5hcp/”,"“,”395")}}</p>
<blockquote>
<p><strong>Note:</strong> Try adjusting the boundaries of the paddle movement, so the whole paddle will be visible on both edges of the Canvas instead of only half of it.</p>
</blockquote>
<h2 id="next-steps">Next steps</h2>
<p>Now we’ve got a complete game we’ll finish our series of lessons with some more small tweaks — <a href="/en-US/docs/Games/Tutorials/2D_Breakout_game_pure_JavaScript/Finishing_up">Finishing up</a>.</p>
<p>{{PreviousNext(“Games/Workflows/2D_Breakout_game_pure_JavaScript/Track_the_score_and_win”, “Games/Workflows/2D_Breakout_game_pure_JavaScript/Finishing_up”)}}</p>
