<p>{{APIRef(“DOM”)}}</p>
<p>The <strong><code>addEventListener()</code></strong> method of the {{domxref(“EventTarget”)}} interface sets up a function that will be called whenever the specified event is delivered to the target.</p>
<p>Common targets are {{domxref(“Element”)}}, or its children, {{domxref(“Document”)}}, and {{domxref(“Window”)}}, but the target may be any object that supports events (such as {{domxref(“XMLHttpRequest”)}}).</p>
<blockquote>
<p><strong>Note:</strong> The <code>addEventListener()</code> method is the <em>recommended</em> way to register an event listener. The benefits are as follows: - It allows adding more than one handler for an event. This is particularly useful for libraries, JavaScript modules, or any other kind of code that needs to work well with other libraries or extensions. - In contrast to using an <code>onXYZ</code> property, it gives you finer-grained control of the phase when the listener is activated (capturing vs. bubbling). - It works on any event target, not just HTML or SVG elements.</p>
</blockquote>
<p>The method <code>addEventListener()</code> works by adding a function, or an object that implements {{domxref(“EventListener”)}}, to the list of event listeners for the specified event type on the {{domxref(“EventTarget”)}} on which it’s called. If the function or object, is already in the list of event listeners for this target, they are not added a second time.</p>
<p>They do not need to be removed manually with {{domxref(“EventTarget.removeEventListener”, “removeEventListener()”)}}.</p>
<blockquote>
<p><strong>Note:</strong> Two identical anonymous functions are considered as different for <code>addEventListener</code> and the second one will <em>also</em> be added to the list of event listener for that target.</p>
<p>Indeed, anonymous functions are not identical even if defined using the <em>same</em> unchanging source-code called repeatedly, <strong>even if in a loop</strong>.</p>
<p>Repeatedly defining the same unnamed function in such cases can be problematic. (See <a href="#memory_issues">Memory issues</a>, below.)</p>
</blockquote>
<p>If an event listener is added to an {{domxref(“EventTarget”)}} from inside another listener, that is during the processing of the event, that event will not trigger the new listener. However, the new listener may be triggered during a later stage of event flow, such as during the bubbling phase.</p>
<h2 id="syntax">Syntax</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="at">addEventListener</span>(type<span class="op">,</span> listener)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="at">addEventListener</span>(type<span class="op">,</span> listener<span class="op">,</span> options)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="at">addEventListener</span>(type<span class="op">,</span> listener<span class="op">,</span> useCapture)<span class="op">;</span></a></code></pre></div>
<h3 id="parameters">Parameters</h3>
<ul>
<li><code>type</code>
<ul>
<li>: A case-sensitive string representing the <a href="/en-US/docs/Web/Events">event type</a> to listen for.</li>
</ul></li>
<li><code>listener</code>
<ul>
<li>: The object that receives a notification (an object that implements the {{domxref(“Event”)}} interface) when an event of the specified type occurs. This must be an object implementing the {{domxref(“EventListener”)}} interface, or a JavaScript <a href="/en-US/docs/Web/JavaScript/Guide/Functions">function</a>. See {{anch(“The event listener callback”)}} for details on the callback itself.</li>
</ul></li>
<li><p><code>options</code> {{optional_inline}}</p>
<ul>
<li><p>: An object that specifies characteristics about the event listener. The available options are:</p>
<ul>
<li><code>capture</code>
<ul>
<li>: A boolean value indicating that events of this type will be dispatched to the registered <code>listener</code> before being dispatched to any <code>EventTarget</code> beneath it in the DOM tree.</li>
</ul></li>
<li><code>once</code>
<ul>
<li>: A boolean value indicating that the <code>listener</code> should be invoked at most once after being added. If <code>true</code>, the <code>listener</code> would be automatically removed when invoked.</li>
</ul></li>
<li><code>passive</code>
<ul>
<li>: A boolean value that, if <code>true</code>, indicates that the function specified by <code>listener</code> will never call {{domxref(“Event.preventDefault”, “preventDefault()”)}}. If a passive listener does call <code>preventDefault()</code>, the user agent will do nothing other than generate a console warning. See <a href="#improving_scrolling_performance_with_passive_listeners">Improving scrolling performance with passive listeners</a> to learn more.</li>
</ul></li>
<li><code>signal</code>
<ul>
<li>: An {{domxref(“AbortSignal”)}}. The listener will be removed when the given <code>AbortSignal</code> object’s {{domxref(“AbortController/abort()”, “abort()”)}} method is called.</li>
</ul></li>
</ul></li>
</ul></li>
<li><p><code>useCapture</code> {{optional_inline}}</p>
<ul>
<li><p>: A boolean value indicating whether events of this type will be dispatched to the registered <code>listener</code> <em>before</em> being dispatched to any <code>EventTarget</code> beneath it in the DOM tree. Events that are bubbling upward through the tree will not trigger a listener designated to use capture. Event bubbling and capturing are two ways of propagating events that occur in an element that is nested within another element, when both elements have registered a handle for that event. The event propagation mode determines the order in which elements receive the event. See <a href="https://www.w3.org/TR/DOM-Level-3-Events/#event-flow">DOM Level 3 Events</a> and <a href="https://www.quirksmode.org/js/events_order.html#link4">JavaScript Event order</a> for a detailed explanation. If not specified, <code>useCapture</code> defaults to <code>false</code>.</p>
<blockquote>
<p><strong>Note:</strong> For event listeners attached to the event target, the event is in the target phase, rather than the capturing and bubbling phases. Event listeners in the <em>capturing</em> phase are called before event listeners in any non-capturing phases.</p>
</blockquote></li>
</ul></li>
<li><code>wantsUntrusted</code> {{optional_inline}} {{Non-standard_inline}}
<ul>
<li>: A Firefox (Gecko)-specific parameter. If <code>true</code>, the listener receives synthetic events dispatched by web content (the default is <code>false</code> for browser {{glossary(“chrome”)}} and <code>true</code> for regular web pages). This parameter is useful for code found in add-ons, as well as the browser itself.</li>
</ul></li>
</ul>
<h3 id="return-value">Return value</h3>
<p>None.</p>
<h2 id="usage-notes">Usage notes</h2>
<h3 id="the-event-listener-callback">The event listener callback</h3>
<p>The event listener can be specified as either a callback function or an object that implements {{domxref(“EventListener”)}}, whose {{domxref(“EventListener.handleEvent()”, “handleEvent()”)}} method serves as the callback function.</p>
<p>The callback function itself has the same parameters and return value as the <code>handleEvent()</code> method; that is, the callback accepts a single parameter: an object based on {{domxref(“Event”)}} describing the event that has occurred, and it returns nothing.</p>
<p>For example, an event handler callback that can be used to handle both {{domxref(“Element/fullscreenchange_event”, “fullscreenchange”)}} and {{domxref(“Element/fullscreenerror_event”, “fullscreenerror”)}} might look like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">function</span> <span class="at">eventHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="cf">if</span> (<span class="va">event</span>.<span class="at">type</span> <span class="op">==</span> <span class="st">&#39;fullscreenchange&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="co">/* handle a full screen toggle */</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="op">}</span> <span class="cf">else</span> <span class="co">/* fullscreenerror */</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="co">/* handle a full screen toggle error */</span></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="op">}</span></a></code></pre></div>
<h3 id="safely-detecting-option-support">Safely detecting option support</h3>
<p>In older versions of the DOM specification, the third parameter of <code>addEventListener()</code> was a Boolean value indicating whether or not to use capture. Over time, it became clear that more options were needed. Rather than adding more parameters to the function (complicating things enormously when dealing with optional values), the third parameter was changed to an object that can contain various properties defining the values of options to configure the process of removing the event listener.</p>
<p>Because older browsers (as well as some not-too-old browsers) still assume the third parameter is a Boolean, you need to build your code to handle this scenario intelligently. You can do this by using feature detection for each of the options you’re interested in.</p>
<p>For example, if you want to check for the <code>passive</code> option:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">let</span> passiveSupported <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-5" title="5">    get <span class="at">passive</span>() <span class="op">{</span> <span class="co">// This function will be called when the browser</span></a>
<a class="sourceLine" id="cb3-6" title="6">                    <span class="co">//   attempts to access the passive property.</span></a>
<a class="sourceLine" id="cb3-7" title="7">      passiveSupported <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="op">}</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="op">};</span></a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="va">window</span>.<span class="at">addEventListener</span>(<span class="st">&quot;test&quot;</span><span class="op">,</span> <span class="kw">null</span><span class="op">,</span> options)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-13" title="13">  <span class="va">window</span>.<span class="at">removeEventListener</span>(<span class="st">&quot;test&quot;</span><span class="op">,</span> <span class="kw">null</span><span class="op">,</span> options)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="op">}</span> <span class="cf">catch</span>(err) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-15" title="15">  passiveSupported <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="op">}</span></a></code></pre></div>
<p>This creates an <code>options</code> object with a getter function for the <code>passive</code> property; the getter sets a flag, <code>passiveSupported</code>, to <code>true</code> if it gets called. That means that if the browser checks the value of the <code>passive</code> property on the <code>options</code> object, <code>passiveSupported</code> will be set to <code>true</code>; otherwise, it will remain <code>false</code>. We then call <code>addEventListener()</code> to set up a fake event handler, specifying those options, so that the options will be checked if the browser recognizes an object as the third parameter. Then, we call <code>removeEventListener()</code> to clean up after ourselves. (Note that <code>handleEvent()</code> is ignored on event listeners that aren’t called.)</p>
<p>You can check whether any option is supported this way. Just add a getter for that option using code similar to what is shown above.</p>
<p>Then, when you want to create an actual event listener that uses the options in question, you can do something like this:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="va">someElement</span>.<span class="at">addEventListener</span>(<span class="st">&quot;mouseup&quot;</span><span class="op">,</span> handleMouseUp<span class="op">,</span> passiveSupported</a>
<a class="sourceLine" id="cb4-2" title="2">                               <span class="op">?</span> <span class="op">{</span> <span class="dt">passive</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span> : <span class="kw">false</span>)<span class="op">;</span></a></code></pre></div>
<p>Here we’re adding a listener for the {{domxref(“Element/mouseup_event”, “mouseup”)}} event on the element <code>someElement</code>. For the third parameter, if <code>passiveSupported</code> is <code>true</code>, we’re specifying an <code>options</code> object with <code>passive</code> set to <code>true</code>; otherwise, we know that we need to pass a Boolean, and we pass <code>false</code> as the value of the <code>useCapture</code> parameter.</p>
<p>If you’d prefer, you can use a third-party library like <a href="https://modernizr.com/docs">Modernizr</a> or <a href="https://github.com/rafrex/detect-it">Detect It</a> to do this test for you.</p>
<p>You can learn more from the article about <a href="https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md#feature-detection"><code>EventListenerOptions</code></a> from the <a href="https://wicg.github.io/admin/charter.html">Web Incubator Community Group</a>.</p>
<h2 id="examples">Examples</h2>
<h3 id="add-a-simple-listener">Add a simple listener</h3>
<p>This example demonstrates how to use <code>addEventListener()</code> to watch for mouse clicks on an element.</p>
<h4 id="html">HTML</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">&lt;table</span><span class="ot"> id=</span><span class="st">&quot;outside&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t1&quot;</span><span class="kw">&gt;</span>one<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t2&quot;</span><span class="kw">&gt;</span>two<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<h4 id="javascript">JavaScript</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// Function to change the content of t2</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">function</span> <span class="at">modifyText</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="kw">const</span> t2 <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;t2&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="cf">if</span> (<span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">==</span> <span class="st">&quot;three&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">=</span> <span class="st">&quot;two&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">    <span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">=</span> <span class="st">&quot;three&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="op">}</span></a>
<a class="sourceLine" id="cb6-10" title="10"></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">// Add event listener to table</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="kw">const</span> el <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;outside&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="va">el</span>.<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> modifyText<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a></code></pre></div>
<p>In this code, <code>modifyText()</code> is a listener for <code>click</code> events registered using <code>addEventListener()</code>. A click anywhere in the table bubbles up to the handler and runs <code>modifyText()</code>.</p>
<h4 id="result">Result</h4>
<p>{{EmbedLiveSample(‘Add_a_simple_listener’)}}</p>
<h3 id="add-an-abortable-listener">Add an abortable listener</h3>
<p>This example demonstrates how to add an <code>addEventListener()</code> that can be aborted with an {{domxref(“AbortSignal”)}}.</p>
<h4 id="html-1">HTML</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">&lt;table</span><span class="ot"> id=</span><span class="st">&quot;outside&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t1&quot;</span><span class="kw">&gt;</span>one<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t2&quot;</span><span class="kw">&gt;</span>two<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<h4 id="javascript-1">JavaScript</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="co">// Add an abortable event listener to table</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">const</span> controller <span class="op">=</span> <span class="kw">new</span> <span class="at">AbortController</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">const</span> el <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;outside&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="va">el</span>.<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> modifyText<span class="op">,</span> <span class="op">{</span> <span class="dt">signal</span><span class="op">:</span> <span class="va">controller</span>.<span class="at">signal</span> <span class="op">}</span> )<span class="op">;</span></a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">// Function to change the content of t2</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">function</span> <span class="at">modifyText</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb8-8" title="8">  <span class="kw">const</span> t2 <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;t2&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="cf">if</span> (<span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">==</span> <span class="st">&quot;three&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-10" title="10">    <span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">=</span> <span class="st">&quot;two&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-12" title="12">    <span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">=</span> <span class="st">&quot;three&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-13" title="13">    <span class="va">controller</span>.<span class="at">abort</span>()<span class="op">;</span> <span class="co">// remove listener after value reaches &quot;three&quot;</span></a>
<a class="sourceLine" id="cb8-14" title="14">  <span class="op">}</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="op">}</span></a></code></pre></div>
<p>In the example above, we modify the code in the previous example such that after the second row’s content changes to “three”, we call <code>abort()</code> from the {{domxref(“AbortController”)}} we passed to the <code>addEventListener()</code> call. That results in the value remaining as “three” forever because we no longer have any code listening for a click event.</p>
<h4 id="result-1">Result</h4>
<p>{{EmbedLiveSample(‘Add_an_abortable_listener’)}}</p>
<h3 id="event-listener-with-anonymous-function">Event listener with anonymous function</h3>
<p>Here, we’ll take a look at how to use an anonymous function to pass parameters into the event listener.</p>
<h4 id="html-2">HTML</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">&lt;table</span><span class="ot"> id=</span><span class="st">&quot;outside&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t1&quot;</span><span class="kw">&gt;</span>one<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t2&quot;</span><span class="kw">&gt;</span>two<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<h4 id="javascript-2">JavaScript</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="co">// Function to change the content of t2</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">function</span> <span class="at">modifyText</span>(new_text) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="kw">const</span> t2 <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;t2&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">=</span> new_text<span class="op">;</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="op">}</span></a>
<a class="sourceLine" id="cb10-6" title="6"></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">// Function to add event listener to table</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="kw">const</span> el <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;outside&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="va">el</span>.<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> <span class="kw">function</span>()<span class="op">{</span><span class="at">modifyText</span>(<span class="st">&quot;four&quot;</span>)<span class="op">},</span> <span class="kw">false</span>)<span class="op">;</span></a></code></pre></div>
<p>Notice that the listener is an anonymous function that encapsulates code that is then, in turn, able to send parameters to the <code>modifyText()</code> function, which is responsible for actually responding to the event.</p>
<h4 id="result-2">Result</h4>
<p>{{EmbedLiveSample(‘Event_listener_with_anonymous_function’)}}</p>
<h3 id="event-listener-with-an-arrow-function">Event listener with an arrow function</h3>
<p>This example demonstrates a simple event listener implemented using arrow function notation.</p>
<h4 id="html-3">HTML</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">&lt;table</span><span class="ot"> id=</span><span class="st">&quot;outside&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t1&quot;</span><span class="kw">&gt;</span>one<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="kw">&lt;tr&gt;&lt;td</span><span class="ot"> id=</span><span class="st">&quot;t2&quot;</span><span class="kw">&gt;</span>two<span class="kw">&lt;/td&gt;&lt;/tr&gt;</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<h4 id="javascript-3">JavaScript</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="co">// Function to change the content of t2</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">function</span> <span class="at">modifyText</span>(new_text) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-3" title="3">  <span class="kw">const</span> t2 <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;t2&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4">  <span class="va">t2</span>.<span class="va">firstChild</span>.<span class="at">nodeValue</span> <span class="op">=</span> new_text<span class="op">;</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="op">}</span></a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">// Add event listener to table with an arrow function</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">const</span> el <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;outside&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="va">el</span>.<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span> <span class="at">modifyText</span>(<span class="st">&quot;four&quot;</span>)<span class="op">;</span> <span class="op">},</span> <span class="kw">false</span>)<span class="op">;</span></a></code></pre></div>
<h4 id="result-3">Result</h4>
<p>{{EmbedLiveSample(‘Event_listener_with_an_arrow_function’)}}</p>
<p>Please note that while anonymous and arrow functions are similar, they have different <code>this</code> bindings. While anonymous (and all traditional JavaScript functions) create their own <code>this</code> bindings, arrow functions inherit the <code>this</code> binding of the containing function.</p>
<p>That means that the variables and constants available to the containing function are also available to the event handler when using an arrow function.</p>
<h3 id="example-of-options-usage">Example of options usage</h3>
<h4 id="html-4">HTML</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;outer&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-2" title="2">  outer, once <span class="er">&amp;</span> none-once</a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;middle&quot;</span><span class="ot"> target=</span><span class="st">&quot;_blank&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-4" title="4">    middle, capture <span class="er">&amp;</span> none-capture</a>
<a class="sourceLine" id="cb13-5" title="5">    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;inner1&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://www.mozilla.org&quot;</span><span class="ot"> target=</span><span class="st">&quot;_blank&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-6" title="6">      inner1, passive <span class="er">&amp;</span> preventDefault(which is not allowed)</a>
<a class="sourceLine" id="cb13-7" title="7">    <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb13-8" title="8">    <span class="kw">&lt;a</span><span class="ot"> class=</span><span class="st">&quot;inner2&quot;</span><span class="ot"> href=</span><span class="st">&quot;https://developer.mozilla.org/&quot;</span><span class="ot"> target=</span><span class="st">&quot;_blank&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb13-9" title="9">      inner2, none-passive <span class="er">&amp;</span> preventDefault(not open new page)</a>
<a class="sourceLine" id="cb13-10" title="10">    <span class="kw">&lt;/a&gt;</span></a>
<a class="sourceLine" id="cb13-11" title="11">  <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb13-12" title="12"><span class="kw">&lt;/div&gt;</span></a></code></pre></div>
<h4 id="css">CSS</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb14-1" title="1"><span class="fu">.outer</span><span class="op">,</span> <span class="fu">.middle</span><span class="op">,</span> <span class="fu">.inner1</span><span class="op">,</span> <span class="fu">.inner2</span> {</a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="kw">display</span>: <span class="dv">block</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-3" title="3">  <span class="kw">width</span>:   <span class="dv">520</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="kw">padding</span>: <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-5" title="5">  <span class="kw">margin</span>:  <span class="dv">15</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="kw">text-decoration</span>: <span class="dv">none</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-7" title="7">}</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="fu">.outer</span> {</a>
<a class="sourceLine" id="cb14-9" title="9">  <span class="kw">border</span>: <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">red</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-10" title="10">  <span class="kw">color</span>:  <span class="cn">red</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-11" title="11">}</a>
<a class="sourceLine" id="cb14-12" title="12"><span class="fu">.middle</span> {</a>
<a class="sourceLine" id="cb14-13" title="13">  <span class="kw">border</span>: <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">green</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-14" title="14">  <span class="kw">color</span>:  <span class="cn">green</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-15" title="15">  <span class="kw">width</span>:  <span class="dv">460</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-16" title="16">}</a>
<a class="sourceLine" id="cb14-17" title="17"><span class="fu">.inner1</span><span class="op">,</span> <span class="fu">.inner2</span> {</a>
<a class="sourceLine" id="cb14-18" title="18">  <span class="kw">border</span>: <span class="dv">1</span><span class="dt">px</span> <span class="dv">solid</span> <span class="cn">purple</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-19" title="19">  <span class="kw">color</span>:  <span class="cn">purple</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-20" title="20">  <span class="kw">width</span>:  <span class="dv">400</span><span class="dt">px</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-21" title="21">}</a></code></pre></div>
<h4 id="javascript-4">JavaScript</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">const</span> outer  <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.outer&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">const</span> middle <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.middle&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">const</span> inner1 <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.inner1&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="kw">const</span> inner2 <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;.inner2&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="kw">const</span> capture <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-7" title="7">  <span class="dt">capture </span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="kw">const</span> noneCapture <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="dt">capture </span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="kw">const</span> once <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-13" title="13">  <span class="dt">once </span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="kw">const</span> noneOnce <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-16" title="16">  <span class="dt">once </span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-18" title="18"><span class="kw">const</span> passive <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-19" title="19">  <span class="dt">passive </span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-21" title="21"><span class="kw">const</span> nonePassive <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-22" title="22">  <span class="dt">passive </span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb15-23" title="23"><span class="op">};</span></a>
<a class="sourceLine" id="cb15-24" title="24"></a>
<a class="sourceLine" id="cb15-25" title="25"><span class="va">outer</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> onceHandler<span class="op">,</span> once)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-26" title="26"><span class="va">outer</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> noneOnceHandler<span class="op">,</span> noneOnce)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-27" title="27"><span class="va">middle</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> captureHandler<span class="op">,</span> capture)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-28" title="28"><span class="va">middle</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> noneCaptureHandler<span class="op">,</span> noneCapture)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-29" title="29"><span class="va">inner1</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> passiveHandler<span class="op">,</span> passive)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="va">inner2</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> nonePassiveHandler<span class="op">,</span> nonePassive)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-31" title="31"></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="kw">function</span> <span class="at">onceHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-33" title="33">  <span class="at">alert</span>(<span class="st">&#39;outer, once&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="op">}</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="kw">function</span> <span class="at">noneOnceHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-36" title="36">  <span class="at">alert</span>(<span class="st">&#39;outer, none-once, default&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-37" title="37"><span class="op">}</span></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="kw">function</span> <span class="at">captureHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-39" title="39">  <span class="co">//event.stopImmediatePropagation();</span></a>
<a class="sourceLine" id="cb15-40" title="40">  <span class="at">alert</span>(<span class="st">&#39;middle, capture&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="op">}</span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="kw">function</span> <span class="at">noneCaptureHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-43" title="43">  <span class="at">alert</span>(<span class="st">&#39;middle, none-capture, default&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="op">}</span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="kw">function</span> <span class="at">passiveHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-46" title="46">  <span class="co">// Unable to preventDefault inside passive event listener invocation.</span></a>
<a class="sourceLine" id="cb15-47" title="47">  <span class="va">event</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb15-48" title="48">  <span class="at">alert</span>(<span class="st">&#39;inner1, passive, open new page&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="op">}</span></a>
<a class="sourceLine" id="cb15-50" title="50"><span class="kw">function</span> <span class="at">nonePassiveHandler</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb15-51" title="51">  <span class="va">event</span>.<span class="at">preventDefault</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb15-52" title="52">  <span class="co">//event.stopPropagation();</span></a>
<a class="sourceLine" id="cb15-53" title="53">  <span class="at">alert</span>(<span class="st">&#39;inner2, none-passive, default, not open new page&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="op">}</span></a></code></pre></div>
<h4 id="result-4">Result</h4>
<p>Click the outer, middle, inner containers respectively to see how the options work.</p>
<p>{{ EmbedLiveSample(‘Example_of_options_usage’, 600, 310, ’‘, ’Web/API/EventTarget/addEventListener’) }}</p>
<p>Before using a particular value in the <code>options</code> object, it’s a good idea to ensure that the user’s browser supports it, since these are an addition that not all browsers have supported historically. See {{anch(“Safely detecting option support”)}} for details.</p>
<h2 id="other-notes">Other notes</h2>
<h3 id="the-value-of-this-within-the-handler">The value of “this” within the handler</h3>
<p>It is often desirable to reference the element on which the event handler was fired, such as when using a generic handler for a set of similar elements.</p>
<p>When attaching a handler function to an element using <code>addEventListener()</code>, the value of {{jsxref(“Operators/this”,“this”)}} inside the handler will be a reference to the element. It will be the same as the value of the <code>currentTarget</code> property of the event argument that is passed to the handler.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="va">my_element</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span> (e) <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">className</span>)           <span class="co">// logs the className of my_element</span></a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">e</span>.<span class="at">currentTarget</span> <span class="op">===</span> <span class="kw">this</span>) <span class="co">// logs `true`</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="op">}</span>)</a></code></pre></div>
<p>As a reminder, <a href="/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions#no_separate_this">arrow functions do not have their own <code>this</code> context</a>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="va">my_element</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> (e) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">className</span>)           <span class="co">// </span><span class="al">WARNING</span><span class="co">: `this` is not `my_element`</span></a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">e</span>.<span class="at">currentTarget</span> <span class="op">===</span> <span class="kw">this</span>) <span class="co">// logs `false`</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="op">}</span>)</a></code></pre></div>
<p>If an event handler (for example, {{domxref(“GlobalEventHandlers.onclick”, “onclick”)}}) is specified on an element in the HTML source, the JavaScript code in the attribute value is effectively wrapped in a handler function that binds the value of <code>this</code> in a manner consistent with the <code>addEventListener()</code>; an occurrence of <code>this</code> within the code represents a reference to the element.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">&lt;table</span><span class="ot"> id=</span><span class="st">&quot;my_table&quot;</span><span class="ot"> onclick=</span><span class="st">&quot;console.log(this.id);&quot;</span><span class="kw">&gt;</span><span class="co">&lt;!-- `this` refers to the table; logs &#39;my_table&#39; --&gt;</span></a>
<a class="sourceLine" id="cb18-2" title="2">  ...</a>
<a class="sourceLine" id="cb18-3" title="3"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<p>Note that the value of <code>this</code> inside a function, <em>called by</em> the code in the attribute value, behaves as per <a href="/en-US/docs/Web/JavaScript/Reference/Operators/this">standard rules</a>. This is shown in the following example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb19-2" title="2">  <span class="kw">function</span> <span class="at">logID</span>() <span class="op">{</span> <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">id</span>)<span class="op">;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="kw">&lt;table</span><span class="ot"> id=</span><span class="st">&quot;my_table&quot;</span><span class="ot"> onclick=</span><span class="st">&quot;logID();&quot;</span><span class="kw">&gt;</span><span class="co">&lt;!-- when called, `this` will refer to the global object --&gt;</span></a>
<a class="sourceLine" id="cb19-5" title="5">  ...</a>
<a class="sourceLine" id="cb19-6" title="6"><span class="kw">&lt;/table&gt;</span></a></code></pre></div>
<p>The value of <code>this</code> within <code>logID()</code> is a reference to the global object {{domxref(“Window”)}} (or <code>undefined</code> in the case of <a href="/en-US/docs/Web/JavaScript/Reference/Strict_mode">strict mode</a>.</p>
<h4 id="specifying-this-using-bind">Specifying “this” using bind()</h4>
<p>The {{jsxref(“Function.prototype.bind()”)}} method lets you establish a fixed <code>this</code> context for all subsequent calls — bypassing problems where it’s unclear what <code>this</code> will be, depending on the context from which your function was called. Note, however, that you’ll need to keep a reference to the listener around so you can remove it later.</p>
<p>This is an example with and without <code>bind()</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">const</span> Something <span class="op">=</span> <span class="kw">function</span>(element) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="co">// |this| is a newly created object</span></a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> <span class="st">&#39;Something Good&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="kw">this</span>.<span class="at">onclick1</span> <span class="op">=</span> <span class="kw">function</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">name</span>)<span class="op">;</span> <span class="co">// undefined, as |this| is the element</span></a>
<a class="sourceLine" id="cb20-6" title="6">  <span class="op">};</span></a>
<a class="sourceLine" id="cb20-7" title="7"></a>
<a class="sourceLine" id="cb20-8" title="8">  <span class="kw">this</span>.<span class="at">onclick2</span> <span class="op">=</span> <span class="kw">function</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">name</span>)<span class="op">;</span> <span class="co">// &#39;Something Good&#39;, as |this| is bound to newly created object</span></a>
<a class="sourceLine" id="cb20-10" title="10">  <span class="op">};</span></a>
<a class="sourceLine" id="cb20-11" title="11"></a>
<a class="sourceLine" id="cb20-12" title="12">  <span class="co">// bind causes a fixed `this` context to be assigned to onclick2</span></a>
<a class="sourceLine" id="cb20-13" title="13">  <span class="kw">this</span>.<span class="at">onclick2</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">onclick2</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-14" title="14"></a>
<a class="sourceLine" id="cb20-15" title="15">  <span class="va">element</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">onclick1</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-16" title="16">  <span class="va">element</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">this</span>.<span class="at">onclick2</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span> <span class="co">// Trick</span></a>
<a class="sourceLine" id="cb20-17" title="17"><span class="op">}</span></a>
<a class="sourceLine" id="cb20-18" title="18"><span class="kw">const</span> s <span class="op">=</span> <span class="kw">new</span> <span class="at">Something</span>(<span class="va">document</span>.<span class="at">body</span>)<span class="op">;</span></a></code></pre></div>
<p>Another solution is using a special function called <code>handleEvent()</code> to catch any events:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">const</span> Something <span class="op">=</span> <span class="kw">function</span>(element) <span class="op">{</span></a>
<a class="sourceLine" id="cb21-2" title="2">  <span class="co">// |this| is a newly created object</span></a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> <span class="st">&#39;Something Good&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-4" title="4">  <span class="kw">this</span>.<span class="at">handleEvent</span> <span class="op">=</span> <span class="kw">function</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb21-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">name</span>)<span class="op">;</span> <span class="co">// &#39;Something Good&#39;, as this is bound to newly created object</span></a>
<a class="sourceLine" id="cb21-6" title="6">    <span class="cf">switch</span>(<span class="va">event</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb21-7" title="7">      <span class="cf">case</span> <span class="st">&#39;click&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb21-8" title="8">        <span class="co">// some code here...</span></a>
<a class="sourceLine" id="cb21-9" title="9">        <span class="cf">break</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-10" title="10">      <span class="cf">case</span> <span class="st">&#39;dblclick&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb21-11" title="11">        <span class="co">// some code here...</span></a>
<a class="sourceLine" id="cb21-12" title="12">        <span class="cf">break</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-13" title="13">    <span class="op">}</span></a>
<a class="sourceLine" id="cb21-14" title="14">  <span class="op">};</span></a>
<a class="sourceLine" id="cb21-15" title="15"></a>
<a class="sourceLine" id="cb21-16" title="16">  <span class="co">// Note that the listeners in this case are |this|, not this.handleEvent</span></a>
<a class="sourceLine" id="cb21-17" title="17">  <span class="va">element</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">this</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-18" title="18">  <span class="va">element</span>.<span class="at">addEventListener</span>(<span class="st">&#39;dblclick&#39;</span><span class="op">,</span> <span class="kw">this</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-19" title="19"></a>
<a class="sourceLine" id="cb21-20" title="20">  <span class="co">// You can properly remove the listeners</span></a>
<a class="sourceLine" id="cb21-21" title="21">  <span class="va">element</span>.<span class="at">removeEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">this</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-22" title="22">  <span class="va">element</span>.<span class="at">removeEventListener</span>(<span class="st">&#39;dblclick&#39;</span><span class="op">,</span> <span class="kw">this</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-23" title="23"><span class="op">}</span></a>
<a class="sourceLine" id="cb21-24" title="24"><span class="kw">const</span> s <span class="op">=</span> <span class="kw">new</span> <span class="at">Something</span>(<span class="va">document</span>.<span class="at">body</span>)<span class="op">;</span></a></code></pre></div>
<p>Another way of handling the reference to <em>this</em> is to pass to the <code>EventListener</code> a function that calls the method of the object that contains the fields that need to be accessed:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">class</span> SomeClass <span class="op">{</span></a>
<a class="sourceLine" id="cb22-2" title="2"></a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="at">constructor</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb22-4" title="4">    <span class="kw">this</span>.<span class="at">name</span> <span class="op">=</span> <span class="st">&#39;Something Good&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb22-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb22-6" title="6"></a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="at">register</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb22-8" title="8">    <span class="kw">const</span> that <span class="op">=</span> <span class="kw">this</span><span class="op">;</span></a>
<a class="sourceLine" id="cb22-9" title="9">    <span class="va">window</span>.<span class="at">addEventListener</span>(<span class="st">&#39;keydown&#39;</span><span class="op">,</span> <span class="kw">function</span>(e) <span class="op">{</span> <span class="va">that</span>.<span class="at">someMethod</span>(e)<span class="op">;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb22-11" title="11"></a>
<a class="sourceLine" id="cb22-12" title="12">  <span class="at">someMethod</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-13" title="13">    <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>.<span class="at">name</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-14" title="14">    <span class="cf">switch</span>(<span class="va">e</span>.<span class="at">keyCode</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-15" title="15">      <span class="cf">case</span> <span class="dv">5</span><span class="op">:</span></a>
<a class="sourceLine" id="cb22-16" title="16">        <span class="co">// some code here...</span></a>
<a class="sourceLine" id="cb22-17" title="17">        <span class="cf">break</span><span class="op">;</span></a>
<a class="sourceLine" id="cb22-18" title="18">      <span class="cf">case</span> <span class="dv">6</span><span class="op">:</span></a>
<a class="sourceLine" id="cb22-19" title="19">        <span class="co">// some code here...</span></a>
<a class="sourceLine" id="cb22-20" title="20">        <span class="cf">break</span><span class="op">;</span></a>
<a class="sourceLine" id="cb22-21" title="21">    <span class="op">}</span></a>
<a class="sourceLine" id="cb22-22" title="22">  <span class="op">}</span></a>
<a class="sourceLine" id="cb22-23" title="23"></a>
<a class="sourceLine" id="cb22-24" title="24"><span class="op">}</span></a>
<a class="sourceLine" id="cb22-25" title="25"></a>
<a class="sourceLine" id="cb22-26" title="26"><span class="kw">const</span> myObject <span class="op">=</span> <span class="kw">new</span> <span class="at">SomeClass</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb22-27" title="27"><span class="va">myObject</span>.<span class="at">register</span>()<span class="op">;</span></a></code></pre></div>
<h3 id="getting-data-into-and-out-of-an-event-listener">Getting data into and out of an event listener</h3>
<p>It may seem that event listeners are like islands, and that it is extremely difficult to pass them any data, much less to get any data back from them after they execute. Event listeners only take one argument, the <a href="/en-US/docs/Learn/JavaScript/Building_blocks/Events#event_objects">Event Object</a>, which is automatically passed to the listener, and the return value is ignored. So how can we get data in and back out of them? There are a number of good methods for doing this.</p>
<h4 id="getting-data-into-an-event-listener-using-this">Getting data into an event listener using “this”</h4>
<p>As mentioned <a href="#specifying_this_using_bind">above</a>, you can use <code>Function.prototype.bind()</code> to pass a value to an event listener via the <code>this</code> reference variable.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">const</span> myButton <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;my-button-id&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">const</span> someString <span class="op">=</span> <span class="st">&#39;Data&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb23-3" title="3"></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="va">myButton</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb23-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(<span class="kw">this</span>)<span class="op">;</span> <span class="co">// Expected Value: &#39;Data&#39;</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="op">}</span>.<span class="at">bind</span>(someString))<span class="op">;</span></a></code></pre></div>
<p>This method is suitable when you don’t need to know which HTML element the event listener fired on programmatically from within the event listener. The primary benefit to doing this is that the event listener receives the data in much the same way that it would if you were to actually pass it through its argument list.</p>
<h4 id="getting-data-into-an-event-listener-using-the-outer-scope-property">Getting data into an event listener using the outer scope property</h4>
<p>When an outer scope contains a variable declaration (with <code>const</code>, <code>let</code>), all the inner functions declared in that scope have access to that variable (look <a href="/en-US/docs/Glossary/Function#different_types_of_functions">here</a> for information on outer/inner functions, and <a href="/en-US/docs/Web/JavaScript/Reference/Statements/var#implicit_globals_and_outer_function_scope">here</a> for information on variable scope). Therefore, one of the simplest ways to access data from outside of an event listener is to make it accessible to the scope in which the event listener is declared.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">const</span> myButton <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;my-button-id&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">let</span> someString <span class="op">=</span> <span class="st">&#39;Data&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-3" title="3"></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="va">myButton</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb24-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(someString)<span class="op">;</span>  <span class="co">// Expected Value: &#39;Data&#39;</span></a>
<a class="sourceLine" id="cb24-6" title="6"></a>
<a class="sourceLine" id="cb24-7" title="7">  someString <span class="op">=</span> <span class="st">&#39;Data Again&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb24-9" title="9"></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="va">console</span>.<span class="at">log</span>(someString)<span class="op">;</span>  <span class="co">// Expected Value: &#39;Data&#39; (will never output &#39;Data Again&#39;)</span></a></code></pre></div>
<blockquote>
<p><strong>Note:</strong> Although inner scopes have access to <code>const</code>, <code>let</code> variables from outer scopes, you cannot expect any changes to these variables to be accessible after the event listener definition, within the same outer scope. Why? Because by the time the event listener would execute, the scope in which it was defined would have already finished executing.</p>
</blockquote>
<h4 id="getting-data-into-and-out-of-an-event-listener-using-objects">Getting data into and out of an event listener using objects</h4>
<p>Unlike most functions in JavaScript, objects are retained in memory as long as a variable referencing them exists in memory. This, and the fact that objects can have properties, and that they can be passed around by reference, makes them likely candidates for sharing data among scopes. Let’s explore this.</p>
<blockquote>
<p><strong>Note:</strong> Functions in JavaScript are actually objects. (Hence they too can have properties, and will be retained in memory even after they finish executing if assigned to a variable that persists in memory.)</p>
</blockquote>
<p>Because object properties can be used to store data in memory as long as a variable referencing the object exists in memory, you can actually use them to get data into an event listener, and any changes to the data back out after an event handler executes. Consider this example.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">const</span> myButton <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;my-button-id&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">const</span> someObject <span class="op">=</span> <span class="op">{</span><span class="dt">aProperty</span><span class="op">:</span> <span class="st">&#39;Data&#39;</span><span class="op">};</span></a>
<a class="sourceLine" id="cb25-3" title="3"></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="va">myButton</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">someObject</span>.<span class="at">aProperty</span>)<span class="op">;</span>  <span class="co">// Expected Value: &#39;Data&#39;</span></a>
<a class="sourceLine" id="cb25-6" title="6"></a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="va">someObject</span>.<span class="at">aProperty</span> <span class="op">=</span> <span class="st">&#39;Data Again&#39;</span><span class="op">;</span>  <span class="co">// Change the value</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-9" title="9"></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="va">window</span>.<span class="at">setInterval</span>(<span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb25-11" title="11">  <span class="cf">if</span> (<span class="va">someObject</span>.<span class="at">aProperty</span> <span class="op">===</span> <span class="st">&#39;Data Again&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb25-12" title="12">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Data Again: True&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-13" title="13">    <span class="va">someObject</span>.<span class="at">aProperty</span> <span class="op">=</span> <span class="st">&#39;Data&#39;</span><span class="op">;</span>  <span class="co">// Reset value to wait for next event execution</span></a>
<a class="sourceLine" id="cb25-14" title="14">  <span class="op">}</span></a>
<a class="sourceLine" id="cb25-15" title="15"><span class="op">},</span> <span class="dv">5000</span>)<span class="op">;</span></a></code></pre></div>
<p>In this example, even though the scope in which both the event listener and the interval function are defined would have finished executing before the original value of <code>someObject.aProperty</code> would have changed, because <code>someObject</code> persists in memory (by <em>reference</em>) in both the event listener and interval function, both have access to the same data (i.e. when one changes the data, the other can respond to the change).</p>
<blockquote>
<p><strong>Note:</strong> Objects are stored in variables by reference, meaning only the memory location of the actual data is stored in the variable. Among other things, this means variables that “store” objects can actually affect other variables that get assigned (“store”) the same object reference. When two variables reference the same object (e.g., <code>let a = b = {aProperty: 'Yeah'};</code>), changing the data in either variable will affect the other.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> Because objects are stored in variables by reference, you can return an object from a function to keep it alive (preserve it in memory so you don’t lose the data) after that function stops executing.</p>
</blockquote>
<h3 id="memory-issues">Memory issues</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">const</span> els <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementsByTagName</span>(<span class="st">&#39;*&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-2" title="2"></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">// Case 1</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="va">els</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>)<span class="op">{</span></a>
<a class="sourceLine" id="cb26-5" title="5">  els[i].<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> <span class="kw">function</span>(e)<span class="op">{</span><span class="co">/*do something*/</span><span class="op">},</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="op">}</span></a>
<a class="sourceLine" id="cb26-7" title="7"></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">// Case 2</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="kw">function</span> <span class="at">processEvent</span>(e)<span class="op">{</span></a>
<a class="sourceLine" id="cb26-10" title="10">  <span class="co">/* do something */</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="op">}</span></a>
<a class="sourceLine" id="cb26-12" title="12"></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span> <span class="op">;</span> i <span class="op">&lt;</span> <span class="va">els</span>.<span class="at">length</span><span class="op">;</span> i<span class="op">++</span>)<span class="op">{</span></a>
<a class="sourceLine" id="cb26-14" title="14">  els[i].<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> processEvent<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="op">}</span></a></code></pre></div>
<p>In the first case above, a new (anonymous) handler function is created with each iteration of the loop. In the second case, the same previously declared function is used as an event handler, which results in smaller memory consumption because there is only one handler function created. Moreover, in the first case, it is not possible to call {{domxref(“EventTarget.removeEventListener”, “removeEventListener()”)}} because no reference to the anonymous function is kept (or here, not kept to any of the multiple anonymous functions the loop might create.) In the second case, it’s possible to do <code>myElement.removeEventListener("click", processEvent, false)</code> because <code>processEvent</code> is the function reference.</p>
<p>Actually, regarding memory consumption, the lack of keeping a function reference is not the real issue; rather it is the lack of keeping a <em>static</em> function reference. In both problem-cases below, a function reference is kept, but it is redefined on each iteration. In the third case, the reference to the anonymous function is being reassigned with each iteration. In the fourth case, the entire function definition is unchanging, but it is still being repeatedly defined as if new. So neither is static. Therefore, though appearing to be multiple identical event listeners, in both cases each iteration will instead create a new listener with its own unique reference to the handler function.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">const</span> els <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementsByTagName</span>(<span class="st">&#39;*&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-2" title="2"></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">function</span> <span class="at">processEvent</span>(e)<span class="op">{</span></a>
<a class="sourceLine" id="cb27-4" title="4">  <span class="co">/* do something */</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="op">}</span></a>
<a class="sourceLine" id="cb27-6" title="6"></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">// For illustration only: Note the mistake of [j] for [i]. We are registering all event listeners to the first element</span></a>
<a class="sourceLine" id="cb27-8" title="8"></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co">// Case 3</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span> <span class="op">;</span> i <span class="op">&lt;</span> <span class="va">els</span>.<span class="at">length</span> <span class="op">;</span> i<span class="op">++</span>)<span class="op">{</span></a>
<a class="sourceLine" id="cb27-11" title="11">  els[j].<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> processEvent <span class="op">=</span> <span class="kw">function</span>(e)<span class="op">{</span><span class="co">/* do something */</span><span class="op">},</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb27-13" title="13"></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="co">// Case 4</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="cf">for</span>(<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> j <span class="op">=</span> <span class="dv">0</span> <span class="op">;</span> i <span class="op">&lt;</span> <span class="va">els</span>.<span class="at">length</span> <span class="op">;</span> i<span class="op">++</span>)<span class="op">{</span></a>
<a class="sourceLine" id="cb27-16" title="16">  <span class="kw">function</span> <span class="at">processEvent</span>(e)<span class="op">{</span><span class="co">/* do something */</span><span class="op">};</span></a>
<a class="sourceLine" id="cb27-17" title="17">  els[j].<span class="at">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> processEvent<span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb27-18" title="18"><span class="op">}</span></a></code></pre></div>
<p>Also in both case 3 and case 4, because the function reference was kept but repeatedly redefined with each <code>addEventListener()</code>, <code>removeEventListener("click", processEvent, false)</code> can still remove a listener, but now only the last one added.</p>
<h3 id="improving-scrolling-performance-with-passive-listeners">Improving scrolling performance with passive listeners</h3>
<p>According to the specification, the default value for the <code>passive</code> option is always <code>false</code>. However, this introduces the potential for event listeners handling certain touch events (among others) to block the browser’s main thread while it is attempting to handle scrolling, resulting in possibly enormous reduction in performance during scroll handling.</p>
<p>To prevent this problem, some browsers (specifically, Chrome and Firefox) have changed the default value of the <code>passive</code> option to <code>true</code> for the {{event(“touchstart”)}} and {{event(“touchmove”)}} events on the document-level nodes {{domxref(“Window”)}}, {{domxref(“Document”)}}, and {{domxref(“Document.body”)}}. This prevents the event listener from <a href="/en-US/docs/Web/API/Event/preventDefault">canceling the event</a>, so it can’t block page rendering while the user is scrolling.</p>
<blockquote>
<p><strong>Note:</strong> See the compatibility table below if you need to know which browsers (and/or which versions of those browsers) implement this altered behavior.</p>
</blockquote>
<p>You can override this behavior by explicitly setting the value of <code>passive</code> to <code>false</code>, as shown here:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb28-1" title="1"><span class="co">/* Feature detection */</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">let</span> passiveIfSupported <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb28-3" title="3"></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb28-5" title="5">  <span class="va">window</span>.<span class="at">addEventListener</span>(<span class="st">&quot;test&quot;</span><span class="op">,</span> <span class="kw">null</span><span class="op">,</span></a>
<a class="sourceLine" id="cb28-6" title="6">    <span class="va">Object</span>.<span class="at">defineProperty</span>(</a>
<a class="sourceLine" id="cb28-7" title="7">      <span class="op">{},</span></a>
<a class="sourceLine" id="cb28-8" title="8">      <span class="st">&quot;passive&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb28-9" title="9">      <span class="op">{</span></a>
<a class="sourceLine" id="cb28-10" title="10">        <span class="dt">get</span><span class="op">:</span> <span class="kw">function</span>() <span class="op">{</span> passiveIfSupported <span class="op">=</span> <span class="op">{</span> <span class="dt">passive</span><span class="op">:</span> <span class="kw">true</span> <span class="op">};</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb28-11" title="11">      <span class="op">}</span></a>
<a class="sourceLine" id="cb28-12" title="12">    )</a>
<a class="sourceLine" id="cb28-13" title="13">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb28-14" title="14"><span class="op">}</span> <span class="cf">catch</span>(err) <span class="op">{}</span></a>
<a class="sourceLine" id="cb28-15" title="15"></a>
<a class="sourceLine" id="cb28-16" title="16"><span class="va">window</span>.<span class="at">addEventListener</span>(<span class="st">&#39;scroll&#39;</span><span class="op">,</span> <span class="kw">function</span>(event) <span class="op">{</span></a>
<a class="sourceLine" id="cb28-17" title="17">  <span class="co">/* do something */</span></a>
<a class="sourceLine" id="cb28-18" title="18">  <span class="co">// can&#39;t use event.preventDefault();</span></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="op">},</span> passiveIfSupported )<span class="op">;</span></a></code></pre></div>
<p>On older browsers that don’t support the <code>options</code> parameter to <code>addEventListener()</code>, attempting to use it prevents the use of the <code>useCapture</code> argument without proper use of <a href="#safely_detecting_option_support">feature detection</a>.</p>
<p>You don’t need to worry about the value of <code>passive</code> for the basic {{event(“scroll”)}} event. Since it can’t be canceled, event listeners can’t block page rendering anyway.</p>
<h2 id="specifications">Specifications</h2>
<p>{{Specifications}}</p>
<h2 id="browser-compatibility">Browser compatibility</h2>
<p>{{Compat}}</p>
<h2 id="see-also">See also</h2>
<ul>
<li>{{domxref(“EventTarget.removeEventListener()”)}}</li>
<li><a href="/en-US/docs/Web/Events/Creating_and_triggering_events">Creating and triggering custom events</a></li>
<li><a href="https://www.quirksmode.org/js/this.html">More details on the use of <code>this</code> in event handlers</a></li>
</ul>
