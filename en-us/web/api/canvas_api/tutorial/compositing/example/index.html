<p>{{CanvasSidebar}}</p>
<p>This sample program demonstrates a number of <a href="/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation">compositing operations</a>. The output looks like this:</p>
<p>{{EmbedLiveSample(“Compositing_example”, “100%”, 7250)}}</p>
<h2 id="compositing-example">Compositing example</h2>
<p>This code sets up the global values used by the rest of the program.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">var</span> canvas1 <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;canvas&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">var</span> canvas2 <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;canvas&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">var</span> gco <span class="op">=</span> [ <span class="st">&#39;source-over&#39;</span><span class="op">,</span><span class="st">&#39;source-in&#39;</span><span class="op">,</span><span class="st">&#39;source-out&#39;</span><span class="op">,</span><span class="st">&#39;source-atop&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">            <span class="st">&#39;destination-over&#39;</span><span class="op">,</span><span class="st">&#39;destination-in&#39;</span><span class="op">,</span><span class="st">&#39;destination-out&#39;</span><span class="op">,</span><span class="st">&#39;destination-atop&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-5" title="5">            <span class="st">&#39;lighter&#39;</span><span class="op">,</span> <span class="st">&#39;copy&#39;</span><span class="op">,</span><span class="st">&#39;xor&#39;</span><span class="op">,</span> <span class="st">&#39;multiply&#39;</span><span class="op">,</span> <span class="st">&#39;screen&#39;</span><span class="op">,</span> <span class="st">&#39;overlay&#39;</span><span class="op">,</span> <span class="st">&#39;darken&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-6" title="6">            <span class="st">&#39;lighten&#39;</span><span class="op">,</span> <span class="st">&#39;color-dodge&#39;</span><span class="op">,</span> <span class="st">&#39;color-burn&#39;</span><span class="op">,</span> <span class="st">&#39;hard-light&#39;</span><span class="op">,</span> <span class="st">&#39;soft-light&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-7" title="7">            <span class="st">&#39;difference&#39;</span><span class="op">,</span> <span class="st">&#39;exclusion&#39;</span><span class="op">,</span> <span class="st">&#39;hue&#39;</span><span class="op">,</span> <span class="st">&#39;saturation&#39;</span><span class="op">,</span> <span class="st">&#39;color&#39;</span><span class="op">,</span> <span class="st">&#39;luminosity&#39;</span></a>
<a class="sourceLine" id="cb1-8" title="8">          ].<span class="at">reverse</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">var</span> gcoText <span class="op">=</span> [</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="st">&#39;This is the default setting and draws new shapes on top of the existing canvas content.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="st">&#39;The new shape is drawn only where both the new shape and the destination canvas overlap. Everything else is made transparent.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="st">&#39;The new shape is drawn where it doesn</span><span class="sc">\&#39;</span><span class="st">t overlap the existing canvas content.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="st">&#39;The new shape is only drawn where it overlaps the existing canvas content.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="st">&#39;New shapes are drawn behind the existing canvas content.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">&#39;The existing canvas content is kept where both the new shape and existing canvas content overlap. Everything else is made transparent.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="st">&#39;The existing content is kept where it doesn</span><span class="sc">\&#39;</span><span class="st">t overlap the new shape.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="st">&#39;The existing canvas is only kept where it overlaps the new shape. The new shape is drawn behind the canvas content.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="st">&#39;Where both shapes overlap the color is determined by adding color values.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="st">&#39;Only the new shape is shown.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="st">&#39;Shapes are made transparent where both overlap and drawn normal everywhere else.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="st">&#39;The pixels of the top layer are multiplied with the corresponding pixel of the bottom layer. A darker picture is the result.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-22" title="22"><span class="st">&#39;The pixels are inverted, multiplied, and inverted again. A lighter picture is the result (opposite of multiply)&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-23" title="23"><span class="st">&#39;A combination of multiply and screen. Dark parts on the base layer become darker, and light parts become lighter.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="st">&#39;Retains the darkest pixels of both layers.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="st">&#39;Retains the lightest pixels of both layers.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-26" title="26"><span class="st">&#39;Divides the bottom layer by the inverted top layer.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-27" title="27"><span class="st">&#39;Divides the inverted bottom layer by the top layer, and then inverts the result.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-28" title="28"><span class="st">&#39;A combination of multiply and screen like overlay, but with top and bottom layer swapped.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-29" title="29"><span class="st">&#39;A softer version of hard-light. Pure black or white does not result in pure black or white.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-30" title="30"><span class="st">&#39;Subtracts the bottom layer from the top layer or the other way round to always get a positive value.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-31" title="31"><span class="st">&#39;Like difference, but with lower contrast.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-32" title="32"><span class="st">&#39;Preserves the luma and chroma of the bottom layer, while adopting the hue of the top layer.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-33" title="33"><span class="st">&#39;Preserves the luma and hue of the bottom layer, while adopting the chroma of the top layer.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-34" title="34"><span class="st">&#39;Preserves the luma of the bottom layer, while adopting the hue and chroma of the top layer.&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-35" title="35"><span class="st">&#39;Preserves the hue and chroma of the bottom layer, while adopting the luma of the top layer.&#39;</span></a>
<a class="sourceLine" id="cb1-36" title="36">          ].<span class="at">reverse</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb1-37" title="37"><span class="kw">var</span> width <span class="op">=</span> <span class="dv">320</span><span class="op">;</span></a>
<a class="sourceLine" id="cb1-38" title="38"><span class="kw">var</span> height <span class="op">=</span> <span class="dv">340</span><span class="op">;</span></a></code></pre></div>
<h3 id="main-program">Main program</h3>
<p>When the page loads, this code runs to set up and run the example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">window</span>.<span class="at">onload</span> <span class="op">=</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="co">// lum in sRGB</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">var</span> lum <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">        <span class="dt">r</span><span class="op">:</span> <span class="fl">0.33</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-5" title="5">        <span class="dt">g</span><span class="op">:</span> <span class="fl">0.33</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-6" title="6">        <span class="dt">b</span><span class="op">:</span> <span class="fl">0.33</span></a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="op">};</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="co">// resize canvas</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="va">canvas1</span>.<span class="at">width</span> <span class="op">=</span> width<span class="op">;</span></a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="va">canvas1</span>.<span class="at">height</span> <span class="op">=</span> height<span class="op">;</span></a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="va">canvas2</span>.<span class="at">width</span> <span class="op">=</span> width<span class="op">;</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="va">canvas2</span>.<span class="at">height</span> <span class="op">=</span> height<span class="op">;</span></a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="at">lightMix</span>()</a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="at">colorSphere</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-15" title="15">    <span class="at">runComposite</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-16" title="16">    <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="op">};</span></a></code></pre></div>
<p>And this code, <code>runComposite()</code>, handles the bulk of the work, relying on a number of utility functions to do the hard parts.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">function</span> <span class="at">createCanvas</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">    var canvas <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;canvas&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="va">canvas</span>.<span class="va">style</span>.<span class="at">background</span> <span class="op">=</span> <span class="st">&quot;url(&quot;</span><span class="op">+</span><span class="va">op_8x8</span>.<span class="at">data</span><span class="op">+</span><span class="st">&quot;)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"> <span class="va">   canvas</span>.<span class="va">style</span>.<span class="at">border</span> <span class="op">=</span> <span class="st">&quot;1px solid #000&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="va">canvas</span>.<span class="va">style</span>.<span class="at">margin</span> <span class="op">=</span> <span class="st">&quot;5px&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="va">canvas</span>.<span class="at">width</span> <span class="op">=</span> width/<span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-7" title="7">    <span class="va">canvas</span>.<span class="at">height</span> <span class="op">=</span> height/<span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="cf">return</span> canvas<span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-10" title="10"></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="kw">function</span> <span class="at">runComposite</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb3-12" title="12">    <span class="kw">var</span> dl <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;dl&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-13" title="13">    <span class="va">document</span>.<span class="va">body</span>.<span class="at">appendChild</span>(dl)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14">    <span class="cf">while</span>(<span class="va">gco</span>.<span class="at">length</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-15" title="15">        <span class="kw">var</span> pop <span class="op">=</span> <span class="va">gco</span>.<span class="at">pop</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-16" title="16">        <span class="kw">var</span> dt <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;dt&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-17" title="17">        <span class="va">dt</span>.<span class="at">textContent</span> <span class="op">=</span> pop<span class="op">;</span></a>
<a class="sourceLine" id="cb3-18" title="18">        <span class="va">dl</span>.<span class="at">appendChild</span>(dt)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-19" title="19">        <span class="kw">var</span> dd <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;dd&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-20" title="20">        <span class="kw">var</span> p <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;p&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-21" title="21">        <span class="va">p</span>.<span class="at">textContent</span> <span class="op">=</span> <span class="va">gcoText</span>.<span class="at">pop</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-22" title="22">        <span class="va">dd</span>.<span class="at">appendChild</span>(p)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-23" title="23"></a>
<a class="sourceLine" id="cb3-24" title="24">        <span class="kw">var</span> canvasToDrawOn <span class="op">=</span> <span class="at">createCanvas</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-25" title="25">        <span class="kw">var</span> canvasToDrawFrom <span class="op">=</span> <span class="at">createCanvas</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-26" title="26">        <span class="kw">var</span> canvasToDrawResult <span class="op">=</span> <span class="at">createCanvas</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-27" title="27"></a>
<a class="sourceLine" id="cb3-28" title="28">        <span class="kw">var</span> ctx <span class="op">=</span> <span class="va">canvasToDrawResult</span>.<span class="at">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-29" title="29">        <span class="va">ctx</span>.<span class="at">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)</a>
<a class="sourceLine" id="cb3-30" title="30">        <span class="va">ctx</span>.<span class="at">save</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-31" title="31">        <span class="va">ctx</span>.<span class="at">drawImage</span>(canvas1<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> height/<span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-32" title="32">        <span class="va">ctx</span>.<span class="at">globalCompositeOperation</span> <span class="op">=</span> pop<span class="op">;</span></a>
<a class="sourceLine" id="cb3-33" title="33">        <span class="va">ctx</span>.<span class="at">drawImage</span>(canvas2<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> height/<span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-34" title="34">        <span class="va">ctx</span>.<span class="at">globalCompositeOperation</span> <span class="op">=</span> <span class="st">&quot;source-over&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-35" title="35">        <span class="va">ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;rgba(0,0,0,0.8)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-36" title="36">        <span class="va">ctx</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span> height/<span class="dv">2</span> <span class="op">-</span> <span class="dv">20</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-37" title="37">        <span class="va">ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;#FFF&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-38" title="38">        <span class="va">ctx</span>.<span class="at">font</span> <span class="op">=</span> <span class="st">&quot;14px arial&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-39" title="39">        <span class="va">ctx</span>.<span class="at">fillText</span>(pop<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> height/<span class="dv">2</span> <span class="op">-</span> <span class="dv">5</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-40" title="40">        <span class="va">ctx</span>.<span class="at">restore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-41" title="41"></a>
<a class="sourceLine" id="cb3-42" title="42">        var ctx <span class="op">=</span> <span class="va">canvasToDrawOn</span>.<span class="at">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="va">        ctx</span>.<span class="at">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)</a>
<a class="sourceLine" id="cb3-44" title="44"><span class="va">        ctx</span>.<span class="at">save</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="va">        ctx</span>.<span class="at">drawImage</span>(canvas1<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> height/<span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="va">        ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;rgba(0,0,0,0.8)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="va">        ctx</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span> height/<span class="dv">2</span> <span class="op">-</span> <span class="dv">20</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="va">        ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;#FFF&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="va">        ctx</span>.<span class="at">font</span> <span class="op">=</span> <span class="st">&quot;14px arial&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="va">        ctx</span>.<span class="at">fillText</span>(<span class="st">&#39;existing content&#39;</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> height/<span class="dv">2</span> <span class="op">-</span> <span class="dv">5</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="va">        ctx</span>.<span class="at">restore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-52" title="52"></a>
<a class="sourceLine" id="cb3-53" title="53">        var ctx <span class="op">=</span> <span class="va">canvasToDrawFrom</span>.<span class="at">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-54" title="54"><span class="va">        ctx</span>.<span class="at">clearRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> height)</a>
<a class="sourceLine" id="cb3-55" title="55"><span class="va">        ctx</span>.<span class="at">save</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-56" title="56"><span class="va">        ctx</span>.<span class="at">drawImage</span>(canvas2<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> height/<span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-57" title="57"><span class="va">        ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;rgba(0,0,0,0.8)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-58" title="58"><span class="va">        ctx</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span> height/<span class="dv">2</span> <span class="op">-</span> <span class="dv">20</span><span class="op">,</span> width/<span class="dv">2</span><span class="op">,</span> <span class="dv">20</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="va">        ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;#FFF&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-60" title="60"><span class="va">        ctx</span>.<span class="at">font</span> <span class="op">=</span> <span class="st">&quot;14px arial&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-61" title="61"><span class="va">        ctx</span>.<span class="at">fillText</span>(<span class="st">&#39;new content&#39;</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> height/<span class="dv">2</span> <span class="op">-</span> <span class="dv">5</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="va">        ctx</span>.<span class="at">restore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-63" title="63"></a>
<a class="sourceLine" id="cb3-64" title="64">        <span class="va">dd</span>.<span class="at">appendChild</span>(canvasToDrawOn)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-65" title="65">        <span class="va">dd</span>.<span class="at">appendChild</span>(canvasToDrawFrom)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-66" title="66">        <span class="va">dd</span>.<span class="at">appendChild</span>(canvasToDrawResult)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-67" title="67"></a>
<a class="sourceLine" id="cb3-68" title="68">        <span class="va">dl</span>.<span class="at">appendChild</span>(dd)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-69" title="69">    <span class="op">}</span></a>
<a class="sourceLine" id="cb3-70" title="70"><span class="op">};</span></a></code></pre></div>
<h3 id="utility-functions">Utility functions</h3>
<p>The program relies on a number of utility functions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> lightMix <span class="op">=</span> <span class="kw">function</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">    var ctx <span class="op">=</span> <span class="va">canvas2</span>.<span class="at">getContext</span>(<span class="st">&quot;2d&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3">   <span class="va"> ctx</span>.<span class="at">save</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4">   <span class="va"> ctx</span>.<span class="at">globalCompositeOperation</span> <span class="op">=</span> <span class="st">&quot;lighter&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5">   <span class="va"> ctx</span>.<span class="at">beginPath</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" title="6">   <span class="va"> ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;rgba(255,0,0,1)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-7" title="7">   <span class="va"> ctx</span>.<span class="at">arc</span>(<span class="dv">100</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="va">Math</span>.<span class="at">PI</span><span class="op">*</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-8" title="8">   <span class="va"> ctx</span>.<span class="at">fill</span>()</a>
<a class="sourceLine" id="cb4-9" title="9">   <span class="va"> ctx</span>.<span class="at">beginPath</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-10" title="10">   <span class="va"> ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;rgba(0,0,255,1)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-11" title="11">   <span class="va"> ctx</span>.<span class="at">arc</span>(<span class="dv">220</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="va">Math</span>.<span class="at">PI</span><span class="op">*</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-12" title="12">   <span class="va"> ctx</span>.<span class="at">fill</span>()</a>
<a class="sourceLine" id="cb4-13" title="13">   <span class="va"> ctx</span>.<span class="at">beginPath</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-14" title="14">   <span class="va"> ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;rgba(0,255,0,1)&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-15" title="15">   <span class="va"> ctx</span>.<span class="at">arc</span>(<span class="dv">160</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="va">Math</span>.<span class="at">PI</span><span class="op">*</span><span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-16" title="16">   <span class="va"> ctx</span>.<span class="at">fill</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-17" title="17">   <span class="va"> ctx</span>.<span class="at">restore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-18" title="18">   <span class="va"> ctx</span>.<span class="at">beginPath</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-19" title="19">   <span class="va"> ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;#f00&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-20" title="20">   <span class="va"> ctx</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">30</span><span class="op">,</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb4-21" title="21">   <span class="va"> ctx</span>.<span class="at">fill</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span> colorSphere <span class="op">=</span> <span class="kw">function</span>(element) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">    var ctx <span class="op">=</span> <span class="va">canvas1</span>.<span class="at">getContext</span>(<span class="st">&quot;2d&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3">    var width <span class="op">=</span> <span class="dv">360</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4">    var halfWidth <span class="op">=</span> width / <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5">    var rotate <span class="op">=</span> (<span class="dv">1</span> / <span class="dv">360</span>) <span class="op">*</span> <span class="va">Math</span>.<span class="at">PI</span> <span class="op">*</span> <span class="dv">2</span><span class="op">;</span> <span class="co">// per degree</span></a>
<a class="sourceLine" id="cb5-6" title="6">    var offset <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// scrollbar offset</span></a>
<a class="sourceLine" id="cb5-7" title="7">    var oleft <span class="op">=</span> <span class="dv">-20</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-8" title="8">    var otop <span class="op">=</span> <span class="dv">-20</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-9" title="9">   <span class="at"> for</span> (<span class="kw">var</span> n <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> n <span class="op">&lt;=</span> <span class="dv">359</span><span class="op">;</span> n <span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb5-10" title="10">        var gradient <span class="op">=</span> <span class="va">ctx</span>.<span class="at">createLinearGradient</span>(oleft <span class="op">+</span> halfWidth<span class="op">,</span> otop<span class="op">,</span> oleft <span class="op">+</span> halfWidth<span class="op">,</span> otop <span class="op">+</span> halfWidth)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-11" title="11">        var color <span class="op">=</span> <span class="va">Color</span>.<span class="at">HSV_RGB</span>(<span class="op">{</span> <span class="dt">H</span><span class="op">:</span> (n <span class="op">+</span> <span class="dv">300</span>) <span class="op">%</span> <span class="dv">360</span><span class="op">,</span> <span class="dt">S</span><span class="op">:</span> <span class="dv">100</span><span class="op">,</span> <span class="dt">V</span><span class="op">:</span> <span class="dv">100</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-12" title="12">       <span class="va"> gradient</span>.<span class="at">addColorStop</span>(<span class="dv">0</span><span class="op">,</span> <span class="st">&quot;rgba(0,0,0,0)&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-13" title="13">       <span class="va"> gradient</span>.<span class="at">addColorStop</span>(<span class="fl">0.7</span><span class="op">,</span> <span class="st">&quot;rgba(&quot;</span><span class="op">+</span><span class="va">color</span>.<span class="at">R</span><span class="op">+</span><span class="st">&quot;,&quot;</span><span class="op">+</span><span class="va">color</span>.<span class="at">G</span><span class="op">+</span><span class="st">&quot;,&quot;</span><span class="op">+</span><span class="va">color</span>.<span class="at">B</span><span class="op">+</span><span class="st">&quot;,1)&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-14" title="14">       <span class="va"> gradient</span>.<span class="at">addColorStop</span>(<span class="dv">1</span><span class="op">,</span> <span class="st">&quot;rgba(255,255,255,1)&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-15" title="15">       <span class="va"> ctx</span>.<span class="at">beginPath</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-16" title="16">       <span class="va"> ctx</span>.<span class="at">moveTo</span>(oleft <span class="op">+</span> halfWidth<span class="op">,</span> otop)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-17" title="17">       <span class="va"> ctx</span>.<span class="at">lineTo</span>(oleft <span class="op">+</span> halfWidth<span class="op">,</span> otop <span class="op">+</span> halfWidth)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-18" title="18">       <span class="va"> ctx</span>.<span class="at">lineTo</span>(oleft <span class="op">+</span> halfWidth <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> otop)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-19" title="19">       <span class="va"> ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> gradient<span class="op">;</span></a>
<a class="sourceLine" id="cb5-20" title="20">       <span class="va"> ctx</span>.<span class="at">fill</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-21" title="21">       <span class="va"> ctx</span>.<span class="at">translate</span>(oleft <span class="op">+</span> halfWidth<span class="op">,</span> otop <span class="op">+</span> halfWidth)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-22" title="22">       <span class="va"> ctx</span>.<span class="at">rotate</span>(rotate)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-23" title="23">       <span class="va"> ctx</span>.<span class="at">translate</span>(<span class="op">-</span>(oleft <span class="op">+</span> halfWidth)<span class="op">,</span> <span class="op">-</span>(otop <span class="op">+</span> halfWidth))<span class="op">;</span></a>
<a class="sourceLine" id="cb5-24" title="24">    <span class="op">}</span></a>
<a class="sourceLine" id="cb5-25" title="25">   <span class="va"> ctx</span>.<span class="at">beginPath</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-26" title="26">   <span class="va"> ctx</span>.<span class="at">fillStyle</span> <span class="op">=</span> <span class="st">&quot;#00f&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-27" title="27">   <span class="va"> ctx</span>.<span class="at">fillRect</span>(<span class="dv">15</span><span class="op">,</span><span class="dv">15</span><span class="op">,</span><span class="dv">30</span><span class="op">,</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb5-28" title="28">   <span class="va"> ctx</span>.<span class="at">fill</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-29" title="29">    return <span class="va">ctx</span>.<span class="at">canvas</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-30" title="30"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// HSV (1978) = H: Hue / S: Saturation / V: Value</span></a>
<a class="sourceLine" id="cb6-2" title="2">Color <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="va">Color</span>.<span class="at">HSV_RGB</span> <span class="op">=</span> <span class="kw">function</span> (o) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">    var H <span class="op">=</span> <span class="va">o</span>.<span class="at">H</span> / <span class="dv">360</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-5" title="5">        S <span class="op">=</span> <span class="va">o</span>.<span class="at">S</span> / <span class="dv">100</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">        V <span class="op">=</span> <span class="va">o</span>.<span class="at">V</span> / <span class="dv">100</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-7" title="7">        R<span class="op">,</span> G<span class="op">,</span> B<span class="op">;</span></a>
<a class="sourceLine" id="cb6-8" title="8">    var A<span class="op">,</span> B<span class="op">,</span> C<span class="op">,</span> D<span class="op">;</span></a>
<a class="sourceLine" id="cb6-9" title="9">   <span class="at"> if</span> (S <span class="op">==</span> <span class="dv">0</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-10" title="10">        R <span class="op">=</span> G <span class="op">=</span> B <span class="op">=</span> <span class="va">Math</span>.<span class="at">round</span>(V <span class="op">*</span> <span class="dv">255</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-11" title="11">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-12" title="12">       <span class="at"> if</span> (H <span class="op">&gt;=</span> <span class="dv">1</span>) H <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-13" title="13">        H <span class="op">=</span> <span class="dv">6</span> <span class="op">*</span> H<span class="op">;</span></a>
<a class="sourceLine" id="cb6-14" title="14">        D <span class="op">=</span> H <span class="op">-</span> <span class="va">Math</span>.<span class="at">floor</span>(H)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-15" title="15">        A <span class="op">=</span> <span class="va">Math</span>.<span class="at">round</span>(<span class="dv">255</span> <span class="op">*</span> V <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> S))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-16" title="16">        B <span class="op">=</span> <span class="va">Math</span>.<span class="at">round</span>(<span class="dv">255</span> <span class="op">*</span> V <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (S <span class="op">*</span> D)))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-17" title="17">        C <span class="op">=</span> <span class="va">Math</span>.<span class="at">round</span>(<span class="dv">255</span> <span class="op">*</span> V <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> (S <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> D))))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-18" title="18">        V <span class="op">=</span> <span class="va">Math</span>.<span class="at">round</span>(<span class="dv">255</span> <span class="op">*</span> V)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-19" title="19">       <span class="at"> switch</span> (<span class="va">Math</span>.<span class="at">floor</span>(H)) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-20" title="20">            case <span class="dv">0</span><span class="op">:</span></a>
<a class="sourceLine" id="cb6-21" title="21">                R <span class="op">=</span> V<span class="op">;</span></a>
<a class="sourceLine" id="cb6-22" title="22">                G <span class="op">=</span> C<span class="op">;</span></a>
<a class="sourceLine" id="cb6-23" title="23">                B <span class="op">=</span> A<span class="op">;</span></a>
<a class="sourceLine" id="cb6-24" title="24">                break<span class="op">;</span></a>
<a class="sourceLine" id="cb6-25" title="25">            case <span class="dv">1</span><span class="op">:</span></a>
<a class="sourceLine" id="cb6-26" title="26">                R <span class="op">=</span> B<span class="op">;</span></a>
<a class="sourceLine" id="cb6-27" title="27">                G <span class="op">=</span> V<span class="op">;</span></a>
<a class="sourceLine" id="cb6-28" title="28">                B <span class="op">=</span> A<span class="op">;</span></a>
<a class="sourceLine" id="cb6-29" title="29">                break<span class="op">;</span></a>
<a class="sourceLine" id="cb6-30" title="30">            case <span class="dv">2</span><span class="op">:</span></a>
<a class="sourceLine" id="cb6-31" title="31">                R <span class="op">=</span> A<span class="op">;</span></a>
<a class="sourceLine" id="cb6-32" title="32">                G <span class="op">=</span> V<span class="op">;</span></a>
<a class="sourceLine" id="cb6-33" title="33">                B <span class="op">=</span> C<span class="op">;</span></a>
<a class="sourceLine" id="cb6-34" title="34">                break<span class="op">;</span></a>
<a class="sourceLine" id="cb6-35" title="35">            case <span class="dv">3</span><span class="op">:</span></a>
<a class="sourceLine" id="cb6-36" title="36">                R <span class="op">=</span> A<span class="op">;</span></a>
<a class="sourceLine" id="cb6-37" title="37">                G <span class="op">=</span> B<span class="op">;</span></a>
<a class="sourceLine" id="cb6-38" title="38">                B <span class="op">=</span> V<span class="op">;</span></a>
<a class="sourceLine" id="cb6-39" title="39">                break<span class="op">;</span></a>
<a class="sourceLine" id="cb6-40" title="40">            case <span class="dv">4</span><span class="op">:</span></a>
<a class="sourceLine" id="cb6-41" title="41">                R <span class="op">=</span> C<span class="op">;</span></a>
<a class="sourceLine" id="cb6-42" title="42">                G <span class="op">=</span> A<span class="op">;</span></a>
<a class="sourceLine" id="cb6-43" title="43">                B <span class="op">=</span> V<span class="op">;</span></a>
<a class="sourceLine" id="cb6-44" title="44">                break<span class="op">;</span></a>
<a class="sourceLine" id="cb6-45" title="45">            case <span class="dv">5</span><span class="op">:</span></a>
<a class="sourceLine" id="cb6-46" title="46">                R <span class="op">=</span> V<span class="op">;</span></a>
<a class="sourceLine" id="cb6-47" title="47">                G <span class="op">=</span> A<span class="op">;</span></a>
<a class="sourceLine" id="cb6-48" title="48">                B <span class="op">=</span> B<span class="op">;</span></a>
<a class="sourceLine" id="cb6-49" title="49">                break<span class="op">;</span></a>
<a class="sourceLine" id="cb6-50" title="50">        <span class="op">}</span></a>
<a class="sourceLine" id="cb6-51" title="51">    <span class="op">}</span></a>
<a class="sourceLine" id="cb6-52" title="52">    return <span class="op">{</span></a>
<a class="sourceLine" id="cb6-53" title="53">       <span class="dt"> R</span><span class="op">:</span> R<span class="op">,</span></a>
<a class="sourceLine" id="cb6-54" title="54">       <span class="dt"> G</span><span class="op">:</span> G<span class="op">,</span></a>
<a class="sourceLine" id="cb6-55" title="55">       <span class="dt"> B</span><span class="op">:</span> B</a>
<a class="sourceLine" id="cb6-56" title="56">    <span class="op">};</span></a>
<a class="sourceLine" id="cb6-57" title="57"><span class="op">};</span></a>
<a class="sourceLine" id="cb6-58" title="58"></a>
<a class="sourceLine" id="cb6-59" title="59"><span class="kw">var</span> createInterlace <span class="op">=</span> <span class="kw">function</span> (size<span class="op">,</span> color1<span class="op">,</span> color2) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-60" title="60">    var proto <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&quot;canvas&quot;</span>).<span class="at">getContext</span>(<span class="st">&quot;2d&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-61" title="61">   <span class="va"> proto</span>.<span class="va">canvas</span>.<span class="at">width</span> <span class="op">=</span> size <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-62" title="62">   <span class="va"> proto</span>.<span class="va">canvas</span>.<span class="at">height</span> <span class="op">=</span> size <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-63" title="63">   <span class="va"> proto</span>.<span class="at">fillStyle</span> <span class="op">=</span> color1<span class="op">;</span> <span class="co">// top-left</span></a>
<a class="sourceLine" id="cb6-64" title="64">   <span class="va"> proto</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> size<span class="op">,</span> size)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-65" title="65">   <span class="va"> proto</span>.<span class="at">fillStyle</span> <span class="op">=</span> color2<span class="op">;</span> <span class="co">// top-right</span></a>
<a class="sourceLine" id="cb6-66" title="66">   <span class="va"> proto</span>.<span class="at">fillRect</span>(size<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> size<span class="op">,</span> size)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-67" title="67">   <span class="va"> proto</span>.<span class="at">fillStyle</span> <span class="op">=</span> color2<span class="op">;</span> <span class="co">// bottom-left</span></a>
<a class="sourceLine" id="cb6-68" title="68">   <span class="va"> proto</span>.<span class="at">fillRect</span>(<span class="dv">0</span><span class="op">,</span> size<span class="op">,</span> size<span class="op">,</span> size)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-69" title="69">   <span class="va"> proto</span>.<span class="at">fillStyle</span> <span class="op">=</span> color1<span class="op">;</span> <span class="co">// bottom-right</span></a>
<a class="sourceLine" id="cb6-70" title="70">   <span class="va"> proto</span>.<span class="at">fillRect</span>(size<span class="op">,</span> size<span class="op">,</span> size<span class="op">,</span> size)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-71" title="71">    var pattern <span class="op">=</span> <span class="va">proto</span>.<span class="at">createPattern</span>(<span class="va">proto</span>.<span class="at">canvas</span><span class="op">,</span> <span class="st">&quot;repeat&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-72" title="72">   <span class="va"> pattern</span>.<span class="at">data</span> <span class="op">=</span> <span class="va">proto</span>.<span class="va">canvas</span>.<span class="at">toDataURL</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-73" title="73">    return pattern<span class="op">;</span></a>
<a class="sourceLine" id="cb6-74" title="74"><span class="op">};</span></a>
<a class="sourceLine" id="cb6-75" title="75"></a>
<a class="sourceLine" id="cb6-76" title="76"><span class="kw">var</span> op_8x8 <span class="op">=</span> <span class="at">createInterlace</span>(<span class="dv">8</span><span class="op">,</span> <span class="st">&quot;#FFF&quot;</span><span class="op">,</span> <span class="st">&quot;#eee&quot;</span>)<span class="op">;</span></a></code></pre></div>
