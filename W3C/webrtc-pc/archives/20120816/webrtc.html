<!DOCTYPE html>
<html lang="en">
<head>
  <title>WebRTC 1.0: Real-time Communication Between Browsers</title>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <!--
     After making changes to this document in the github repo, run:
      ./publish.sh webrtc.html
    to publish a new editor's draft to the W3C CVS. This assumes your
    CVS checkout is located at ../2011/webrtc, you can specify the location
    as the second argument, for example:
      ./publish.sh webrtc.html ~/path/to/w3/2011/webrtc
  -->

  
  
<style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}


/* --- --- */
ol.algorithm { counter-reset:numsection; list-style-type: none; }
ol.algorithm li { margin: 0.5em 0; }
ol.algorithm li:before { font-weight: bold; counter-increment: numsection; content: counters(numsection, ".") ") "; }

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}
</style><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #52e052; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><style>/* HIGHLIGHTS */
code.prettyprint {
    color:  inherit;
}

/* this from google-code-prettify */
.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.attributes dd, .methods dd, .constants dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet"><!--[if lt IE 9]><script src='undefined://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>

<body><div class="head">
  <p>
    
      <a href="http://www.w3.org/"><img src="http://www.w3.org/Icons/w3c_home" alt="W3C" height="48" width="72"></a>
    
  </p>
  <h1 class="title" id="title">WebRTC 1.0: Real-time Communication Between Browsers</h1>
  
  <h2 id="w3c-editor-s-draft-16-august-2012"><acronym title="World Wide Web Consortium">W3C</acronym> Editor's Draft 16 August 2012</h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a href="http://dev.w3.org/2011/webrtc/editor/webrtc.html">http://dev.w3.org/2011/webrtc/editor/webrtc.html</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/webrtc/">http://www.w3.org/TR/webrtc/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://dev.w3.org/2011/webrtc/editor/webrtc.html">http://dev.w3.org/2011/webrtc/editor/webrtc.html</a></dd>
    
      <dt>Previous version:</dt>
      <dd><a href="http://dev.w3.org/2011/webrtc/editor/archives/20120813/webrtc.html">http://dev.w3.org/2011/webrtc/editor/archives/20120813/webrtc.html</a></dd>

    <dt>Editors:</dt>
    <dd><span>Adam Bergkvist</span>, Ericsson</dd>
<dd><span>Daniel C. Burnett</span>, Voxeo</dd>
<dd><span>Cullen Jennings</span>, Cisco</dd>
<dd><span>Anant Narayanan</span>, Mozilla</dd>

    
  </dl>
  
  
  
  
    
      <p class="copyright">Initial Author of this Specification was Ian Hickson, Google Inc., with the following copyright statement:<br> © Copyright 2004-2011 Apple Computer, Inc., Mozilla Foundation, and Opera Software ASA. You are granted a license to use, reproduce and create derivative works of this document.</p> <p class="copyright">All subsequent changes since 26 July 2011 done by the <acronym title="World Wide Web Consortium">W3C</acronym> WebRTC Working Group are under the following <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>:<br>© 2011-2012 <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>, <a href="http://www.ercim.eu/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. <a href="http://www.w3.org/Consortium/Legal/copyright-documents">Document use</a>  rules apply.</p> <p class="copyright">For the entire publication on the <acronym title="World Wide Web Consortium">W3C</acronym> site the <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a> and <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> rules apply.</p>
    
  
  <hr>
</div>
  <section class="introductory" id="abstract"><h2>Abstract</h2>
    <p>This document defines a set of ECMAScript APIs in WebIDL to allow media
    to be sent over the network to another browser or device implementing the
    appropriate set of real-time protocols, and media to be received from
    another browser or device. This specification is being developed in
    conjunction with a protocol specification developed by the IETF RTCWEB group
    and an API specification to get access to local media devices developed by
    the Media Capture Task Force.</p>
  </section><section id="sotd" class="introductory"><h2>Status of This Document</h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication. Other
          documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the latest revision
          of this technical report can be found in the <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym> technical reports
          index</a> at http://www.w3.org/TR/.</em>
        </p>
        
    <p>This document is not complete. It is subject to major changes and, while
    early experimentation is encouraged, it is therefore not intended for
    implementation. The API is based on preliminary work done in the WHATWG.
    The Web Real-Time Communications Working Group expects this specification
    to evolve significantly based on:</p>

    <ul>
      <li>The outcome of ongoing exchanges in the companion RTCWEB group at
      IETF to define the set of protocols that, together with this document,
      will enable real-time communications in Web browsers.</li>

      <li>Privacy issues that arise when exposing local capabilities and local
      streams.</li>

      <li>Technical discussions within the group, on the data channel in
      particular.</li>

      <li>Experience gained through early experimentations.</li>

      <li>Feedback received from other groups and individuals.</li>
    </ul>
  
        <p>
          This document was published by the <a href="http://www.w3.org/2011/04/webrtc/">Web Real-Time Communications Working Group</a> as an Editor's Draft.
          
          If you wish to make comments regarding this document, please send them to 
          <a href="mailto:public-webrtc@w3.org">public-webrtc@w3.org</a> 
          (<a href="mailto:public-webrtc-request@w3.org?subject=subscribe">subscribe</a>,
          <a href="http://lists.w3.org/Archives/Public/public-webrtc/">archives</a>).
          
          
          All feedback is welcome.
        </p>
        
          <p>
            Publication as an Editor's Draft does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym> Membership.
            This is a draft document and may be updated, replaced or obsoleted by other documents at 
            any time. It is inappropriate to cite this document as other than work in progress.
          </p>
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
          
          
          
            
              <acronym title="World Wide Web Consortium">W3C</acronym> maintains a <a href="http://www.w3.org/2004/01/pp-impl/47318/status" rel="disclosure">public list of any patent disclosures</a> 
            
            made in connection with the deliverables of the group; that page also includes instructions for 
            disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the
            information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
          
          
        </p>
        
      
    
  
</section><section id="toc"><h2 class="introductory">Table of Contents</h2><ul class="toc"><li class="tocline"><a class="tocxref" href="#intro"><span class="secno">1. </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#conformance"><span class="secno">2. </span>Conformance</a></li><li class="tocline"><a class="tocxref" href="#terminology"><span class="secno">3. </span>Terminology</a></li><li class="tocline"><a class="tocxref" href="#network-stream-api"><span class="secno">4. </span>Network Stream API</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#introduction"><span class="secno">4.1 </span>Introduction</a></li><li class="tocline"><a class="tocxref" href="#interface-definitions"><span class="secno">4.2 </span>Interface definitions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#mediastream"><span class="secno">4.2.1 </span>MediaStream</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#label"><span class="secno">4.2.1.1 </span>label</a></li><li class="tocline"><a class="tocxref" href="#events-on-mediastream"><span class="secno">4.2.1.2 </span>Events on MediaStream</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamtrack"><span class="secno">4.2.2 </span>MediaStreamTrack</a></li></ul></li><li class="tocline"><a class="tocxref" href="#audiomediastreamtrack"><span class="secno">4.3 </span>AudioMediaStreamTrack</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes"><span class="secno">4.3.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods"><span class="secno">4.3.2 </span>Methods</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#peer-to-peer-connections"><span class="secno">5. </span>Peer-to-peer connections</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcpeerconnection"><span class="secno">5.1 </span>RTCPeerConnection</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcsdptype"><span class="secno">5.1.1 </span>RTCSdpType</a></li><li class="tocline"><a class="tocxref" href="#rtcsessiondescription-class"><span class="secno">5.1.2 </span>RTCSessionDescription Class</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-1"><span class="secno">5.1.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-1"><span class="secno">5.1.2.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcsessiondescriptioninit-members"><span class="secno">5.1.2.3 </span>Dictionary <span class="formerLink"><code>RTCSessionDescriptionInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcsessiondescriptioncallback"><span class="secno">5.1.3 </span>RTCSessionDescriptionCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-rtcsessiondescriptioncallback-parameters"><span class="secno">5.1.3.1 </span>Callback <span class="formerLink"><code>RTCSessionDescriptionCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcvoidcallback"><span class="secno">5.1.4 </span>RTCVoidCallback</a></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnectionerrorcallback"><span class="secno">5.1.5 </span>RTCPeerConnectionErrorCallback</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#callback-rtcpeerconnectionerrorcallback-parameters"><span class="secno">5.1.5.1 </span>Callback <span class="formerLink"><code>RTCPeerConnectionErrorCallback</code></span> Parameters</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcpeerstate-enum"><span class="secno">5.1.6 </span>RTCPeerState Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcicestate-enum"><span class="secno">5.1.7 </span>RTCIceState Enum</a></li><li class="tocline"><a class="tocxref" href="#rtcicecandidate-type"><span class="secno">5.1.8 </span>RTCIceCandidate Type</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-2"><span class="secno">5.1.8.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-2"><span class="secno">5.1.8.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcicecandidateinit-members"><span class="secno">5.1.8.3 </span>Dictionary <span class="formerLink"><code>RTCIceCandidateInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtciceserver-type"><span class="secno">5.1.9 </span>RTCIceServer Type</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtciceserver-members"><span class="secno">5.1.9.1 </span>Dictionary <span class="formerLink"><code>RTCIceServer</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcconfiguration-type"><span class="secno">5.1.10 </span>RTCConfiguration Type</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#dictionary-rtciceserver-members-1"><span class="secno">5.1.10.1 </span>Dictionary <span class="formerLink"><code>RTCIceServer</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#rtcpeerconnection-interface"><span class="secno">5.1.11 </span>RTCPeerConnection Interface</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#iana-registrations"><span class="secno">6. </span>IANA Registrations</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#constraints"><span class="secno">6.1 </span>Constraints</a></li></ul></li><li class="tocline"><a class="tocxref" href="#simple-example"><span class="secno">7. </span>Simple Example</a></li><li class="tocline"><a class="tocxref" href="#advanced-example"><span class="secno">8. </span>Advanced Example</a></li><li class="tocline"><a class="tocxref" href="#call-flow-browser-to-browser"><span class="secno">9. </span>Call Flow Browser to Browser</a></li><li class="tocline"><a class="tocxref" href="#call-flow-browser-to-mcu"><span class="secno">10. </span>Call Flow Browser to MCU </a></li><li class="tocline"><a class="tocxref" href="#peer-to-peer-data-api"><span class="secno">11. </span>Peer-to-peer Data API</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#datachannel"><span class="secno">11.1 </span>DataChannel</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-3"><span class="secno">11.1.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#methods-3"><span class="secno">11.1.2 </span>Methods</a></li><li class="tocline"><a class="tocxref" href="#dictionary-datachannelinit-members"><span class="secno">11.1.3 </span>Dictionary <span class="formerLink"><code>DataChannelInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#examples"><span class="secno">11.2 </span>Examples</a></li></ul></li><li class="tocline"><a class="tocxref" href="#garbage-collection"><span class="secno">12. </span>Garbage collection</a></li><li class="tocline"><a class="tocxref" href="#event-definitions"><span class="secno">13. </span>Event definitions</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#rtcpeerconnectioniceevent"><span class="secno">13.1 </span>RTCPeerConnectionIceEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-4"><span class="secno">13.1.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-rtcpeerconnectioniceeventinit-members"><span class="secno">13.1.2 </span>Dictionary <span class="formerLink"><code>RTCPeerConnectionIceEventInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamtrackevent"><span class="secno">13.2 </span>MediaStreamTrackEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-5"><span class="secno">13.2.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-mediastreamtrackeventinit-members"><span class="secno">13.2.2 </span>Dictionary <span class="formerLink"><code>MediaStreamTrackEventInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#mediastreamevent"><span class="secno">13.3 </span>MediaStreamEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-6"><span class="secno">13.3.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-mediastreameventinit-members"><span class="secno">13.3.2 </span>Dictionary <span class="formerLink"><code>MediaStreamEventInit</code></span> Members</a></li></ul></li><li class="tocline"><a class="tocxref" href="#datachannelevent"><span class="secno">13.4 </span>DataChannelEvent</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#attributes-7"><span class="secno">13.4.1 </span>Attributes</a></li><li class="tocline"><a class="tocxref" href="#dictionary-datachanneleventinit-members"><span class="secno">13.4.2 </span>Dictionary <span class="formerLink"><code>DataChannelEventInit</code></span> Members</a></li></ul></li></ul></li><li class="tocline"><a class="tocxref" href="#event-summary"><span class="secno">14. </span>Event summary</a></li><li class="tocline"><a class="tocxref" href="#security-considerations"><span class="secno">15. </span>Security Considerations</a></li><li class="tocline"><a class="tocxref" href="#change-log"><span class="secno">16. </span>Change Log</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><span class="secno">A. </span>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><span class="secno">B. </span>References</a><ul class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><span class="secno">B.1 </span>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><span class="secno">B.2 </span>Informative references</a></li></ul></li></ul></section>

  

  <section class="informative" id="intro">
    <!--OddPage--><h2><span class="secno">1. </span>Introduction</h2><p><em>This section is non-normative.</em></p>

    <p>There are a number of facets to video-conferencing in HTML covered by
    this specification:</p>

    <ul>
      <li>Representing a multimedia stream (video, audio, or both) from local
      devices (video cameras, microphones, Web cams) or from prerecorded files
      provided by the user.</li>

      <li>Connecting to remote peers using NAT-traversal technologies such as
      ICE, STUN, and TURN.</li>

      <li>Sending the locally-produced streams to remote peers and receiving
      streams from remote peers.</li>

      <li>Sending arbitrary data directly to remote peers.</li>
    </ul>

    <p>This document defines the APIs used for these features. This
    specification is being developed in conjunction with a protocol
    specification developed by the <a href="http://datatracker.ietf.org/wg/rtcweb/">IETF RTCWEB group</a> and an API
    specification to get access to local media devices developed by the
    <a href="http://www.w3.org/2011/04/webrtc/">Media Capture Task
    Force</a>.</p>
  </section>

  <section id="conformance"><!--OddPage--><h2><span class="secno">2. </span>Conformance</h2>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p>
  The key words <em title="must" class="rfc2119">must</em>, <em title="must not" class="rfc2119">must not</em>, <em title="required" class="rfc2119">required</em>, <em title="should" class="rfc2119">should</em>, <em title="should not" class="rfc2119">should not</em>, <em title="recommended" class="rfc2119">recommended</em>, <em title="may" class="rfc2119">may</em>,
  and <em title="optional" class="rfc2119">optional</em> in this specification are to be interpreted as described in [<cite><a href="#bib-RFC2119" class="bibref">RFC2119</a></cite>].
</p>

    <p>This specification defines conformance criteria that apply to a single
    product: the <dfn id="dfn-user-agent">user agent</dfn> that implements the interfaces that it
    contains.</p>

    <p>Implementations that use ECMAScript to implement the APIs defined in
    this specification must implement them in a manner consistent with the
    ECMAScript Bindings defined in the Web IDL specification [<cite><a href="#bib-WEBIDL" class="bibref">WEBIDL</a></cite>], as
    this specification uses that specification and terminology.</p>
  </section>

  <section id="terminology">
    <!--OddPage--><h2><span class="secno">3. </span>Terminology</h2>

    <p>The <code><a href="http://dev.w3.org/html5/spec/webappapis.html#eventhandler">EventHandler</a></code>
    interface represents a callback used for event handlers as defined in
    [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

    <p>The concepts <dfn id="dfn-queue-a-task"><a href="http://dev.w3.org/html5/spec/webappapis.html#queue-a-task">queue a
    task</a></dfn> and <dfn id="dfn-fires-a-simple-event"><a href="http://dev.w3.org/html5/spec/webappapis.html#fire-a-simple-event">fires a
    simple event</a></dfn> are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>

    <p>The terms <dfn id="dfn-event-handlers"><a href="http://dev.w3.org/html5/spec/webappapis.html#event-handlers">event
    handlers</a></dfn> and <dfn id="dfn-event-handler-event-types"><a href="http://dev.w3.org/html5/spec/webappapis.html#event-handler-event-type">event
    handler event types</a></dfn> are defined in [<cite><a href="#bib-HTML5" class="bibref">HTML5</a></cite>].</p>
  </section>

  <section id="network-stream-api">
    <!--OddPage--><h2><span class="secno">4. </span>Network Stream API</h2>

    <section id="introduction">
      <h3><span class="secno">4.1 </span>Introduction</h3>

      <p>The <code>MediaStream</code> interface, as defined in the
      [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] specification, typically represents a stream of data of
      audio and/or video. A <code>MediaStream</code> may be extended to
      represent a stream that either comes from or is sent to a remote node
      (and not just the local camera, for instance). The extensions required to
      enable this capability on the <code>MediaStream</code> object will be
      described in this document.</p>

      <p>A <code>MediaStream</code> as defined in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] may contain
      zero or more <code>MediaStreamTrack</code> objects. A
      <code>MediaStreamTrack</code> sent to another peer will appear as one and
      only one <code>MediaStreamTrack</code> to the recipient. A peer is
      defined as a user agent that supports this specification.</p>

      <p>Channels are the smallest unit considered in the
      <code>MediaStream</code> specification. Channels are intended to be
      encoded together for transmission as, for instance, an RTP payload type.
      All of the channels that a codec needs to encode jointly <em title="must" class="rfc2119">must</em> be in the
      same <code>MediaStreamTrack</code> and the codecs <em title="should" class="rfc2119">should</em> be able to
      encode, or discard, all the channels in the track.</p>

      <p>The concepts of an input and output to a given
      <code>MediaStream</code> apply in the case of <code>MediaStream</code>
      objects transmitted over the network as well. A
      <code><a>MediaStream</a></code> created by a
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object (later described in this
      document) will take as input the data received from a remote peer.
      Similarly, a <code>MediaStream</code> from a local source, for instance a
      camera via [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] will have an output that represents what is
      transmitted to a remote peer if the object is used with a
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

      <p>The concept of duplicating <code>MediaStream</code> objects as
      described in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] is also applicable here. This feature can
      be used, for instance, in a video-conferencing scenario to display the
      local video from the user’s camera and microphone in a local monitor,
      while only transmitting the audio to the remote peer (e.g. in response to
      the user using a "video mute" feature). Combining tracks from different
      <code><a>MediaStream</a></code> objects into a new
      <code><a>MediaStream</a></code> is useful in certain cases.</p>
    </section>

    <section id="interface-definitions">
      <h3><span class="secno">4.2 </span>Interface definitions</h3>

      <div class="note"><div class="note-title"><span>Note</span></div><p class="">In this section, we only specify aspects of the
      following objects that are relevant when used along with a
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>. Please refer to the original
      definitions of the objects in the [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] document for general
      information on using <code>MediaStream</code> and
      <code>MediaStreamTrack</code>.

      </p></div><section id="mediastream">
        <h4><span class="secno">4.2.1 </span>MediaStream</h4>

        <section id="label">
          <h5><span class="secno">4.2.1.1 </span>label</h5>

          <p>The <code>label</code> attribute specified in
          <code>MediaStream</code> returns a label that is unique to this
          stream, so that streams can be recognized after they are sent through
          the <code><a href="#peerconnection">RTCPeerConnection</a></code>
          API.</p>

          <p>When a <code><a href="#mediastream">MediaStream</a></code> is
          created to represent a stream obtained from a remote peer, the
          <code>label</code> attribute is initialized from information provided
          by the remote source.</p>

          <div class="note"><div class="note-title"><span>Note</span></div><p class="">The label of a <code><a>MediaStream</a></code> object
          is unique to the source of the stream, but that does not mean it is
          not possible to end up with duplicates. For example, a locally
          generated stream could be sent from one user agent to a remote peer
          using <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> ,and then sent back to the
          original user agent in the same manner, in which case the original
          user agent will have multiple streams with the same label (the
          locally-generated one and the one received from the remote peer).</p></div>
        </section>

        <section id="events-on-mediastream">
          <h5><span class="secno">4.2.1.2 </span>Events on MediaStream</h5>

          <p>A new media track may be associated with an existing
          <code><a>MediaStream</a></code> . For example, if a remote peer
          adds a new <code><a>MediaStreamTrack</a></code> object to one of the
          track lists of a <code><a>MediaStream</a></code> that is being sent
          over a <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>, this is observed on
          the local user agent. If this happens for the reason exemplified, or
          for any other reason than the <code>add()</code> [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>]
          method being invoked locally on a
          <code><a>MediaStreamTrackList</a></code> or tracks are being
          added as the stream is created (i.e. the stream is initialized with
          tracks), the user agent <em title="must" class="rfc2119">must</em> run the following steps:</p>

          <ol>
            <li>
              <p>Create a <code><a>MediaStreamTrack</a></code> object
              <var>track</var> to represent the new media component.</p>
            </li>

            <li>
              <p>If <var>track’s</var> <code><a href="getusermedia.html#dom-mediastreamtrack-kind">kind</a></code>
              attribute equals "<code>audio</code>", add it to the
              <code><a>MediaStream</a></code> object’s <code><a href="getusermedia.html#dom-mediastream-audiotracks">audioTracks</a></code>
              <code><a>MediaStreamTrackList</a></code> object.</p>
            </li>

            <li>
              <p>If <var>track’s</var> <code><a href="getusermedia.html#dom-mediastreamtrack-kind">kind</a></code>
              attribute equals "<code>video</code>", add it to the
              <code><a>MediaStream</a></code> object’s <code><a href="getusermedia.html#dom-mediastream-videotracks">videoTracks</a></code>
              <code><a>MediaStreamTrackList</a></code> object.</p>
            </li>

            <li>
              <p><a class="internalDFN" href="#dfn-fire-a-track-event">Fire a track event</a> named <code><a href="#event-mediastreamtracklist-addtrack">addtrack</a></code> with
              the newly created <var>track</var> at the
              <code><a>MediaStreamTrackList</a></code> object.</p>
            </li>
          </ol>

          <p>An existing media track may also be disassociated from a
          <code><a>MediaStream</a></code> . If this happens for any other
          reason than the <code>remove()</code> [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] method being
          invoked locally on a <code><a>MediaStreamTrackList</a></code> or the
          stream is being destroyed, the user agent <em title="must" class="rfc2119">must</em> run the following
          steps:</p>

          <ol>
            <li>
              <p>Let <var>track</var> be the
              <code><a>MediaStreamTrack</a></code> object representing the
              media component about to be removed.</p>
            </li>

            <li>
              <p>Remove <var>track</var> from the
              <code><a>MediaStreamTrackList</a></code> object.</p>
            </li>

            <li>
              <p><a class="internalDFN" href="#dfn-fire-a-track-event">Fire a track event</a> named <code><a href="#event-mediastreamtracklist-removetrack">removetrack</a></code>
              with <var>track</var> at the
              <code><a>MediaStreamTrackList</a></code> object.</p>
            </li>
          </ol>

          <p>The event source for the <code>onended</code> event in the
          networked case is the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
          object.</p>
        </section>
      </section>

      <section id="mediastreamtrack">
        <h4><span class="secno">4.2.2 </span>MediaStreamTrack</h4>

        <p>A <code>MediaStreamTrack</code> object’s reference to its
        <code>MediaStream</code> in the non-local media source case (an RTP
        source, as is the case for a <code>MediaStream</code> received over a
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>) is always strong.</p>

        <p>When a track belongs to a <code><a>MediaStream</a></code> that comes
        from a remote peer and the remote peer has permanently stopped sending
        data the <code>ended</code> event <em title="must" class="rfc2119">must</em> be fired on the track, as
        specified in [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>].</p>

        <div class="issue"><div class="issue-title"><span>Issue 1</span></div><p class="">ISSUE: How do you know when it has stopped? This seems
        like an SDP question, not a media-levelquestion.</p></div>

        <p>A track in a <code><a>MediaStream</a></code> , received with a
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> , <em title="must" class="rfc2119">must</em> have its
        <code>readyState</code> attribute [<cite><a href="#bib-GETUSERMEDIA" class="bibref">GETUSERMEDIA</a></cite>] set to
        <code><a href="#widl-MediaStreamTrack-MUTED">MUTED</a></code> (1) until
        media data arrives.</p>

        <p>In addition, a <code>MediaStreamTrack</code> has its
        <code>readyState</code> set to <code>MUTED</code> on the remote peer if
        the local user agent disables the corresponding
        <code><a>MediaStreamTrack</a></code> in the
        <code><a>MediaStream</a></code> that is being sent. When the addstream
        event triggers on a <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>, all
        <code><a>MediaStreamTrack</a></code> objects in the resulting
        <code><a>MediaStream</a></code> are muted until media data can be read
        from the RTP source.</p>

        <div class="issue"><div class="issue-title"><span>Issue 2</span></div><p class="">ISSUE: How do you know when it has been disabled? This
        seems like an SDP question, not a media-levelquestion.</p></div>
      </section>
    </section>

    <section id="audiomediastreamtrack">
      <h3><span class="secno">4.3 </span>AudioMediaStreamTrack</h3>

      <div class="note"><div class="note-title"><span>Note</span></div><p class="">The DTMF API is having a bunch of list discussion and
      will probably change.</p></div>

      <p>The <code><a class="idlType" href="#idl-def-AudioMediaStreamTrack"><code>AudioMediaStreamTrack</code></a></code> is a specialization of a
      normal <code><a>MediaStreamTrack</a></code> that only carries audio
      and is extended to have the capability to send and/or receive DTMF
      codes.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-AudioMediaStreamTrack">interface <span class="idlInterfaceID">AudioMediaStreamTrack</span> : <span class="idlSuperclass"><a>MediaStreamTrack</a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>boolean</a></span> <span class="idlAttrName"><a href="#widl-AudioMediaStreamTrack-canInsertDTMF">canInsertDTMF</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-AudioMediaStreamTrack-insertDTMF-void-DOMString-tones-long-duration">insertDTMF</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">tones</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>long</a></span> <span class="idlParamName">duration</span></span>);</span>
};</span></pre><section id="attributes"><h4><span class="secno">4.3.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-AudioMediaStreamTrack-canInsertDTMF"><code>canInsertDTMF</code> of type <span class="idlAttrType"><a>boolean</a></span>, readonly</dt><dd>
          <p>The <dfn id="dom-audiomediastreamtrack-caninsertdtmf"><code>canInsertDTMF</code></dfn>
          attribute <em title="must" class="rfc2119">must</em> indicate if the
          <code><a class="idlType" href="#idl-def-AudioMediaStreamTrack"><code>AudioMediaStreamTrack</code></a></code> is capable of sending
          DTMF.</p>
        </dd></dl></section><section id="methods"><h4><span class="secno">4.3.2 </span>Methods</h4><dl class="methods"><dt id="widl-AudioMediaStreamTrack-insertDTMF-void-DOMString-tones-long-duration"><code>insertDTMF</code></dt><dd>
          <p>When a <code><a class="idlType" href="#idl-def-AudioMediaStreamTrack"><code>AudioMediaStreamTrack</code></a></code> object’s <dfn id="dom-AudioMediaStreamTrack-insertDTMF"><code>insertDTMF()</code></dfn>
          method is invoked, the user agent <em title="must" class="rfc2119">must</em> queue a task that sends the
          DTMF tones.</p>

          <p>The tone parameters is treated as a series of characters. The
          characters 0 to 9, A to D, #, and * generated the associated DTMF
          tones. The characters a to d are equivalent to A to D. The character,
          indicates a an delay of 2 seconds before processing the next
          character in the tones parameter. Unrecognized characters are
          ignored.</p>

          <p>The duration parameters indicates the duration in ms to play the
          each DTMF passed in the tones parameters. The duration can not be
          more than 6000 or less than 70. The default duration is 100 ms for
          each tone. The gap between tones <em title="must" class="rfc2119">must</em> be at least 50 ms but should be
          as short as possible.</p>

          <div class="issue"><div class="issue-title"><span>Issue 3</span></div><p class="">ISSUE: How are invalid values handled?</p></div>

          <p>If insertDTMF is called on the same object while an existing task
          for this object to generate DTMF is still running, the previous task
          is canceled. Calling insertDTMF with an empty tones parameter can be
          used to cancel any tones currently being sent.</p>

          <div class="note"><div class="note-title"><span>Note</span></div><p class="">Editor Note: We need to add a callback that is set on
          the object that is called after the tones are sent. This is needed to
          allow the application to know when it can send new tones without
          canceling the tones that are currently being sent.</p></div>

          <div class="note"><div class="note-title"><span>Note</span></div><p class="">Editor Note: It seems we would want a callback or
          event for incoming tones. The proposal sent to the list had them
          played as audio to the speaker but I don’t see how that is
          useful.</p></div>
        <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">tones</td><td class="prmType"><code><a>DOMString</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">duration</td><td class="prmType"><code><a>long</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd></dl></section>
    </section>
  </section>

  <section id="peer-to-peer-connections">
    <!--OddPage--><h2><span class="secno">5. </span>Peer-to-peer connections</h2>

    <p>A <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> allows two users to communicate
    directly, browser to browser. Communications are coordinated via a
    signaling channel which is provided by unspecified means, but generally by
    a script in the page via the server, e.g. using
    <code>XMLHttpRequest</code>.</p>

    <p>Calling <code>new <a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a>(<var>configuration</var>
    )</code> creates a <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

    <p>The <var>configuration</var> has the information to find and access the
    [<cite><a href="#bib-STUN" class="bibref">STUN</a></cite>] and [<cite><a href="#bib-TURN" class="bibref">TURN</a></cite>] servers. There may be multiple servers of each type
    and any TURN server also acts as a STUN server.</p>

    <p>A RTCPeerConnection object has an associated ICE agent,
    RTCPeerConnection state, and ICE state. These are initialized when the
    object is created.</p>

    <p>When the <dfn id="dom-peerconnection"><code>RTCPeerConnection()</code></dfn> constructor is
    invoked, the user agent <em title="must" class="rfc2119">must</em> run the following steps. This algorithm has a
    synchronous section (which is triggered as part of the event loop
    algorithm).</p>

    <ol>
      <li>
        <p>Create an ICE Agent and let <var>connection</var>’s <a href="#peerconnection-ice-agent"><code>RTCPeerConnection</code> ICE
        Agent</a> be that ICE Agent and provide it the STUN and TURN servers
        from the configuration array. The [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>] will proceed with gathering
        as soon as the IceTransports constraint is not set to "none". At this
        point the ICE Agent does not know how many ICE components it needs (and
        hence the number of candidates to gather) but it can make a reasonable
        assumption and as the RTCPeerConnection object gets more information,
        it can adjust the number of components.</p>
      </li>

      <li>
        <p>Set <var>connection</var>’s <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
        readiness state</a> to <code><a href="#widl-RTCPeerConnection-NEW">"new"</a></code> .</p>
      </li>

      <li>
        <p>Set <var>connection</var>’s <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code> ice
        state</a> to <code><a href="#widl-RTCPeerConnection-NEW">"new"</a></code> .</p>
      </li>

      <li>
        <p>Let <var>connection</var>’s <code title="dom-RTCPeerConnection-localStreams"><a href="#widl-RTCPeerConnection-localStreams">localStreams</a></code>
        attribute be an empty read-only <code><a>MediaStream</a></code>
        array.</p>
      </li>

      <li>
        <p>Let <var>connection</var>’s <code title="dom-RTCPeerConnection-remoteStreams"><a href="#widl-RTCPeerConnection-remoteStreams">remoteStreams</a></code>
        attribute be an empty read-only <code><a>MediaStream</a></code>
        array.</p>
      </li>

      <li>
        <p>Return <var>connection</var>, but continue these steps
        asynchronously.</p>
      </li>

      <li>
        <p>Await a stable state. The synchronous section consists of the
        remaining steps of this algorithm.</p>
      </li>
    </ol>

    <p>During the lifetime of the RTCPeerConnection object, the following
    procedures are followed:</p>

    <ol>
      <li>
        <p>If <var>iceState</var> is "new" and the IceTransports constraint is
        not set to "none", it <em title="must" class="rfc2119">must</em> queue a task to start gathering ICE address
        and set the <var>iceState</var> to "gathering".</p>
      </li>

      <li>
        <p>If the ICE Agent has found one or more candidate pairs for any
        MediaStreamTrack that forms a valid connection, the ICE state is changed
        to "connected".</p>
      </li>

      <li>
        <p>When the ICE Agent finishes checking all candidate pairs, if at
        least one connection has been found for some MediaStreamTrack, the
        <var>iceState</var> is changed to "completed" and if no connection has
        been found for any MediaStreamTrack, the iceState is changed to
        "failed".</p>

        <div class="issue"><div class="issue-title"><span>Issue 4</span></div><p class="">ISSUE: Note that this means that if I was able to
        negotiate audio but not video via ICE, then <var>iceState</var> ==
        "completed". Is this really what is desired?</p></div>
      </li>

      <li>
        <p>If the <var>iceState</var> is "connected" or "completed" and both the
        local and remote session descriptions are set, the RTCPeerConnection
        state is set to "active".</p>
      </li>

      <li>
        <p>If the <var>iceState</var> is "failed", a task is queued to calls the
        close method.</p>

        <div class="issue"><div class="issue-title"><span>Issue 5</span></div><p class="">ISSUE:: CJ - this seems wrong to me.</p></div>
      </li>
    </ol>

    <p>User agents negotiate the codec resolution, bitrate, and other media
    parameters. User agents are <em title="recommended" class="rfc2119">recommended</em> to initially negotiate for the
    maximum resolution of a video stream. For streams that are then rendered
    (using a <code>video</code> element), user agents are <em title="recommended" class="rfc2119">recommended</em> to
    renegotiate for a resolution that matches the rendered display size.</p>

    <div class="note"><div class="note-title"><span>Note</span></div><p class="">Starting with the native resolution means that if the Web
    application notifies its peer of the native resolution as it starts sending
    data, and the peer prepares its <code>video</code> element accordingly,
    there will be no need for a renegotiation once the stream is flowing.</p></div>
    <!--
      <p>All SDP media descriptions for RTP flows represented by <code>
          <a>MediaStreamTrack</a>
        </code> objects MUST include a label attribute ("<code
      title="">a=label:</code>") whose value is the value of the <code>
          <a>MediaStream</a>
        </code> object's <code title="dom-MediaStream-label">
          <a href="#dom-mediastream-label">label</a>
        </code> attribute. [[!SDP]] [[!SDPLABEL]]</p>

      <p><a href="#peerconnection"><code>RTCPeerConnection</code>s</a> MUST not
      generate any candidates for media streams whose media descriptions do
      not have a label attribute ("<code>a=label:</code>"). [[!ICE]] [[!SDP]]
      [[!SDPLABEL]]  (Note: CJ - I have no idea why this is here) </p>
      -->

    <p>The word "components" in this context refers to an RTP media flow and
    does not have anything to do with how [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>] uses the term
    "component".</p>

    <p>When a user agent has reached the point where a
    <code><a>MediaStream</a></code> can be created to represent incoming
    components, the user agent <em title="must" class="rfc2119">must</em> run the following steps:</p>

    <ol>
      <li>
        <p>Let <var>connection</var> be the
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> expecting this media.</p>
      </li>

      <li>
        <p>Create a <code><a>MediaStream</a></code> object to represent the
        media stream.
        <!-- Set its <code> <a href="#dom-mediastream-label">label</a>
            </code> attribute to the value of the SDP Label attribute for that
          component's media stream. --></p>
      </li>

      <li>
        <p>Run the following steps for each component in the media stream.</p>

        <ol>
          <li>
            <p>Create a <code><a>MediaStreamTrack</a></code> object
            <var>track</var> to represent the component. [[EDITORIAL: Can we
            just reference 3.2.1.2 here?]]</p>
          </li>

          <li>
            <p>If <var>track's</var> <code><a href="getusermedia.html#dom-mediastreamtrack-kind">kind</a></code>
            attribute equals "<code>audio</code>", add it to the
            <code><a>MediaStream</a></code> object's <code><a href="getusermedia.html#dom-mediastream-audiotracks">audioTracks</a></code>
            <code><a>MediaStreamTrackList</a></code> object.</p>
          </li>

          <li>
            <p>If <var>track's</var> <code><a href="getusermedia.html#dom-mediastreamtrack-kind">kind</a></code>
            attribute equals "<code>video</code>", add it to the
            <code><a>MediaStream</a></code> object's <code><a href="getusermedia.html#dom-mediastream-videotracks">videoTracks</a></code>
            <code><a>MediaStreamTrackList</a></code> object.</p>
          </li>
        </ol>

        <div class="note"><div class="note-title"><span>Note</span></div><p class="">The creation of new incoming <code>MediaStream</code>s
        may be triggered either by SDP negotiation or by the receipt of media
        on a given flow.
        <!--  [[OPEN ISSUE: How many <code>MediaStream</code>s are created
            when you receive multiple conflicting pranswers?]] --></p></div>

        <div class="note"><div class="note-title"><span>Note</span></div><p class="">The internal order in the
        <code><a>MediaStreamTrackList</a></code> objects on the receiving side
        should reflect the order on the sending side. One way to enforce this
        is to specify the order in the SDP.</p></div>
      </li>

      <li>
        <p>Queue a task to run the following substeps:</p>

        <ol>
          <li>
            <p>If the <var>connection</var>’s <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
            readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), abort these
            steps.</p>
          </li><!-- close() was probably called just before this
     task ran -->

          <li>
            <p>Add the newly created <code><a>MediaStream</a></code> object to
            the end of <var>connection</var>’s <code title="dom-RTCPeerConnection-remoteStreams"><a href="#widl-RTCPeerConnection-remoteStreams">remoteStreams</a></code>
            array.</p>
          </li>

          <li>
            <p><a href="#fire-a-stream-event">Fire a stream event</a> named
            <code title="event-MediaStream-addstream"><a href="#event-mediastream-addstream">addstream</a></code> with the newly
            created <code><a>MediaStream</a></code> object at the <var title="">connection</var> object.</p>
          </li>
        </ol>
      </li>
    </ol>

    <p>When a user agent has negotiated media for a component that belongs to a
    media stream that is already represented by an existing
    <code><a>MediaStream</a></code> object, the user agent <em title="must" class="rfc2119">must</em> associate the
    component with that <code><a>MediaStream</a></code> object.</p>

    <p>When a <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> finds that a stream from
    the remote peer has been removed <!-- (its
      port has been set to zero in a media description sent on the signaling
      channel), -->, the user agent <em title="must" class="rfc2119">must</em> follow these steps:</p>

    <ol>
      <li>
        <p>Let <var>connection</var> be the
        <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> associated with the stream being
        removed.</p>
      </li>

      <li>
        <p>Let <var>stream</var> be the <code><a>MediaStream</a></code> object
        that represents the media stream being removed, if any. If there isn't
        one, then abort these steps.</p>
      </li>

      <li>
        <p>By definition, <var>stream</var> is now <a>finished</a>.</p>

        <div class="note"><div class="note-title"><span>Note</span></div><p class="">A <span title="concept-task">task</span> is thus
        <span title="queue a task">queued</span> to update <var>stream</var>
        and fire an event.</p></div>
      </li>

      <li>
        <p>Queue a task to run the following substeps:</p>

        <ol>
          <li>
            <p>If the <var>connection</var>’s <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
            readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), abort these
            steps.</p>
          </li><!-- close() was probably called just before this
     task ran -->

          <li>
            <p>Remove <var>stream</var> from <var>connection</var>’s
            <code><a href="#widl-RTCPeerConnection-remoteStreams">remoteStreams</a></code>
            array.</p>
          </li>

          <li>
            <p><a href="#fire-a-stream-event">Fire a stream event</a> named
            <code title="event-MediaStream-removestream"><a href="#event-mediastream-removestream">removestream</a></code> with
            <var title="">stream</var> at the <var>connection</var> object.</p>
          </li>
        </ol>
      </li>
    </ol>

    <p>The task source for the <span title="concept-task">tasks</span> listed
    in this section is the networking task source.</p>

    <p>If something in the browser changes that causes the
    <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object to need to initiate a new
    session description negotiation, an <code><a href="#event-negotiation">negotiationneeded</a></code> event is fired at the
    <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

    <p>In particular, if a <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object is
    <a title="consumer">consuming</a> a <code><a>MediaStream</a></code> and a
    track is added to one of the stream's
    <code><a>MediaStreamTrackList</a></code> objects, by, e.g., the
    <code><a href="getusermedia.html#dom-mediastreamtracklist-add">add()</a></code> method
    being invoked, the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object <em title="must" class="rfc2119">must</em> fire
    the "negotiationneeded" event. Removal of media components must also
    trigger "negotiationneeded".</p>

    <p class="warning">To prevent network sniffing from allowing a fourth party
    to establish a connection to a peer using the information sent out-of-band
    to the other peer and thus spoofing the client, the configuration
    information <em title="should" class="rfc2119">should</em> always be transmitted using an encrypted connection.</p>

    <section id="rtcpeerconnection">
      <h3><span class="secno">5.1 </span>RTCPeerConnection</h3>

      <p>The general operation of the RTCPeerConnection is described in
      [<cite><a href="#bib-RTCWEB-JSEP" class="bibref">RTCWEB-JSEP</a></cite>].</p>

      <section id="rtcsdptype">
        <h4><span class="secno">5.1.1 </span>RTCSdpType</h4>

        <p>The RTCSdpType enum describes the type of a
        <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> instance.</p>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCSdpType">enum <span class="idlEnumID">RTCSdpType</span> {
    "<span class="idlEnumItem">offer</span>",
    "<span class="idlEnumItem">pranswer</span>",
    "<span class="idlEnumItem">answer</span>"
};</span></pre><table class="simple"><tr><th colspan="2">Enumeration description</th></tr><tr><td><code>offer</code></td><td>
            <p>An RTCSdpType of "offer" indicates that a description should be
            treated as an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] offer.</p>
          </td></tr><tr><td><code>pranswer</code></td><td>
            <p>An RTCSdpType of "pranswer" indicates that a description should
            be treated as an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] answer, but not a final answer. A
            description used as a SDP "pranswer" may be applied as a response
            to a SDP offer, or an update to a previously sent SDP
            "pranswer".</p>
          </td></tr><tr><td><code>answer</code></td><td>
            <p>An RTCSdpType of "answer" indicates that a description should be
            treated as an [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] final answer, and the offer-answer exchange
            should be considered complete. A description used as a SDP answer
            may be applied as a response to a SDP offer, or an update to a
            previously send SDP "pranswer".</p>
          </td></tr></table>
      </section>

      <section id="rtcsessiondescription-class">
        <h4><span class="secno">5.1.2 </span>RTCSessionDescription Class</h4>

        <p>The <dfn id="dom-sessiondescription"><code>RTCSessionDescription()</code></dfn>
        constructor takes an optional dictionary argument,
        <var>descriptionInitDict</var>, whose content is used to initialize the
        new <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> object. If a dictionary
        key is not present in <var>descriptionInitDict</var>, the corresponding
        attribute will be initialized to null. If the constructor is run without
        the dictionary argument, all attributes will be initialized to null.
        This class is a future extensible carrier for the data contained in
        it and does not perform any substantive processing.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCSessionDescription">[<span class="extAttr">Constructor (optional RTCSessionDescriptionInit descriptionInitDict)</span>]
interface <span class="idlInterfaceID">RTCSessionDescription</span> {
<span class="idlAttribute">             attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a>?</span> <span class="idlAttrName"><a href="#widl-RTCSessionDescription-type">type</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>DOMString</a>?</span>  <span class="idlAttrName"><a href="#widl-RTCSessionDescription-sdp">sdp</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>stringifier</a></span> <span class="idlMethName"><a href="#widl-RTCSessionDescription-DOMString-stringifier">DOMString</a></span> ();</span>
};<br><span class="idlDictionary" id="idl-def-RTCSessionDescriptionInit">dictionary <span class="idlDictionaryID">RTCSessionDescriptionInit</span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span> <span class="idlMemberName"><a href="#widl-RTCSessionDescriptionInit-type">type</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a>DOMString</a></span>  <span class="idlMemberName"><a href="#widl-RTCSessionDescriptionInit-sdp">sdp</a></span>;</span>
};</span></span></pre><section id="attributes-1"><h5><span class="secno">5.1.2.1 </span>Attributes</h5><dl class="attributes"><dt id="widl-RTCSessionDescription-sdp"><code>sdp</code> of type <span class="idlAttrType"><a>DOMString</a></span>, nullable</dt><dd>The string representation of the SDP [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>]</dd><dt id="widl-RTCSessionDescription-type"><code>type</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span>, nullable</dt><dd>What type of SDP this RTCSessionDescription represents.</dd></dl></section><section id="methods-1"><h5><span class="secno">5.1.2.2 </span>Methods</h5><dl class="methods"><dt id="widl-RTCSessionDescription-DOMString-stringifier"><code>DOMString</code></dt><dd>
            <p>Objects implementing the <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a>
            </code> interface <em title="must" class="rfc2119">must</em> stringify by running the steps below. Let
            <code><a href="#widl-RTCSessionDescription-type">type</a></code>
            and <code><a href="#widl-RTCSessionDescription-sdp">sdp</a></code>
            be the elements of <var>attributeList</var>, the list of attributes
            to include in the string representation.</p>

            <ol>
              <li>
                <p>Let <var>result</var> be U+0028 LEFT PARENTHESIS U+007B LEFT
                CURLY BRACKET.</p>
              </li>

              <li>
                <p>For each attribute in <var>attributeList</var> append, to
                <var>result</var>, the attribute name, U+003A COLON U+0022
                QUOTATION MARK, the attribute value, U+0022 QUOTATION MARK and
                U+002C COMMA. If the attribute was the last element in
                <var>attributeList</var>, then remove the last U+002C COMMA.</p>
              </li>

              <li>
                <p>Append U+007D RIGTH CURLY BRACKET U+0029 RIGHT PARENTHESIS to
                <var>result</var> and return <var>result</var>.</p>
              </li>
            </ol>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a>stringifier</a></code></div></dd></dl></section>

        <section id="dictionary-rtcsessiondescriptioninit-members"><h5><span class="secno">5.1.2.3 </span>Dictionary <a href="#idl-def-RTCSessionDescriptionInit" class="idlType"><code>RTCSessionDescriptionInit</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-RTCSessionDescriptionInit-sdp"><code>sdp</code> of type <span class="idlMemberType"><a>DOMString</a></span></dt><dd></dd><dt id="widl-RTCSessionDescriptionInit-type"><code>type</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCSdpType"><code>RTCSdpType</code></a></span></dt><dd>DOMString sdp</dd></dl></section>
      </section>

      <section id="rtcsessiondescriptioncallback">
        <h4><span class="secno">5.1.3 </span>RTCSessionDescriptionCallback</h4>

        <pre class="idl"><span class="idlCallback" id="idl-def-RTCSessionDescriptionCallback">callback <span class="idlCallbackID">RTCSessionDescriptionCallback</span> = <span class="idlCallbackType"><a>void</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlParamName">sdp</span></span>);</span></pre><section id="callback-rtcsessiondescriptioncallback-parameters"><h5><span class="secno">5.1.3.1 </span>Callback <a href="#idl-def-RTCSessionDescriptionCallback" class="idlType"><code>RTCSessionDescriptionCallback</code></a> Parameters</h5><dl class="callback-members"><dt id="widl-RTCSessionDescriptionCallback-sdp"><code>sdp</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span></dt><dd>The object containing the SDP [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>].</dd></dl></section>
      </section>

      <section id="rtcvoidcallback">
        <h4><span class="secno">5.1.4 </span>RTCVoidCallback</h4>

        <pre class="idl"><span class="idlCallback" id="idl-def-RTCVoidCallback">callback <span class="idlCallbackID">RTCVoidCallback</span> = <span class="idlCallbackType"><a>void</a></span> ();</span></pre>
      </section>

      <section id="rtcpeerconnectionerrorcallback">
        <h4><span class="secno">5.1.5 </span>RTCPeerConnectionErrorCallback</h4>

        <pre class="idl"><span class="idlCallback" id="idl-def-RTCPeerConnectionErrorCallback">callback <span class="idlCallbackID">RTCPeerConnectionErrorCallback</span> = <span class="idlCallbackType"><a>void</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">errorInformation</span></span>);</span></pre><section id="callback-rtcpeerconnectionerrorcallback-parameters"><h5><span class="secno">5.1.5.1 </span>Callback <a href="#idl-def-RTCPeerConnectionErrorCallback" class="idlType"><code>RTCPeerConnectionErrorCallback</code></a> Parameters</h5><dl class="callback-members"><dt id="widl-RTCPeerConnectionErrorCallback-errorInformation"><code>errorInformation</code> of type <span class="idlMemberType"><a>DOMString</a></span></dt><dd>
            Information about what went wrong.

            <div class="issue"><div class="issue-title"><span>Issue 6</span></div><p class="">ISSUE: Should this be an enum?</p></div>
          </dd></dl></section>
      </section>

      <section id="rtcpeerstate-enum">
        <h4><span class="secno">5.1.6 </span>RTCPeerState Enum</h4>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCPeerState">enum <span class="idlEnumID">RTCPeerState</span> {
    "<span class="idlEnumItem">new</span>",
    "<span class="idlEnumItem">opening</span>",
    "<span class="idlEnumItem">active</span>",
    "<span class="idlEnumItem">closing</span>",
    "<span class="idlEnumItem">closed</span>"
};</span></pre><table class="simple"><tr><th colspan="2">Enumeration description</th></tr><tr><td><code>new</code></td><td>The object was just created, and no networking has yet
          occurred.</td></tr><tr><td><code>opening</code></td><td>
            The user agent is attempting to establish an connection with the
            ICE Agent and waiting for local and remote SDP to be set.

            <div class="issue"><div class="issue-title"><span>Issue 7</span></div><p class="">ISSUE: do we need more states between "opening"
            and "active"?</p></div>
          </td></tr><tr><td><code>active</code></td><td>The ICE Agent has found a connection both the local and remote
          SDP have been set. It is possible for media to flow.</td></tr><tr><td><code>closing</code></td><td>The <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object is terminating
          all media and is in the process of closing the connection.</td></tr><tr><td><code>closed</code></td><td>The connection is closed.</td></tr></table>
      </section>

      <section id="rtcicestate-enum">
        <h4><span class="secno">5.1.7 </span>RTCIceState Enum</h4>

        <div class="note"><div class="note-title"><span>Note</span></div><p class="">There is active discussion around changing
        these states.</p></div>

        <pre class="idl"><span class="idlEnum" id="idl-def-RTCIceState">enum <span class="idlEnumID">RTCIceState</span> {
    "<span class="idlEnumItem">new</span>",
    "<span class="idlEnumItem">gathering</span>",
    "<span class="idlEnumItem">waiting</span>",
    "<span class="idlEnumItem">checking</span>",
    "<span class="idlEnumItem">connected</span>",
    "<span class="idlEnumItem">completed</span>",
    "<span class="idlEnumItem">failed</span>",
    "<span class="idlEnumItem">closed</span>"
};</span></pre><table class="simple"><tr><th colspan="2">Enumeration description</th></tr><tr><td><code>new</code></td><td>The RTCPeerConnection object was just created, and no networking
          has yet occurred.</td></tr><tr><td><code>gathering</code></td><td>The ICE Agent is attempting to gather addresses.</td></tr><tr><td><code>waiting</code></td><td>The ICE Agent is not gathering any addresses and is waiting for
          candidates from the other side before it can start checking.</td></tr><tr><td><code>checking</code></td><td>The ICE Agent is checking candidate pairs but has not yet found a
          connection. In addition to checking, it may also still be
          gathering.</td></tr><tr><td><code>connected</code></td><td>The ICE Agent has found a connection but is still checking other
          candidate pairs to see if there is a better connection. It may also
          still be gathering.</td></tr><tr><td><code>completed</code></td><td>The ICE Agent has finished gathering and checking and found a
          connection.</td></tr><tr><td><code>failed</code></td><td>The ICE Agent is finished checking all candidate pairs and failed
          to find a connection.</td></tr><tr><td><code>closed</code></td><td>The ICE Agent has shut down and is no longer responding to STUN
          requests.</td></tr></table>
      </section>

      <section id="rtcicecandidate-type">
        <h4><span class="secno">5.1.8 </span>RTCIceCandidate Type</h4>

        <p>The <dfn id="dom-icecandidate"><code>RTCIceCandidate()</code></dfn>
        constructor takes an optional dictionary argument,
        <var>candidateInitDict</var>, whose content is used to initialize the
        new <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> object. If a dictionary
        key is not present in <var>candidateInitDict</var>, the corresponding
        attribute will be initialized to null. If the constructor is run without
        the dictionary argument, all attributes will be initialized to null.
        This class is a future extensible carrier for the data contained in
        it and does not perform any substantive processing.</p>

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCIceCandidate">[<span class="extAttr">Constructor (optional RTCIceCandidateInit candidateInitDict)</span>]
interface <span class="idlInterfaceID">RTCIceCandidate</span> {
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>DOMString</a>?</span>      <span class="idlAttrName"><a href="#widl-RTCIceCandidate-candidate">candidate</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>DOMString</a>?</span>      <span class="idlAttrName"><a href="#widl-RTCIceCandidate-sdpMid">sdpMid</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>unsigned short</a>?</span> <span class="idlAttrName"><a href="#widl-RTCIceCandidate-sdpMLineIndex">sdpMLineIndex</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>stringifier</a></span> <span class="idlMethName"><a href="#widl-RTCIceCandidate-DOMString-stringifier">DOMString</a></span> ();</span>
};<br><span class="idlDictionary" id="idl-def-RTCIceCandidateInit">dictionary <span class="idlDictionaryID">RTCIceCandidateInit</span> {
<span class="idlMember">    <span class="idlMemberType"><a>DOMString</a></span>      <span class="idlMemberName"><a href="#widl-RTCIceCandidateInit-candidate">candidate</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a>DOMString</a></span>      <span class="idlMemberName"><a href="#widl-RTCIceCandidateInit-sdpMid">sdpMid</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a>unsigned short</a></span> <span class="idlMemberName"><a href="#widl-RTCIceCandidateInit-sdpMLineIndex">sdpMLineIndex</a></span>;</span>
};</span></span></pre><section id="attributes-2"><h5><span class="secno">5.1.8.1 </span>Attributes</h5><dl class="attributes"><dt id="widl-RTCIceCandidate-candidate"><code>candidate</code> of type <span class="idlAttrType"><a>DOMString</a></span>, nullable</dt><dd>This carries the candidate-attribute as defined in section 15.1
          of [<cite><a href="#bib-ICE" class="bibref">ICE</a></cite>].</dd><dt id="widl-RTCIceCandidate-sdpMLineIndex"><code>sdpMLineIndex</code> of type <span class="idlAttrType"><a>unsigned short</a></span>, nullable</dt><dd>This indeicates the index (starting at zero) of m-line in the SDP
          this candidate is assocated with.</dd><dt id="widl-RTCIceCandidate-sdpMid"><code>sdpMid</code> of type <span class="idlAttrType"><a>DOMString</a></span>, nullable</dt><dd>If present, this contains the identierfier of the "media stream
          identification" as defined in [RFC 3388] for m-line this candidate is
          assocated with.</dd></dl></section><section id="methods-2"><h5><span class="secno">5.1.8.2 </span>Methods</h5><dl class="methods"><dt id="widl-RTCIceCandidate-DOMString-stringifier"><code>DOMString</code></dt><dd>Objects that implement the <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code>
          interface must stringify as defined by the <code>
          <a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> <code><a href="#widl-RTCSessionDescription-DOMString-stringifier">stringifier
          algorithm</a></code> with <code><a href="#widl-RTCIceCandidate-candidate">candidate</a></code>, <code>
          <a href="#widl-RTCIceCandidate-sdpMid">sdpMid</a></code>, <code>
          <a href="#widl-RTCIceCandidate-sdpMLineIndex">sdpMLineIndex</a></code>
          as the elements of <var>attributeList</var>.<div><em>No parameters.</em></div><div><em>Return type: </em><code><a>stringifier</a></code></div></dd></dl></section>

        <section id="dictionary-rtcicecandidateinit-members"><h5><span class="secno">5.1.8.3 </span>Dictionary <a href="#idl-def-RTCIceCandidateInit" class="idlType"><code>RTCIceCandidateInit</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-RTCIceCandidateInit-candidate"><code>candidate</code> of type <span class="idlMemberType"><a>DOMString</a></span></dt><dd>DOMString sdpMid</dd><dt id="widl-RTCIceCandidateInit-sdpMLineIndex"><code>sdpMLineIndex</code> of type <span class="idlMemberType"><a>unsigned short</a></span></dt><dd></dd><dt id="widl-RTCIceCandidateInit-sdpMid"><code>sdpMid</code> of type <span class="idlMemberType"><a>DOMString</a></span></dt><dd>unsigned short sdpMLineIndex</dd></dl></section>
      </section>

      <section id="rtciceserver-type">
        <h4><span class="secno">5.1.9 </span>RTCIceServer Type</h4>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIceServer">dictionary <span class="idlDictionaryID">RTCIceServer</span> {
<span class="idlMember">    <span class="idlMemberType"><a>DOMString</a></span>          <span class="idlMemberName"><a href="#widl-RTCIceServer-url">url</a></span>;</span>
<span class="idlMember">    <span class="idlMemberType"><a>nullable DOMString</a></span> <span class="idlMemberName"><a href="#widl-RTCIceServer-credential">credential</a></span>;</span>
};</span></pre><section id="dictionary-rtciceserver-members"><h5><span class="secno">5.1.9.1 </span>Dictionary <a href="#idl-def-RTCIceServer" class="idlType"><code>RTCIceServer</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-RTCIceServer-credential"><code>credential</code> of type <span class="idlMemberType"><a>nullable DOMString</a></span></dt><dd>
            <p>If the url element of the internal array is TURN URI, then this
            is the credential to use with that TURN server.</p>
          </dd><dt id="widl-RTCIceServer-url"><code>url</code> of type <span class="idlMemberType"><a>DOMString</a></span></dt><dd>
            <p>A stun or turn URI as defined in [<cite><a href="#bib-STUN-URI" class="bibref">STUN-URI</a></cite>] and
            [<cite><a href="#bib-TURN-URI" class="bibref">TURN-URI</a></cite>].</p>
          </dd></dl></section>

        <p>In network topologies with multiple layers of NATs, it is desirable
        to have a STUN servers between every layer of NATs in addition to the
        TURN servers to minimize the number peer to peer network latency.</p>

        <p>An example array of RTCIceServer objects is:</p>

        <p><code>[ { url:"stun:stun.example.net"] } , {
        url:"turn:user@turn.example.org", credential:"myPassword"} ]</code></p>
      </section>

      <section id="rtcconfiguration-type">
        <h4><span class="secno">5.1.10 </span>RTCConfiguration Type</h4>

        <pre class="idl"><span class="idlDictionary" id="idl-def-RTCIceServer">dictionary <span class="idlDictionaryID">RTCIceServer</span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a>[]</span> <span class="idlMemberName"><a href="#widl-RTCIceServer-iceServers">iceServers</a></span>;</span>
};</span></pre><section id="dictionary-rtciceserver-members-1"><h5><span class="secno">5.1.10.1 </span>Dictionary <a href="#idl-def-RTCIceServer" class="idlType"><code>RTCIceServer</code></a> Members</h5><dl class="dictionary-members"><dt id="widl-RTCIceServer-iceServers"><code>iceServers</code> of type array of <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceServer"><code>RTCIceServer</code></a></span></dt><dd>
            <p>An array of containing the STUN and TURN servers provided by the
            JS that can be used by ICE.</p>
          </dd></dl></section>
      </section>

      <section id="rtcpeerconnection-interface">
        <h4><span class="secno">5.1.11 </span>RTCPeerConnection Interface</h4>

        <pre class="idl"><span class="idlTypedef" id="idl-def-MediaStreamArray">typedef <span class="idlTypedefType"><a>MediaStream</a></span>[] <span class="idlTypedefID">MediaStreamArray</span>;</span></pre><div class="idlTypedefDesc">

        <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnection">[<span class="extAttr">Constructor (RTCConfiguration configuration, optional MediaConstraints
        constraints)</span>]
interface <span class="idlInterfaceID">RTCPeerConnection</span> : <span class="idlSuperclass"><a>EventTarget </a></span> {
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-createOffer-void-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback-MediaConstraints-constraints">createOffer</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>MediaConstraints</a></span> <span class="idlParamName">constraints</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-createAnswer-void-RTCSessionDescription-offer-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback--failureCallback---null-optional-MediaConstraints-constraints---null-optional-boolean-createProvisionalAnswer---false">createAnswer</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlParamName">offer</span></span>, <span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>RTCPeerConnectionErrorCallback? failureCallback =</a></span> <span class="idlParamName">null</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>optional MediaConstraints constraints =</a></span> <span class="idlParamName">null</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>optional boolean createProvisionalAnswer =</a></span> <span class="idlParamName">false</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-setLocalDescription-void-RTCSessionDescription-description-RTCVoidCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback">setLocalDescription</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlParamName">description</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCVoidCallback"><code>RTCVoidCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlAttrName"><a href="#widl-RTCPeerConnection-localDescription">localDescription</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-setRemoteDescription-void-RTCSessionDescription-description-RTCVoidCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback">setRemoteDescription</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlParamName">description</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCVoidCallback"><code>RTCVoidCallback</code></a></span> <span class="idlParamName">successCallback</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></span> <span class="idlParamName">failureCallback</span></span>);</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span> <span class="idlAttrName"><a href="#widl-RTCPeerConnection-remoteDescription">remoteDescription</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCPeerState"><code>RTCPeerState</code></a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-readyState">readyState</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-updateIce-void-RTCConfiguration--configuration---null-optional-MediaConstraints--constraints---null-boolean-restart---false">updateIce</a></span> (<span class="idlParam">optional <span class="idlParamType"><a>RTCConfiguration? configuration =</a></span> <span class="idlParamName">null</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>optional MediaConstraints? constraints =</a></span> <span class="idlParamName">null</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>boolean restart =</a></span> <span class="idlParamName">false</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-addIceCandidate-void-RTCIceCandidate-candidate">addIceCandidate</a></span> (<span class="idlParam"><span class="idlParamType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span> <span class="idlParamName">candidate</span></span>);</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceState"><code>RTCIceState</code></a></span>           <span class="idlAttrName"><a href="#widl-RTCPeerConnection-iceState">iceState</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamArray"><code>MediaStreamArray</code></a></span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnection-localStreams">localStreams</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamArray"><code>MediaStreamArray</code></a></span>      <span class="idlAttrName"><a href="#widl-RTCPeerConnection-remoteStreams">remoteStreams</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></span> <span class="idlMethName"><a href="#widl-RTCPeerConnection-createDataChannel-DataChannel-DOMString-label-DataChannelInit-dataChannelDict">createDataChannel</a></span> (<span class="idlParam">[<span class="extAttr">TreatNullAs=EmptyString</span>] <span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">label</span></span>, <span class="idlParam">optional <span class="idlParamType"><a class="idlType" href="#idl-def-DataChannelInit"><code>DataChannelInit</code></a></span> <span class="idlParamName">dataChannelDict</span></span>);</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-ondatachannel">ondatachannel</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-addStream-void-MediaStream-stream-MediaConstraints-constraints">addStream</a></span> (<span class="idlParam"><span class="idlParamType"><a>MediaStream</a></span> <span class="idlParamName">stream</span></span>, <span class="idlParam">optional <span class="idlParamType"><a>MediaConstraints</a></span> <span class="idlParamName">constraints</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-removeStream-void-MediaStream-stream">removeStream</a></span> (<span class="idlParam"><span class="idlParamType"><a>MediaStream</a></span> <span class="idlParamName">stream</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span>        <span class="idlMethName"><a href="#widl-RTCPeerConnection-close-void">close</a></span> ();</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onnegotationneeded">onnegotationneeded</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onicecandidate">onicecandidate</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onopen">onopen</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onstatechange">onstatechange</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onaddstream">onaddstream</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onremovestream">onremovestream</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>          <span class="idlAttrName"><a href="#widl-RTCPeerConnection-onicechange">onicechange</a></span>;</span>
};</span></pre><section><h5 id="attributes-8">Attributes</h5><dl class="attributes"><dt id="widl-RTCPeerConnection-iceState"><code>iceState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceState"><code>RTCIceState</code></a></span>, readonly</dt><dd>
            <p>The <dfn id="dom-peerconnection-icestate"><code>iceState</code></dfn> attribute
            <em title="must" class="rfc2119">must</em> return the state of the <a href="#peerconnection-ice-agent"><code>RTCPeerConnection</code> ICE
            Agent</a> ICE state.</p>
          </dd><dt id="widl-RTCPeerConnection-localDescription"><code>localDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly</dt><dd>
            <p>The <dfn id="dom-peerconnection-localdescription"><code>localDescription</code></dfn>
            attribute <em title="must" class="rfc2119">must</em> return the <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code>
            that was most recently passed to <code><a href="#dom-peerconnection-setlocaldescription">setLocalDescription()</a></code>,
            plus any local candidates that have been generated by the ICE Agent
            since then.</p>

            <p>A null object will be returned if the local description has not
            yet been set.</p>
          </dd><dt id="widl-RTCPeerConnection-localStreams"><code>localStreams</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamArray"><code>MediaStreamArray</code></a></span>, readonly</dt><dd>
            <p>Returns a live array containing the local streams (those that
            were added with <code title="dom-RTCPeerConnection-addStream"><a href="#dom-peerconnection-addstream">addStream()</a></code> ).</p>
          </dd><dt id="widl-RTCPeerConnection-onaddstream"><code>onaddstream</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>
            This event handler, of event handler event type <code><a href="#event-mediastream-addstream">addstream</a></code>, <em title="must" class="rfc2119">must</em> be
            fired by all objects implementing the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface It is called any
            time a MediaStream is added by the remote peer.
          </dd><dt id="widl-RTCPeerConnection-ondatachannel"><code>ondatachannel</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of type <code><a href="#event-peerconnection-datachannel">datachannel</a></code> , <em title="must" class="rfc2119">must</em> be
          supported by all objects implementing the
          <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface.</dd><dt id="widl-RTCPeerConnection-onicecandidate"><code>onicecandidate</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of event handler event type <code><a href="#event-onicecandidate">onicecandidate</a></code> , <em title="must" class="rfc2119">must</em> be supported
          by all objects implementing the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
          interface. It is called any time there is a new ICE candidate
          added to a previous offer or answer.</dd><dt id="widl-RTCPeerConnection-onicechange"><code>onicechange</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>
            This event handler, of event handler event type <code><a href="#event-mediastream-icechange">icechange</a></code>, <em title="must" class="rfc2119">must</em> be
            fired by all objects implementing the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface. It is called any
            time the <var>iceState</var> changes.
          </dd><dt id="widl-RTCPeerConnection-onnegotationneeded"><code>onnegotationneeded</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>
            This event handler, of event handler event type <code><a href="#event-negotiation-needed">negotiationneeded</a></code> , <em title="must" class="rfc2119">must</em>
            be supported by all objects implementing the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface.
          </dd><dt id="widl-RTCPeerConnection-onopen"><code>onopen</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of event handler event type <code><a href="#event-mediastream-open">open</a></code> , <em title="must" class="rfc2119">must</em> be supported by all
          objects implementing the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
          interface.</dd><dt id="widl-RTCPeerConnection-onremovestream"><code>onremovestream</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>
            This event handler, of event handler event type <code><a href="#event-mediastream-removestream">removestream</a></code>, <em title="must" class="rfc2119">must</em> be
            fired by all objects implementing the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> interface. It is called any
            time a MediaStream is removed by the remote peer.
          </dd><dt id="widl-RTCPeerConnection-onstatechange"><code>onstatechange</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of event handler event type <code><a href="#event-mediastream-open">statechange</a></code> , <em title="must" class="rfc2119">must</em> be supported
          by all objects implementing the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
          interface. It is called any time the readyState changes.</dd><dt id="widl-RTCPeerConnection-readyState"><code>readyState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCPeerState"><code>RTCPeerState</code></a></span>, readonly</dt><dd>
            <p>The <dfn id="dom-peerconnection-readystate"><code title="">readyState</code></dfn> attribute <em title="must" class="rfc2119">must</em> return the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
            readiness state</a>.</p>
          </dd><dt id="widl-RTCPeerConnection-remoteDescription"><code>remoteDescription</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></span>, readonly</dt><dd>
            <p>The <dfn id="dom-peerconnection-remotedescription"><code>remoteDescription</code></dfn>
            attribute <em title="must" class="rfc2119">must</em> return the <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code>
            that was most recently passed to <code><a href="#dom-peerconnection-setremotedescription">setRemoteDescription()</a></code>,
            plus any remote candidates that have been supplied via
            <code><a href="#dom-peerconnection-addicecandidate">addIceCandidate()</a></code>
            since then.</p>

            <p>A null object will be returned if the remote description has not
            yet been set.</p>
          </dd><dt id="widl-RTCPeerConnection-remoteStreams"><code>remoteStreams</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-MediaStreamArray"><code>MediaStreamArray</code></a></span>, readonly</dt><dd>
            <p>Returns a live array containing the streams that the remote
            streams. (those that were added by the remote side).</p>

            <p>This array is updated when <code><a href="#event-mediastream-addstream">addstream</a></code> and
            <code title="event-MediaStream-removestream"><a href="#event-mediastream-removestream">removestream</a></code> events
            are fired.</p>
          </dd></dl></section><section><h5 id="methods-4">Methods</h5><dl class="methods"><dt id="widl-RTCPeerConnection-addIceCandidate-void-RTCIceCandidate-candidate"><code>addIceCandidate</code></dt><dd>
            <p>The <dfn id="dom-peerconnection-addicecandidate"><code>addIceCandidate()</code></dfn>
            method provides a remote candidate to the ICE Agent, which will be
            added to the remote description. Connectivity checks will be sent
            to the new candidates as long as the "IceTransports" constraint is
            not set to "none". This call will result in a change to the state
            of the ICE Agent, and may result in a change to media state if it
            results in different connectivity being established.</p>

            <p>A TBD exception will be thrown if candidate parameter is
            malformed.</p>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">candidate</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-addStream-void-MediaStream-stream-MediaConstraints-constraints"><code>addStream</code></dt><dd>
            <p>Adds a new stream to the RTCPeerConnection.</p>

            <p>When the <dfn id="dom-peerconnection-addstream"><code title="">addStream()</code></dfn> method is invoked, the user agent <em title="must" class="rfc2119">must</em>
            run the following steps:</p>

            <ol>
              <li>
                <p>If the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
                <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
                readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), throw
                an <code>INVALID_STATE_ERR</code> exception.</p>
              </li>

              <li>
                <p>If <var>stream</var> is already in the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <code title="dom-RTCPeerConnection-localStreams"><a href="#widl-RTCPeerConnection-localStreams">localStreams</a></code>
                object, then abort these steps.</p>
              </li>

              <li>
                <p>Add <var>stream</var> to the end of the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <code title="dom-RTCPeerConnection-localStreams"><a href="#widl-RTCPeerConnection-localStreams">localStreams</a></code>
                object.</p>
              </li>

              <li>
                <p>Parse the <var>constraints</var> provided by the application
                and apply them to the MediaStream, if possible. NOTE - need to
                deal with throwing an exception here.</p>
              </li>

              <li>
                <p>Fire a negotiationneeded event.</p>

                <div class="issue"><div class="issue-title"><span>Issue 9</span></div><p class="">ISSUE: Should this fire if the
                RTCPeerConnection is in "new"?</p></div>
              </li>
            </ol>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">stream</td><td class="prmType"><code><a>MediaStream</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">constraints</td><td class="prmType"><code><a>MediaConstraints</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-close-void"><code>close</code></dt><dd>
            <p>When the <dfn id="dom-peerconnection-close"><code title="">close()</code></dfn> method is invoked, the user agent <em title="must" class="rfc2119">must</em> run
            the following steps:</p>

            <ol>
              <li>
                <p>If the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
                <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
                readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), throw
                an <code>INVALID_STATE_ERR</code> exception.</p>
              </li>

              <li>
                <p>Destroy the <a href="#peerconnection-ice-agent"><code>RTCPeerConnection</code> ICE
                Agent</a>, abruptly ending any active ICE processing and any
                active streaming, and releasing any relevant resources (e.g.
                TURN permissions).</p>
              </li>

              <li>
                <p>Set the object's <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
                readiness state</a> to <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3).</p>
              </li>
            </ol>
          <div><em>No parameters.</em></div><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-createAnswer-void-RTCSessionDescription-offer-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback--failureCallback---null-optional-MediaConstraints-constraints---null-optional-boolean-createProvisionalAnswer---false"><code>createAnswer</code></dt><dd>
            <p>The createAnswer method generates a [<cite><a href="#bib-SDP" class="bibref">SDP</a></cite>] answer with the
            supported configuration for the session that is compatible with the
            parameters supplied in offer. Like createOffer, the returned blob
            contains descriptions of the local MediaStreams attached to this
            RTCPeerConnection, the codec/RTP/RTCP options negotiated for this
            session, and any candidates that have been gathered by the ICE
            Agent. The constraints parameter may be supplied to provide
            additional control over the generated answer.</p>

            <p>As an answer, the generated SDP will contain a specific
            configuration that, along with the offer, specifies how the media
            plane should be established. The generation of the SDP must follow
            the appropriate process for generating an answer or provisional
            answer.</p>

            <p>Session descriptions generated by createAnswer must be
            immediately usable by setLocalDescription without generating an
            error if setLocalDescription is called from the successCallback
            function. Like createOffer, the returned description should reflect
            the current state of the system. The session descriptions <em title="must" class="rfc2119">must</em>
            remain usable by setLocalDescription without causing an error until
            at least the end of the successCallback function. Calling this
            method is needed to get the ICE user name fragment and password.
            Provisional offers, as described in [<cite><a href="#bib-RTCWEB-JSEP" class="bibref">RTCWEB-JSEP</a></cite>], are created if
            and only if the createProvisionalOffer flag is true.</p>

            <p>The failureCallback will be called if the system cannot
            generate an appropriate answer given the offer.</p>

            <p>A TBD exception is thrown if the constraints parameter is
            malformed.</p>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">offer</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">null</td><td class="prmType"><code><a>RTCPeerConnectionErrorCallback? failureCallback =</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">null</td><td class="prmType"><code><a>optional MediaConstraints constraints =</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">false</td><td class="prmType"><code><a>optional boolean createProvisionalAnswer =</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-createDataChannel-DataChannel-DOMString-label-DataChannelInit-dataChannelDict"><code>createDataChannel</code></dt><dd>
            <p>Creates a new <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object with the
            given label. The <code><a class="idlType" href="#idl-def-DataChannelInit"><code>DataChannelInit</code></a></code> dictionary can
            be used to configure properties of underlying channel such as 
            <!--priority and--> data reliability. A corresponding
            <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object is dispatched at the other
            peer if the channel setup was successful.</p>

            <p>When the <dfn id="dom-peerconnection-createdatachannel"><code>createDataChannel()</code></dfn>
            method is invoked, the user agent <em title="must" class="rfc2119">must</em> run the following steps.</p>

            <ol>
              <li>
                <p>If the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object’s
                <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
                readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), throw
                an <code>INVALID_STATE_ERR</code> exception.</p>
              </li>

              <li>
                <p>Let <var>channel</var> be a newly created
                <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object.</p>
              </li>

              <li>
                <p>Initialize <var>channel</var>’s <code><a href="#dom-datachannel-label">label</a></code> attribute to the
                value of the first argument.</p>
              </li>

              <li>
                <p>Initialize <var>channel</var>’s <code><a href="#dom-datachannel-reliable">reliable</a></code> attribute to
                true.</p>
              </li>

              <li>
                <p>If the second argument is present and it contains a
                <code><a href="#widl-DataChannelInit-reliable">reliable</a></code> dictionary
                member, then set <var>channel</var>’s <code><a href="#dom-datachannel-reliable">reliable</a></code> attribute to
                the dictionary member value.</p>
              </li>

              <li>
                <p>Return <var>channel</var> and continue these steps in the
                background.</p>
              </li>

              <li>
                <p>Create <var>channel</var>’s associated <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data
                transport</a>.</p>
              </li>
            </ol>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">label</td><td class="prmType"><code><a>DOMString</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">dataChannelDict</td><td class="prmType"><code><a class="idlType" href="#idl-def-DataChannelInit"><code>DataChannelInit</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code></div></dd><dt id="widl-RTCPeerConnection-createOffer-void-RTCSessionDescriptionCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback-MediaConstraints-constraints"><code>createOffer</code></dt><dd>
            <p>The createOffer method generates a blob of SDP that contains a
            RFC 3264 offer with the supported configurations for the session,
            including descriptions of the local MediaStreams attached to this
            RTCPeerConnection, the codec/RTP/RTCP options supported by this
            implementation, and any candidates that have been gathered by the
            ICE Agent. The constraints parameter may be supplied to provide
            additional control over the offer generated.</p>

            <p>As an offer, the generated SDP will contain the full set of
            capabilities supported by the session (as opposed to an answer,
            which will include only a specific negotiated subset to use); for
            each SDP line, the generation of the SDP must follow the
            appropriate process for generating an offer. In the event
            createOffer is called after the session is established, createOffer
            will generate an offer that is compatible with the current session,
            incorporating any changes that have been made to the session since
            the last complete offer-answer exchange, such as addition or
            removal of streams. If no changes have been made, the offer will be
            include the capabilities of the current local description as well
            as any additional capabilities that could be negotiated in an
            updated offer.</p>

            <p>Session descriptions generated by createOffer <em title="must" class="rfc2119">must</em> be
            immediately usable by setLocalDescription without causing an error
            as long as setLocalDiscription is called within the successCallback
            function. If a system has limited resources (e.g. a finite number
            of decoders), createOffer needs to return an offer that reflects
            the current state of the system, so that setLocalDescription will
            succeed when it attempts to acquire those resources. The session
            descriptions <em title="must" class="rfc2119">must</em> remain usable by setLocalDescription without
            causing an error until at least end of the successCallback
            function. Calling this method is needed to get the ICE user name
            fragment and password.</p>

            <p>The failureCallback will be called if the system can not
            generate an appropriate offer given the state of the
            RTCPeerConnection.</p>

            <p>A TBD exception is thrown if the constraints parameter is
            malformed.</p>

            <p>To Do: Discuss privacy aspects of this from a finger printing
            point of view - it's probably around as bad as access to a canvas
            :-)</p>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescriptionCallback"><code>RTCSessionDescriptionCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">constraints</td><td class="prmType"><code><a>MediaConstraints</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-removeStream-void-MediaStream-stream"><code>removeStream</code></dt><dd>
            <p>Removes the given stream from the localStream array in the
            RTCPeerConnection and fires negotiationneeded.</p>

            <p>When the other peer stops sending a stream in this manner, a
            <code title="event-MediaStream-removestream"><a href="#event-mediastream-removestream">removestream</a></code> event is
            fired at the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object.</p>

            <p>When the <dfn id="dom-peerconnection-removestream"><code title="">removeStream()</code></dfn> method is invoked, the user agent
            <em title="must" class="rfc2119">must</em> run the following steps:</p>

            <ol>
              <li>
                <p>If the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's
                <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
                readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), throw
                an <code>INVALID_STATE_ERR</code> exception.</p>
              </li>

              <li>
                <p>If <var>stream</var> is not in the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <code title="dom-RTCPeerConnection-localStreams"><a href="#widl-RTCPeerConnection-localStreams">localStreams</a></code>
                object, then abort these steps. TODO: Do we need an exception
                here?</p>
              </li>

              <li>
                <p>Remove <var>stream</var> from the
                <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object's <code title="dom-RTCPeerConnection-localStreams"><a href="#widl-RTCPeerConnection-localStreams">localStreams</a></code>
                object.</p>
              </li>

              <li>
                <p>Fire a negotiationneeded event.</p>
              </li>
            </ol>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">stream</td><td class="prmType"><code><a>MediaStream</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-setLocalDescription-void-RTCSessionDescription-description-RTCVoidCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>setLocalDescription</code></dt><dd>
            <p>The <dfn id="dom-peerconnection-setlocaldescription"><code>setLocalDescription()</code></dfn>
            method instructs the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> to apply
            the supplied <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> as the local
            description.</p>

            <p>This API changes the local media state. In order to successfully
            handle scenarios where the application wants to offer to change
            from one media format to a different, incompatible format, the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> must be able to
            simultaneously support use of both the old and new local
            descriptions (e.g. support codecs that exist in both descriptions)
            until a final answer is received, at which point the
            <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> can fully adopt the new local
            description, or roll back to the old description if the remote side
            denied the change.</p>

            <div class="issue"><div class="issue-title"><span>Issue 8</span></div><p class="">ISSUE: how to indicate to roll back?</p></div>

            <p>To Do: specify what parts of the SDP can be changed between the
            createOffer and setLocalDescription</p>

            <p>Changes to the state of media transmission will occur when a
            final answer is successfully applied.  <code><a class="internalDFN" href="#dom-peerconnection-localdescription">localDescription</a></code>
            <em title="must" class="rfc2119">must</em> return the previous description until the new
            description is successfully applied.</p>

            <p>The <code>failureCallback</code> will be called if the
            <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> is a valid description but cannot be
            applied at the media layer, e.g., if there are
            insufficient resources to apply the SDP.  The user agent
            <em title="must" class="rfc2119">must</em> roll back as necessary if the new description was
            partially applied when the failure occurred.</p>

            <p>A TBD exception is thrown if the SDP content is invalid.</p>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">description</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCVoidCallback"><code>RTCVoidCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-setRemoteDescription-void-RTCSessionDescription-description-RTCVoidCallback-successCallback-RTCPeerConnectionErrorCallback-failureCallback"><code>setRemoteDescription</code></dt><dd>
            <p>The <dfn id="dom-peerconnection-setremotedescription"><code>setRemoteDescription()</code></dfn>
            method instructs the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> to apply
            the supplied <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> as the
            remote offer or answer. This API changes the local media state.</p>

            <p>Changes to the state of media transmission will occur when a
            final answer is successfully applied.
            <code><a class="internalDFN" href="#dom-peerconnection-remotedescription">remoteDescription</a></code> <em title="must" class="rfc2119">must</em> return the previous
            description until the new description is successfully applied.</p>

            <p>The <code>failureCallback</code> will be called if the
            <code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code> is a valid description but
            cannot be applied at the media layer, e.g., if there are
            insufficient resources to apply the SDP. The user agent <em title="must" class="rfc2119">must</em> roll
            back as necessary if the new description was partially applied when
            the failure occurred.</p>

            <p>A TBD exception is thrown if the SDP content is invalid.</p>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">description</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCSessionDescription"><code>RTCSessionDescription</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr><tr><td class="prmName">successCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCVoidCallback"><code>RTCVoidCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">failureCallback</td><td class="prmType"><code><a class="idlType" href="#idl-def-RTCPeerConnectionErrorCallback"><code>RTCPeerConnectionErrorCallback</code></a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-RTCPeerConnection-updateIce-void-RTCConfiguration--configuration---null-optional-MediaConstraints--constraints---null-boolean-restart---false"><code>updateIce</code></dt><dd>
            <p>The updateIce method restarts or updates the ICE Agent process
            of gathering local candidates and pinging remote candidates. If
            there is a mandatory constraint called "IceTransports" it will
            control how the ICE engine can act. This can be used to limit
            the use to TURN candidates by a callee to avoid leaking location
            information prior to the call being accepted.</p>

            <p>This call may result in a change to the state of the ICE Agent,
            and may result in a change to media state if it results in
            connectivity being established.</p>

            <p>If the restart parameter is set to true, the ICE state machine
            discards all candidates it has gathered, allocates new ports for
            the host candidates, and restarts ICE as if there had been no
            previous ICE session. Applications can use this to reset all ICE
            negotiation when something has gone terribly wrong.</p>

            <p>A TBD exception will be thrown if constraints parameter is
            malformed.</p>
          <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">null</td><td class="prmType"><code><a>RTCConfiguration? configuration =</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">null</td><td class="prmType"><code><a>optional MediaConstraints? constraints =</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr><tr><td class="prmName">false</td><td class="prmType"><code><a>boolean restart =</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptTrue">✔</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd></dl></section>

      </div></section>
    </section>
  </section>

  <section id="iana-registrations">
    <!--OddPage--><h2 id="sec-iana"><span class="secno">6. </span>IANA Registrations</h2>

    <p>IANA is requested to register the constraints defined in <a href="#sec-constraints">Constraints Section</a> as specified in
    [<cite><a href="#bib-RTCWEB-CONSTRAINTS" class="bibref">RTCWEB-CONSTRAINTS</a></cite>].</p>

    <section id="constraints">
      <h3 id="sec-constraints"><span class="secno">6.1 </span>Constraints</h3>

      <p>TOOD: Need to change the naming and declaration of these constraints
      to match the constraints draft once that is a bit further along. The
      names here now are likely not quite right but they serve as a place
      holder.</p>

      <div class="issue"><div class="issue-title"><span>Issue 10</span></div><p class="">ISSUE: there are multiple ways to add constraints. How
      are multiple values reconciled?</p></div>

      <p>The following new constraints are defined that can be used with a
      RTCPeerConnection object:</p>

      <dl>
        <dt>OfferToReceiveVideo</dt>

        <dd>
          <p>This is a enum type constraint that can take the values "true" and
          "false". The default is a non mandatory "true" for a
          RTCPeerConnection object that has a video stream at the point in time
          when the constraints are being evaluated and is non mandatory "false"
          otherwise.</p>

          <p>In some cases, a RTCPeerConnection may wish to receive video but
          it is not going to send any video. The RTCPeerConnection needs to
          know if it should signal to the remote side if it wishes to receive
          video or not. This constraint allows an application to indicate its
          preferences for receiving video when creating an offer.</p>
        </dd>

        <dt>OfferToReceiveAudio</dt>

        <dd>
          <p>This is a enum type constraint that can take the values "true" and
          "false". The default is a non mandatory "true".</p>

          <p>In some cases, a RTCPeerConnection may wish to receive audio but
          it is not going to send any audio. The RTCPeerConnection needs to
          know if it should signal to the remote side if it wishes to receive
          audio. This constraints allows an application to indicate its
          preferences for receiving audio when creating an offer.</p>
        </dd>

        <dt>VoiceActivityDetection</dt>

        <dd>
          <p>This is a enum type constraint that can take the values "true" and
          "false". The default is a non mandatory "true".</p>

          <p>Many codecs and system are capable of detecting "silence" and
          changing their behavior in this case by doing things such as not
          transmitting any media. In many cases, such as when dealing with
          sounds other than spoken voice or emergency calling, it is desirable
          to be able to turn off this behavior. This constraints allows the
          application to provide information about if it wishes this type of
          processing enable or disabled.</p>
        </dd>

        <dt>IceTransports</dt>

        <dd>
          <p>This is a enum type constraint that can take the values "none",
          "relay", and "all". The default is a non mandatory "all".</p>

          <p>This constraint indicates which candidates the ICE engine is
          allowed to use. The value "none" means the ICE engine <em title="must" class="rfc2119">must</em> not
          send or receive any packets at this point. The value "relay" indicates
          the ICE engine <em title="must" class="rfc2119">must</em> only use media relay candidates such as
          candidates passing through a TURN server. This can be used to reduce
          leakage of IP addresses in certain use cases. The value of "all"
          indicates all values can be used.</p>
        </dd>
      </dl>

      <p>TODO items - need to register with IANA.</p>
    </section>
  </section><!--
      <section>
        <h3>SignalingCallback</h3>

        <dl class="idl"
            title="[Callback, NoInterfaceObject] interface SignalingCallback">
          <dt>void handleEvent (DOMString message, RTCPeerConnection source)</dt>

          <dd>Def TBD</dd>
        </dl>
      </section>
    -->

  <section id="simple-example">
    <!--OddPage--><h2><span class="secno">7. </span>Simple Example</h2>

    <div>
      <p>When two peers decide they are going to set up a connection to each
      other, they both go through these steps. The STUN/TURN server
      configuration describes a server they can use to get things like their
      public IP address or to set up NAT traversal. They also have to send data
      for the signaling channel to each other using the same out-of-band
      mechanism they used to establish that they were going to communicate in
      the first place.</p>

      <div class="example"><div class="example-title"><span>Example 1</span></div><pre class="example highlight prettyprint"><span class="kwd">var</span><span class="pln"> signalingChannel </span><span class="pun">=</span><span class="pln"> createSignalingChannel</span><span class="pun">();</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> pc</span><span class="pun">;</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> configuration </span><span class="pun">=</span><span class="pln"> </span><span class="pun">...;</span><span class="pln">

</span><span class="com">// run start(true) to initiate a call</span><span class="pln">
</span><span class="kwd">function</span><span class="pln"> start</span><span class="pun">(</span><span class="pln">isCaller</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    pc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCPeerConnection</span><span class="pun">(</span><span class="pln">configuration</span><span class="pun">);</span><span class="pln">

    </span><span class="com">// send any ice candidates to the other peer</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onicecandidate </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"candidate"</span><span class="pun">:</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">candidate </span><span class="pun">}));</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// once remote stream arrives, show it in the remote video element</span><span class="pln">
    pc</span><span class="pun">.</span><span class="pln">onaddstream </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        remoteView</span><span class="pun">.</span><span class="pln">src </span><span class="pun">=</span><span class="pln"> URL</span><span class="pun">.</span><span class="pln">createObjectURL</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">stream</span><span class="pun">);</span><span class="pln">
    </span><span class="pun">};</span><span class="pln">

    </span><span class="com">// get the local stream, show it in the local video element and send it</span><span class="pln">
    navigator</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln"> </span><span class="str">"audio"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln"> </span><span class="str">"video"</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">},</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        selfView</span><span class="pun">.</span><span class="pln">src </span><span class="pun">=</span><span class="pln"> URL</span><span class="pun">.</span><span class="pln">createObjectURL</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">);</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addStream</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">);</span><span class="pln">

        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">isCaller</span><span class="pun">)</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">createOffer</span><span class="pun">(</span><span class="pln">gotDescription</span><span class="pun">);</span><span class="pln">
        </span><span class="kwd">else</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">createAnswer</span><span class="pun">(</span><span class="pln">pc</span><span class="pun">.</span><span class="pln">remoteDescription</span><span class="pun">,</span><span class="pln"> gotDescription</span><span class="pun">);</span><span class="pln">

        </span><span class="kwd">function</span><span class="pln"> gotDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
            pc</span><span class="pun">.</span><span class="pln">setLocalDescription</span><span class="pun">(</span><span class="pln">desc</span><span class="pun">);</span><span class="pln">
            signalingChannel</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="pln">JSON</span><span class="pun">.</span><span class="pln">stringify</span><span class="pun">({</span><span class="pln"> </span><span class="str">"sdp"</span><span class="pun">:</span><span class="pln"> desc </span><span class="pun">}));</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
    </span><span class="pun">});</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

signalingChannel</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">pc</span><span class="pun">)</span><span class="pln">
        start</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">

    </span><span class="kwd">var</span><span class="pln"> signal </span><span class="pun">=</span><span class="pln"> JSON</span><span class="pun">.</span><span class="pln">parse</span><span class="pun">(</span><span class="pln">evt</span><span class="pun">.</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">signal</span><span class="pun">.</span><span class="pln">sdp</span><span class="pun">)</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">setRemoteDescription</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCSessionDescription</span><span class="pun">(</span><span class="pln">signal</span><span class="pun">.</span><span class="pln">sdp</span><span class="pun">));</span><span class="pln">
    </span><span class="kwd">else</span><span class="pln">
        pc</span><span class="pun">.</span><span class="pln">addIceCandidate</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">RTCIceCandidate</span><span class="pun">(</span><span class="pln">signal</span><span class="pun">.</span><span class="pln">candidate</span><span class="pun">));</span><span class="pln">
</span><span class="pun">};</span></pre></div>
    </div>
  </section>

  <section id="advanced-example">
    <!--OddPage--><h2><span class="secno">8. </span>Advanced Example</h2>

    <div>
      <p>This example shows the more comples functionality.</p>
      <div class="example"><div class="example-title"><span>Example 2</span></div><pre class="example highlight prettyprint"><span class="pln">TODO</span></pre></div>
    </div>
  </section>

  <section id="call-flow-browser-to-browser">
    <!--OddPage--><h2><span class="secno">9. </span>Call Flow Browser to Browser</h2>

    <div class="note"><div class="note-title"><span>Note</span></div><p class="">Editor Note: This example flow needs to be discussed on the
    list and is likely wrong in many ways.</p></div>

    <p>This shows an example of one possible call flow between two
    browsers. This does not show every callback that gets fired but instead
    tries to reduce it down to only show the key events and messages. </p>

    <p><img alt="A MediaStream" src="images/ladder-2party-simple.svg" width="100%"></p>

    <p> The following flow show a more complete set of the callbacks and events
    that happen. </p>

    <p><img alt="A MediaStream" src="images/ladder-2party-full.svg" width="100%"></p>
     </section>

    <section id="call-flow-browser-to-mcu">
    <!--OddPage--><h2><span class="secno">10. </span>Call Flow Browser to MCU </h2>

    <div class="note"><div class="note-title"><span>Note</span></div><p class="">Editor Note: This example flow needs to be discussed on the
    list and is likely wrong in many ways.</p></div>

    <p>This shows an example of one possible call flow between a centralized
    conferencing server and a browsers. This does not show every callback that
    gets fired but instead tries to reduce it down to only show the key events
    and messages. </p>

    <p><img alt="A MediaStream" src="images/ladder-mcu-simple.svg" width="100%"></p>
  </section>

  <section id="peer-to-peer-data-api">
    <!--OddPage--><h2><span class="secno">11. </span>Peer-to-peer Data API</h2>

    <p>The Peer-to-peer Data API lets a web application send and receive
    generic application data peer-to-peer.</p>

    <div class="issue"><div class="issue-title"><span>Issue 11</span>: More Open Issue</div><div class="">
      <ul>
        <li>Data channel setup signaling (signaling via SDP and application
        specific signaling channel or first channel via SDP and consecutive
        channels via internal signalling).</li>

        <li>What can be shared with the WebSocket API specification regarding
        actual interfaces.</li>
      </ul>
    </div></div>

    <section id="datachannel">
      <h3><span class="secno">11.1 </span>DataChannel</h3>

      <p>The <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> interface represents a
      bi-directional data channel between two peers. A
      <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> is created via a factory method on a
      <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object. The corresponding
      <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object is then dispatched at the other
      peer if the channel setup was successful.</p>

      <p>Each <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> has an associated <dfn id="dfn-underlying-data-transport">underlying
      data transport</dfn> that is used to transport actual data to the other
      peer. The transport properties of the <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a>,
      such as reliability mode, are configured by the peer taking the
      initiative to create the channel. The other peer cannot change any
      transport properties of a offered data channel. The actual wire protocol
      between the peers is out of the scope for this specification.</p>

      <p>A <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> created with <code><a href="#dom-peerconnection-createdatachannel">createDataChannel()</a></code>
      <em title="must" class="rfc2119">must</em> initially be in the <code><a href="#widl-DataChannelState-connecting">connecting</a></code> state. If the
      <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object’s <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a>
      is successfully set up, the user agent <em title="must" class="rfc2119">must</em> <a href="#announce-datachannel-open">announce the <code>DataChannel</code> as
      open</a>.</p>

      <p>When the user agent is to <dfn id="announce-datachannel-open">announce
      a <code>DataChannel</code> as open</dfn>, the user agent <em title="must" class="rfc2119">must</em> queue a
      task to run the following steps:</p>

      <ol>
        <li>
          <p>If the associated <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object’s
          <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
          readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), abort these
          steps.</p>
        </li>

        <li>
          <p>Let <var>channel</var> be the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
          object to be announced.</p>
        </li>

        <li>
          <p>Set <var>channel</var>’s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
          <code><a href="#widl-DataChannelState-open">open</a></code>.</p>
        </li>

        <li>
          <p><a>Fire a simple event</a> named <code><a href="#event-datachannel-open">open</a></code> at <var>channel</var>.</p>
        </li>
      </ol>

      <p>When an <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> has been established, the
      user agent, of the peer that did not initiate the creation process <em title="must" class="rfc2119">must</em>
      queue a task to run the following steps:</p>

      <ol>
        <li>
          <p>If the associated <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object’s
          <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
          readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code> (3), abort these
          steps.</p>
        </li>

        <li>
          <p>Let <var>configuration</var> be an information bundle with
          key-value pairs, received from the other peer as a part of the
          process to establish the <a>underlying data channel</a>.</p>
        </li>

        <li>
          <p>Let <var>channel</var> be a newly created
          <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object.</p>
        </li>

        <li>
          <p>Initialize <var>channel</var>’s <code><a href="#dom-datachannel-label">label</a></code> attribute to value that
          corresponds to the "<code>label</code>" key in
          <var>configuration</var>.</p>
        </li>

        <li>
          <p>Initialize <var>channel</var>’s <code><a href="#dom-datachannel-reliable">reliable</a></code> attribute to
          true.</p>
        </li>

        <li>
          <p>If <var>configuration</var> contains a key named
          "<code>reliable</code>", set <var>channel</var>’s <code><a href="#dom-datachannel-reliable">reliable</a></code> attribute to the
          corresponding value.</p>
        </li><!--
          <li>
          <p>Have the user agent <a href="#announce-datachannel-open">announce
          <var>connection</var> as open</a>.</p>
          </li>
          -->

        <li>
          <p>Set <var>channel</var>’s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
          <code><a href="#widl-DataChannelState-open">open</a></code>.</p>
        </li>

        <li>
          <p><a>Fire a datachannel event</a> named <code><a href="#event-peerconnection-datachannel">datachannel</a></code> with
          <var>channel</var> at the <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
          object.</p>
        </li>
      </ol>

      <p>When the <dfn id="tear-down-data-transport">process of tearing down a
      <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object’s <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data
      transport</a></dfn> is initiated, the user agent <em title="must" class="rfc2119">must</em> run the following
      steps:</p>

      <ol>
        <li>
          <p>If the associated <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code> object’s
          <a href="#peerconnection-readiness-state"><code>RTCPeerConnection</code>
          readiness state</a> is <code><a href="#widl-RTCPeerConnection-CLOSED">CLOSED</a></code>, abort these
          steps.</p>
        </li>

        <li>
          <p>Let <var>channel</var> be the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
          object which is about to be closed.</p>
        </li>

        <li>
          <p>If <var>channel</var>’s <code><a href="#dom-datachannel-readystate">readyState</a></code> is <code><a href="#widl-DataChannelState-closing">closing</a></code> or <code><a href="#widl-DataChannelState-closed">closed</a></code>, then abort these
          steps.</p>
        </li>

        <li>
          <p>Set <var>channel</var>’s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
          <code><a href="#widl-DataChannelState-closing">closing</a></code>.</p>
        </li>

        <li>
          <p>Queue a task to run the following steps:</p>
        </li>

        <li>
          <ol>
            <li>
              <p>Close <var>channel</var>’s <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data
              transport</a>.</p>

              <div class="note"><div class="note-title"><span>Note</span></div><div class="">
                The data transport protocol will specify what happens to, e.g.
                buffered data, when the data transport is closed.
              </div></div>
            </li>

            <li>
              <p>Set <var>channel</var>’s <code><a href="#dom-datachannel-readystate">readyState</a></code> attribute to
              <code><a href="#widl-DataChannelState-closed">closed</a></code>
              (3).</p>
            </li>

            <li>
              <p>Fire a simple event named <code title="event-DataChannel-close"><a href="#event-datachannel-close">close</a></code> at
              <var>channel</var>.</p>
            </li>
          </ol>
        </li>
      </ol>

      <pre class="idl"><span class="idlInterface" id="idl-def-DataChannel">interface <span class="idlInterfaceID">DataChannel</span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>DOMString</a></span>        <span class="idlAttrName"><a href="#widl-DataChannel-label">label</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>boolean</a></span>          <span class="idlAttrName"><a href="#widl-DataChannel-reliable">reliable</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-DataChannelState"><code>DataChannelState</code></a></span> <span class="idlAttrName"><a href="#widl-DataChannel-readyState">readyState</a></span>;</span>
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>unsigned long</a></span>    <span class="idlAttrName"><a href="#widl-DataChannel-bufferedAmount">bufferedAmount</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>     <span class="idlAttrName"><a href="#widl-DataChannel-onopen">onopen</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>     <span class="idlAttrName"><a href="#widl-DataChannel-onerror">onerror</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>     <span class="idlAttrName"><a href="#widl-DataChannel-onclose">onclose</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-DataChannel-close-void">close</a></span> ();</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>EventHandler</a></span>     <span class="idlAttrName"><a href="#widl-DataChannel-onmessage">onmessage</a></span>;</span>
<span class="idlAttribute">             attribute <span class="idlAttrType"><a>DOMString</a></span>        <span class="idlAttrName"><a href="#widl-DataChannel-binaryType">binaryType</a></span>;</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-DataChannel-send-void-DOMString-data">send</a></span> (<span class="idlParam"><span class="idlParamType"><a>DOMString</a></span> <span class="idlParamName">data</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-DataChannel-send-void-ArrayBuffer-data">send</a></span> (<span class="idlParam"><span class="idlParamType"><a>ArrayBuffer</a></span> <span class="idlParamName">data</span></span>);</span>
<span class="idlMethod">    <span class="idlMethType"><a>void</a></span> <span class="idlMethName"><a href="#widl-DataChannel-send-void-Blob-data">send</a></span> (<span class="idlParam"><span class="idlParamType"><a>Blob</a></span> <span class="idlParamName">data</span></span>);</span>
};</span></pre><section id="attributes-3"><h4><span class="secno">11.1.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-DataChannel-binaryType"><code>binaryType</code> of type <span class="idlAttrType"><a>DOMString</a></span></dt><dd>
          <div class="note"><div class="note-title"><span>Note</span></div><p class="">FIXME: align behavior with WebSocket API</p></div>
        </dd><dt id="widl-DataChannel-bufferedAmount"><code>bufferedAmount</code> of type <span class="idlAttrType"><a>unsigned long</a></span>, readonly</dt><dd>
          <div class="note"><div class="note-title"><span>Note</span></div><p class="">FIXME: align behavior with WebSocket API</p></div>
        </dd><dt id="widl-DataChannel-label"><code>label</code> of type <span class="idlAttrType"><a>DOMString</a></span>, readonly</dt><dd>
          <p>The <dfn id="dom-datachannel-label"><code>DataChannel.label</code></dfn>
          attribute represents a label that can be used to distinguish this
          <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object from other
          <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> objects. The attribute <em title="must" class="rfc2119">must</em> return
          the value to which it was set when the
          <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object was created.</p>
        </dd><dt id="widl-DataChannel-onclose"><code>onclose</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of type <code><a href="#event-datachannel-close">close</a></code> , <em title="must" class="rfc2119">must</em> be supported by all
        objects implementing the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
        interface.</dd><dt id="widl-DataChannel-onerror"><code>onerror</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of type <code><a href="#event-datachannel-error">error</a></code> , <em title="must" class="rfc2119">must</em> be supported by all
        objects implementing the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
        interface.</dd><dt id="widl-DataChannel-onmessage"><code>onmessage</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of type <code><a href="#event-datachannel-message">message</a></code> , <em title="must" class="rfc2119">must</em> be supported by
        all objects implementing the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
        interface.</dd><dt id="widl-DataChannel-onopen"><code>onopen</code> of type <span class="idlAttrType"><a>EventHandler</a></span></dt><dd>This event handler, of type <code><a href="#event-datachannel-open">open</a></code> , <em title="must" class="rfc2119">must</em> be supported by all
        objects implementing the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
        interface.</dd><dt id="widl-DataChannel-readyState"><code>readyState</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-DataChannelState"><code>DataChannelState</code></a></span>, readonly</dt><dd>
          <p>The <dfn id="dom-datachannel-readystate"><code>DataChannel.readyState</code></dfn>
          attribute represents the state of the <code>DataChannel</code>
          object. It <em title="must" class="rfc2119">must</em> return the value to which the user agent last set it
          (as defined by the processing model algorithms).</p>
        </dd><dt id="widl-DataChannel-reliable"><code>reliable</code> of type <span class="idlAttrType"><a>boolean</a></span>, readonly</dt><dd>
          <p>The <dfn id="dom-datachannel-reliable"><code>DataChannel.reliable</code></dfn>
          attribute returns true if the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> is
          reliable, and false otherwise. The attribute <em title="must" class="rfc2119">must</em> return the value to
          which it was set when the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> was
          created.</p>
        </dd></dl></section><section id="methods-3"><h4><span class="secno">11.1.2 </span>Methods</h4><dl class="methods"><dt id="widl-DataChannel-close-void"><code>close</code></dt><dd>
          <p>Closes the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> . It may be called
          regardless if the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object was created
          by this peer or the remote peer.</p>

          <p>When the <dfn id="dfn-close"><code>close()</code></dfn> method is called, the
          user agent <em title="must" class="rfc2119">must</em> initiate <a href="#tear-down-data-transport">the
          process of tearing down</a> the <code>DataChannel</code> object’s
          <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a>.</p>
        <div><em>No parameters.</em></div><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-DataChannel-send-void-DOMString-data"><code>send</code></dt><dd>
          <div class="note"><div class="note-title"><span>Note</span></div><p class="">FIXME: align behavior with WebSocket API</p></div>
        <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code><a>DOMString</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-DataChannel-send-void-ArrayBuffer-data"><code>send</code></dt><dd>
          <div class="note"><div class="note-title"><span>Note</span></div><p class="">FIXME: align behavior with WebSocket API</p></div>
        <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code><a>ArrayBuffer</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd><dt id="widl-DataChannel-send-void-Blob-data"><code>send</code></dt><dd>
          <div class="note"><div class="note-title"><span>Note</span></div><p class="">FIXME: align behavior with WebSocket API</p></div>
        <table class="parameters"><tr><th>Parameter</th><th>Type</th><th>Nullable</th><th>Optional</th><th>Description</th></tr><tr><td class="prmName">data</td><td class="prmType"><code><a>Blob</a></code></td><td class="prmNullFalse">✘</td><td class="prmOptFalse">✘</td><td class="prmDesc"></td></tr></table><div><em>Return type: </em><code><a>void</a></code></div></dd></dl></section>

      <pre class="idl"><span class="idlDictionary" id="idl-def-DataChannelInit">dictionary <span class="idlDictionaryID">DataChannelInit</span> {
<span class="idlMember">    <span class="idlMemberType"><a>boolean</a></span> <span class="idlMemberName"><a href="#widl-DataChannelInit-reliable">reliable</a></span>;</span>
};</span></pre><section id="dictionary-datachannelinit-members"><h4><span class="secno">11.1.3 </span>Dictionary <a href="#idl-def-DataChannelInit" class="idlType"><code>DataChannelInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-DataChannelInit-reliable"><code>reliable</code> of type <span class="idlMemberType"><a>boolean</a></span></dt><dd>FIXME: write description</dd></dl></section>

      <pre class="idl"><span class="idlEnum" id="idl-def-DataChannelState">enum <span class="idlEnumID">DataChannelState</span> {
    "<span class="idlEnumItem">connecting</span>",
    "<span class="idlEnumItem">open</span>",
    "<span class="idlEnumItem">closing</span>",
    "<span class="idlEnumItem">closed</span>"
};</span></pre><table class="simple"><tr><th colspan="2">Enumeration description</th></tr><tr><td><code>connecting</code></td><td>
          <p>The user agent is attempting to establish the <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data
          transport</a>. This is the initial state of a
          <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object created with <code><a href="#dom-peerconnection-createdatachannel">createDataChannel()</a></code>
          .</p>
        </td></tr><tr><td><code>open</code></td><td>
          <p>The <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> is established and
          communication is possible. This is the initial state of a
          <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object dispatched as a part of a
          <code><a class="idlType" href="#idl-def-DataChannelEvent"><code>DataChannelEvent</code></a></code> .</p>
        </td></tr><tr><td><code>closing</code></td><td>
          <p>The process of closing down the <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a>
          has started.</p>
        </td></tr><tr><td><code>closed</code></td><td>
          <p>The <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data transport</a> has been closed or could not
          be established.</p>
        </td></tr></table>
    </section>

    <section id="examples">
      <h3><span class="secno">11.2 </span>Examples</h3>

      <div>
        <p>This simple example shows how to create a DataChannel, register an
        event listener to handle incoming data, and how to send a message.</p>
        <div class="example"><div class="example-title"><span>Example 3</span></div><pre class="example highlight prettyprint"><span class="kwd">var</span><span class="pln"> chan </span><span class="pun">=</span><span class="pln"> peerConn</span><span class="pun">.</span><span class="pln">createDataChannel</span><span class="pun">(</span><span class="str">"mylabel"</span><span class="pun">);</span><span class="pln">
chan</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    </span><span class="com">// use evt.data };</span><span class="pln">
    chan</span><span class="pun">.</span><span class="pln">send</span><span class="pun">(</span><span class="str">"hello"</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span></pre></div>
      </div>

      <div>
        <p>This simple example shows how to register an event listener to
        handle the case when a remote peer creates a new DataChannel.</p>
        <div class="example"><div class="example-title"><span>Example 4</span></div><pre class="example highlight prettyprint"><span class="pln">peerConn</span><span class="pun">.</span><span class="pln">ondatachannel </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
   </span><span class="kwd">var</span><span class="pln"> chan </span><span class="pun">=</span><span class="pln"> evt</span><span class="pun">.</span><span class="pln">channel</span><span class="pun">;</span><span class="pln">
   chan</span><span class="pun">.</span><span class="pln">onmessage </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">evt</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
       </span><span class="com">// use evt.data</span><span class="pln">
   </span><span class="pun">};</span><span class="pln">
   chan</span><span class="pun">.</span><span class="pln">onclose </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="com">// remote side closed the data channel</span><span class="pln">
   </span><span class="pun">};</span><span class="pln">
</span><span class="pun">};</span></pre></div>
      </div>

    <!--div>
    <p>This simple example shows how configure two DataChannel objects for different purposes.</p>
<pre  class='example sh_javascript'>
// the chat channel is reliable and not as prioritized as game data
var chatChan = peerConn.createDataChannel("chat", { "priority": 1 });

// the game data channel is prioritized and unreliable low latency channel for high performance
var gameDataChan = peerConn.createDataChannel("data", { "reliable": false, "priority": 10 });
    </pre>
  </div-->
    </section>
  </section>

  <section id="garbage-collection">
    <!--OddPage--><h2><span class="secno">12. </span>Garbage collection</h2>

    <p>A <code>Window</code> object <dfn id="concept-peerconnection-owner">has
    a strong reference</dfn> to any <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
    objects created from the constructor whose global object is that
    <code>Window</code> object.</p>
    <!-- we could be less strict here, e.g. dropping the reference when
  there’s no way for an event to be fired because there’s no event handlers
  registered and there’s no way for the remote peer to notice anything because
  no media is streaming; or e.g. dropping the reference when the object reaches
  the CLOSED state. But as dropping the reference in those cases is black-box
  indistinguishable from keeping the reference, I haven't bothered to work out
  the exact rules. If you do change this, see the /unloading document cleanup
  steps/. -->
  </section>

  <section id="event-definitions">
    <!--OddPage--><h2><span class="secno">13. </span>Event definitions</h2>

    <section id="rtcpeerconnectioniceevent">
      <h3><span class="secno">13.1 </span>RTCPeerConnectionIceEvent</h3>

      <p>The <code>onicecandidate</code> event of the RTCPeerConnection uses
      the <code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code> interface.</p>

      <p><dfn id="dfn-fire-an-ice-candidate-event" title="Fire an ice candidate event">Firing a
      <code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code> event named
      <var>e</var></dfn> with an <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code>
      <var>candidate</var> means that an event with the name <var>e</var>,
      which does not bubble (except where otherwise stated) and is not
      cancelable (except where otherwise stated), and which uses the
      <code>RTCPeerConnectionIceEvent</code> interface with the
      <code>candidate</code> attribute set to the new ICE candidate <em title="must" class="rfc2119">must</em> be
      created and dispatched at the given target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-RTCPeerConnectionIceEvent">[<span class="extAttr">Constructor(DOMString type, RTCPeerConnectionIceEventInit eventInitDict)</span>]
interface <span class="idlInterfaceID">RTCPeerConnectionIceEvent</span> : <span class="idlSuperclass"><a>Event</a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span> <span class="idlAttrName"><a href="#widl-RTCPeerConnectionIceEvent-candidate">candidate</a></span>;</span>
};<br><span class="idlDictionary" id="idl-def-RTCPeerConnectionIceEventInit">dictionary <span class="idlDictionaryID">RTCPeerConnectionIceEventInit</span> : <span class="idlSuperclass"><a>EventInit</a></span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span> <span class="idlMemberName"><a href="#widl-RTCPeerConnectionIceEventInit-candidate">candidate</a></span>;</span>
};</span></span></pre><section id="attributes-4"><h4><span class="secno">13.1.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-RTCPeerConnectionIceEvent-candidate"><code>candidate</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span>, readonly</dt><dd>
          <p>The <code>candidate</code> attribute is the
          <code><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></code> object with the new ICE candidate
          that caused the event.</p>
        </dd></dl></section>

      <section id="dictionary-rtcpeerconnectioniceeventinit-members"><h4><span class="secno">13.1.2 </span>Dictionary <a href="#idl-def-RTCPeerConnectionIceEventInit" class="idlType"><code>RTCPeerConnectionIceEventInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-RTCPeerConnectionIceEventInit-candidate"><code>candidate</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-RTCIceCandidate"><code>RTCIceCandidate</code></a></span></dt><dd>
          <p>&nbsp;</p>
        </dd></dl></section>
    </section>

    <section id="mediastreamtrackevent">
      <h3><span class="secno">13.2 </span>MediaStreamTrackEvent</h3>

      <p>The <code><a href="#event-mediastreamtracklist-addtrack">addtrack</a></code> and
      <code title="event-MediaStreamTracklist-removetrack"><a href="#event-mediastreamtracklist-removetrack">removetrack</a></code> events
      use the <code><a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a></code> interface.</p>

      <p><dfn id="dfn-fire-a-track-event" title="Fire a track event">Firing a track event named
      <var>e</var></dfn> with a <code><a>MediaStreamTrack</a></code>
      <var>track</var> means that an event with the name <var>e</var>, which
      does not bubble (except where otherwise stated) and is not cancelable
      (except where otherwise stated), and which uses the
      <code><a class="idlType" href="#idl-def-MediaStreamTrackEvent"><code>MediaStreamTrackEvent</code></a></code> interface with the
      <code><a href="#dom-mediastreamtrackevent-track">track</a></code>
      attribute set to <var>track</var>, <em title="must" class="rfc2119">must</em> be created and dispatched at the
      given target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamTrackEvent">[<span class="extAttr">Constructor(DOMString type, MediaStreamTrackEventInit eventInitDict)</span>]
interface <span class="idlInterfaceID">MediaStreamTrackEvent</span> : <span class="idlSuperclass"><a>Event</a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>MediaStreamTrack</a></span> <span class="idlAttrName"><a href="#widl-MediaStreamTrackEvent-track">track</a></span>;</span>
};<br><span class="idlDictionary" id="idl-def-MediaStreamTrackEventInit">dictionary <span class="idlDictionaryID">MediaStreamTrackEventInit</span> : <span class="idlSuperclass"><a>EventInit</a></span> {
<span class="idlMember">    <span class="idlMemberType"><a>readonly MediaStreamTrack</a>?</span> <span class="idlMemberName"><a href="#widl-MediaStreamTrackEventInit-track">track</a></span>;</span>
};</span></span></pre><section id="attributes-5"><h4><span class="secno">13.2.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaStreamTrackEvent-track"><code>track</code> of type <span class="idlAttrType"><a>MediaStreamTrack</a></span>, readonly</dt><dd>
          <p>The <dfn id="dom-mediastreamtrackevent-track"><code>track</code></dfn> attribute
          represents the <code><a>MediaStreamTrack</a></code> object associated
          with the event.</p>
        </dd></dl></section>

      <section id="dictionary-mediastreamtrackeventinit-members"><h4><span class="secno">13.2.2 </span>Dictionary <a href="#idl-def-MediaStreamTrackEventInit" class="idlType"><code>MediaStreamTrackEventInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-MediaStreamTrackEventInit-track"><code>track</code> of type <span class="idlMemberType"><a>readonly MediaStreamTrack</a></span>, nullable</dt><dd>
          <p>&nbsp;</p>
        </dd></dl></section>
    </section>

    <section id="mediastreamevent">
      <h3><span class="secno">13.3 </span>MediaStreamEvent</h3>

      <p>The <code><a href="#event-mediastream-addstream">addstream</a></code>
      and <code title="event-MediaStream-removestream"><a href="#event-mediastream-removestream">removestream</a></code> events use the
      <code><a class="idlType" href="#idl-def-MediaStreamEvent"><code>MediaStreamEvent</code></a></code> interface.</p>

      <p><dfn id="fire-a-stream-event" title="fire a stream event">Firing a
      stream event named <var>e</var></dfn> with a
      <code><a>MediaStream</a></code> <var>stream</var> means that an event
      with the name <var>e</var>, which does not bubble (except where otherwise
      stated) and is not cancelable (except where otherwise stated), and which
      uses the <code><a class="idlType" href="#idl-def-MediaStreamEvent"><code>MediaStreamEvent</code></a></code> interface with the
      <code><a href="#dom-mediastreamevent-stream">stream</a></code> attribute
      set to <var title="">stream</var>, <em title="must" class="rfc2119">must</em> be created and dispatched at the
      given target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-MediaStreamEvent">[<span class="extAttr">Constructor(DOMString type, MediaStreamEventInit eventInitDict)</span>]
interface <span class="idlInterfaceID">MediaStreamEvent</span> : <span class="idlSuperclass"><a>Event</a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a>MediaStream</a>?</span> <span class="idlAttrName"><a href="#widl-MediaStreamEvent-stream">stream</a></span>;</span>
};<br><span class="idlDictionary" id="idl-def-MediaStreamEventInit">dictionary <span class="idlDictionaryID">MediaStreamEventInit</span> : <span class="idlSuperclass"><a>EventInit</a></span> {
<span class="idlMember">    <span class="idlMemberType"><a>MediaStream</a></span> <span class="idlMemberName"><a href="#widl-MediaStreamEventInit-stream">stream</a></span>;</span>
};</span></span></pre><section id="attributes-6"><h4><span class="secno">13.3.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-MediaStreamEvent-stream"><code>stream</code> of type <span class="idlAttrType"><a>MediaStream</a></span>, readonly, nullable</dt><dd>
          <p>The <dfn id="dom-mediastreamevent-stream"><code>stream</code></dfn> attribute
          represents the <code><a>MediaStream</a></code> object associated with
          the event.</p>
        </dd></dl></section>

      <section id="dictionary-mediastreameventinit-members"><h4><span class="secno">13.3.2 </span>Dictionary <a href="#idl-def-MediaStreamEventInit" class="idlType"><code>MediaStreamEventInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-MediaStreamEventInit-stream"><code>stream</code> of type <span class="idlMemberType"><a>MediaStream</a></span></dt><dd>
          <p>&nbsp;</p>
        </dd></dl></section>
    </section>

    <section id="datachannelevent">
      <h3><span class="secno">13.4 </span>DataChannelEvent</h3>

      <p>The <code><a href="#event-peerconnection-datachannel">datachannel</a></code> event use the
      <code><a class="idlType" href="#idl-def-DataChannelEvent"><code>DataChannelEvent</code></a></code> interface.</p>

      <p><dfn id="fire-a-datachannel-event" title="fire a datachannel event">Firing a datachannel event named
      <var>e</var></dfn> with a <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
      <var>channel</var> means that an event with the name <var>e</var>, which
      does not bubble (except where otherwise stated) and is not cancelable
      (except where otherwise stated), and which uses the
      <code><a class="idlType" href="#idl-def-DataChannelEvent"><code>DataChannelEvent</code></a></code> interface with the <code><a href="#dom-datachannelevent-channel">channel</a></code> attribute set to
      <var>channel</var>, <em title="must" class="rfc2119">must</em> be created and dispatched at the given
      target.</p>

      <pre class="idl"><span class="idlInterface" id="idl-def-DataChannelEvent">[<span class="extAttr">Constructor(DOMString type, DataChannelEventInit eventInitDict)</span>]
interface <span class="idlInterfaceID">DataChannelEvent</span> : <span class="idlSuperclass"><a>Event</a></span> {
<span class="idlAttribute">    readonly attribute <span class="idlAttrType"><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></span> <span class="idlAttrName"><a href="#widl-DataChannelEvent-channel">channel</a></span>;</span>
};<br><span class="idlDictionary" id="idl-def-DataChannelEventInit">dictionary <span class="idlDictionaryID">DataChannelEventInit</span> : <span class="idlSuperclass"><a>EventInit</a></span> {
<span class="idlMember">    <span class="idlMemberType"><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></span> <span class="idlMemberName"><a href="#widl-DataChannelEventInit-channel">channel</a></span>;</span>
};</span></span></pre><section id="attributes-7"><h4><span class="secno">13.4.1 </span>Attributes</h4><dl class="attributes"><dt id="widl-DataChannelEvent-channel"><code>channel</code> of type <span class="idlAttrType"><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></span>, readonly</dt><dd>
          <p>The <dfn id="dom-datachannelevent-channel"><code>channel</code></dfn> attribute
          represents the <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object associated with
          the event.</p>
        </dd></dl></section>

      <section id="dictionary-datachanneleventinit-members"><h4><span class="secno">13.4.2 </span>Dictionary <a href="#idl-def-DataChannelEventInit" class="idlType"><code>DataChannelEventInit</code></a> Members</h4><dl class="dictionary-members"><dt id="widl-DataChannelEventInit-channel"><code>channel</code> of type <span class="idlMemberType"><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></span></dt><dd>
          <p>&nbsp;</p>
        </dd></dl></section>
    </section>
  </section>

  <section id="event-summary" class="informative">
    <!--OddPage--><h2><span class="secno">14. </span>Event summary</h2><p><em>This section is non-normative.</em></p>

    <p>The following event fires on <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code>
    objects:</p>

    <table style="border-width:0; width:60%" border="1">
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn id="event-datachannel-open"><code>open</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>
            The <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object’s <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data
            transport</a> has been established (or re-established).
          </td>
        </tr>

        <tr>
          <td><dfn id="event-datachannel-message"><code>MessageEvent</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>A message was successfully received. TODO: Ref where MessageEvent
          is defined?</td>
        </tr>

        <tr>
          <td><dfn id="event-datachannel-error"><code>error</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>TODO.</td>
        </tr>

        <tr>
          <td><dfn id="event-datachannel-close"><code>close</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>
            The <code><a class="idlType" href="#idl-def-DataChannel"><code>DataChannel</code></a></code> object’s <a class="internalDFN" href="#dfn-underlying-data-transport">underlying data
            transport</a> has was closed.
          </td>
        </tr>
      </tbody>
    </table>

    <p>The following events fire on <code><a class="idlType" href="#idl-def-RTCPeerConnection"><code>RTCPeerConnection</code></a></code>
    objects:</p>

    <table style="border-width:0; width:60%" border="1">
      <tbody><tr>
        <th>Event name</th>

        <th>Interface</th>

        <th>Fired when...</th>
      </tr>

      </tbody><tbody>
        <tr>
          <td><dfn id="event-mediastream-connecting"><code>connecting</code></dfn></td>

          <td><code>Event</code></td>

          <td>TODO</td>
        </tr>

        <tr>
          <td><dfn id="event-mediastream-open"><code>open</code></dfn></td>

          <td><code>Event</code></td>

          <td>TODO</td>
        </tr>
        <!--
        <tr>
          <td><dfn title="event-MediaStream-error"><code>error</code></dfn></td>
          <td><code>Event</code></td>
          <td></td>
        </tr>
        <tr>
          <td><dfn title="event-MediaStream-close"><code>close</code></dfn></td>
          <td><code>Event</code></td>
          <td>The <code title="dom-RTCPeerConnection-close">close()</code> method was
            called. </td>
        </tr>
        <tr>
          <td>
            <dfn id="event-mediastream-message">
              <code>message</code>
            </dfn>
          </td>

          <td>
            <code>MessageEvent</code>
          </td>

          <td>A <a href="#data-udp-media-stream">data UDP media
          stream</a> message was received.</td>
        </tr>
        -->

        <tr>
          <td><dfn id="event-mediastream-addstream"><code>addstream</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-MediaStreamEvent"><code>MediaStreamEvent</code></a></code></td>

          <td>A new stream has been added to the <code title="dom-RTCPeerConnection-remoteStreams"><a href="#widl-RTCPeerConnection-remoteStreams">remoteStreams</a></code>
          array.</td>
        </tr>

        <tr>
          <td><dfn id="event-mediastream-removestream"><code>removestream</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-MediaStreamEvent"><code>MediaStreamEvent</code></a></code></td>

          <td>A stream has been removed from the <code title="dom-RTCPeerConnection-remoteStreams"><a href="#widl-RTCPeerConnection-remoteStreams">remoteStreams</a></code>
          array.</td>
        </tr>

        <tr>
          <td><dfn id="event-negotiation"><code>negotiationneeded</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>
            The browser wishes to inform the application that session
            negotiation needs to be done at some point in the near future.
          </td>
        </tr>

        <tr>
          <td><dfn id="event-statechange"><code>statechange</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>TODO</td>
        </tr>

        <tr>
          <td><dfn id="event-icechange"><code>icechange</code></dfn></td>

          <td><code><a>Event</a></code></td>

          <td>TODO</td>
        </tr>

        <tr>
          <td><dfn id="event-icecandidate"><code>icecandidate</code></dfn></td>

          <td><code><a class="idlType" href="#idl-def-RTCPeerConnectionIceEvent"><code>RTCPeerConnectionIceEvent</code></a></code></td>

          <td>TODO</td>
        </tr>
      </tbody>
    </table>

  </section>

  <section id="security-considerations">
    <!--OddPage--><h2><span class="secno">15. </span>Security Considerations</h2>
    <p>TBD.</p>
  </section>

  <section id="change-log">
    <!--OddPage--><h2><span class="secno">16. </span>Change Log</h2>

    <p>This section will be removed before publication.</p>

    <!-- Why do the first two headings automatically convert to <h2>? -->
    <h2 id="changes-since-aug-13-2012">Changes since Aug 13, 2012</h2>

    <ol>
      <li>Made the RTCSessionDescription and RTCIceCandidate constructors take
      dictionaries instead of a strings. Also added detailed stringifier
      algorithm.</li>

      <li>Went through the list of issues (issue numbers are only valid with
      HEAD at fcda53c460). Closed (fixed/wontfix): 1, 8, 10, 13, 14, 16, 18, 19,
      22, 23, 24. Converted to notes: 4, 12. Updated: 9.</li>

      <li>Incorporate
      <a href="http://lists.w3.org/Archives/Public/www-archive/2012Aug/0015.html">
      changes proposed</a> by Li Li.</li>

      <li>Use an enum for DataChannelState and fix IDLs where using an optional
      argument also requires all previous optional arguments to have a default
      value.</li>
    </ol>

    <h2 id="changes-since-jul-20-2012">Changes since Jul 20, 2012</h2>

    <ol>
      <li>Added RTC Prefix to names (including the notes below).</li>

      <li>Moved to new defintion of configuration and ice servers object.</li>

      <li>Added correlating lines to candidate structure.</li>

      <li>Converted setLocalDescription and setRemoteDescription to be asynchronous.</li>

      <li>Added call flows.</li>
     </ol>

    <h3 id="changes-since-jul-13-2012">Changes since Jul 13, 2012</h3>

    <ol>
      <li>Removed peer attribute from RTCPeerConnectionIceEvent (duplicates
      functionality of Event.target attribute).</li>

      <li>Removed RTCIceCandidateCallback (no longer used).</li>

      <li>Removed RTCPeerConnectionEvent (we use a simple event instead).</li>

      <li>Removed RTCSdpType argument from setLocalDescription() and
      setRemoteDescription(). Updated simple example to match.</li>
    </ol>

    <h3 id="changes-since-may-28-2012">Changes since May 28, 2012</h3>

    <ol>
      <li>Changed names to use RTC Prefix.</li>

      <li>Changed the data structure used to pass in STUN and TURN servers in
      configuration.</li>

      <li>Updated simple RTCPeerConnection example (RTCPeerConnection
      constructor arguments; use icecandidate event).</li>

      <li>Initial import of new Data API.</li>

      <li>Removed some left-overs from the old Data Stream API.</li>

      <li>Renamed "underlying data channel" to "underlying data transport".
      Fixed closing procedures. Fixed some typos.</li>
    </ol>

    <h3 id="changes-since-april-27-2012">Changes since April 27, 2012</h3>

    <ol>
      <li>Major rewrite of RTCPeerConnection section to line up with IETF JSEP
      draft.</li>

      <li>Added simple RTCPeerConnection example. Initial update of
      RTCSessionDescription and RTCIceCandidate to support serialization and
      construction.</li>
    </ol>

    <h3 id="changes-since-21-april-2012">Changes since 21 April 2012</h3>

    <ol>
      <li>Moved MediaStream and related definitions to getUserMedia.</li>

      <li>Removed section "Obtaining local multimedia content".</li>

      <li>Updated getUserMedia() calls in examples (changes in Media Capture TF
      spec).</li>

      <li>Introduced MediaStreamTrackList interface with support for adding and
      removing tracks.</li>

      <li>Updated the algorithm that is run when RTCPeerConnection receives a
      stream (create new stream when negotiated instead of when data
      arrives).</li>

    </ol>

    <h3 id="changes-since-12-january-2012">Changes since 12 January 2012</h3>

    <ol>
      <li>Clarified the relation of Stream, Track, and Channel.</li>
    </ol>

    <h3 id="changes-since-17-october-2011">Changes since 17 October 2011</h3>

    <ol>
      <li>Tweak the introduction text and add a reference to the IETF RTCWEB
      group.</li>

      <li>Changed the first argument to getUserMedia to be an object.</li>

      <li>Added a MediaStreamHints object as a second argument to
      RTCPeerConnection.addStream.</li>

      <li>Added AudioMediaStreamTrack class and DTMF interface.</li>
    </ol>

    <h3 id="changes-since-23-august-2011">Changes since 23 August 2011</h3>

    <ol>
      <li>Separated the SDP and ICE Agent into separate agents and added
      explicit state attributes for each.</li>

      <li>Removed the send method from PeerConenction and associated callback
      function.</li>

      <li>Modified MediaStream() constructor to take a list of MediaStreamTrack
      objects instead of a MediaStream. Removed text about MediaStream parent
      and child relationship.</li>

      <li>Added abstract.</li>

      <li>Moved a few paragraphs from the MediaStreamTrack.label section to the
      MediaStream.label section (where they belong).</li>

      <li>Split MediaStream.tracks into MediaStream.audioTracks and
      MediaStream.videoTracks.</li>

      <li>Removed a sentence that implied that track access is limited to
      LocalMediaStream.</li>

      <li>Updated a few getUserMedia()-examples to use MediaStreamOptions.</li>

      <li>Replaced calls to URL.getObjectURL() with URL.createObjectURL() in
      example code.</li>

      <li>Fixed some broken getUserMedia() links.</li>

      <li>Introduced state handling on MediaStreamTrack (removed state handling
      from MediaStream).</li>

      <li>Reintroduced onended on MediaStream to simplify checking if all
      tracks are ended.</li>

      <li>Aligned the MediaStreamTrack ended event dispatching behavior with
      that of MediaStream.</li>

      <li>Updated the LocalMediaStream.stop() algorithm to implicitly use the
      end track algorithm.</li>

      <li>Replaced an occurrence the term finished track with ended track (to
      align with rest of spec).</li>

      <li>Moved (and extended) the explanation about track references and media
      sources from LocalMediaStream to MediaStreamTrack.</li>
    </ol>
  </section>

  <section id="acknowledgements" class="appendix">
    <!--OddPage--><h2><span class="secno">A. </span>Acknowledgements</h2>

    <p>The editors wish to thank the Working Group chairs, Harald Alvestrand
    and Stefan Håkansson, for their support.</p>
  </section>


<section class="appendix" id="references"><!--OddPage--><h2><span class="secno">B. </span>References</h2><section id="normative-references"><h3><span class="secno">B.1 </span>Normative references</h3><dl class="bibliography"><dt id="bib-GETUSERMEDIA">[GETUSERMEDIA]</dt><dd>D. Burnett, A. Narayanan. <a href="http://dev.w3.org/2011/webrtc/editor/getusermedia.html"><cite>getusermedia: Getting access to local devices that can generate multimedia streams</cite></a> 22 December 2011. W3C Editors draft (Work in progress.) URL: <a href="http://dev.w3.org/2011/webrtc/editor/getusermedia.html">http://dev.w3.org/2011/webrtc/editor/getusermedia.html</a> 
</dd><dt id="bib-HTML5">[HTML5]</dt><dd>Ian Hickson; David Hyatt. <a href="http://www.w3.org/TR/html5"><cite>HTML5.</cite></a> 29 March 2012. W3C Working Draft. (Work in progress.) URL: <a href="http://www.w3.org/TR/html5">http://www.w3.org/TR/html5</a> 
</dd><dt id="bib-ICE">[ICE]</dt><dd>J. Rosenberg. <a href="http://tools.ietf.org/html/rfc5245"><cite>Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols.</cite></a> April 2010. Internet RFC 5245. URL: <a href="http://tools.ietf.org/html/rfc5245">http://tools.ietf.org/html/rfc5245</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt"><cite>Key words for use in RFCs to Indicate Requirement Levels.</cite></a> March 1997. Internet RFC 2119.  URL: <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a> 
</dd><dt id="bib-RTCWEB-CONSTRAINTS">[RTCWEB-CONSTRAINTS]</dt><dd>D. Burnett. <a href="http://datatracker.ietf.org/doc/draft-burnett-rtcweb-constraints-registry/"><cite>IANA Registry for RTCWeb Media Constraints.</cite></a> URL: <a href="http://datatracker.ietf.org/doc/draft-burnett-rtcweb-constraints-registry/">http://datatracker.ietf.org/doc/draft-burnett-rtcweb-constraints-registry/</a> 
</dd><dt id="bib-SDP">[SDP]</dt><dd>J. Rosenberg, H. Schulzrinne. <a href="http://tools.ietf.org/html/rfc3264"><cite>An Offer/Answer Model with the Session Description Protocol (SDP).</cite></a> June 2002. Internet RFC 3264. URL: <a href="http://tools.ietf.org/html/rfc3264">http://tools.ietf.org/html/rfc3264</a>
</dd><dt id="bib-STUN">[STUN]</dt><dd>J. Rosenberg, R. Mahy, P. Matthews, D. Wing. <a href="http://tools.ietf.org/html/rfc5389"><cite>Session Traversal Utilities for NAT (STUN).</cite></a> October 2008. Internet RFC 5389. URL: <a href="http://tools.ietf.org/html/rfc5389">http://tools.ietf.org/html/rfc5389</a>
</dd><dt id="bib-STUN-URI">[STUN-URI]</dt><dd>S. Nandakumar,  G. Salgueiro, P. Jones, and M. Petit-Huguenin. <a href="http://tools.ietf.org/html/draft-nandakumar-rtcweb-stun-uri"><cite>URI Scheme for Session Traversal Utilities for NAT (STUN) Protocol.</cite></a> 12 March 2012. Internet Draft (work in progress). URL: <a href="http://tools.ietf.org/html/draft-nandakumar-rtcweb-stun-uri">http://tools.ietf.org/html/draft-nandakumar-rtcweb-stun-uri</a> 
</dd><dt id="bib-TURN">[TURN]</dt><dd>P. Mahy, P. Matthews, J. Rosenberg. <a href="http://tools.ietf.org/html/rfc5766"><cite>Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN).</cite></a> April 2010. Internet RFC 5766. URL: <a href="http://tools.ietf.org/html/rfc5766">http://tools.ietf.org/html/rfc5766</a>
</dd><dt id="bib-TURN-URI">[TURN-URI]</dt><dd>M. Petit-Huguenin, S. Nandakumar,  G. Salgueiro, and  P. Jones. <a href="http://tools.ietf.org/html/draft-petithuguenin-behave-turn-uris"><cite>Traversal Using Relays around NAT (TURN) Uniform Resource Identifiers.</cite></a> 12 March 2012. Internet Draft (work in progress). URL: <a href="http://tools.ietf.org/html/draft-petithuguenin-behave-turn-uris">http://tools.ietf.org/html/draft-petithuguenin-behave-turn-uris</a> 
</dd><dt id="bib-WEBIDL">[WEBIDL]</dt><dd>Cameron McCormack. <a href="http://www.w3.org/TR/2011/WD-WebIDL-20110927/"><cite>Web IDL.</cite></a> 27 September 2011. W3C Working Draft. (Work in progress.) URL: <a href="http://www.w3.org/TR/2011/WD-WebIDL-20110927/">http://www.w3.org/TR/2011/WD-WebIDL-20110927/</a> 
</dd></dl></section><section id="informative-references"><h3><span class="secno">B.2 </span>Informative references</h3><dl class="bibliography"><dt id="bib-RTCWEB-JSEP">[RTCWEB-JSEP]</dt><dd>J. Uberti, C. Jennings. <a href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/"><cite>Javascript Session Establishment Protocol.</cite></a> URL: <a href="http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/">http://datatracker.ietf.org/doc/draft-ietf-rtcweb-jsep/</a> 
</dd></dl></section></section></body></html>