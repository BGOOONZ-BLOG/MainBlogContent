<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:WD" about="" property="dcterms:language" content="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width,initial-scale=1" name="viewport">
    <title>Model for Tabular Data and Metadata on the Web</title>
    
    
    <style type="text/css">
      .grammar td { font-family: monospace; vertical-align: top; }
      .grammar-literal { color: gray;}
    </style>
  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #ff4500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.issue-title span, div.note-title span {
    text-transform: uppercase;
}
div.note, div.issue {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child { margin-top: 0 }
.issue, .note {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}


</style><link href="https://www.w3.org/StyleSheets/TR/W3C-WD" rel="stylesheet"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--><style type='text/css'>
.diff-old-a {
  font-size: smaller;
  color: red;
}

.diff-new { background-color: yellow; }
.diff-chg { background-color: lime; }
.diff-new:before,
.diff-new:after
    { content: "\2191" }
.diff-chg:before, .diff-chg:after
    { content: "\2195" }
.diff-old { text-decoration: line-through; background-color: #FBB; }
.diff-old:before,
.diff-old:after
    { content: "\2193" }
:focus { border: thin red solid}
</style>
</head>

<body id="respecDocument" role="document" class="h-entry">
<div id="respecHeader" role="contentinfo" class="head">
<p>
<a href="http://www.w3.org/">
<img src="https://www.w3.org/Icons/w3c_home" alt="W3C" height="48" width="72">
</a>
</p>
<h1 class="title p-name" id="title" property="dcterms:title">
Model
for
Tabular
Data
and
Metadata
on
the
Web
</h1>
<h2 id="w3c-working-draft-10-july-2014" property="dcterms:issued" datatype="xsd:dateTime" content="2014-07-09T23:00:00.000Z">
<abbr title="World Wide Web Consortium">
W3C
</abbr>
<del class="diff-old">First
Public
</del>
Working
Draft
<del class="diff-old">27
March
</del>
<time class="dt-published" datetime="2014-07-10">
<ins class="diff-chg">10
July
</ins>
2014
</time>
</h2>
<dl>
<dt>
This
version:
</dt>
<dd>
<del class="diff-old">http://www.w3.org/TR/2014/WD-tabular-data-model-20140327/
</del>
<a class="u-url" href="http://www.w3.org/TR/2014/WD-tabular-data-model-20140710/">
<ins class="diff-chg">http://www.w3.org/TR/2014/WD-tabular-data-model-20140710/
</ins>
</a>
</dd>
<dt>
Latest
published
version:
</dt>
<dd>
<a href="http://www.w3.org/TR/tabular-data-model/">
http://www.w3.org/TR/tabular-data-model/
</a>
</dd>
<dt>
Latest
editor's
draft:
</dt>
<dd>
<a href="http://w3c.github.io/csvw/syntax/">
http://w3c.github.io/csvw/syntax/
</a>
</dd>
<dt>
<ins class="diff-new">Previous
version:
</ins></dt><dd><a rel="dcterms:replaces" href="http://www.w3.org/TR/2014/WD-tabular-data-model-20140327/"><ins class="diff-new">
http://www.w3.org/TR/2014/WD-tabular-data-model-20140327/
</ins></a></dd><dt>
Editors:
</dt>
<dd class="p-author h-card vcard" rel="bibo:editor" inlist="">
<span typeof="foaf:Person">
<span property="foaf:name" class="p-name fn">
Jeni
Tennison
</span>,
<a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://theodi.org/">
Open
Data
Institute
</a>
</span>
</dd>
<dd class="p-author h-card vcard" rel="bibo:editor" inlist="">
<span typeof="foaf:Person">
<a class="u-url url p-name fn" rel="foaf:homepage" property="foaf:name" content="Gregg Kellogg" href="http://greggkellogg.net/">
Gregg
Kellogg
</a>,
<a rel="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://kellogg-assoc.com/">
Kellogg
Associates
</a>
</span>
</dd>
<dt>
Repository:
</dt>
<dd>
<a href="https://github.com/w3c/csvw">
We
are
on
Github
</a>
</dd>
<dd>
<a href="https://github.com/w3c/csvw">
File
a
bug
</a>
</dd>
<dt>
<ins class="diff-new">Changes:
</ins></dt><dd><a href="diff-20140327.html"><ins class="diff-new">
Diff
to
previous
version
</ins></a></dd>
<dd>
<a href="https://github.com/w3c/csvw/commits/gh-pages">
Commit
history
</a>
</dd>
</dl>
<p class="copyright">
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">
Copyright
</a>
©
2014
<a href="http://www.w3.org/">
<abbr title="World Wide Web Consortium">
W3C
</abbr>
</a>
<sup>
®
</sup>
(
<a href="http://www.csail.mit.edu/">
<abbr title="Massachusetts Institute of Technology">
MIT
</abbr>
</a>,
<a href="http://www.ercim.eu/">
<abbr title="European Research Consortium for Informatics and Mathematics">
ERCIM
</abbr>
</a>,
<a href="http://www.keio.ac.jp/">
Keio
</a>,
<a href="http://ev.buaa.edu.cn/">
Beihang
</a>
),
All
Rights
Reserved.
<abbr title="World Wide Web Consortium">
W3C
</abbr>
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">
liability
</a>,
<a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">
trademark
</a>
and
<a href="http://www.w3.org/Consortium/Legal/copyright-documents">
document
use
</a>
rules
apply.
</p>
<hr>
</div>
<section rel="bibo:Chapter" resource="#abstract" typeof="bibo:Chapter" datatype="" property="dcterms:abstract" class="introductory" id="abstract">
<h2 id="h2_abstract" role="heading" aria-level="1">
Abstract
</h2>
<p>
Tabular
data
is
routinely
transferred
on
the
web
as
"CSV",
but
the
definition
of
"CSV"
in
practice
is
very
loose.
This
document
outlines
a
basic
data
model
or
infoset
for
tabular
data
and
metadata
about
that
tabular
data.
It
also
contains
some
non-normative
information
about
a
best
practice
syntax
for
tabular
data,
for
mapping
into
that
data
model,
to
contribute
to
the
standardisation
of
CSV
syntax
by
IETF.
Various
methods
of
locating
metadata
are
also
provided.
</p>
</section>
<section rel="bibo:Chapter" resource="#sotd" typeof="bibo:Chapter" id="sotd" class="introductory">
<h2 id="h2_sotd" role="heading" aria-level="1">
Status
of
This
Document
</h2>
<p>
<em>
This
section
describes
the
status
of
this
document
at
the
time
of
its
publication.
Other
documents
may
supersede
this
document.
A
list
of
current
<abbr title="World Wide Web Consortium">
W3C
</abbr>
publications
and
the
latest
revision
of
this
technical
report
can
be
found
in
the
<a href="http://www.w3.org/TR/">
<abbr title="World Wide Web Consortium">
W3C
</abbr>
technical
reports
index
</a>
at
http://www.w3.org/TR/.
</em>
</p>
<p>
The
CSV
on
the
Web
Working
Group
was
chartered
to
produce
a
Recommendation
"Access
methods
for
CSV
Metadata"
as
well
as
Recommendations
for
"Metadata
vocabulary
for
CSV
data"
and
"Mapping
mechanism
to
transforming
CSV
into
various
Formats
(e.g.,
RDF,
JSON,
or
XML)".
This
document
aims
to
primarily
satisfy
the
first
of
those
Recommendations
(see
<a href="#locating-metadata" class="sectionRef sec-ref">
section
<span class="secno">
3.
</span>
<span class="sec-title">
Locating
Metadata
</span>
</a>
),
though
it
also
specifies
an
underlying
model
and
therefore
starting
point
for
the
other
chartered
Recommendations.
</p>
<p>
This
document
is
based
on
IETF's
[
<cite>
<a href="#bib-RFC4180" class="bibref">
RFC4180
</a>
</cite>
]
which
is
an
Informational
RFC.
The
working
group's
expectation
is
that
future
suggestions
to
refine
RFC
4180
will
be
relayed
to
the
IETF
(e.g.
around
I18N
and
multi-part
packaging)
and
contribute
to
its
discussions
about
moving
CSV
to
the
Standards
track.
</p>
<p>
<ins class="diff-new">Many
"CSV"
files
embed
metadata,
for
example
in
lines
before
the
header
row
of
the
CSV
document.
This
specification
does
not
define
any
formats
for
embedding
metadata
within
CSV
files,
aside
from
the
names
of
columns
in
the
header
row.
</ins></p><p>
This
document
was
published
by
the
<a href="http://www.w3.org/2013/csvw/">
CSV
on
the
Web
Working
Group
</a>
as
a
<del class="diff-old">First
Public
</del>
Working
Draft.
This
document
is
intended
to
become
a
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Recommendation.
If
you
wish
to
make
comments
regarding
this
document,
please
send
them
to
<a href="mailto:public-csv-wg@w3.org">
public-csv-wg@w3.org
</a>
(
<a href="mailto:public-csv-wg-request@w3.org?subject=subscribe">
subscribe
</a>,
<a href="http://lists.w3.org/Archives/Public/public-csv-wg/">
archives
</a>
).
All
comments
are
welcome.
</p>
<p>
Publication
as
a
<del class="diff-old">First
Public
</del>
Working
Draft
does
not
imply
endorsement
by
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Membership.
This
is
a
draft
document
and
may
be
updated,
replaced
or
obsoleted
by
other
documents
at
any
time.
It
is
inappropriate
to
cite
this
document
as
other
than
work
in
progress.
</p>
<p>
This
document
was
produced
by
a
group
operating
under
the
<a id="sotd_patent" about="" rel="w3p:patentRules" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">
5
February
2004
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
<abbr title="World Wide Web Consortium">
W3C
</abbr>
maintains
a
<a href="http://www.w3.org/2004/01/pp-impl/68238/status" rel="disclosure">
public
list
of
any
patent
disclosures
</a>
made
in
connection
with
the
deliverables
of
the
group;
that
page
also
includes
instructions
for
disclosing
a
patent.
An
individual
who
has
actual
knowledge
of
a
patent
which
the
individual
believes
contains
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">
Essential
Claim(s)
</a>
must
disclose
the
information
in
accordance
with
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">
section
6
of
the
<abbr title="World Wide Web Consortium">
W3C
</abbr>
Patent
Policy
</a>.
</p>
</section>
<section id="toc">
<h2 id="h2_toc" role="heading" aria-level="1" class="introductory">
Table
of
Contents
</h2>
<ul id="respecContents" role="directory" class="toc">
<li class="tocline">
<a class="tocxref" href="#intro">
<span class="secno">
1.
</span>
Introduction
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#model">
<span class="secno">
2.
</span>
Tabular
Data
<del class="diff-old">Model
</del>
<ins class="diff-chg">Models
</ins>
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#core-tabular-data-model">
<span class="secno">
2.1
</span>
Core
<ins class="diff-new">Tabular
</ins>
Data
Model
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#annotated-tabular-data-model">
<span class="secno">
2.2
</span>
Annotated
<ins class="diff-new">Tabular
</ins>
Data
Model
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#grouped-tabular-data-model">
<span class="secno">
2.3
</span>
Grouped
<ins class="diff-new">Tabular
</ins>
Data
Model
</a>
</li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#locating-metadata">
<span class="secno">
3.
</span>
Locating
Metadata
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#embedded-metadata">
<span class="secno">
3.1
</span>
Embedded
Metadata
</a>
</li>
<li class="tocline">
<del class="diff-old">3.2
Embedded
Link
</del>
<a class="tocxref" href="#package">
<span class="secno">
<del class="diff-old">3.3
</del>
<ins class="diff-chg">3.2
</ins>
</span>
Package
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#link-header">
<span class="secno">
<del class="diff-old">3.4
</del>
<ins class="diff-chg">3.3
</ins>
</span>
Link
Header
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#standard-path">
<span class="secno">
<del class="diff-old">3.5
</del>
<ins class="diff-chg">3.4
</ins>
</span>
Standard
Path
</a>
</li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#syntax">
<span class="secno">
4.
</span>
CSV+
Syntax
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#content-type">
<span class="secno">
4.1
</span>
Content
Type
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#encoding">
<span class="secno">
4.2
</span>
Encoding
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#line-endings">
<span class="secno">
4.3
</span>
Line
Endings
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#lines">
<span class="secno">
4.4
</span>
Lines
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#headers">
<span class="secno">
4.4.1
</span>
Headers
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#bidirectionality-in-csv-files">
<span class="secno">
<ins class="diff-new">4.4.2
</ins></span><ins class="diff-new">
Bidirectionality
in
CSV+
Files
</ins></a></li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#ebnf">
<span class="secno">
4.5
</span>
Grammar
</a>
</li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#parsing">
<span class="secno">
5.
</span>
Parsing
Tabular
Data
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#standards">
<span class="secno">
A.
</span>
Existing
Standards
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#rfc">
<span class="secno">
A.1
</span>
RFC
4180
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#excel">
<span class="secno">
A.2
</span>
Excel
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#saved-csv">
<span class="secno">
A.2.1
</span>
Saved
CSV
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#opened-csv">
<span class="secno">
A.2.2
</span>
Opened
CSV
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#imported-csv">
<span class="secno">
A.2.3
</span>
Imported
CSV
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#copied-tabular-data">
<span class="secno">
A.2.4
</span>
Copied
Tabular
Data
</a>
</li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#google">
<span class="secno">
A.3
</span>
Google
Spreadsheets
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#downloading-csv">
<span class="secno">
A.3.1
</span>
Downloading
CSV
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#importing-csv">
<span class="secno">
A.3.2
</span>
Importing
CSV
</a>
</li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#csv-files-in-a-tabular-data-package">
<span class="secno">
A.4
</span>
CSV
Files
in
<del class="diff-old">the
Simple
</del>
<ins class="diff-chg">a
Tabular
</ins>
Data
<del class="diff-old">Format
</del>
<ins class="diff-chg">Package
</ins>
</a>
</li>
</ul>
</li>
<li class="tocline">
<a class="tocxref" href="#references">
<span class="secno">
B.
</span>
References
</a>
<ul class="toc">
<li class="tocline">
<a class="tocxref" href="#normative-references">
<span class="secno">
B.1
</span>
Normative
references
</a>
</li>
<li class="tocline">
<a class="tocxref" href="#informative-references">
<span class="secno">
B.2
</span>
Informative
references
</a>
</li>
</ul>
</li>
</ul>
</section>
<section rel="bibo:Chapter" resource="#intro" typeof="bibo:Chapter" id="intro">
<h2 id="h2_intro" role="heading" aria-level="1">
<span class="secno">
1.
</span>
Introduction
</h2>
<p>
<dfn id="dfn-tabular-data" title="tabular data">
Tabular
data
</dfn>
is
data
that
is
structured
into
rows,
each
of
which
contains
information
about
some
thing.
Each
row
contains
the
same
number
of
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
(although
some
of
these
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
may
be
empty),
which
provide
values
of
properties
of
the
thing
described
by
the
row.
In
tabular
data,
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
within
the
same
column
provide
values
for
the
same
property
of
the
thing
described
by
the
particular
row.
This
is
what
differentiates
tabular
data
from
other
line-oriented
formats.
</p>
<p>
Tabular
data
is
routinely
transferred
on
the
web
in
a
textual
format
called
"CSV",
but
the
definition
of
"CSV"
in
practice
is
very
loose.
Some
people
use
the
term
to
mean
any
delimited
text
file.
Others
stick
more
closely
to
the
most
standard
definition
of
CSV
that
there
is,
[
<cite>
<a href="#bib-RFC4180" class="bibref">
RFC4180
</a>
</cite>
].
<a href="#standards" class="sectionRef">
Appendix
A
</a>
describes
the
various
ways
in
which
CSV
is
defined.
</p>
</section>
<section rel="bibo:Chapter" resource="#model" typeof="bibo:Chapter" id="model">
<h2 id="h2_model" role="heading" aria-level="1">
<span class="secno">
2.
</span>
Tabular
Data
<del class="diff-old">Model
</del>
<ins class="diff-chg">Models
</ins>
</h2>
<p>
There
are
different
levels
of
data
models
for
tabular
data:
</p>
<ul>
<li>
The
<dfn id="dfn-core-tabular-data-model">
core
<ins class="diff-new">tabular
</ins>
data
model
</dfn>
described
in
<a href="#core-tabular-data-model" class="sectionRef sec-ref">
section
<span class="secno">
2.1
</span>
<span class="sec-title">
Core
<ins class="diff-new">Tabular
</ins>
Data
Model
</span>
</a>
defines
the
core
model
for
a
single
table
of
basic
data.
</li>
<li>
The
<dfn id="dfn-annotated-tabular-data-model">
annotated
<ins class="diff-new">tabular
</ins>
data
model
</dfn>
described
in
<a href="#annotated-tabular-data-model" class="sectionRef sec-ref">
section
<span class="secno">
2.2
</span>
<span class="sec-title">
Annotated
<ins class="diff-new">Tabular
</ins>
Data
Model
</span>
</a>
defines
a
model
for
tables
that
are
annotated
with
metadata.
</li>
<li>
The
<dfn id="dfn-grouped-tabular-data-model">
grouped
<ins class="diff-new">tabular
</ins>
data
model
</dfn>
described
in
<a href="#grouped-tabular-data-model" class="sectionRef sec-ref">
section
<span class="secno">
2.3
</span>
<span class="sec-title">
Grouped
<ins class="diff-new">Tabular
</ins>
Data
Model
</span>
</a>
defines
a
model
for
tables
that
are
related
to
each
other
in
some
way.
</li>
</ul>
<section id="core-tabular-data-model">
<h3 id="h3_core-tabular-data-model" role="heading" aria-level="2">
<span class="secno">
2.1
</span>
Core
<ins class="diff-new">Tabular
</ins>
Data
Model
</h3>
<p>
<ins class="diff-new">The
core
tabular
data
model
can
be
used
to
describe
a
table
that
lacks
any
annotations,
whether
those
annotations
are
embedded
within
a
CSV
file
or
arise
from
a
separate
metadata
document.
</ins></p><p>
Data
is
held
in
a
<dfn id="dfn-table">
table
</dfn>.
<ins class="diff-new">The
properties
of
a
table
are:
</ins>
</p>
<del class="diff-old">Each
</del>
<ul>
<li>
<dfn id="dfn-table-columns" title="table columns">
<ins class="diff-chg">columns
</ins></dfn><ins class="diff-chg">
—
the
list
of
</ins><a class="internalDFN" href="#dfn-column" title="column"><ins class="diff-chg">
columns
</ins></a><ins class="diff-chg">
in
the
table.
A
</ins>
table
<del class="diff-old">has
</del>
<em title="MUST" class="rfc2119">
<ins class="diff-chg">MUST
</ins></em><ins class="diff-chg">
have
</ins>
one
or
more
columns
<del class="diff-old">.
The
</del>
<ins class="diff-chg">and
the
</ins>
order
of
the
columns
<ins class="diff-new">within
the
list
</ins>
is
significant
and
<del class="diff-old">must
</del>
<em title="MUST" class="rfc2119">
<ins class="diff-chg">MUST
</ins></em>
be
preserved
by
<del class="diff-old">applications.
</del>
<ins class="diff-chg">applications
</ins></li><li><dfn id="dfn-table-rows" title="table rows"><ins class="diff-chg">
rows
</ins></dfn><ins class="diff-chg">
—
the
list
of
rows
in
the
table
</ins></li></ul>
<p>
<del class="diff-old">Each
</del>
<ins class="diff-chg">A
</ins><dfn id="dfn-column"><ins class="diff-chg">
column
</ins></dfn><ins class="diff-chg">
represents
a
vertical
arrangement
of
</ins><a class="internalDFN" href="#dfn-cell" title="cell"><ins class="diff-chg">
cells
</ins></a><ins class="diff-chg">
within
a
</ins><a class="internalDFN" href="#dfn-table">
table
<del class="diff-old">has
</del>
</a>.
<ins class="diff-chg">The
properties
of
a
column
are:
</ins></p><ul><li><dfn id="dfn-column-table" title="column table"><ins class="diff-chg">
table
</ins></dfn><ins class="diff-chg">
—
the
</ins><a class="internalDFN" href="#dfn-table"><ins class="diff-chg">
table
</ins></a><ins class="diff-chg">
that
the
column
appears
in
</ins></li><li><dfn id="dfn-column-number" title="column number"><ins class="diff-chg">
number
</ins></dfn><ins class="diff-chg">
—
the
position
of
the
column
amongst
the
</ins><a class="internalDFN" href="#dfn-table-columns" title="table columns"><ins class="diff-chg">
columns
</ins></a><ins class="diff-chg">
for
the
associated
</ins><a class="internalDFN" href="#dfn-column-table" title="column table"><ins class="diff-chg">
table
</ins></a>,<ins class="diff-chg">
starting
from
1
</ins></li><li><dfn id="dfn-column-cells" title="column cells"><ins class="diff-chg">
cells
</ins></dfn><ins class="diff-chg">
—
the
list
of
</ins><a class="internalDFN" href="#dfn-cell" title="cell"><ins class="diff-chg">
cells
</ins></a><ins class="diff-chg">
in
the
column.
A
column
</ins><em title="MUST" class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
contain
</ins>
one
<del class="diff-old">or
more
rows
.
</del>
<ins class="diff-chg">cell
from
each
</ins><a class="internalDFN" href="#dfn-row"><ins class="diff-chg">
row
</ins></a><ins class="diff-chg">
in
the
table.
</ins>
The
order
of
the
<ins class="diff-new">cells
in
the
list
</ins><em title="MUST" class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
match
the
order
of
the
</ins>
rows
<del class="diff-old">is
significant
and
must
be
preserved
by
applications.
Each
</del>
<ins class="diff-chg">in
which
they
appear
within
the
</ins><a class="internalDFN" href="#dfn-table-rows" title="table rows"><ins class="diff-chg">
rows
</ins></a><ins class="diff-chg">
for
the
associated
</ins><a class="internalDFN" href="#dfn-column-table" title="column table"><ins class="diff-chg">
table
</ins></a>.</li></ul><p><ins class="diff-chg">
A
</ins><dfn id="dfn-row">
row
<del class="diff-old">contains
</del>
</dfn>
<ins class="diff-chg">represents
</ins>
a
<del class="diff-old">field
</del>
<ins class="diff-chg">horizontal
arrangement
of
</ins><a class="internalDFN" href="#dfn-cell" title="cell"><ins class="diff-chg">
cells
</ins></a><ins class="diff-chg">
within
a
</ins><a class="internalDFN" href="#dfn-table"><ins class="diff-chg">
table
</ins></a>.<ins class="diff-chg">
The
properties
of
a
row
are:
</ins></p><ul><li><dfn id="dfn-row-table" title="row table"><ins class="diff-chg">
table
</ins></dfn><ins class="diff-chg">
—
the
</ins><a class="internalDFN" href="#dfn-table"><ins class="diff-chg">
table
</ins></a><ins class="diff-chg">
that
the
row
appears
in
</ins></li><li><dfn id="dfn-row-number" title="row number"><ins class="diff-chg">
number
</ins>
</dfn>
<ins class="diff-new">—
the
position
of
the
row
amongst
the
</ins><a class="internalDFN" href="#dfn-table-rows" title="table rows"><ins class="diff-new">
rows
</ins></a>
for
<ins class="diff-new">the
</ins><a class="internalDFN" href="#dfn-row-table" title="row table"><ins class="diff-new">
table
</ins></a>,<ins class="diff-new">
starting
from
1
</ins></li><li><dfn id="dfn-row-cells" title="row cells"><ins class="diff-new">
cells
</ins></dfn><ins class="diff-new">
—
the
list
of
</ins><a class="internalDFN" href="#dfn-cell" title="cell"><ins class="diff-new">
cells
</ins></a><ins class="diff-new">
in
the
row.
A
row
</ins><em title="MUST" class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
contain
one
cell
from
</ins>
each
<a class="internalDFN" href="#dfn-column">
column
</a>
in
the
table.
<del class="diff-old">Some
</del>
<ins class="diff-chg">The
order
</ins>
of
<del class="diff-old">these
fields
</del>
<ins class="diff-chg">the
cells
in
the
list
</ins><em title="MUST" class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
match
the
order
of
the
columns
in
which
they
appear
within
the
</ins><a class="internalDFN" href="#dfn-table-columns"><ins class="diff-chg">
table
columns
</ins></a><ins class="diff-chg">
for
the
row's
table.
</ins></li></ul><p><ins class="diff-chg">
A
</ins><dfn id="dfn-cell"><ins class="diff-chg">
cell
</ins></dfn><ins class="diff-chg">
represents
a
cell
at
the
intersection
of
a
</ins><a class="internalDFN" href="#dfn-row"><ins class="diff-chg">
row
</ins></a><ins class="diff-chg">
and
a
</ins><a class="internalDFN" href="#dfn-column"><ins class="diff-chg">
column
</ins></a><ins class="diff-chg">
within
a
</ins><a class="internalDFN" href="#dfn-table"><ins class="diff-chg">
table
</ins></a>.<ins class="diff-chg">
The
properties
of
a
cell
are:
</ins></p><ul><li><dfn id="dfn-cell-table" title="cell table"><ins class="diff-chg">
table
</ins></dfn><ins class="diff-chg">
—
the
</ins><a class="internalDFN" href="#dfn-table"><ins class="diff-chg">
table
</ins></a><ins class="diff-chg">
that
the
cell
appears
in
</ins></li><li><dfn id="dfn-cell-column" title="cell column"><ins class="diff-chg">
column
</ins></dfn><ins class="diff-chg">
—
the
</ins><a class="internalDFN" href="#dfn-column"><ins class="diff-chg">
column
</ins></a><ins class="diff-chg">
that
the
cell
appears
in;
the
cell
</ins><em title="MUST" class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
in
the
</ins><a class="internalDFN" href="#dfn-column-cells" title="column cells"><ins class="diff-chg">
cells
</ins></a><ins class="diff-chg">
for
that
column
</ins></li><li><dfn id="dfn-cell-row" title="cell row"><ins class="diff-chg">
row
</ins></dfn><ins class="diff-chg">
—
the
</ins><a class="internalDFN" href="#dfn-row"><ins class="diff-chg">
row
</ins></a><ins class="diff-chg">
that
the
cell
appears
in;
the
cell
</ins><em title="MUST" class="rfc2119"><ins class="diff-chg">
MUST
</ins></em><ins class="diff-chg">
be
in
the
</ins><a class="internalDFN" href="#dfn-row-cells" title="row cells"><ins class="diff-chg">
cells
</ins></a><ins class="diff-chg">
for
that
row
</ins></li><li><dfn id="dfn-string-value"><ins class="diff-chg">
string
value
</ins></dfn><ins class="diff-chg">
—
a
string
that
is
the
original
syntactic
representation
of
the
value
of
the
cell,
ie
how
the
cell
appears
within
a
CSV
file;
this
</ins>
may
be
<ins class="diff-chg">an
empty
string
</ins></li><li><dfn id="dfn-cell-value" title="cell value"><ins class="diff-chg">
value
</ins></dfn><ins class="diff-chg">
—
the
semantic
value
of
the
cell;
within
the
core
tabular
data
model
this
is
either
a
string
which
is
the
same
as
the
</ins><a class="internalDFN" href="#dfn-string-value"><ins class="diff-chg">
string
value
</ins></a><ins class="diff-chg">
of
the
cell,
or
</ins><code>
null
<del class="diff-old">fields
.
</del>
</code>,
<ins class="diff-chg">if
the
</ins><a class="internalDFN" href="#dfn-string-value"><ins class="diff-chg">
string
value
</ins></a><ins class="diff-chg">
is
an
empty
string
</ins></li></ul><div class="issue"><div id="h_issue_1" role="heading" aria-level="3" class="issue-title"><span><ins class="diff-chg">
Issue
1
</ins></span></div><p class=""><ins class="diff-chg">
Should
there
be
a
distinction
made
(in
the
core
tabular
data
model)
between
empty
cells
and
cells
whose
value
is
an
empty
string?
With
a
lack
of
other
metadata,
the
only
way
to
make
the
distinction
would
be
to
say
there
was
a
difference
between
a
missing
value
in
a
CSV
file
(eg
the
second
value
in
</ins><code><ins class="diff-chg">
a,,z
</ins></code><ins class="diff-chg">
)
and
a
quoted
value
(eg
the
second
value
in
</ins><code><ins class="diff-chg">
a,"",z
</ins></code><ins class="diff-chg">
).
This
seems
dangerous
as
I
don't
think
many
clients
will
make
a
distinction
between
the
two,
so
the
semantics
will
be
lost
on
round-tripping.
</ins>
</p>
</div>
</section>
<section id="annotated-tabular-data-model">
<h3 id="h3_annotated-tabular-data-model" role="heading" aria-level="2">
<span class="secno">
2.2
</span>
Annotated
<ins class="diff-new">Tabular
</ins>
Data
Model
</h3>
<p>
An
<dfn id="dfn-annotated-table">
annotated
table
</dfn>
is
a
<a class="internalDFN" href="#dfn-table">
table
</a>
that
is
annotated
with
additional
metadata.
The
table
<del class="diff-old">has
a
</del>
<em title="MAY" class="rfc2119">
<ins class="diff-chg">MAY
</ins></em><ins class="diff-chg">
have
any
</ins>
number
of
<dfn id="dfn-property" title="property">
properties
</dfn>
<ins class="diff-new">in
addition
to
those
provided
in
the
core
tabular
data
model
described
in
</ins><a href="#core-tabular-data-model" class="sectionRef sec-ref"><ins class="diff-new">
section
</ins><span class="secno"><ins class="diff-new">
2.1
</ins></span><span class="sec-title"><ins class="diff-new">
Core
Tabular
Data
Model
</ins></span></a>
which
provide
<del class="diff-old">additional
</del>
information
about
the
table
as
a
whole.
The
<dfn id="dfn-value" title="value">
values
</dfn>
of
these
properties
may
be
lists,
structured
objects,
or
atomic
values.
Annotations
on
a
table
may
include:
</p>
<ul>
<li>
titles
or
descriptions
of
the
table
</li>
<li>
information
about
the
source
or
provenance
of
the
data
in
the
table
</li>
<li>
links
to
other
tables
(eg
to
indicate
tables
that
include
related
information)
</li>
</ul>
<p>
The
<a class="internalDFN" href="#dfn-column" title="column">
columns
</a>
within
an
<a class="internalDFN" href="#dfn-annotated-table">
annotated
table
</a>
are
all
<dfn id="dfn-annotated-column" title="annotated column">
annotated
columns
<del class="diff-old">.
</del>
</dfn>:
<ins class="diff-chg">columns
which
</ins><em title="MAY" class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
have
any
number
of
</ins><a class="internalDFN" href="#dfn-property" title="property"><ins class="diff-chg">
properties
</ins></a><ins class="diff-chg">
in
addition
to
those
provided
in
the
core
tabular
data
model
described
in
</ins><a href="#core-tabular-data-model" class="sectionRef sec-ref"><ins class="diff-chg">
section
</ins><span class="secno"><ins class="diff-chg">
2.1
</ins></span><span class="sec-title"><ins class="diff-chg">
Core
Tabular
Data
Model
</ins></span></a>.
The
annotations
on
a
column
<ins class="diff-new">might
</ins>
provide
information
about
how
to
interpret
the
<del class="diff-old">fields
</del>
<a class="internalDFN" href="#dfn-cell" title="cell">
<ins class="diff-chg">cells
</ins>
</a>
in
the
<del class="diff-old">column.
</del>
<ins class="diff-chg">column
or
information
about
the
column
as
a
whole.
Examples
of
annotations
might
be:
</ins>
</p>
<ul>
<li>
a
name
or
label
for
the
column
</li>
<li>
the
expected
type
of
values
in
that
column
</li>
<li>
an
indication
of
whether
the
column
contains
unique
values
</li>
</ul>
<p>
The
<a class="internalDFN" href="#dfn-row" title="row">
rows
</a>
within
an
<a class="internalDFN" href="#dfn-annotated-table">
annotated
table
</a>
are
all
<dfn id="dfn-annotated-row" title="annotated row">
annotated
rows
<del class="diff-old">.
</del>
</dfn>:
<ins class="diff-chg">rows
which
</ins><em title="MAY" class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
have
any
number
of
</ins><a class="internalDFN" href="#dfn-property" title="property"><ins class="diff-chg">
properties
</ins></a><ins class="diff-chg">
in
addition
to
those
provided
in
the
core
tabular
data
model
described
in
</ins><a href="#core-tabular-data-model" class="sectionRef sec-ref"><ins class="diff-chg">
section
</ins><span class="secno"><ins class="diff-chg">
2.1
</ins></span><span class="sec-title"><ins class="diff-chg">
Core
Tabular
Data
Model
</ins></span></a>.
The
annotations
on
a
row
provide
additional
metadata
about
the
information
held
in
the
row,
such
as:
</p>
<ul>
<li>
the
certainty
of
the
information
in
that
row
</li>
<li>
information
about
the
source
or
provenance
of
the
data
in
that
row
</li>
</ul>
<p>
The
<del class="diff-old">fields
</del>
<a class="internalDFN" href="#dfn-cell" title="cell">
<ins class="diff-chg">cells
</ins>
</a>
within
an
<a class="internalDFN" href="#dfn-annotated-row">
annotated
row
</a>
are
all
<dfn id="dfn-annotated-cell" title="annotated cell">
annotated
<del class="diff-old">fields
.
</del>
<ins class="diff-chg">cells
</ins></dfn>:<ins class="diff-chg">
cells
which
</ins><em title="MAY" class="rfc2119"><ins class="diff-chg">
MAY
</ins></em><ins class="diff-chg">
have
any
number
of
</ins><a class="internalDFN" href="#dfn-property" title="property"><ins class="diff-chg">
properties
</ins></a><ins class="diff-chg">
in
addition
to
those
provided
in
the
core
tabular
data
model
described
in
</ins><a href="#core-tabular-data-model" class="sectionRef sec-ref"><ins class="diff-chg">
section
</ins><span class="secno"><ins class="diff-chg">
2.1
</ins></span><span class="sec-title"><ins class="diff-chg">
Core
Tabular
Data
Model
</ins></span></a>.
The
annotations
on
a
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
provide
metadata
about
the
value
held
in
the
<del class="diff-old">field,
</del>
<ins class="diff-chg">cell,
</ins>
particularly
when
this
overrides
the
information
provided
for
the
<a class="internalDFN" href="#dfn-annotated-column">
annotated
column
</a>
and
<a class="internalDFN" href="#dfn-annotated-row">
annotated
row
</a>
that
the
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
falls
within.
Annotations
on
a
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
might
be:
</p>
<ul>
<li>
notes
to
aid
the
interpretation
of
the
value
</li>
<li>
type
annotations
for
the
value
</li>
<li>
<ins class="diff-new">a
flag
that
indicates
the
value
is
a
null
value
</ins></li>
</ul>
<p>
<ins class="diff-new">The
</ins><a class="internalDFN" href="#dfn-cell-value" title="cell value"><ins class="diff-new">
value
</ins></a><ins class="diff-new">
of
an
</ins><a class="internalDFN" href="#dfn-annotated-cell"><ins class="diff-new">
annotated
cell
</ins></a><em title="MAY" class="rfc2119"><ins class="diff-new">
MAY
</ins></em><ins class="diff-new">
be
of
a
datatype
other
than
a
string.
For
example,
annotations
might
enable
a
processor
to
understand
the
</ins><a class="internalDFN" href="#dfn-string-value"><ins class="diff-new">
string
value
</ins></a><ins class="diff-new">
of
the
cell
as
representing
a
number
or
a
date.
</ins></p>
<div class="issue">
<div id="h_issue_2" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">1
</del>
<ins class="diff-chg">2
</ins></span></div><p class=""><ins class="diff-chg">
The
permitted
types
of
names
and
values
of
annotations
need
to
be
spelled
out
here.
</ins></p></div><div class="issue"><div id="h_issue_3" role="heading" aria-level="3" class="issue-title"><span><ins class="diff-chg">
Issue
3
</ins>
</span>
</div>
<div class="">
<p>
It
might
be
useful
to
define
annotated
regions
as
follows:
</p>
<blockquote>
An
<a class="internalDFN" href="#dfn-annotated-table">
annotated
table
</a>
may
also
contain
a
number
of
<dfn id="dfn-annotated-region" title="annotated region">
annotated
regions
</dfn>.
Regions
are
themselves
tabular
structures
comprised
of
selected
<a class="internalDFN" href="#dfn-row" title="row">
rows
</a>
and
<a class="internalDFN" href="#dfn-column" title="column">
columns
</a>
and
the
<del class="diff-old">fields
</del>
<a class="internalDFN" href="#dfn-cell" title="cell">
<ins class="diff-chg">cells
</ins>
</a>
within
those
rows
for
those
columns.
Annotated
regions
are
regions
that
have
annotations
associated
with
them.
<a class="internalDFN" href="#dfn-annotated-column" title="annotated column">
Annotated
columns
</a>
and
<a class="internalDFN" href="#dfn-annotated-row" title="annotated row">
annotated
rows
</a>
are
special
types
of
annotated
regions
where
the
region
is
the
entirety
of
a
single
column
or
single
row.
</blockquote>
<p>
But
it's
not
currently
clear
that
there
are
use
cases
or
examples
that
justify
it.
Input
is
welcome
on
this.
</p>
</div>
</div>
</section>
<section id="grouped-tabular-data-model">
<h3 id="h3_grouped-tabular-data-model" role="heading" aria-level="2">
<span class="secno">
2.3
</span>
Grouped
<ins class="diff-new">Tabular
</ins>
Data
Model
</h3>
<p>
A
<dfn id="dfn-group-of-tables">
group
of
tables
</dfn>
comprises
a
set
of
<a class="internalDFN" href="#dfn-table" title="table">
tables
</a>
(which
may
be
<a class="internalDFN" href="#dfn-annotated-table" title="annotated table">
annotated
tables
</a>
)
and
a
set
of
annotations
(
<a class="internalDFN" href="#dfn-property" title="property">
properties
</a>
and
<a class="internalDFN" href="#dfn-value" title="value">
values
</a>
)
that
relate
to
the
set.
</p>
<div class="note">
<div id="h_note_1" role="heading" aria-level="3" class="note-title">
<span>
Note
</span>
</div>
<p class="">
Tables
can
be
loosely
related
to
each
other
simply
through
annotations;
not
all
tables
that
are
related
to
each
other
need
to
grouped
together.
Groups
of
tables
are
useful
because
they
can
be
annotated
with
metadata
that
applies
to
all
the
tables
in
the
group.
</p>
</div>
</section>
</section>
<section id="locating-metadata">
<h2 id="h2_locating-metadata" role="heading" aria-level="1">
<span class="secno">
3.
</span>
Locating
Metadata
</h2>
<p>
As
described
in
<a href="#annotated-tabular-data-model" class="sectionRef sec-ref">
section
<span class="secno">
2.2
</span>
<span class="sec-title">
Annotated
<ins class="diff-new">Tabular
</ins>
Data
Model
</span>
</a>,
tabular
data
may
have
a
number
of
annotations
associated
with
it.
Here
we
describe
the
different
methods
that
can
be
used
to
locate
those
annotations
given
a
link
to
a
CSV
file.
</p>
<p>
In
most
methods
of
locating
metadata
described
here,
metadata
is
provided
within
a
separate
document.
The
syntax
of
this
document
is
<del class="diff-old">not
</del>
defined
<del class="diff-old">here,
but
these
</del>
<ins class="diff-chg">in
the
</ins><a href="http://w3c.github.io/csvw/metadata/"><ins class="diff-chg">
Metadata
Vocabulary
for
Tabular
Data
</ins></a><ins class="diff-chg">
specification.
These
</ins>
documents
can
include
things
like:
</p>
<ul>
<li>
metadata
about
the
table,
such
as
titles,
descriptions,
provenance,
and
links
to
other
tables
</li>
<li>
metadata
about
columns
in
the
table,
such
as
labels,
data
types
and
other
constraints,
or
flags
to
indicate
values
in
the
column
are
unique
</li>
<li>
metadata
about
rows
in
the
table,
such
as
certainty
or
provenance
</li>
<li>
metadata
about
values
in
the
table,
such
as
notes
or
type
annotations
</li>
</ul>
<p>
When
creating
a
set
of
annotations
from
metadata,
if
the
same
property
is
specified
in
two
locations
then
information
<del class="diff-old">closer
</del>
<ins class="diff-chg">"closer"
</ins>
to
the
document
itself
should
override
information
<del class="diff-old">further
</del>
<ins class="diff-chg">"further"
</ins>
from
the
document.
Explicitly,
the
order
of
preference
is:
</p>
<ol>
<li>
metadata
embedded
within
the
tabular
data
file
itself,
see
<a href="#embedded-metadata" class="sectionRef sec-ref">
section
<span class="secno">
3.1
</span>
<span class="sec-title">
Embedded
Metadata
</span>
</a>
</li>
<li>
metadata
<del class="diff-old">in
a
document
linked
to
from
a
reference
within
the
tabular
data
file,
see
section
3.2
Embedded
Link
metadata
</del>
within
a
package
that
the
tabular
data
file
belongs
to,
see
<a href="#package" class="sectionRef sec-ref">
section
<span class="secno">
<del class="diff-old">3.3
</del>
<ins class="diff-chg">3.2
</ins>
</span>
<span class="sec-title">
Package
</span>
</a>
</li>
<li>
metadata
in
a
document
linked
to
using
a
<code>
Link
</code>
header
when
retrieving
the
tabular
data
file,
see
<a href="#link-header" class="sectionRef sec-ref">
section
<span class="secno">
<del class="diff-old">3.4
</del>
<ins class="diff-chg">3.3
</ins>
</span>
<span class="sec-title">
Link
Header
</span>
</a>
</li>
<li>
metadata
in
a
document
located
through
a
standard
path
from
the
tabular
data
file,
see
<a href="#standard-path" class="sectionRef sec-ref">
section
<span class="secno">
<del class="diff-old">3.5
</del>
<ins class="diff-chg">3.4
</ins>
</span>
<span class="sec-title">
Standard
Path
</span>
</a>
</li>
</ol>
<del class="diff-old">3.1
Embedded
Metadata
Metadata
may
be
directly
embedded
within
a
CSV
file.
</del>
<div class="issue">
<div id="h_issue_4" role="heading" aria-level="2" class="issue-title">
<span>
Issue
<del class="diff-old">2
</del>
<ins class="diff-chg">4
</ins>
</span>
</div>
<p class="">
<del class="diff-old">What
should
the
syntax
be
for
embedding
metadata
within
</del>
<ins class="diff-chg">We
probably
need
to
add
some
rules
about
conflicts
as
well.
For
example,
if
</ins>
a
<ins class="diff-new">metadata
file
says
that
the
</ins>
CSV
<del class="diff-old">file?
An
example
approach
is
shown
</del>
<ins class="diff-chg">should
contain
certain
columns
but
the
names
of
the
columns
are
different
</ins>
in
<del class="diff-old">Linked
</del>
<ins class="diff-chg">the
</ins>
CSV
<del class="diff-old">.
If
this
</del>
<ins class="diff-chg">file
itself,
</ins>
is
<del class="diff-old">allowed
we
should
specify
a
new
media
type
for
the
syntax.
</del>
<ins class="diff-chg">this
an
error?
</ins>
</p>
</div>
<section id="embedded-metadata">
<h3 id="h3_embedded-metadata" role="heading" aria-level="2">
<span class="secno">
<del class="diff-old">3.2
</del>
<ins class="diff-chg">3.1
</ins>
</span>
Embedded
<del class="diff-old">Link
</del>
<ins class="diff-chg">Metadata
</ins>
</h3>
<p>
<del class="diff-old">A
link
to
the
metadata
to
be
used
with
</del>
<ins class="diff-chg">The
first
line
of
</ins>
a
<del class="diff-old">CSV
may
</del>
<ins class="diff-chg">CSV+
file
</ins><em title="MUST" class="rfc2119"><ins class="diff-chg">
MUST
</ins></em>
be
<del class="diff-old">indicated
within
</del>
<ins class="diff-chg">processed
as
a
header
line
unless
</ins>
the
<del class="diff-old">CSV
</del>
<ins class="diff-chg">CSV+
</ins>
file
<del class="diff-old">itself.
</del>
<ins class="diff-chg">is
served
with
a
</ins><code><ins class="diff-chg">
header=absent
</ins></code><ins class="diff-chg">
parameter
on
the
media
type.
Each
cell
in
the
header
line
that
includes
non-whitespace
characters
provides
a
</ins><strong><ins class="diff-chg">
title
</ins></strong><ins class="diff-chg">
annotation
on
the
column
in
which
it
appears.
</ins>
</p>
<div class="issue">
<div id="h_issue_5" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">3
</del>
<ins class="diff-chg">5
</ins>
</span>
</div>
<del class="diff-old">How
should
a
link
</del>
<p class="">
<ins class="diff-chg">The
</ins><strong><ins class="diff-chg">
title
</ins></strong><ins class="diff-chg">
annotation
needs
to
</ins>
be
<del class="diff-old">embedded?
Perhaps
something
like:
          
as
</del>
<ins class="diff-chg">linked
to
</ins>
the
<del class="diff-old">first
line?
If
this
is
allowed
we
should
specify
a
new
media
type
for
</del>
<ins class="diff-chg">relevant
annotation
in
</ins>
the
<del class="diff-old">syntax.
</del>
<ins class="diff-chg">metadata
vocabulary.
</ins>
</p>
</div>
</section>
<section id="package">
<h3 id="h3_package" role="heading" aria-level="2">
<span class="secno">
<del class="diff-old">3.3
</del>
<ins class="diff-chg">3.2
</ins>
</span>
Package
</h3>
<p>
Rather
than
providing
CSV
files
directly
on
the
web,
they
can
be
packaged
up
with
a
metadata
file
that
includes
annotations,
and
any
other
relevant
CSV
files.
</p>
<div class="issue">
<div id="h_issue_6" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">4
</del>
<ins class="diff-chg">6
</ins>
</span>
</div>
<div class="">
<p>
What
should
that
package
look
like?
Just
a
zip?
A
multipart
document?
How
is
the
metadata
file
within
it
identified?
If
this
is
allowed
we
should
specify
a
new
media
type
for
the
package.
</p>
<p>
<ins class="diff-new">See
</ins><a href="http://w3ctag.github.io/packaging-on-the-web/"><ins class="diff-new">
Packaging
on
the
Web
Editor's
Draft
</ins></a><ins class="diff-new">
for
a
proposed
generic
approach
for
packaging
on
the
web
that
could
be
used
for
packaging
CSV
files
and
metadata,
and
discovering
those
packages.
</ins></p></div>
</div>
</section>
<section id="link-header">
<h3 id="h3_link-header" role="heading" aria-level="2">
<span class="secno">
<del class="diff-old">3.4
</del>
<ins class="diff-chg">3.3
</ins>
</span>
Link
Header
</h3>
<p>
When
retrieving
a
CSV
file
via
HTTP,
the
response
can
include
a
<code>
Link
</code>
header
with
<code>
rel=describedby
</code>
that
points
to
a
metadata
file
that
describes
the
CSV
file.
<ins class="diff-new">If,
by
inspection,
the
referenced
file
is
not
a
valid
metadata
file
then
it
</ins><em title="MUST" class="rfc2119"><ins class="diff-new">
MUST
</ins></em><ins class="diff-new">
be
ignored.
If
there
is
more
than
one
valid
metadata
file
linked
to
through
multiple
</ins><code><ins class="diff-new">
Link
</ins></code><ins class="diff-new">
headers,
then
the
metadata
referenced
by
</ins><code><ins class="diff-new">
Link
</ins></code><ins class="diff-new">
headers
that
appear
later
in
the
response
override
that
referenced
by
earlier
</ins><code><ins class="diff-new">
Link
</ins></code><ins class="diff-new">
headers.
</ins>
</p>
<div class="issue">
<div id="h_issue_7" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">5
</del>
<ins class="diff-chg">7
</ins>
</span>
</div>
<p class="">
Is
<a href="http://www.w3.org/TR/powder-dr/#appD">
<code>
rel=describedby
</code>
</a>
the
right
link
relation
to
use?
</p>
</div>
</section>
<section id="standard-path">
<h3 id="h3_standard-path" role="heading" aria-level="2">
<span class="secno">
<del class="diff-old">3.5
</del>
<ins class="diff-chg">3.4
</ins>
</span>
Standard
Path
</h3>
<p>
<del class="diff-old">When
retrieving
</del>
<ins class="diff-chg">Given
</ins>
a
CSV
<del class="diff-old">file
via
HTTP,
</del>
<ins class="diff-chg">file,
</ins>
the
default
location
for
a
metadata
file
that
describes
that
CSV
file
is
set
to
<code>
<del class="diff-old">csv-metadata
</del>
<var>
<ins class="diff-chg">filename
</ins></var>.csvm
</code>
in
the
same
directory.
If
<del class="diff-old">this
</del>
<ins class="diff-chg">that
file
does
not
exist,
then
the
application
should
look
for
a
metadata
file
at
</ins><code><ins class="diff-chg">
metadata.csvm
</ins></code><ins class="diff-chg">
in
the
same
directory.
In
both
cases,
if
the
</ins>
metadata
file
does
not
explicitly
point
to
the
relevant
CSV
file
then
it
<em title="MUST" class="rfc2119">
MUST
</em>
be
ignored.
</p>
<div class="issue">
<div id="h_issue_8" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">6
</del>
<ins class="diff-chg">8
</ins>
</span>
</div>
<p class="">
<del class="diff-old">Deliberately
not
included
</del>
<ins class="diff-chg">Used
</ins>
a
suffix
<del class="diff-old">here,
because
</del>
<ins class="diff-chg">on
filenames
to
find
metadata
about
them,
though
</ins>
we
haven't
decided
what
format
metadata
documents
should
be
in,
or
even
if
they
should
be
conneg'd.
<del class="diff-old">Probably
best
for
the
file
to
be
in
the
same
directory
as
the
CSV
file,
so
that
you
can
have
one
metadata
document
that
describes
a
lot
of
them.
</del>
</p>
</div>
<div class="issue">
<div id="h_issue_9" role="heading" aria-level="3" class="issue-title">
<span>
<ins class="diff-chg">Issue
9
</ins></span></div><p class="">
Should
there
be
a
default
navigational
thing
of
continuing
up
the
path
hierarchy
until
you
find
a
metadata
document?
</p>
</div>
<div class="issue">
<div id="h_issue_10" role="heading" aria-level="3" class="issue-title">
<span>
<ins class="diff-new">Issue
10
</ins></span></div><p class=""><ins class="diff-new">
We
have
discussed
using
a
</ins><code>.well-known</code><ins class="diff-new">
location
or
something
within
a
sitemap
file
to
provide
the
location
of
a
metadata
file
about
a
given
CSV
file,
but
these
are
just
as
unlikely
to
be
editable
as
a
</ins><code><ins class="diff-new">
Link
</ins></code><ins class="diff-new">
header,
so
probably
don't
address
the
use
case
that
the
standard
path
method
addresses,
of
being
a
really
simple
way
to
provide
metadata
about
a
CSV
file.
</ins></p></div>
</section>
</section>
<section rel="bibo:Chapter" resource="#syntax" typeof="bibo:Chapter" id="syntax" class="informative">
<h2 id="h2_syntax" role="heading" aria-level="1">
<span class="secno">
4.
</span>
CSV+
Syntax
</h2>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
There
is
no
standard
for
CSV,
and
there
are
many
variants
of
CSV
used
on
the
web
today.
This
section
defines
a
method
for
outputting
tabular
data
adhering
to
the
<a class="internalDFN" href="#dfn-core-tabular-data-model">
core
tabular
data
model
</a>
described
in
<a href="#core-tabular-data-model" class="sectionRef sec-ref">
section
<span class="secno">
2.1
</span>
<span class="sec-title">
Core
<ins class="diff-new">Tabular
</ins>
Data
Model
</span>
</a>
into
a
standard,
CSV-based,
syntax.
Compliant
applications
that
output
this
format
must
meet
each
of
the
constraints.
</p>
<div class="note">
<div id="h_note_2" role="heading" aria-level="2" class="note-title">
<span>
Note
</span>
</div>
<p class="">
We
are
actively
working
with
the
IETF
to
develop
a
standard
for
CSV,
which
is
outside
the
scope
of
the
Working
Group.
The
details
here
aim
to
help
shape
that
standard
based
on
our
requirements.
</p>
</div>
<p>
This
section
does
not
seek
to
describe
how
applications
that
<em>
input
</em>
textual
tabular
data
should
interpret
it,
except
that
any
data
that
is
in
the
format
defined
here
should
be
understood
as
defined
here.
</p>
<div class="note">
<div id="h_note_3" role="heading" aria-level="2" class="note-title">
<span>
Note
</span>
</div>
<div class="">
<p>
This
syntax
is
not
compliant
with
<code>
text/csv
</code>
as
defined
in
[
<cite>
<a href="#bib-RFC4180" class="bibref">
RFC4180
</a>
</cite>
]:
it
permits
characters
other
than
ASCII,
and
it
permits
line
endings
other
than
<code>
CRLF
</code>.
Supporting
the
full
set
of
Unicode
characters
by
using
UTF-8
and
supporting
<code>
LF
</code>
line
endings
are
important
characteristics
for
data
formats
that
are
used
internationally
and
on
non-Windows
platforms.
However,
all
files
that
adhere
to
[
<cite>
<a href="#bib-RFC4180" class="bibref">
RFC4180
</a>
</cite>
]'s
definition
of
CSV
are
compliant
CSV+
files.
</p>
</div>
</div>
<section rel="bibo:Chapter" resource="#content-type" typeof="bibo:Chapter" id="content-type">
<h3 id="h3_content-type" role="heading" aria-level="2">
<span class="secno">
4.1
</span>
Content
Type
</h3>
<p>
The
appropriate
content
type
for
a
CSV+
file
is
<code>
text/csv
</code>.
For
example,
when
a
CSV+
file
is
transmitted
via
HTTP,
the
HTTP
response
<em title="MUST" class="rfc2119">
MUST
</em>
include
a
<code>
Content-Type
</code>
header
with
the
value
<code>
text/csv
</code>:
</p>
<del class="diff-old">        Content-Type: text/csv
</del>
        <pre>Content-Type: text/csv
</pre>
<div class="issue">
<div id="h_issue_11" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">7
</del>
<ins class="diff-chg">11
</ins>
</span>
</div>
<p class="">
See
below
for
issues
relating
to
whether
we
should
instead
define
a
different
content
type.
</p>
</div>
</section>
<section rel="bibo:Chapter" resource="#encoding" typeof="bibo:Chapter" id="encoding">
<h3 id="h3_encoding" role="heading" aria-level="2">
<span class="secno">
4.2
</span>
Encoding
</h3>
<p>
CSV+
files
<em title="SHOULD" class="rfc2119">
SHOULD
</em>
be
encoded
using
UTF-8.
If
a
CSV+
file
is
not
encoded
using
UTF-8,
the
encoding
<em title="MUST" class="rfc2119">
MUST
</em>
be
specified
through
the
<code>
charset
</code>
parameter
in
the
<code>
Content-Type
</code>
header:
</p>
<del class="diff-old">        Content-Type: text/csv;charset=ISO-8859-1
</del>
        <pre>Content-Type: text/csv;charset=ISO-8859-1
</pre>
<div class="issue">
<div id="h_issue_12" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">8
</del>
<ins class="diff-chg">12
</ins>
</span>
</div>
<div class="">
<p>
RFC4180
defines
the
default
charset
as
US-ASCII
because
that
was
(at
the
time
RFC4180
was
written)
the
default
charset
for
all
<code>
text/*
</code>
media
types.
This
has
been
superseded
with
RFC6657.
<a href="http://tools.ietf.org/html/rfc6657#section-3">
Section
3
of
RFC6657
</a>
states
"new
subtypes
of
the
"text"
media
type
<em title="SHOULD NOT" class="rfc2119">
SHOULD
NOT
</em>
define
a
default
"charset"
value.
If
there
is
a
strong
reason
to
do
so
despite
this
advice,
they
<em title="SHOULD" class="rfc2119">
SHOULD
</em>
use
the
"UTF-8"
[RFC3629]
charset
as
the
default."
</p>
<p>
Do
we
have
a
strong
reason
to
specify
a
default
charset?
Should
we
be
defining
<code>
application/csv
</code>
instead,
to
avoid
doing
unrecommended
things
with
a
<code>
text/*
</code>
media
type.
</p>
</div>
</div>
</section>
<section rel="bibo:Chapter" resource="#line-endings" typeof="bibo:Chapter" id="line-endings">
<h3 id="h3_line-endings" role="heading" aria-level="2">
<span class="secno">
4.3
</span>
Line
Endings
</h3>
<p>
The
ends
of
rows
in
a
CSV+
file
<em title="MUST" class="rfc2119">
MUST
</em>
be
either
<code>
CRLF
</code>
(
<code>
U+000D
U+000A
</code>
)
or
<code>
LF
</code>
(
<code>
U+000A
</code>
).
Line
endings
within
escaped
<del class="diff-old">fields
</del>
<a class="internalDFN" href="#dfn-cell" title="cell">
<ins class="diff-chg">cells
</ins>
</a>
are
not
normalised.
</p>
<div class="issue">
<div id="h_issue_13" role="heading" aria-level="3" class="issue-title">
<span>
Issue
<del class="diff-old">9
</del>
<ins class="diff-chg">13
</ins>
</span>
</div>
<div class="">
<p>
<a href="http://tools.ietf.org/html/rfc2046#section-4.1.1">
Section
4.1.1
of
RFC2046
</a>
specifies
that
"The
canonical
form
of
any
MIME
"text"
subtype
<em title="MUST" class="rfc2119">
MUST
</em>
always
represent
a
line
break
as
a
CRLF
sequence.
Similarly,
any
occurrence
of
CRLF
in
MIME
"text"
<em title="MUST" class="rfc2119">
MUST
</em>
represent
a
line
break.
Use
of
CR
and
LF
outside
of
line
break
sequences
is
also
forbidden."
</p>
<p>
Should
we
be
defining
<code>
application/csv
</code>
instead,
to
prevent
having
to
adhere
to
this
rule,
or
should
we
stick
to
the
<code>
CRLF
</code>
rule?
</p>
</div>
</div>
</section>
<section rel="bibo:Chapter" resource="#lines" typeof="bibo:Chapter" id="lines">
<h3 id="h3_lines" role="heading" aria-level="2">
<span class="secno">
4.4
</span>
Lines
</h3>
<p>
Each
line
of
a
CSV+
file
<em title="MUST" class="rfc2119">
MUST
</em>
contain
the
same
number
of
comma-separated
values.
</p>
<p>
Values
that
contain
commas,
line
endings
or
double
quotes
<em title="MUST" class="rfc2119">
MUST
</em>
be
escaped
by
having
the
entire
value
wrapped
in
double
quotes.
There
<em title="MUST NOT" class="rfc2119">
MUST
NOT
</em>
be
whitespace
before
or
after
the
double
quotes.
Within
these
escaped
<del class="diff-old">fields,
</del>
<ins class="diff-chg">cells,
</ins>
any
double
quotes
<em title="MUST" class="rfc2119">
MUST
</em>
be
escaped
with
two
double
quotes
(
<code>
""
</code>
).
</p>
<section rel="bibo:Chapter" resource="#headers" typeof="bibo:Chapter" id="headers">
<h4 id="h4_headers" role="heading" aria-level="3">
<span class="secno">
4.4.1
</span>
Headers
</h4>
<p>
The
first
line
of
a
CSV+
file
<em title="SHOULD" class="rfc2119">
SHOULD
</em>
contain
a
comma-separated
list
of
names
of
<a class="internalDFN" href="#dfn-column" title="column">
columns
</a>.
This
is
known
as
the
<dfn id="dfn-header-line">
header
line
</dfn>
and
provides
names
for
the
columns.
There
are
no
constraints
on
these
names.
</p>
<p>
If
a
CSV+
file
does
not
include
a
header
line,
this
<em title="MUST" class="rfc2119">
MUST
</em>
be
specified
using
the
<code>
header
</code>
parameter
of
the
media
type:
</p>
<del class="diff-old">          Content-Type: text/csv;header=absent
</del>
          <pre>Content-Type: text/csv;header=absent
</pre>
</section>
<section id="bidirectionality-in-csv-files">
<h4 id="h4_bidirectionality-in-csv-files" role="heading" aria-level="3">
<span class="secno">
<ins class="diff-new">4.4.2
</ins></span><ins class="diff-new">
Bidirectionality
in
CSV+
Files
</ins></h4><p><ins class="diff-new">
Bidirectional
content
does
not
alter
the
definition
of
rows
or
the
assignment
of
cells
to
columns.
Whether
or
not
a
CSV+
file
contains
right-to-left
characters,
the
first
column's
content
is
the
first
cell
of
each
row,
which
is
the
text
prior
to
the
first
occurrence
of
a
comma
within
that
row.
</ins></p><div class="example"><p><ins class="diff-new">
For
example,
</ins><a href="http://referendum2012.elections.eg/results/referendum-results"><ins class="diff-new">
Egyptian
Referendum
results
</ins></a><ins class="diff-new">
are
available
as
a
CSV
file
at
</ins><a href="https://egelections-2011.appspot.com/Referendum2012/results/csv/EG.csv"><ins class="diff-new">
https://egelections-2011.appspot.com/Referendum2012/results/csv/EG.csv
</ins></a>.<ins class="diff-new">
Over
the
wire
and
in
non-Unicode-aware
text
editors,
the
CSV
looks
like:
</ins></p>            <pre>              <bdo dir="ltr"><ins class="diff-new">
‌ا‌ل‌م‌ح‌ا‌ف‌ظ‌ة‌,‌ن‌س‌ب‌ة‌ ‌م‌و‌ا‌ف‌ق‌,‌ن‌س‌ب‌ة‌ ‌غ‌ي‌ر‌ ‌م‌و‌ا‌ف‌ق‌,‌ع‌د‌د‌ ‌ا‌ل‌ن‌ا‌خ‌ب‌ي‌ن‌,‌ا‌ل‌أ‌ص‌و‌ا‌ت‌ ‌ا‌ل‌ص‌ح‌ي‌ح‌ة‌,‌ا‌ل‌أ‌ص‌و‌ا‌ت‌ ‌ا‌ل‌ب‌ا‌ط‌ل‌ة‌,‌ن‌س‌ب‌ة‌ ‌ا‌ل‌م‌ش‌ا‌ر‌ك‌ة‌,‌م‌و‌ا‌ف‌ق‌,‌غ‌ي‌ر‌ ‌م‌و‌ا‌ف‌ق‌
‌ا‌ل‌ق‌ل‌ي‌و‌ب‌ي‌ة‌,60.0,40.0,"2,639,808","853,125","15,224",32.9,"512,055","341,070"
‌ا‌ل‌ج‌ي‌ز‌ة‌,66.7,33.3,"4,383,701","1,493,092","24,105",34.6,"995,417","497,675"
‌ا‌ل‌ق‌ا‌ه‌ر‌ة‌,43.2,56.8,"6,580,478","2,254,698","36,342",34.8,"974,371","1,280,327"
‌ق‌ن‌ا‌,84.5,15.5,"1,629,713","364,509","6,743",22.8,"307,839","56,670"
...
</ins>              </bdo></pre><p><ins class="diff-new">
Within
this
CSV
file,
the
first
column
appears
as
the
content
of
each
line
before
the
first
comma
and
is
named
</ins><code><ins class="diff-new">
المحافظة
</ins></code><ins class="diff-new">
(appearing
at
the
start
of
each
row
as
</ins><code><bdo dir="ltr"><ins class="diff-new">
‌ا‌ل‌م‌ح‌ا‌ف‌ظ‌ة‌
</ins></bdo></code><ins class="diff-new">
in
the
example,
which
is
displaying
the
relevant
characters
from
left
to
right
in
the
order
they
appear
"on
the
wire").
</ins></p><p><ins class="diff-new">
The
CSV
translates
to
a
table
model
that
looks
like:
</ins></p><table style="width: 100%; text-align: right"><colgroup><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"></colgroup><thead><tr style="text-align: centre"><th><ins class="diff-new">
Column
/
Row
</ins></th><th><ins class="diff-new">
column
1
</ins></th><th><ins class="diff-new">
column
2
</ins></th><th><ins class="diff-new">
column
3
</ins></th><th><ins class="diff-new">
column
4
</ins></th><th><ins class="diff-new">
column
5
</ins></th><th><ins class="diff-new">
column
6
</ins></th><th><ins class="diff-new">
column
7
</ins></th><th><ins class="diff-new">
column
8
</ins></th><th><ins class="diff-new">
column
9
</ins></th></tr></thead><tbody><tr><th><ins class="diff-new">
row
1
(header)
</ins></th><th><ins class="diff-new">
المحافظة
</ins></th><th><ins class="diff-new">
نسبة
موافق
</ins></th><th><ins class="diff-new">
نسبة
غير
موافق
</ins></th><th><ins class="diff-new">
عدد
الناخبين
</ins></th><th><ins class="diff-new">
الأصوات
الصحيحة
</ins></th><th><ins class="diff-new">
الأصوات
الباطلة
</ins></th><th><ins class="diff-new">
نسبة
المشاركة
</ins></th><th><ins class="diff-new">
موافق
</ins></th><th><ins class="diff-new">
غير
موافق
</ins></th></tr><tr><th><ins class="diff-new">
row
2
</ins></th><td><ins class="diff-new">
القليوبية
</ins></td><td><ins class="diff-new">
60.0
</ins></td><td><ins class="diff-new">
40.0
</ins></td><td><ins class="diff-new">
2,639,808
</ins></td><td><ins class="diff-new">
853,125
</ins></td><td><ins class="diff-new">
15,224
</ins></td><td><ins class="diff-new">
32.9
</ins></td><td><ins class="diff-new">
512,055
</ins></td><td><ins class="diff-new">
341,070
</ins></td></tr><tr><th><ins class="diff-new">
row
3
</ins></th><td><ins class="diff-new">
الجيزة
</ins></td><td><ins class="diff-new">
66.7
</ins></td><td><ins class="diff-new">
33.3
</ins></td><td><ins class="diff-new">
4,383,701
</ins></td><td><ins class="diff-new">
1,493,092
</ins></td><td><ins class="diff-new">
24,105
</ins></td><td><ins class="diff-new">
34.6
</ins></td><td><ins class="diff-new">
995,417
</ins></td><td><ins class="diff-new">
497,675
</ins></td></tr><tr><th><ins class="diff-new">
row
4
</ins></th><td><ins class="diff-new">
القاهرة
</ins></td><td><ins class="diff-new">
43.2
</ins></td><td><ins class="diff-new">
56.8
</ins></td><td><ins class="diff-new">
6,580,478
</ins></td><td><ins class="diff-new">
2,254,698
</ins></td><td><ins class="diff-new">
36,342
</ins></td><td><ins class="diff-new">
34.8
</ins></td><td><ins class="diff-new">
974,371
</ins></td><td><ins class="diff-new">
1,280,327
</ins></td></tr><tr><th><ins class="diff-new">
row
5
</ins></th><td><ins class="diff-new">
قنا
</ins></td><td><ins class="diff-new">
84.5
</ins></td><td><ins class="diff-new">
15.5
</ins></td><td><ins class="diff-new">
1,629,713
</ins></td><td><ins class="diff-new">
364,509
</ins></td><td><ins class="diff-new">
6,743
</ins></td><td><ins class="diff-new">
22.8
</ins></td><td><ins class="diff-new">
307,839
</ins></td><td><ins class="diff-new">
56,670
</ins></td></tr></tbody></table><p><ins class="diff-new">
The
fragment
identifier
</ins><code><ins class="diff-new">
#col=3
</ins></code><ins class="diff-new">
identifies
the
third
of
the
columns,
named
</ins><code><ins class="diff-new">
نسبة
غير
موافق
</ins></code><ins class="diff-new">
(appearing
as
</ins><code><bdo dir="ltr"><ins class="diff-new">
‌ن‌س‌ب‌ة‌
‌غ‌ي‌ر‌
‌م‌و‌ا‌ف‌ق‌
</ins></bdo></code><ins class="diff-new">
in
the
example).
</ins></p><p><ins class="diff-new">
[
</ins><cite><a href="#bib-CSV-METADATA" class="bibref"><ins class="diff-new">
CSV-METADATA
</ins></a></cite><ins class="diff-new">
]
defines
how
this
table
model
should
be
displayed
by
compliant
applications,
and
how
metadata
can
affect
the
display.
The
default
is
for
the
display
to
be
determined
by
the
content
of
the
table.
For
example,
if
this
CSV
were
turned
into
an
HTML
table
for
display
into
a
web
page,
it
should
be
displayed
with
the
first
column
on
the
right
and
the
last
on
the
left,
as
follows:
</ins></p><table style="width: 100%; text-align: right"><thead><tr><th><ins class="diff-new">
غير
موافق
</ins></th><th><ins class="diff-new">
موافق
</ins></th><th><ins class="diff-new">
نسبة
المشاركة
</ins></th><th><ins class="diff-new">
الأصوات
الباطلة
</ins></th><th><ins class="diff-new">
الأصوات
الصحيحة
</ins></th><th><ins class="diff-new">
عدد
الناخبين
</ins></th><th><ins class="diff-new">
نسبة
غير
موافق
</ins></th><th><ins class="diff-new">
نسبة
موافق
</ins></th><th><ins class="diff-new">
المحافظة
</ins></th></tr></thead><tbody><tr><td><ins class="diff-new">
341,070
</ins></td><td><ins class="diff-new">
512,055
</ins></td><td><ins class="diff-new">
32.9
</ins></td><td><ins class="diff-new">
15,224
</ins></td><td><ins class="diff-new">
853,125
</ins></td><td><ins class="diff-new">
2,639,808
</ins></td><td><ins class="diff-new">
40.0
</ins></td><td><ins class="diff-new">
60.0
</ins></td><td><ins class="diff-new">
القليوبية
</ins></td></tr><tr><td><ins class="diff-new">
497,675
</ins></td><td><ins class="diff-new">
995,417
</ins></td><td><ins class="diff-new">
34.6
</ins></td><td><ins class="diff-new">
24,105
</ins></td><td><ins class="diff-new">
1,493,092
</ins></td><td><ins class="diff-new">
4,383,701
</ins></td><td><ins class="diff-new">
33.3
</ins></td><td><ins class="diff-new">
66.7
</ins></td><td><ins class="diff-new">
الجيزة
</ins></td></tr><tr><td><ins class="diff-new">
1,280,327
</ins></td><td><ins class="diff-new">
974,371
</ins></td><td><ins class="diff-new">
34.8
</ins></td><td><ins class="diff-new">
36,342
</ins></td><td><ins class="diff-new">
2,254,698
</ins></td><td><ins class="diff-new">
6,580,478
</ins></td><td><ins class="diff-new">
56.8
</ins></td><td><ins class="diff-new">
43.2
</ins></td><td><ins class="diff-new">
القاهرة
</ins></td></tr><tr><td><ins class="diff-new">
56,670
</ins></td><td><ins class="diff-new">
307,839
</ins></td><td><ins class="diff-new">
22.8
</ins></td><td><ins class="diff-new">
6,743
</ins></td><td><ins class="diff-new">
364,509
</ins></td><td><ins class="diff-new">
1,629,713
</ins></td><td><ins class="diff-new">
15.5
</ins></td><td><ins class="diff-new">
84.5
</ins></td><td><ins class="diff-new">
قنا
</ins></td></tr></tbody></table><p><ins class="diff-new">
The
fragment
identifier
</ins><code><ins class="diff-new">
#col=3
</ins></code><ins class="diff-new">
still
identifies
the
third
of
the
columns,
named
</ins><code><ins class="diff-new">
نسبة
غير
موافق
</ins></code>,<ins class="diff-new">
which
appears
in
the
HTML
display
as
the
third
column
from
the
right
and
is
what
those
who
read
right-to-left
would
think
of
as
the
third
column.
</ins></p><p><ins class="diff-new">
Note
that
this
display
matches
that
shown
</ins><a href="http://referendum2012.elections.eg/results/referendum-results"><ins class="diff-new">
on
the
original
website
</ins></a>.</p></div><div class="issue"><div id="h_issue_14" role="heading" aria-level="4" class="issue-title"><span><ins class="diff-new">
Issue
14
</ins></span></div><div class=""><p><ins class="diff-new">
An
alternative
approach
is
for
the
CSV
to
be
parsed
into
a
table
model
in
which
the
columns
are
numbered
in
the
reverse,
for
tables
which
are
either
marked
as
or
detected
to
be
right-to-left
tables.
For
example,
we
could
introduce
a
</ins><code><ins class="diff-new">
bidi=rtl
</ins></code><ins class="diff-new">
or
similar
media
type
parameter,
and
use
this
to
determine
whether
the
first
column
in
table
generated
from
the
CSV
is
the
text
before
the
first
comma
in
each
line
or
the
text
after
the
last
comma
in
the
line.
</ins></p><p><ins class="diff-new">
In
the
example
above,
if
the
CSV
were
served
with
</ins><code><ins class="diff-new">
bidi=rtl
</ins></code>,<ins class="diff-new">
or
the
table
was
detected
as
being
a
right-to-left
table,
then
the
column
numbering
in
the
model
would
be
reversed:
</ins></p><table style="width: 100%; text-align: right"><colgroup><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"><col style="width: 10%"></colgroup><thead><tr style="text-align: centre"><th><ins class="diff-new">
Column
/
Row
</ins></th><th><ins class="diff-new">
column
9
</ins></th><th><ins class="diff-new">
column
8
</ins></th><th><ins class="diff-new">
column
7
</ins></th><th><ins class="diff-new">
column
6
</ins></th><th><ins class="diff-new">
column
5
</ins></th><th><ins class="diff-new">
column
4
</ins></th><th><ins class="diff-new">
column
3
</ins></th><th><ins class="diff-new">
column
2
</ins></th><th><ins class="diff-new">
column
1
</ins></th></tr></thead><tbody><tr><th><ins class="diff-new">
row
1
(header)
</ins></th><th><ins class="diff-new">
المحافظة
</ins></th><th><ins class="diff-new">
نسبة
موافق
</ins></th><th><ins class="diff-new">
نسبة
غير
موافق
</ins></th><th><ins class="diff-new">
عدد
الناخبين
</ins></th><th><ins class="diff-new">
الأصوات
الصحيحة
</ins></th><th><ins class="diff-new">
الأصوات
الباطلة
</ins></th><th><ins class="diff-new">
نسبة
المشاركة
</ins></th><th><ins class="diff-new">
موافق
</ins></th><th><ins class="diff-new">
غير
موافق
</ins></th></tr><tr><th><ins class="diff-new">
row
2
</ins></th><td><ins class="diff-new">
القليوبية
</ins></td><td><ins class="diff-new">
60.0
</ins></td><td><ins class="diff-new">
40.0
</ins></td><td><ins class="diff-new">
2,639,808
</ins></td><td><ins class="diff-new">
853,125
</ins></td><td><ins class="diff-new">
15,224
</ins></td><td><ins class="diff-new">
32.9
</ins></td><td><ins class="diff-new">
512,055
</ins></td><td><ins class="diff-new">
341,070
</ins></td></tr><tr><th><ins class="diff-new">
row
3
</ins></th><td><ins class="diff-new">
الجيزة
</ins></td><td><ins class="diff-new">
66.7
</ins></td><td><ins class="diff-new">
33.3
</ins></td><td><ins class="diff-new">
4,383,701
</ins></td><td><ins class="diff-new">
1,493,092
</ins></td><td><ins class="diff-new">
24,105
</ins></td><td><ins class="diff-new">
34.6
</ins></td><td><ins class="diff-new">
995,417
</ins></td><td><ins class="diff-new">
497,675
</ins></td></tr><tr><th><ins class="diff-new">
row
4
</ins></th><td><ins class="diff-new">
القاهرة
</ins></td><td><ins class="diff-new">
43.2
</ins></td><td><ins class="diff-new">
56.8
</ins></td><td><ins class="diff-new">
6,580,478
</ins></td><td><ins class="diff-new">
2,254,698
</ins></td><td><ins class="diff-new">
36,342
</ins></td><td><ins class="diff-new">
34.8
</ins></td><td><ins class="diff-new">
974,371
</ins></td><td><ins class="diff-new">
1,280,327
</ins></td></tr><tr><th><ins class="diff-new">
row
5
</ins></th><td><ins class="diff-new">
قنا
</ins></td><td><ins class="diff-new">
84.5
</ins></td><td><ins class="diff-new">
15.5
</ins></td><td><ins class="diff-new">
1,629,713
</ins></td><td><ins class="diff-new">
364,509
</ins></td><td><ins class="diff-new">
6,743
</ins></td><td><ins class="diff-new">
22.8
</ins></td><td><ins class="diff-new">
307,839
</ins></td><td><ins class="diff-new">
56,670
</ins></td></tr></tbody></table><p><ins class="diff-new">
This
would
require
a
change
to
[
</ins><cite><a href="#bib-RFC7111" class="bibref"><ins class="diff-new">
RFC7111
</ins></a></cite><ins class="diff-new">
]
but
that
might
be
required
by
updates
to
the
definition
of
</ins><code><ins class="diff-new">
text/csv
</ins></code><ins class="diff-new">
in
any
case.
With
the
change,
the
fragment
identifier
</ins><code><ins class="diff-new">
#col=3
</ins></code><ins class="diff-new">
would
then
refer
to
the
third
column
from
the
right,
named
</ins><code><ins class="diff-new">
نسبة
المشاركة
</ins></code>.</p><p><ins class="diff-new">
If
the
model
were
defined
in
this
way,
there
would
be
no
need
to
determine
the
order
of
the
columns
when
displayed
using
a
metadata
property.
Columns
would
always
be
displayed
with
the
first
column
(numbered
1
in
the
model)
on
the
left.
The
final
display
in
HTML,
for
example,
would
be
exactly
as
above.
The
only
difference
would
be
that
</ins><code><ins class="diff-new">
#col=3
</ins></code><ins class="diff-new">
would
refer
to
the
third
column
from
the
left.
</ins></p><p><ins class="diff-new">
We
note
that
using
media
type
parameters
is
problematic
because
publishers
might
not
have
the
ability
to
set
them
on
their
servers,
and
because
they
can
easily
get
lost
as
a
file
is
republished
or
emailed
between
people.
</ins></p><p><ins class="diff-new">
We
invite
comment
on
the
best
way
to
approach
bidirectionality
in
CSV
files.
</ins></p></div></div></section>
</section>
<section rel="bibo:Chapter" resource="#ebnf" typeof="bibo:Chapter" id="ebnf">
<h3 id="h3_ebnf" role="heading" aria-level="2">
<span class="secno">
4.5
</span>
Grammar
</h3>
<p>
This
grammar
is
a
generalization
of
that
defined
in
[
<cite>
<a href="#bib-RFC4180" class="bibref">
RFC4180
</a>
</cite>
]
and
is
included
for
reference
only.
</p>
<p>
The
<abbr title="Extended Backus–Naur Form">
EBNF
</abbr>
used
here
is
defined
in
XML
1.0
[
<cite>
<a href="#bib-EBNF-NOTATION" class="bibref">
EBNF-NOTATION
</a>
</cite>
].
</p>
<div>
<table class="grammar">
<tbody id="grammar-productions">
<tr id="grammar-production-csv">
<td>
[1]
</td>
<td>
<code>
csv
</code>
</td>
<td>::=
</td>
<td>
<a href="#grammar-production-header">
header
</a>
<a href="#grammar-production-record">
record
</a>
<code>
+
</code>
</td>
</tr>
<tr id="grammar-production-header">
<td>
[2]
</td>
<td>
<code>
header
</code>
</td>
<td>::=
</td>
<td>
<a href="#grammar-production-record">
record
</a>
</td>
</tr>
<tr id="grammar-production-record">
<td>
[3]
</td>
<td>
<code>
record
</code>
</td>
<td>::=
</td>
<td>
<a href="#grammar-production-fields">
fields
</a>
<code class="grammar-char-escape">
#x0D
</code>
<code>
?
</code>
<code class="grammar-char-escape">
#x0A
</code>
</td>
</tr>
<tr id="grammar-production-fields">
<td>
[4]
</td>
<td>
<code>
fields
</code>
</td>
<td>::=
</td>
<td>
<a href="#grammar-production-field">
field
</a>
("
<code class="grammar-literal">,
</code>
"
<a href="#grammar-production-fields">
fields
</a>
)
<code>
*
</code>
</td>
</tr>
<tr id="grammar-production-field">
<td>
[5]
</td>
<td>
<code>
field
</code>
</td>
<td>::=
</td>
<td>
<a href="#grammar-production-WS">
WS
</a>
<code>
*
</code>
<a href="#grammar-production-rawfield">
rawfield
</a>
<a href="#grammar-production-WS">
WS
</a>
<code>
*
</code>
</td>
</tr>
<tr id="grammar-production-rawfield">
<td>
[6]
</td>
<td>
<code>
rawfield
</code>
</td>
<td>::=
</td>
<td>
'
<code class="grammar-literal">
"
</code>
'
<a href="#grammar-production-QCHAR">
QCHAR
</a>
<code>
*
</code>
'
<code class="grammar-literal">
"
</code>
'
<code>
|
</code>
<a href="#grammar-production-SCHAR">
SCHAR
</a>
<code>
*
</code>
</td>
</tr>
<tr id="grammar-production-QCHAR">
<td>
[7]
</td>
<td>
<code>
QCHAR
</code>
</td>
<td>::=
</td>
<td>
<code>
[
</code>
<code class="grammar-literal">
^"
</code>
<code>
]
</code>
<code>
|
</code>
'
<code class="grammar-literal">
""
</code>
'
</td>
</tr>
<tr id="grammar-production-SCHAR">
<td>
[8]
</td>
<td>
<code>
SCHAR
</code>
</td>
<td>::=
</td>
<td>
<code>
[
</code>
<code class="grammar-literal">
^",
</code>
<code class="grammar-char-escape">
#x0A
</code>
<code class="grammar-char-escape">
#x0D
</code>
<code>
]
</code>
</td>
</tr>
<tr id="grammar-production-WS">
<td>
[9]
</td>
<td>
<code>
WS
</code>
</td>
<td>::=
</td>
<td>
<code>
[
</code>
<code class="grammar-char-escape">
#x20
</code>
<code class="grammar-char-escape">
#x09
</code>
<code>
]
</code>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note">
<div id="h_note_4" role="heading" aria-level="3" class="note-title">
<span>
Note
</span>
</div>
<p class="">
We
should
probably
place
further
restrictions
on
QCHAR
and
SCHAR
to
avoid
control
characters.
If
header
weren’t
optional,
it
would
be
better
defined
as
in
RFC4180,
but
if
the
syntax
allows
it
to
be
optional,
this
would
make
it
not
an
LL(1)
grammar,
which
isn’t
too
much
of
an
issue.
</p>
</div>
</section>
</section>
<section rel="bibo:Chapter" resource="#parsing" typeof="bibo:Chapter" id="parsing" class="informative">
<h2 id="h2_parsing" role="heading" aria-level="1">
<span class="secno">
5.
</span>
Parsing
Tabular
Data
</h2>
<p>
<em>
This
section
is
non-normative.
</em>
</p>
<p>
As
described
in
<a href="#syntax" class="sectionRef sec-ref">
section
<span class="secno">
4.
</span>
<span class="sec-title">
CSV+
Syntax
</span>
</a>,
there
may
be
many
formats
which
an
application
might
interpret
into
the
tabular
data
model
described
in
<a href="#model" class="sectionRef sec-ref">
section
<span class="secno">
2.
</span>
<span class="sec-title">
Tabular
Data
<del class="diff-old">Model
</del>
<ins class="diff-chg">Models
</ins>
</span>
</a>,
including
using
different
separators
or
fixed
format
tables,
multiple
tables
within
a
single
file,
or
ones
that
have
metadata
lines
before
a
table
header.
</p>
<div class="note">
<div id="h_note_5" role="heading" aria-level="2" class="note-title">
<span>
Note
</span>
</div>
<p class="">
Standardising
the
parsing
of
CSV
is
outside
the
chartered
scope
of
the
Working
Group.
This
non-normative
section
is
intended
to
help
the
creators
of
parsers
handle
the
wide
variety
of
CSV-based
formats
that
they
may
encounter
due
to
the
current
lack
of
standardisation
of
the
format.
</p>
</div>
<p>
This
section
describes
an
algorithm
for
parsing
formats
other
than
the
plain
CSV+
format
specified
in
<a href="#syntax" class="sectionRef sec-ref">
section
<span class="secno">
4.
</span>
<span class="sec-title">
CSV+
Syntax
</span>
</a>.
It
is
impossible
to
do
this
in
a
fully
automated
manner,
so
this
algorithm
depends
on
the
following
flags
being
set
externally
(eg
through
user
input):
</p>
<dl>
<dt>
<dfn id="dfn-encoding">
encoding
</dfn>
</dt>
<dd>
The
character
encoding
for
the
file,
one
of
the
encodings
listed
in
[
<cite>
<a href="#bib-encoding" class="bibref">
encoding
</a>
</cite>
].
The
default
is
<code>
utf-8
</code>.
</dd>
<dt>
<dfn id="dfn-row-terminator">
row
terminator
</dfn>
</dt>
<dd>
The
character
that
is
used
at
the
end
of
a
row.
The
default
is
<code>
CRLF
</code>.
</dd>
<dt>
<dfn id="dfn-enclosure-character">
enclosure
character
</dfn>
</dt>
<dd>
The
character
that
is
used
around
escaped
<del class="diff-old">fields.
</del>
<ins class="diff-chg">cells.
</ins>
The
default
is
<code>
"
</code>.
</dd>
<dt>
<dfn id="dfn-escape-character">
escape
character
</dfn>
</dt>
<dd>
The
character
that
is
used
to
escape
the
<a class="internalDFN" href="#dfn-enclosure-character">
enclosure
character
</a>
within
escaped
<del class="diff-old">fields.
</del>
<ins class="diff-chg">cells.
</ins>
The
default
is
<code>
"
</code>.
</dd>
<dt>
<dfn id="dfn-skip-rows">
skip
rows
</dfn>
</dt>
<dd>
The
number
of
rows
to
skip
at
the
beginning
of
the
file,
before
a
header
row
or
tabular
data.
The
default
is
<code>
0
</code>.
</dd>
<dt>
<dfn id="dfn-comment-prefix">
comment
prefix
</dfn>
</dt>
<dd>
A
character
that,
when
it
appears
at
the
beginning
of
a
skipped
row,
indicates
a
comment
that
should
be
associated
as
a
comment
annotation
to
the
table.
The
default
is
<code>
#
</code>.
</dd>
<dt>
<dfn id="dfn-header-row-count">
header
row
count
</dfn>
</dt>
<dd>
The
number
of
header
rows
(following
the
skipped
rows)
in
the
file.
The
default
is
<code>
1
</code>.
</dd>
<dt>
<dfn id="dfn-delimiter">
delimiter
</dfn>
</dt>
<dd>
The
separator
between
<del class="diff-old">fields.
</del>
<ins class="diff-chg">cells.
</ins>
The
default
is
<code>,
</code>.
</dd>
<dt>
<dfn id="dfn-skip-columns">
skip
columns
</dfn>
</dt>
<dd>
The
number
of
columns
to
skip
at
the
beginning
of
each
row,
before
any
header
columns.
The
default
is
<code>
0
</code>.
</dd>
<dt>
<dfn id="dfn-header-column-count">
header
column
count
</dfn>
</dt>
<dd>
The
number
of
header
columns
(following
the
skipped
columns)
in
each
row.
The
default
is
<code>
0
</code>.
</dd>
<dt>
<dfn id="dfn-skip-blank-rows">
skip
blank
rows
</dfn>
</dt>
<dd>
Indicates
whether
to
ignore
wholly
empty
rows
(ie
rows
in
which
all
the
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
are
empty).
The
default
is
<code>
false
</code>.
</dd>
<dt>
<dfn id="dfn-trim">
trim
</dfn>
</dt>
<dd>
Indicates
whether
to
trim
whitespace
around
<del class="diff-old">fields.
</del>
<ins class="diff-chg">cells.
</ins>
</dd>
</dl>
<div class="issue">
<div id="h_issue_15" role="heading" aria-level="2" class="issue-title">
<span>
Issue
<del class="diff-old">10
</del>
<ins class="diff-chg">15
</ins>
</span>
</div>
<div class="">
<p>
When
parsing,
should
we:
</p>
<ul>
<li>
always
trim
whitespace
around
<del class="diff-old">fields?
</del>
<ins class="diff-chg">cells?
</ins>
</li>
<li>
always
create
empty
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
for
missing
cells?
</li>
</ul>
</div>
</div>
<p>
The
algorithm
for
parsing
a
document
containing
tabular
data
is
as
follows:
</p>
<ol>
<li>
Read
the
file
using
the
specified
<a class="internalDFN" href="#dfn-encoding">
encoding
</a>.
</li>
<li>
Find
the
rows.
Each
row
ends
with
a
<a class="internalDFN" href="#dfn-row-terminator">
row
terminator
</a>,
but
values
that
are
enclosed
within
the
<a class="internalDFN" href="#dfn-enclosure-character">
enclosure
character
</a>
may
contain
the
<a class="internalDFN" href="#dfn-row-terminator">
row
terminator
</a>
without
it
indicating
the
end
of
the
row.
The
<a class="internalDFN" href="#dfn-enclosure-character">
enclosure
character
</a>
may
be
escaped
using
the
<a class="internalDFN" href="#dfn-escape-character">
escape
character
</a>
where
it
appears
within
<del class="diff-old">fields.
</del>
<ins class="diff-chg">cells.
</ins>
</li>
<li>
Skip
the
number
of
rows
indicated
by
the
<a class="internalDFN" href="#dfn-skip-rows">
skip
rows
</a>
parameter.
</li>
<li>
Within
the
skipped
rows,
find
rows
that
start
with
the
<a class="internalDFN" href="#dfn-comment-prefix">
comment
prefix
</a>.
These
form
comment
annotations
on
the
table.
</li>
<li>
Gather
the
number
of
header
rows
indicated
by
the
<a class="internalDFN" href="#dfn-header-row-count">
header
row
count
</a>
parameter;
the
remaining
rows
are
data
rows.
</li>
<li>
<p>
Split
the
header
and
data
rows
into
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
using
the
<a class="internalDFN" href="#dfn-delimiter">
delimiter
</a>.
Values
that
are
enclosed
within
the
<a class="internalDFN" href="#dfn-enclosure-character">
enclosure
character
</a>
may
contain
the
<a class="internalDFN" href="#dfn-delimiter">
delimiter
</a>.
The
<a class="internalDFN" href="#dfn-enclosure-character">
enclosure
character
</a>
may
be
escaped
using
the
<a class="internalDFN" href="#dfn-escape-character">
escape
character
</a>
where
it
appears
within
<del class="diff-old">fields.
</del>
<ins class="diff-chg">cells.
</ins>
</p>
<p>
If
<a class="internalDFN" href="#dfn-trim">
trim
</a>
is
<code>
true
</code>
or
<code>
start
</code>
then
whitespace
from
the
start
of
values
that
are
not
enclosed
must
be
removed
from
the
value.
If
<a class="internalDFN" href="#dfn-trim">
trim
</a>
is
<code>
true
</code>
or
<code>
end
</code>
then
whitespace
from
the
end
of
values
that
are
not
enclosed
must
be
removed
from
the
value.
</p>
</li>
<li>
In
each
row,
ignore
the
number
of
columns
indicated
by
the
<a class="internalDFN" href="#dfn-skip-columns">
skip
columns
</a>
parameter.
<ins class="diff-new">Always
start
from
the
first
character
in
the
row
when
counting
columns
(see
</ins><a href="#bidirectionality-in-csv-files" class="sectionRef sec-ref"><ins class="diff-new">
section
</ins><span class="secno"><ins class="diff-new">
4.4.2
</ins></span><span class="sec-title"><ins class="diff-new">
Bidirectionality
in
CSV+
Files
</ins></span></a><ins class="diff-new">
).
</ins>
</li>
<li>
Gather
the
number
of
header
columns
indicated
by
the
<a class="internalDFN" href="#dfn-header-column-count">
header
column
count
</a>
parameter.
<ins class="diff-new">Always
start
from
the
first
character
in
the
row
when
counting
columns
(see
</ins><a href="#bidirectionality-in-csv-files" class="sectionRef sec-ref"><ins class="diff-new">
section
</ins><span class="secno"><ins class="diff-new">
4.4.2
</ins></span><span class="sec-title"><ins class="diff-new">
Bidirectionality
in
CSV+
Files
</ins></span></a><ins class="diff-new">
).
</ins>
</li>
<li>
Each
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
within
a
header
row
that
is
not
in
a
skipped
or
header
column
is
a
label
annotation
on
that
column.
</li>
<li>
Each
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
within
a
header
column
is
an
annotation
on
the
row
it
appears
in;
if
there
is
a
header
row
then
that
provides
the
type
of
the
annotation
for
the
row,
otherwise
it
is
a
label
annotation.
</li>
<li>
If
<a class="internalDFN" href="#dfn-skip-blank-rows">
skip
blank
rows
</a>
is
<code>
true
</code>
then
ignore
any
rows
in
which
all
the
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
values
are
empty
strings.
</li>
</ol>
</section>
<section rel="bibo:Chapter" resource="#standards" typeof="bibo:Chapter" class="appendix" id="standards">
<h2 id="h2_standards" role="heading" aria-level="1">
<span class="secno">
A.
</span>
Existing
Standards
</h2>
<p>
This
appendix
outlines
various
ways
in
which
CSV
is
defined.
</p>
<section rel="bibo:Chapter" resource="#rfc" typeof="bibo:Chapter" id="rfc">
<h3 id="h3_rfc" role="heading" aria-level="2">
<span class="secno">
A.1
</span>
RFC
4180
</h3>
<p>
[
<cite>
<a href="#bib-RFC4180" class="bibref">
RFC4180
</a>
</cite>
]
defines
CSV
with
the
following
ABNF
grammar:
</p>
<del class="diff-old">        file = [header CRLF] record *(CRLF record) [CRLF]
header = name *(COMMA name)
record = field *(COMMA field)
name = field
field = (escaped / non-escaped)
escaped = DQUOTE *(TEXTDATA / COMMA / CR / LF / 2DQUOTE) DQUOTE
non-escaped = *TEXTDATA
COMMA = %x2C
CR = %x0D
DQUOTE =  %x22
LF = %x0A
CRLF = CR LF
TEXTDATA =  %x20-21 / %x23-2B / %x2D-7E
</del>
        <pre>file = [header CRLF] record *(CRLF record) [CRLF]
<ins class="diff-chg">header = name *(COMMA name)
record = field *(COMMA field)
name = field
field = (escaped / non-escaped)
escaped = DQUOTE *(TEXTDATA / COMMA / CR / LF / 2DQUOTE) DQUOTE
non-escaped = *TEXTDATA
COMMA = %x2C
CR = %x0D
DQUOTE =  %x22
LF = %x0A
CRLF = CR LF
TEXTDATA =  %x20-21 / %x23-2B / %x2D-7E
</ins>
</pre>
<p>
Of
particular
note
here
are:
</p>
<ul>
<li>
The
production
for
<code>
TEXTDATA
</code>
indicates
that
only
non-control
ASCII
characters
are
permitted
within
a
CSV
file.
This
restriction
is
routinely
ignored
in
practice,
and
is
impractical
on
the
international
web.
</li>
<li>
Lines
should
be
ended
with
<code>
CRLF
</code>.
This
makes
it
harder
to
produce
CSV
files
on
Unix-based
systems
where
the
usual
line
ending
is
<code>
LF
</code>.
</li>
<li>
The
header
line
is
optional;
a
<code>
header
</code>
parameter
on
the
media
type
indicates
whether
the
header
is
present
or
not.
</li>
<li>
Fields
may
be
escaped
by
wrapping
them
in
double
quotes;
any
double
quotes
within
the
field
must
be
escaped
with
two
double
quotes
(
<code>
""
</code>
).
</li>
</ul>
</section>
<section rel="bibo:Chapter" resource="#excel" typeof="bibo:Chapter" id="excel">
<h3 id="h3_excel" role="heading" aria-level="2">
<span class="secno">
A.2
</span>
Excel
</h3>
<p>
Excel
is
a
common
tool
for
both
creating
and
reading
CSV
documents,
and
therefore
the
CSV
that
it
produces
is
a
de
facto
standard.
</p>
<div class="note">
<div id="h_note_6" role="heading" aria-level="3" class="note-title">
<span>
Note
</span>
</div>
<p class="">
The
following
describes
the
behaviour
of
Microsoft
Excel
for
Mac
2011
with
an
English
locale.
Further
testing
is
needed
to
see
the
behaviour
of
Excel
in
other
situations.
</p>
</div>
<section id="saved-csv">
<h4 id="h4_saved-csv" role="heading" aria-level="3">
<span class="secno">
A.2.1
</span>
Saved
CSV
</h4>
<p>
Excel
generates
CSV
files
encoded
using
Windows-1252
with
<code>
LF
</code>
line
endings.
Characters
that
cannot
be
represented
within
Windows-1252
are
replaced
by
underscores.
Only
those
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
that
need
escaping
(eg
because
they
contain
commas
or
double
quotes)
are
escaped,
and
double
quotes
are
escaped
with
two
double
quotes.
</p>
<p>
Dates
and
numbers
are
formatted
as
displayed,
which
means
that
formatting
can
lead
to
information
being
lost
or
becoming
inconsistent.
</p>
</section>
<section id="opened-csv">
<h4 id="h4_opened-csv" role="heading" aria-level="3">
<span class="secno">
A.2.2
</span>
Opened
CSV
</h4>
<p>
When
opening
CSV
files,
Excel
interprets
CSV
files
saved
in
UTF-8
as
being
encoded
as
Windows-1252
(whether
or
not
a
<a href="http://en.wikipedia.org/wiki/Byte_order_mark">
<abbr title="Byte Order Mark">
BOM
</abbr>
</a>
is
present).
It
correctly
deals
with
double
quoted
<del class="diff-old">fields,
</del>
<ins class="diff-chg">cells,
</ins>
except
that
it
converts
line
breaks
within
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
into
spaces.
It
understands
<code>
CRLF
</code>
as
a
line
break.
It
detects
dates
(formatted
as
<code>
YYYY-MM-DD
</code>
)
and
formats
them
in
the
default
date
formatting
for
files.
</p>
</section>
<section id="imported-csv">
<h4 id="h4_imported-csv" role="heading" aria-level="3">
<span class="secno">
A.2.3
</span>
Imported
CSV
</h4>
<p>
Excel
provides
more
control
when
importing
CSV
files
into
Excel.
However,
it
does
not
properly
understand
UTF-8
(with
or
without
<abbr title="Byte Order Mark">
BOM
</abbr>
).
It
does
however
properly
understand
UTF-16
and
can
read
non-ASCII
characters
from
a
UTF-16-encoded
file.
</p>
<p>
A
particular
quirk
in
the
importing
of
CSV
is
that
if
a
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
contains
a
line
break,
the
final
double
quote
that
escapes
the
<del class="diff-old">field
</del>
<ins class="diff-chg">cell
</ins>
will
be
included
within
it.
</p>
</section>
<section id="copied-tabular-data">
<h4 id="h4_copied-tabular-data" role="heading" aria-level="3">
<span class="secno">
A.2.4
</span>
Copied
Tabular
Data
</h4>
<p>
When
tabular
data
is
copied
from
Excel,
it
is
copied
in
a
tab-delimited
format,
with
<code>
LF
</code>
line
breaks.
</p>
</section>
</section>
<section rel="bibo:Chapter" resource="#google" typeof="bibo:Chapter" id="google">
<h3 id="h3_google" role="heading" aria-level="2">
<span class="secno">
A.3
</span>
Google
Spreadsheets
</h3>
<section id="downloading-csv">
<h4 id="h4_downloading-csv" role="heading" aria-level="3">
<span class="secno">
A.3.1
</span>
Downloading
CSV
</h4>
<p>
Downloaded
CSV
files
are
encoded
in
UTF-8,
without
a
<a href="http://en.wikipedia.org/wiki/Byte_order_mark">
<abbr title="Byte Order Mark">
BOM
</abbr>
</a>,
and
with
<code>
LF
</code>
line
endings.
Dates
and
numbers
are
formatted
as
they
appear
within
the
spreadsheet.
</p>
</section>
<section id="importing-csv">
<h4 id="h4_importing-csv" role="heading" aria-level="3">
<span class="secno">
A.3.2
</span>
Importing
CSV
</h4>
<p>
CSV
files
can
be
imported
as
UTF-8
(with
or
without
<abbr title="Byte Order Mark">
BOM
</abbr>
).
<code>
CRLF
</code>
line
endings
are
correctly
recognised.
Dates
are
reformatted
to
the
default
date
format
on
load.
</p>
</section>
</section>
<section id="csv-files-in-a-tabular-data-package">
<h3 id="h3_csv-files-in-a-tabular-data-package" role="heading" aria-level="2">
<span class="secno">
A.4
</span>
CSV
Files
in
<del class="diff-old">the
Simple
</del>
<ins class="diff-chg">a
Tabular
</ins>
Data
<del class="diff-old">Format
</del>
<ins class="diff-chg">Package
</ins>
</h3>
<p>
<del class="diff-old">Ths
</del>
<a href="http://dataprotocols.org/tabular-data-package/#csv-files">
<del class="diff-old">Simple
</del>
<ins class="diff-chg">Tabular
</ins>
Data
<del class="diff-old">Format
</del>
<ins class="diff-chg">Packages
</ins>
</a>
<del class="diff-old">places
</del>
<ins class="diff-chg">place
</ins>
the
following
restrictions
on
CSV
files:
</p>
<blockquote>
<p>
As
a
starting
point,
CSV
files
included
in
a
<del class="diff-old">Simple
</del>
<ins class="diff-chg">Tabular
</ins>
Data
<del class="diff-old">Format
</del>
<ins class="diff-chg">Package
</ins>
package
must
conform
to
the
RFC
for
CSV
(4180
-
Common
Format
and
MIME
Type
for
Comma-Separated
Values
(CSV)
Files).
In
addition:
</p>
<ul>
<li>
File
names
<em title="MUST" class="rfc2119">
MUST
</em>
end
with
<code>.csv
</code>
</li>
<li>
Files
<em title="MUST" class="rfc2119">
MUST
</em>
be
encoded
as
UTF-8
</li>
<li>
<p>
Files
<em title="MUST" class="rfc2119">
MUST
</em>
have
a
single
header
row.
This
row
<em title="MUST" class="rfc2119">
MUST
</em>
be
the
first
row
in
the
file.
</p>
<ul>
<li>
Terminology:
each
column
in
the
CSV
file
is
termed
a
<em>
field
</em>
and
its
<code>
name
</code>
is
the
string
in
that
column
in
the
header
row.
</li>
<li>
The
<code>
name
</code>
<em title="MUST" class="rfc2119">
MUST
</em>
be
unique
amongst
fields
and
<em title="MUST" class="rfc2119">
MUST
</em>
contain
at
least
one
character
</li>
<li>
There
are
no
further
restrictions
on
the
form
of
the
<code>
name
</code>
but
it
is
<em title="RECOMMENDED" class="rfc2119">
RECOMMENDED
</em>
that
it
contain
only
alphanumeric
characters
together
with
“
.-_”
</li>
</ul>
</li>
<li>
Rows
in
the
file
<em title="MUST NOT" class="rfc2119">
MUST
NOT
</em>
contain
more
fields
than
are
in
the
header
row
(though
they
may
contain
less)
</li>
<li>
Each
file
<em title="MUST" class="rfc2119">
MUST
</em>
have
an
entry
in
the
<code>
resources
</code>
array
in
the
<code>
datapackage.json
</code>
file
</li>
<li>
The
resource
metadata
<em title="MUST" class="rfc2119">
MUST
</em>
include
a
<code>
schema
</code>
attribute
whose
value
<em title="MUST" class="rfc2119">
MUST
</em>
conform
to
the
JSON
Table
Schema
</li>
<li>
All
fields
in
the
CSV
files
<em title="MUST" class="rfc2119">
MUST
</em>
be
described
in
the
<code>
schema
</code>
</li>
</ul>
<p>
CSV
files
generated
by
different
applications
often
vary
in
their
syntax,
e.g.
use
of
quoting
characters,
delimiters,
etc.
To
encourage
conformance,
CSV
files
in
a
<del class="diff-old">Simple
</del>
<ins class="diff-chg">CSV
files
in
a
Tabular
</ins>
Data
<del class="diff-old">Format
</del>
<ins class="diff-chg">Package
</ins>
<em title="SHOULD" class="rfc2119">
SHOULD
</em>
</p>
<ul>
<li>
Use
“,”
as
field
delimiters
</li>
<li>
Use
“rn”
or
“n”
as
line
terminators
</li>
</ul>
<p>
If
a
CSV
file
does
not
follow
these
rules
then
its
specific
CSV
dialect
<em title="MUST" class="rfc2119">
MUST
</em>
be
documented.
The
resource
hash
for
the
resource
in
the
<code>
datapackage.json
</code>
descriptor
<em title="MUST" class="rfc2119">
MUST
</em>:
</p>
<ul>
<li>
Include
a
<code>
dialect
</code>
key
that
conforms
to
that
described
in
the
<a href="http://dataprotocols.org/csv-dialect/">
CSV
Dialect
Description
Format
</a>
</li>
</ul>
<p>
Applications
processing
the
CSV
file
<em title="SHOULD" class="rfc2119">
SHOULD
</em>
read
use
the
<code>
dialect
</code>
of
the
CSV
file
to
guide
parsing.
</p>
</blockquote>
</section>
<div class="issue">
<div id="h_issue_16" role="heading" aria-level="2" class="issue-title">
<span>
Issue
<del class="diff-old">11
</del>
<ins class="diff-chg">16
</ins>
</span>
</div>
<div class="">
<p>
More
details
of
behaviour
of
other
tools
should
go
here.
This
should
include
the
most
popular
CSV
parsing/generating
libraries
in
common
programming
languages.
Test
files
which
include
non-ASCII
characters,
double
quotes
and
line
breaks
within
<del class="diff-old">fields
</del>
<ins class="diff-chg">cells
</ins>
are:
</p>
<ul>
<li>
<a href="test-utf8.csv">
test-utf8.csv
</a>
</li>
<li>
<a href="test-utf8-bom.csv">
test-utf8-bom.csv
</a>
</li>
<li>
<a href="test-utf16.csv">
test-utf16.csv
</a>
</li>
<li>
<a href="test-utf16-bom.csv">
test-utf16-bom.csv
</a>
</li>
<li>
<a href="test.xlsx">
test.xslx
</a>
</li>
<li>
<a href="test.xls">
test.xsl
</a>
</li>
</ul>
</div>
</div>
</section>
<section rel="bibo:Chapter" resource="#references" typeof="bibo:Chapter" id="references" class="appendix">
<h2 id="h2_references" role="heading" aria-level="1">
<span class="secno">
B.
</span>
References
</h2>
<section rel="bibo:Chapter" resource="#normative-references" typeof="bibo:Chapter" id="normative-references">
<h3 id="h3_normative-references" role="heading" aria-level="2">
<span class="secno">
B.1
</span>
Normative
references
</h3>
<dl about="" class="bibliography">
<dt id="bib-RFC4180">
[RFC4180]
</dt>
<dd rel="dcterms:requires">
Y.
Shafranovich.
<a href="http://www.ietf.org/rfc/rfc4180.txt">
<cite>
Common
Format
and
MIME
Type
for
Comma-Separated
Values
(CSV)
Files
</cite>
</a>.
October
2005.
<del class="diff-old">Internet
RFC
3987.
</del>
<ins class="diff-chg">Informational.
</ins>
URL:
<a href="http://www.ietf.org/rfc/rfc4180.txt">
http://www.ietf.org/rfc/rfc4180.txt
</a>
</dd>
<dt id="bib-encoding">
[encoding]
</dt>
<dd rel="dcterms:requires">
Anne
van
Kesteren;
Joshua
Bell;
Addison
Phillips.
<a href="http://www.w3.org/TR/encoding/">
<cite>
Encoding
</cite>
</a>.
<del class="diff-old">28
January
</del>
<ins class="diff-chg">3
June
</ins>
2014.
W3C
<ins class="diff-new">Last
Call
</ins>
Working
Draft.
URL:
<a href="http://www.w3.org/TR/encoding/">
http://www.w3.org/TR/encoding/
</a>
</dd>
</dl>
</section>
<section rel="bibo:Chapter" resource="#informative-references" typeof="bibo:Chapter" id="informative-references">
<h3 id="h3_informative-references" role="heading" aria-level="2">
<span class="secno">
B.2
</span>
Informative
references
</h3>
<dl about="" class="bibliography">
<dt id="bib-CSV-METADATA">
<ins class="diff-new">[CSV-METADATA]
</ins></dt><dd rel="dcterms:references"><ins class="diff-new">
Rufus
Pollock;
Jeni
Tennison.
</ins><a href="http://w3c.github.io/csvw/metadata/"><cite><ins class="diff-new">
Metadata
Vocabulary
for
Tabular
Data
</ins></cite></a><ins class="diff-new">
Editor's
Draft.
URL:
</ins><a href="http://w3c.github.io/csvw/metadata/"><ins class="diff-new">
http://w3c.github.io/csvw/metadata/
</ins></a></dd>
<dt id="bib-EBNF-NOTATION">
[EBNF-NOTATION]
</dt>
<dd rel="dcterms:references">
Tim
Bray;
Jean
Paoli;
C.
M.
Sperberg-McQueen;
Eve
Maler;
François
Yergeau.
<a href="http://www.w3.org/TR/REC-xml/#sec-notation">
<cite>
EBNF
Notation
</cite>
</a>
26
November
2008.
W3C
Recommendation.
URL:
<a href="http://www.w3.org/TR/REC-xml/#sec-notation">
http://www.w3.org/TR/REC-xml/#sec-notation
</a>
</dd>
<dt id="bib-RFC7111">
<ins class="diff-new">[RFC7111]
</ins></dt><dd rel="dcterms:references"><ins class="diff-new">
M.
Hausenblas;
E.
Wilde;
J.
Tennison.
</ins><a href="http://tools.ietf.org/html/rfc7111"><cite><ins class="diff-new">
URI
Fragment
Identifiers
for
the
text/csv
Media
Type
</ins></cite></a>.<ins class="diff-new">
January
2014.
Internet
RFC
7111.
URL:
</ins><a href="http://www.ietf.org/rfc/rfc7111.txt"><ins class="diff-new">
http://www.ietf.org/rfc/rfc7111.txt
</ins>
</a>
</dd>
</dl>
</section>
</section>
</body>
</html>
