<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Content Security Policy Level 3</title>
  <link href="default.css" rel="stylesheet" type="text/css">
  <link href="https://www.w3.org/StyleSheets/TR/W3C-WD" rel="stylesheet" type="text/css">
  <meta content="Bikeshed 1.0.0" name="generator">
<style>
  ul.toc ul ul ul {
    margin: 0 0 0 2em;
  }
  ul.toc ul ul ul span.secno {
    margin-left: -9em;
  }
</style>
 </head>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Content Security Policy Level 3</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C First Public Working Draft, <time class="dt-updated" datetime="2015-01-19">19 January 2015</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://www.w3.org/TR/2015/WD-CSP-3-20150119/">http://www.w3.org/TR/2015/WD-CSP-3-20150119/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/CSP3/">http://www.w3.org/TR/CSP3/</a>
     <dt>Editor's Draft:
     <dd><a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
     <dt>Version History:
     <dd><a href="https://github.com/w3c/webappsec-csp/commits/master/index.src.html">https://github.com/w3c/webappsec-csp/commits/master/index.src.html</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BCSP%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[CSP] <i data-lt="">… message topic …</i></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
     <dt>Participate:
     <dd><span><a href="https://github.com/w3c/webappsec-csp/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-csp/issues">open issues</a>)</span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This document defines a mechanism by which web developers can control the

resources which a particular page can fetch or execute, as well as a number
of security-relevant policy decisions.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of
  its publication. Other documents may supersede this document. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the <a href="http://www.w3.org/TR/">W3C technical reports
  index at http://www.w3.org/TR/.</a></em> </p>
   <p> This document was published by the <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a> as a Working Draft. This document is intended to become a W3C Recommendation. </p>
   <p> The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5BCSP%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “CSP” in the subject,
	preferably like this:
	“[CSP] <em>…summary of comment…</em>” </p>
   <p> This document is a <strong>First Public Working Draft</strong>. </p>
   <p> Publication as a First Public Working Draft does not imply endorsement by the W3C
  Membership. This is a draft document and may be updated, replaced or
  obsoleted by other documents at any time. It is inappropriate to cite this
  document as other than work in progress. </p>
   <p> This document was produced by the <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li>
       <a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
       <ul class="toc">
        <li><a href="#example-basic"><span class="secno">1.1.1</span> <span class="content">Control Execution</span></a>
       </ul>
      <li><a href="#goals"><span class="secno">1.2</span> <span class="content">Goals</span></a>
      <li><a href="#changes-from-level-2"><span class="secno">1.3</span> <span class="content">Changes from Level 2</span></a>
      <li><a href="#open-questions"><span class="secno">1.4</span> <span class="content">Open Questions</span></a>
     </ul>
    <li>
     <a href="#framework"><span class="secno">2</span> <span class="content">Framework</span></a>
     <ul class="toc">
      <li>
       <a href="#framework-policy"><span class="secno">2.1</span> <span class="content">Policies</span></a>
       <ul class="toc">
        <li><a href="#parse-serialized-policy"><span class="secno">2.1.1</span> <span class="content"> Parse a <var>serialized CSP</var> as <var>disposition</var> </span></a>
        <li><a href="#parse-serialized-policy-list"><span class="secno">2.1.2</span> <span class="content"> Parse a serialized CSP <var>list</var> as <var>disposition</var> </span></a>
       </ul>
      <li>
       <a href="#framework-directives"><span class="secno">2.2</span> <span class="content">Directives</span></a>
       <ul class="toc">
        <li><a href="#framework-directive-source-list"><span class="secno">2.2.1</span> <span class="content">Source Lists</span></a>
       </ul>
      <li>
       <a href="#framework-violation"><span class="secno">2.3</span> <span class="content">Violations</span></a>
       <ul class="toc">
        <li><a href="#create-violation-for-global"><span class="secno">2.3.1</span> <span class="content"> Create a violation object for <var>global</var>, <var>policy</var>, and <var>directive</var> </span></a>
        <li><a href="#create-violation-for-request"><span class="secno">2.3.2</span> <span class="content"> Create a violation object for <var>request</var>, <var>policy</var>, and <var>directive</var> </span></a>
       </ul>
     </ul>
    <li>
     <a href="#policy-delivery"><span class="secno">3</span> <span class="content"> Policy Delivery </span></a>
     <ul class="toc">
      <li><a href="#csp-header"><span class="secno">3.1</span> <span class="content"> The <code>Content-Security-Policy</code> HTTP Response Header Field </span></a>
      <li><a href="#cspro-header"><span class="secno">3.2</span> <span class="content"> The <code>Content-Security-Policy-Report-Only</code> HTTP Response Header Field </span></a>
      <li><a href="#meta-element"><span class="secno">3.3</span> <span class="content"> The <code>&lt;meta></code> element </span></a>
     </ul>
    <li>
     <a href="#integrations"><span class="secno">4</span> <span class="content">Integrations</span></a>
     <ul class="toc">
      <li>
       <a href="#fetch-integration"><span class="secno">4.1</span> <span class="content"> Integration with Fetch </span></a>
       <ul class="toc">
        <li><a href="#set-response-csp-list"><span class="secno">4.1.1</span> <span class="content"> Set <var>response</var>’s <code>CSP list</code> </span></a>
        <li><a href="#report-for-request"><span class="secno">4.1.2</span> <span class="content"> Report Content Security Policy violations for <var>request</var> </span></a>
        <li><a href="#should-block-request"><span class="secno">4.1.3</span> <span class="content"> Should <var>request</var> be blocked by Content Security Policy? </span></a>
        <li><a href="#should-block-response"><span class="secno">4.1.4</span> <span class="content"> Should <var>response</var> to <var>request</var> be blocked by Content
    Security Policy? </span></a>
       </ul>
      <li>
       <a href="#html-integration"><span class="secno">4.2</span> <span class="content"> Integration with HTML </span></a>
       <ul class="toc">
        <li><a href="#initialize-document-csp"><span class="secno">4.2.1</span> <span class="content"> Initialize a <code>Document</code>'s <code>CSP list</code> </span></a>
        <li><a href="#initialize-global-object-csp"><span class="secno">4.2.2</span> <span class="content"> Initialize a global object’s <code>CSP list</code> </span></a>
        <li><a href="#should-block-inline"><span class="secno">4.2.3</span> <span class="content"> Should <var>element</var>’s inline <var>type</var> behavior be blocked by Content Security Policy? </span></a>
       </ul>
     </ul>
    <li>
     <a href="#reporting"><span class="secno">5</span> <span class="content"> Reporting </span></a>
     <ul class="toc">
      <li><a href="#violation-events"><span class="secno">5.1</span> <span class="content"> Violation DOM Events </span></a>
      <li><a href="#deprecated-serialize-violation"><span class="secno">5.2</span> <span class="content"> Obtain the deprecated serialization of <var>violation</var> </span></a>
      <li><a href="#report-violation"><span class="secno">5.3</span> <span class="content"> Report a <var>violation</var> </span></a>
     </ul>
    <li>
     <a href="#csp-directives"><span class="secno">6</span> <span class="content"> Content Security Policy Directives </span></a>
     <ul class="toc">
      <li>
       <a href="#directives-fetch"><span class="secno">6.1</span> <span class="content"> Fetch Directives </span></a>
       <ul class="toc">
        <li>
         <a href="#directive-child-src"><span class="secno">6.1.1</span> <span class="content"><code>child-src</code></span></a>
         <ul class="toc">
          <li><a href="#child-src-algorithms"><span class="secno">6.1.1.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-connect-src"><span class="secno">6.1.2</span> <span class="content"><code>connect-src</code></span></a>
         <ul class="toc">
          <li><a href="#connect-src-algorithms"><span class="secno">6.1.2.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-default-src"><span class="secno">6.1.3</span> <span class="content"><code>default-src</code></span></a>
         <ul class="toc">
          <li><a href="#default-src-algorithms"><span class="secno">6.1.3.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-font-src"><span class="secno">6.1.4</span> <span class="content"><code>font-src</code></span></a>
         <ul class="toc">
          <li><a href="#font-src-algorithms"><span class="secno">6.1.4.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-img-src"><span class="secno">6.1.5</span> <span class="content"><code>img-src</code></span></a>
         <ul class="toc">
          <li><a href="#img-src-algorithms"><span class="secno">6.1.5.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-manifest-src"><span class="secno">6.1.6</span> <span class="content"><code>manifest-src</code></span></a>
         <ul class="toc">
          <li><a href="#manifest-src-algorithms"><span class="secno">6.1.6.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-media-src"><span class="secno">6.1.7</span> <span class="content"><code>media-src</code></span></a>
         <ul class="toc">
          <li><a href="#media-src-algorithms"><span class="secno">6.1.7.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-object-src"><span class="secno">6.1.8</span> <span class="content"><code>object-src</code></span></a>
         <ul class="toc">
          <li><a href="#object-src-algorithms"><span class="secno">6.1.8.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-script-src"><span class="secno">6.1.9</span> <span class="content"><code>script-src</code></span></a>
         <ul class="toc">
          <li><a href="#script-src-algorithms"><span class="secno">6.1.9.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#directive-style-src"><span class="secno">6.1.10</span> <span class="content"><code>style-src</code></span></a>
         <ul class="toc">
          <li><a href="#style-src-algorithms"><span class="secno">6.1.10.1</span> <span class="content">Algorithms</span></a>
         </ul>
        <li>
         <a href="#fetch-directive-matching-url"><span class="secno">6.1.11</span> <span class="content">URL Matching Algorithms</span></a>
         <ul class="toc">
          <li><a href="#does-request-violate-policy"><span class="secno">6.1.11.1</span> <span class="content"> Does <var>request</var> violate <var>policy</var>? </span></a>
          <li><a href="#match-url-to-source-list"><span class="secno">6.1.11.2</span> <span class="content"> Does <var>url</var> match <var>source list</var>? </span></a>
          <li><a href="#match-url-to-source-expression"><span class="secno">6.1.11.3</span> <span class="content"> Does <var>url</var> match <var>expression</var> in <var>origin</var> with <var>redirect count</var>? </span></a>
          <li><a href="#effective-directive-for-a-request"><span class="secno">6.1.11.4</span> <span class="content"> Get the effective directive for <var>request</var> </span></a>
         </ul>
        <li>
         <a href="#fetch-directive-matching-element"><span class="secno">6.1.12</span> <span class="content">Element Matching Algorithms</span></a>
         <ul class="toc">
          <li><a href="#match-element-to-source-list"><span class="secno">6.1.12.1</span> <span class="content"> Does <var>element</var> match source <var>list</var>? </span></a>
         </ul>
       </ul>
      <li>
       <a href="#directives-reporting"><span class="secno">6.2</span> <span class="content"> Reporting Directives </span></a>
       <ul class="toc">
        <li><a href="#directive-report-uri"><span class="secno">6.2.1</span> <span class="content"><code>report-uri</code></span></a>
        <li><a href="#directive-report-to"><span class="secno">6.2.2</span> <span class="content"><code>report-to</code></span></a>
       </ul>
      <li><a href="#directives-elsewhere"><span class="secno">6.3</span> <span class="content"> Directives Defined in Other Documents </span></a>
     </ul>
    <li>
     <a href="#security-considerations"><span class="secno">7</span> <span class="content">Security Considerations</span></a>
     <ul class="toc">
      <li><a href="#security-nonces"><span class="secno">7.1</span> <span class="content">Nonce Reuse</span></a>
     </ul>
    <li>
     <a href="#authoring-considerations"><span class="secno">8</span> <span class="content">Authoring Considerations</span></a>
     <ul class="toc">
      <li><a href="#multiple-policies"><span class="secno">8.1</span> <span class="content"> The effect of multiple policies </span></a>
     </ul>
    <li>
     <a href="#implementation-considerations"><span class="secno">9</span> <span class="content">Implementation Considerations</span></a>
     <ul class="toc">
      <li><a href="#extensions"><span class="secno">9.1</span> <span class="content">Vendor-specific Extensions and Addons</span></a>
     </ul>
    <li>
     <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA Considerations</span></a>
     <ul class="toc">
      <li><a href="#iana-csp"><span class="secno">10.1</span> <span class="content"> Content-Security-Policy </span></a>
     </ul>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ul>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul>
  </div>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>This document defines Content Security Policy (CSP), a tool which developers
  can use to lock down their applications in various ways, mitigating the risk
  of content injection vulnerabilities such as cross-site scripting, and
  reducing the privilege with which their applications execute.</p>
    <p>CSP is not intended as a first line of defense against content injection
  vulnerabilities. Instead, CSP is best used as defense-in-depth. It reduces
  the harm that a malicious injection can cause, but it is not a replacement for
  careful input validation and output encoding.</p>
    <p>This document is an iteration on Content Security Policy Level 2, with the
  goal of more clearly explaining the interactions between CSP, HTML, and Fetch
  on the one hand, and providing clear hooks for modular extensibility on the
  other. Ideally, this will form a stable core upon which we can build new
  functionality.</p>
    <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
    <h4 class="heading settled" data-level="1.1.1" id="example-basic"><span class="secno">1.1.1. </span><span class="content">Control Execution</span><a class="self-link" href="#example-basic"></a></h4>
    <div class="example" id="example-1451d1f8">
     <a class="self-link" href="#example-1451d1f8"></a> MegaCorp Inc’s developers want to protect themselves against cross-site
    scripting attacks. They can mitigate the risk of script injection by
    ensuring that their trusted CDN is the only origin from which script can
    load and execute. Moreover, they wish to ensure that no plugins can
    execute in their pages' contexts. The following policy has that effect: 
<pre>Content-Security-Policy: script-src https://cdn.example.com/scripts/; object-src 'none'
</pre>
    </div>
    <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
    <p>Content Security Policy aims to do to a few related things:</p>
    <ol>
     <li data-md="">
      <p>Mitigate the risk of content-injection attacks by giving developers
  fairly granular control over</p>
      <ul>
       <li data-md="">
        <p>The resources which can be requested (and subsequently embedded or
  executed) on behalf of a specific <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> or <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code></p>
       <li data-md="">
        <p>The execution of inline script</p>
       <li data-md="">
        <p>Dynamic code execution (via <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a></code> and similar constructs)</p>
       <li data-md="">
        <p>The application of inline style</p>
      </ul>
     <li data-md="">
      <p>Mitigate the risk of attacks which require a resource to be embedded
  in a malicious context (the "Pixel Perfect" attack described in <a data-link-type="biblio" href="#biblio-timing">[TIMING]</a>, for example) by giving developers granular control over the
  origins which can embed a given resource.</p>
     <li data-md="">
      <p>Provide a policy framework which allows developers to reduce the privilege
  of their applications.</p>
     <li data-md="">
      <p>Provide a reporting mechanism which allows developers to detect flaws
  being exploited in the wild.</p>
    </ol>
    <h3 class="heading settled" data-level="1.3" id="changes-from-level-2"><span class="secno">1.3. </span><span class="content">Changes from Level 2</span><a class="self-link" href="#changes-from-level-2"></a></h3>
    <p>This document describes an evolution of the Content Security Policy Level 2
  specification <a data-link-type="biblio" href="#biblio-csp2">[CSP2]</a>. The following is a high-level overview of the changes:</p>
    <ol>
     <li data-md="">
      <p>The specification has been rewritten from the ground up in terms of the <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> specification, which should make it simpler to integrate CSP’s
  requirements and restrictions with other specifications (and with
  Service Workers in particular).</p>
     <li data-md="">
      <p>The <code>frame-src</code> directive, which was deprecated in CSP Level
  2, has been removed.</p>
     <li data-md="">
      <p>Insecure schemes in source expressions now match their secure variants.
  That is, <code>http:</code> is equivalent to <code>http: https:</code>, and <code>http://a.com</code> to <code>http://a.com https://a.com</code>.</p>
      <p>Likewise, <code>'self'</code> now matches <code>https</code> and <code>wss</code> variants of the page’s
  origin, even on pages whose scheme is <code>http</code>.</p>
     <li data-md="">
      <p>Violation reports generated from inline script or style will now report
  "<code>inline</code>" as the blocked resource. Likewise, blocked <code>eval()</code> execution
  will report "<code>eval</code>" as the blocked resource.</p>
     <li data-md="">
      <p>Directives with effects on a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> or <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code> itself (as opposed
  to the resources such a context can load) have moved out into a separate <a data-link-type="biblio" href="#biblio-csp-document">[CSP-DOCUMENT]</a> module. This includes <code>base-uri</code>, <code>form-action</code>, <code>frame-ancestors</code>, <code>plugin-types</code>, <code>sandbox</code>.</p>
     <li data-md="">
      <p>The <code>manifest-src</code> directive has been added.</p>
     <li data-md="">
      <p>The <code>report-uri</code> directive is deprecated in favor of the new <code>report-to</code> directive, which relies on <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a> as infrastructure.</p>
    </ol>
    <h3 class="heading settled" data-level="1.4" id="open-questions"><span class="secno">1.4. </span><span class="content">Open Questions</span><a class="self-link" href="#open-questions"></a></h3>
    <ol>
     <li data-md="">
      <p>Do we really want to remove <code>frame-src</code>? Though the threat model of
  workers and frames is similar, they have distinct capabilities. Perhaps
  it makes sense for folks to allow workers while disallowing frames, or
  vice-versa?</p>
     <li data-md="">
      <p>Can we enable <code>sandbox</code> inside <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code>? It’s not clear what threat we’re
  preventing by dropping support for it (and Chrome and Safari support it
  today).</p>
     <li data-md="">
      <p>Reporting:</p>
      <ol>
       <li data-md="">
        <p>Do we still need to strip values? I think we’ve removed much of the
  risk by using the original URL of a blocked resource; there shouldn’t
  be anything in the report JSON that script can’t gather on its own by
  walking the DOM.</p>
      </ol>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="framework-policy"><span class="secno">2.1. </span><span class="content">Policies</span><a class="self-link" href="#framework-policy"></a></h3>
    <p>A <dfn data-dfn-type="dfn" data-export="" data-local-lt="policies" id="policy">policy<a class="self-link" href="#policy"></a></dfn> defines a set of allowed and
  restricted behaviors, and may be applied to a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/browsers.html#dom-window">Window</a></code> or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a></code> as described in <a href="#initialize-global-object-csp">§4.2.2 Initialize a global object’s CSP list</a>.</p>
    <p>Each policy has an associated <dfn data-dfn-for="policy" data-dfn-type="dfn" data-noexport="" id="policy-directive-set">directive set<a class="self-link" href="#policy-directive-set"></a></dfn>, which
  is a set of <a data-link-type="dfn" href="#directives">directives</a> that define the policy’s implications when
  applied.</p>
    <p>Each policy has an associated <dfn data-dfn-for="policy" data-dfn-type="dfn" data-noexport="" id="policy-disposition">disposition<a class="self-link" href="#policy-disposition"></a></dfn>, which is
  either "<code>enforce</code>" or "<code>report</code>".</p>
    <p>A <dfn data-dfn-type="dfn" data-export="" id="serialized-csp">serialized CSP<a class="self-link" href="#serialized-csp"></a></dfn> is an ASCII string, consisting of a
  semicolon-delimited series of <a data-link-type="dfn" href="#serialized-directive">serialized directives</a>, adhering to the
  following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre><dfn data-dfn-type="grammar" data-export="" id="grammardef-serialized-policy">serialized-policy<a class="self-link" href="#grammardef-serialized-policy"></a></dfn> = <a data-link-type="grammar" href="#grammardef-serialized-directive">serialized-directive</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> ";" [ <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> <a data-link-type="grammar" href="#grammardef-serialized-directive">serialized-directive</a> ] )
                    ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">OWS</a> is defined in section 3.2.3 of RFC 7230
</pre>
    <h4 class="heading settled" data-algorithm="Parse a serialized CSP as disposition" data-dfn-type="dfn" data-level="2.1.1" data-lt="parse a serialized CSP" data-noexport="" id="parse-serialized-policy"><span class="secno">2.1.1. </span><span class="content"> Parse a <var>serialized CSP</var> as <var>disposition</var> </span><a class="self-link" href="#parse-serialized-policy"></a></h4>
    <p>Given a <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a> (<var>serialized CSP</var>), and a <a data-link-type="dfn" href="#policy-disposition">disposition</a> (<var>disposition</var>), this algorithm will return a <a data-link-type="dfn" href="#policy">policy</a> object. If the string cannot be parsed, the resulting <a data-link-type="dfn" href="#policy">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set">directive set</a> will be empty.</p>
    <ol>
     <li data-md="">
      <p>Let <var>policy</var> be a new <a data-link-type="dfn" href="#policy">policy</a> with an empty <a data-link-type="dfn" href="#policy-directive-set">directive set</a>, and a <a data-link-type="dfn" href="#policy-disposition">disposition</a> of <var>disposition</var>.</p>
     <li data-md="">
      <p>For each <var>token</var> returned by <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">strictly splitting</a> <var>serialized
  CSP</var> on the U+003B SEMICOLON character (<code>;</code>):</p>
      <ol>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a> from <var>token</var>.</p>
       <li data-md="">
        <p>If <var>token</var> is an empty string, skip the remaining substeps
  and continue to the next item.</p>
       <li data-md="">
        <p>Let <var>directive name</var> be the result of <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters">collecting a sequence of
  characters</a> from <var>token</var> which are not <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#space-characters">space
  characters</a>.</p>
       <li data-md="">
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set">directive set</a> contains a <a data-link-type="dfn" href="#directives">directive</a> whose <a data-link-type="dfn" href="#directive-name">name</a> is <var>directive
  name</var>, skip the remaining substeps and continue to the next item.</p>
        <p>The user agent SHOULD notify developers that a directive was ignored.
  A console warning might be appropriate, for example.</p>
       <li data-md="">
        <p>Let <var>directive value</var> be the result of <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces">splitting <var>token</var> on
  spaces</a>.</p>
       <li data-md="">
        <p>Let <var>directive</var> be a new <a data-link-type="dfn" href="#directives">directive</a> whose <a data-link-type="dfn" href="#directive-name">name</a> is <var>directive name</var>, and <a data-link-type="dfn" href="#directive-value">value</a> is <var>directive value</var>.</p>
       <li data-md="">
        <p>Add <var>directive</var> to <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set">directive set</a>.</p>
      </ol>
     <li data-md="">
      <p>Return <var>policy</var>.</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Parse a serialized CSP list as disposition" data-level="2.1.2" id="parse-serialized-policy-list"><span class="secno">2.1.2. </span><span class="content"> Parse a serialized CSP <var>list</var> as <var>disposition</var> </span><a class="self-link" href="#parse-serialized-policy-list"></a></h4>
    <p>Given a string (<var>list</var>) and a <a data-link-type="dfn" href="#policy-disposition">disposition</a> (<var>disposition</var>)
  which contains a comma-delimited series of <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a> strings, the
  following algorithm will return a list of <a data-link-type="dfn" href="#policy">policies</a>:</p>
    <ol>
     <li data-md="">
      <p>Let <var>policies</var> be an empty list.</p>
     <li data-md="">
      <p>For each <var>token</var> returned by <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-commas">splitting <var>list</var> on commas</a>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>policy</var> be the result of executing <a href="#parse-serialized-policy">§2.1.1 Parse a serialized CSP as disposition</a> on <var>token</var> with <var>disposition</var>.</p>
       <li data-md="">
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set">directive set</a> is empty, skip the
  remaining substeps, and continue to the next item.</p>
       <li data-md="">
        <p>Add <var>policy</var> to <var>policies</var>.</p>
      </ol>
     <li data-md="">
      <p>Return <var>policies</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="2.2" id="framework-directives"><span class="secno">2.2. </span><span class="content">Directives</span><a class="self-link" href="#framework-directives"></a></h3>
    <p><a data-link-type="dfn" href="#policy">Policies</a> contain a set of <dfn data-dfn-type="dfn" data-noexport="" id="directives">directives<a class="self-link" href="#directives"></a></dfn>, each of which controls
  a specific behavior. The directives defined in this document are described in
  detail in <a href="#csp-directives">§6 Content Security Policy Directives</a>.</p>
    <p>Each <a data-link-type="dfn" href="#directives">directive</a> is a <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-name">name<a class="self-link" href="#directive-name"></a></dfn> / <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-value">value<a class="self-link" href="#directive-value"></a></dfn> pair. The <a data-link-type="dfn" href="#directive-name">name</a> is a
  non-empty string, and the <a data-link-type="dfn" href="#directive-value">value</a> is a set of non-empty strings. The <a data-link-type="dfn" href="#directive-value">value</a> set MAY be empty.</p>
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="serialized-directive">serialized directive<a class="self-link" href="#serialized-directive"></a></dfn> is an ASCII string, consisting of one or more
  whitespace-delimited tokens, and adhering to the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre><dfn data-dfn-type="grammar" data-export="" id="grammardef-serialized-directive">serialized-directive<a class="self-link" href="#grammardef-serialized-directive"></a></dfn> = <a data-link-type="grammar" href="#grammardef-directive-name">directive-name</a> [ <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="#grammardef-directive-value">directive-value</a> ]
<dfn data-dfn-type="grammar" data-export="" id="grammardef-directive-name">directive-name<a class="self-link" href="#grammardef-directive-name"></a></dfn>       = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-" )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-directive-value">directive-value<a class="self-link" href="#grammardef-directive-value"></a></dfn>      = *( %x09 / %x20-%x2B / %x2D-%x3A / %x3C-%7E )
                       ; Directive values may contain whitespace and <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">VCHAR</a> characters,
                       ; excluding ";" and ","

; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> is defined in section 3.2.3 of RFC7230. <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a>, <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a>, and
; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">VCHAR</a> are defined in Appendix B.1 of RFC 5234.
</pre>
    <p><a data-link-type="dfn" href="#directives">Directives</a> have five associated algorithms:</p>
    <ol>
     <li data-md="">
      <p>A <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-pre-request-check">pre-request check<a class="self-link" href="#directive-pre-request-check"></a></dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> and a <a data-link-type="dfn" href="#policy">policy</a> as an argument, and is executed during <a href="#should-block-request">§4.1.3 Should request be blocked by Content Security Policy?</a>. This algorithm returns "<code>Allowed</code>" unless
  otherwise specified.</p>
     <li data-md="">
      <p>A <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-post-request-check">post-request check<a class="self-link" href="#directive-post-request-check"></a></dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>, and a <a data-link-type="dfn" href="#policy">policy</a> as arguments, and
  is executed during <a href="#should-block-response">§4.1.4 Should response to request be blocked by Content
    Security Policy?</a>. This algorithm returns
  "<code>Allowed</code>" unless otherwise specified.</p>
     <li data-md="">
      <p>A <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-response-check">response check<a class="self-link" href="#directive-response-check"></a></dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>, and a <a data-link-type="dfn" href="#policy">policy</a> as arguments, and
  is executed during <a href="#should-block-response">§4.1.4 Should response to request be blocked by Content
    Security Policy?</a>. This algorithm returns
  "<code>Allowed</code>" unless otherwise specified.</p>
     <li data-md="">
      <p>An <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-inline-check">inline check<a class="self-link" href="#directive-inline-check"></a></dfn>, which takes an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> and
  a type string as arguments, and is executed during <a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a>. This algorithm returns "<code>Allowed</code>" unless
  otherwise specified.</p>
     <li data-md="">
      <p>An <dfn data-dfn-for="directive" data-dfn-type="dfn" data-noexport="" id="directive-initialization">initialization<a class="self-link" href="#directive-initialization"></a></dfn>, which takes a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> or <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>, and a <a data-link-type="dfn" href="#policy">policy</a> as
  arguments. This algorithm is executed during <a href="#initialize-document-csp">§4.2.1 Initialize a Document's CSP list</a>,
  and has no effect unless otherwise specified.</p>
    </ol>
    <h4 class="heading settled" data-level="2.2.1" id="framework-directive-source-list"><span class="secno">2.2.1. </span><span class="content">Source Lists</span><a class="self-link" href="#framework-directive-source-list"></a></h4>
    <p>Many <a data-link-type="dfn" href="#directives">directives</a>' <a data-link-type="dfn" href="#directive-value">values</a> consist of <dfn data-dfn-type="dfn" data-noexport="" id="source-lists">source lists<a class="self-link" href="#source-lists"></a></dfn>: sets
  of tokens which identify content that can be fetched and potentially embedded
  or executed. These tokens represent one of the following types of <dfn data-dfn-type="dfn" data-noexport="" id="source-expression">source
  expression<a class="self-link" href="#source-expression"></a></dfn>:</p>
    <ol>
     <li data-md="">
      <p>Keywords such as <a data-link-type="grammar" href="#grammardef-none"><code>'none'</code></a> and <a data-link-type="grammar" href="#grammardef-self"><code>'self'</code></a> (which match nothing and the current
  URL’s origin, respectively)</p>
     <li data-md="">
      <p>Serialized URLs such as <code>https://example.com/path/to/file.js</code> (which matches a specific file) or <code>https://example.com/</code> (which matches everything on that origin)</p>
     <li data-md="">
      <p>Schemes such as <code>https:</code> (which matches any resource having
  the specified scheme)</p>
     <li data-md="">
      <p>Hosts such as <code>example.com</code> (which matches any resource on
  the host, regardless of scheme) or <code>*.example.com</code> (which
  matches any resource on the host or any of its subdomains (and any of
  its subdomains' subdomains, and so on))</p>
     <li data-md="">
      <p>Nonces such as <code>'nonce-qwertyu12345'</code> (which can match specific
  elements on a page)</p>
     <li data-md="">
      <p>Digests such as <code>'sha256-abcd...'</code> (which can match specific
  elements on a page)</p>
    </ol>
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="serialized-source-list">serialized source list<a class="self-link" href="#serialized-source-list"></a></dfn> is an ASCII string, consisting of a
  space-delimited series of <a data-link-type="dfn" href="#source-expression">source expressions</a>, adhering to the
  following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre><dfn data-dfn-type="grammar" data-export="" id="grammardef-serialized-source-list">serialized-source-list<a class="self-link" href="#grammardef-serialized-source-list"></a></dfn> = ( <a data-link-type="grammar" href="#grammardef-source-expression">source-expression</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="#grammardef-source-expression">source-expression</a> ) ) / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-none">'none'<a class="self-link" href="#grammardef-none"></a></dfn>"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-source-expression">source-expression<a class="self-link" href="#grammardef-source-expression"></a></dfn>      = <a data-link-type="grammar" href="#grammardef-scheme-source">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source">host-source</a> / <a data-link-type="grammar" href="#grammardef-keyword-source">keyword-source</a>
                         / <a data-link-type="grammar" href="#grammardef-nonce-source">nonce-source</a> / <a data-link-type="grammar" href="#grammardef-hash-source">hash-source</a>

; Schemes:
<dfn data-dfn-type="grammar" data-export="" id="grammardef-scheme-source">scheme-source<a class="self-link" href="#grammardef-scheme-source"></a></dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a> ":"
                ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a> is defined in section 3.1 of RFC 3986.

; Hosts: "example.com" / "*.example.com" / "https://*.example.com:12/path/to/file.js"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-host-source">host-source<a class="self-link" href="#grammardef-host-source"></a></dfn> = [ <a data-link-type="grammar" href="#grammardef-scheme-part">scheme-part</a> "://" ] <a data-link-type="grammar" href="#grammardef-host-part">host-part</a> [ <a data-link-type="grammar" href="#grammardef-port-part">port-part</a> ] [ <a data-link-type="grammar" href="#grammardef-path-part">path-part</a> ]
<dfn data-dfn-type="grammar" data-export="" id="grammardef-scheme-part">scheme-part<a class="self-link" href="#grammardef-scheme-part"></a></dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a>
<dfn data-dfn-type="grammar" data-export="" id="grammardef-host-part">host-part<a class="self-link" href="#grammardef-host-part"></a></dfn>   = "*" / [ "*." ] 1*<a data-link-type="grammar" href="#grammardef-host-char">host-char</a> *( "." 1*<a data-link-type="grammar" href="#grammardef-host-char">host-char</a> )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-host-char">host-char<a class="self-link" href="#grammardef-host-char"></a></dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "-"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-port-part">port-part<a class="self-link" href="#grammardef-port-part"></a></dfn>   = ":" ( 1*<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "*" )
<dfn data-dfn-type="grammar" data-export="" id="grammardef-path-part">path-part<a class="self-link" href="#grammardef-path-part"></a></dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a>
              ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a> is defined in section 3.3 of RFC 3986.
   
; Keywords:
<dfn data-dfn-type="grammar" data-export="" id="grammardef-keyword-source">keyword-source<a class="self-link" href="#grammardef-keyword-source"></a></dfn> = "<dfn data-dfn-type="grammar" data-export="" id="grammardef-self">'self'<a class="self-link" href="#grammardef-self"></a></dfn>" / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-unsafe-inline">'unsafe-inline'<a class="self-link" href="#grammardef-unsafe-inline"></a></dfn>" / "<dfn data-dfn-type="grammar" data-export="" id="grammardef-unsafe-eval">'unsafe-eval'<a class="self-link" href="#grammardef-unsafe-eval"></a></dfn>" 

; Nonces: 'nonce-[nonce goes here]'
<dfn data-dfn-type="grammar" data-export="" id="grammardef-nonce-source">nonce-source<a class="self-link" href="#grammardef-nonce-source"></a></dfn>  = "'nonce-" <a data-link-type="grammar" href="#grammardef-base64-value">base64-value</a> "'"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-base64-value">base64-value<a class="self-link" href="#grammardef-base64-value"></a></dfn>  = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">DIGIT</a> / "+" / "/" / "-" / "_" )*2( "=" ) 

; Digests: 'sha256-[digest goes here]'
<dfn data-dfn-type="grammar" data-export="" id="grammardef-hash-source">hash-source<a class="self-link" href="#grammardef-hash-source"></a></dfn>    = "'" <a data-link-type="grammar" href="#grammardef-hash-algorithm">hash-algorithm</a> "-" <a data-link-type="grammar" href="#grammardef-base64-value">base64-value</a> "'"
<dfn data-dfn-type="grammar" data-export="" id="grammardef-hash-algorithm">hash-algorithm<a class="self-link" href="#grammardef-hash-algorithm"></a></dfn> = "sha256" / "sha384" / "sha512"
</pre>
    <p>The <a data-link-type="grammar" href="#grammardef-host-char">host-char</a> production intentionally contains only ASCII
  characters; internationalized domain names cannot be entered directly as part
  of a <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a>, but instead MUST be Punycode-encoded <a data-link-type="biblio" href="#biblio-rfc3492">[RFC3492]</a>. For example, the domain <code>üüüüüü.de</code> MUST be represented as <code>xn--tdaaaaaa.de</code>.</p>
    <p class="note" role="note">Note: Though IP address do match the grammar above, only <code>127.0.0.1</code> will actually match a URL when used in a source
  expression (see <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> for details). The security
  properties of IP addresses are suspect, and authors ought to prefer hostnames
  whenever possible.</p>
    <p>A <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> <dfn data-dfn-type="dfn" data-noexport="" id="matches-a-source-list">matches a source list<a class="self-link" href="#matches-a-source-list"></a></dfn> if the algorithm in <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> returns <code>Matches</code>.</p>
    <h3 class="heading settled" data-level="2.3" id="framework-violation"><span class="secno">2.3. </span><span class="content">Violations</span><a class="self-link" href="#framework-violation"></a></h3>
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="violation">violation<a class="self-link" href="#violation"></a></dfn> represents an action or resource which goes against the <a data-link-type="dfn" href="#policy">policies</a> associated with a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-global-object">global object<a class="self-link" href="#violation-global-object"></a></dfn>, which
  is the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> whose <a data-link-type="dfn" href="#policy">policy</a> has been violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-url">url<a class="self-link" href="#violation-url"></a></dfn> which is its <a data-link-type="dfn" href="#violation-global-object">global object</a>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code>.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-status">status<a class="self-link" href="#violation-status"></a></dfn> which is a
  non-negative integer representing the HTTP status code of the resource for
  which the global object was instantiated.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-resource">resource<a class="self-link" href="#violation-resource"></a></dfn>, which is
  either <code>null</code>, "<code>inline</code>", "<code>eval</code>", or a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code>. It represents the resource
  which violated the policy.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-referrer">referrer<a class="self-link" href="#violation-referrer"></a></dfn>, which is either <code>null</code>, or a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code>. It represents the referrer of the resource whose policy
  was violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-policy">policy<a class="self-link" href="#violation-policy"></a></dfn>, which is the <a data-link-type="dfn" href="#policy">policy</a> that has been violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has an <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-effective-directive">effective directive<a class="self-link" href="#violation-effective-directive"></a></dfn> which is a non-empty string representing the <a data-link-type="dfn" href="#directives">directive</a> whose
  enforcement caused the violation.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-source-file">source file<a class="self-link" href="#violation-source-file"></a></dfn>, which is
  either <code>null</code> or a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code>.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-line-number">line number<a class="self-link" href="#violation-line-number"></a></dfn>, which is
  a non-negative integer.</p>
    <p>Each <a data-link-type="dfn" href="#violation">violation</a> has a <dfn data-dfn-for="violation" data-dfn-type="dfn" data-noexport="" id="violation-column-number">column number<a class="self-link" href="#violation-column-number"></a></dfn>, which
  is a non-negative integer.</p>
    <h4 class="heading settled" data-algorithm="Create a violation object for global, policy, and directive" data-level="2.3.1" id="create-violation-for-global"><span class="secno">2.3.1. </span><span class="content"> Create a violation object for <var>global</var>, <var>policy</var>, and <var>directive</var> </span><a class="self-link" href="#create-violation-for-global"></a></h4>
    <p>Given a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> (<var>global</var>), a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>), and a
  string (<var>directive</var>), the following algorithm creates a new <a data-link-type="dfn" href="#violation">violation</a> object, and populates it with an initial set of data:</p>
    <ol>
     <li data-md="">
      <p>Let <var>violation</var> be a new <a data-link-type="dfn" href="#violation">violation</a> whose <a data-link-type="dfn" href="#violation-global-object">global
  object</a> is <var>global</var>, <a data-link-type="dfn" href="#violation-policy">policy</a> is <var>policy</var>, <a data-link-type="dfn" href="#violation-effective-directive">effective directive</a> is <var>directive</var>, and <a data-link-type="dfn" href="#violation-resource">resource</a> is <code>null</code>.</p>
     <li data-md="">
      <p>If the user agent is currently executing script, and can extract a source
  file’s URL, line number, and column number from the <var>global</var>, set <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file">source file</a>, <a data-link-type="dfn" href="#violation-line-number">line
  number</a>, and <a data-link-type="dfn" href="#violation-column-number">column number</a> accordingly.</p>
      <p class="issue" id="issue-f447ede5"><a class="self-link" href="#issue-f447ede5"></a> Is this kind of thing specified anywhere? I didn’t see anything
  that looked useful in <a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a>.</p>
     <li data-md="">
      <p>If <var>global</var> is a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/browsers.html#dom-window">Window</a></code> object, set <var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer">referrer</a> to <var>global</var>’s <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/browsers.html#dom-document-2">document</a></code>'s <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#dom-document-referrer">referrer</a></code>.</p>
     <li data-md="">
      <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-status">status</a> to the HTTP status code
  for the resource associated with <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object">global
  object</a>.</p>
      <p class="issue" id="issue-99576800"><a class="self-link" href="#issue-99576800"></a> How, exactly, do we get the status code? We don’t actually store it
  anywhere.</p>
     <li data-md="">
      <p>Return <var>violation</var>.</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Create a violation object for request, policy, and directive" data-level="2.3.2" id="create-violation-for-request"><span class="secno">2.3.2. </span><span class="content"> Create a violation object for <var>request</var>, <var>policy</var>, and <var>directive</var> </span><a class="self-link" href="#create-violation-for-request"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>), and a string
  (<var>directive</var>), the following algorithm creates a new <a data-link-type="dfn" href="#violation">violation</a> object,
  and populates it with an initial set of data:</p>
    <ol>
     <li data-md="">
      <p>Let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§2.3.1 Create a violation object for global, policy, and directive</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-global-object">global object</a>, <var>policy</var>, and <var>directive</var>.</p>
     <li data-md="">
      <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource">resource</a> to <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a>.</p>
      <p class="note" role="note">Note: We use <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a>, and <em>not</em> its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url">current url</a>, as the latter might contain information
  about redirect targets to which the page MUST NOT be given access.</p>
     <li data-md="">
      <p>Return <var>violation</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="policy-delivery"><span class="secno">3. </span><span class="content"> Policy Delivery </span><a class="self-link" href="#policy-delivery"></a></h2>
    <p>A server MAY declare a <a data-link-type="dfn" href="#policy">policy</a> for a particular <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource
  representation</a> via an HTTP response header field whose value is a <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a>. This mechanism is defined in detail in <a href="#csp-header">§3.1 The Content-Security-Policy HTTP Response Header Field</a> and <a href="#cspro-header">§3.2 The Content-Security-Policy-Report-Only HTTP Response Header Field</a>, and the integration with Fetch
  and HTML is described in <a href="#fetch-integration">§4.1 Integration with Fetch</a> and <a href="#html-integration">§4.2 Integration with HTML</a>.</p>
    <p>A <a data-link-type="dfn" href="#policy">policy</a> may also be declared inline in an HTML document via a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element’s <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code> attribute, as described in <a href="#meta-element">§3.3 The &lt;meta> element</a>.</p>
    <h3 class="heading settled" data-level="3.1" id="csp-header"><span class="secno">3.1. </span><span class="content"> The <code>Content-Security-Policy</code> HTTP Response Header Field </span><a class="self-link" href="#csp-header"></a></h3>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="content-security-policy"><code>Content-Security-Policy</code><a class="self-link" href="#content-security-policy"></a></dfn> HTTP response header field
  is the preferred mechanism for delivering a policy from a server to a client.
  The header’s value is represented by the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre>Content-Security-Policy = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy">serialized-policy</a>
</pre>
    <div class="example" id="example-30ac7d45">
     <a class="self-link" href="#example-30ac7d45"></a> 
<pre><a data-link-type="dfn" href="#content-security-policy">Content-Security-Policy</a>: script-src 'self';
                         report-to csp-reporting-endpoint
</pre>
    </div>
    <p>A server MAY send different <code>Content-Security-Policy</code> header field
  values with different <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">representations</a> of the same resource.</p>
    <p>A server SHOULD NOT send more than one HTTP response header field named
  "<code>Content-Security-Policy</code>" with a given <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource
  representation</a>.</p>
    <p>When the user agent receives a <code>Content-Security-Policy</code> header field, it
  MUST <a data-link-type="dfn" href="#parse-serialized-policy">parse</a> and <a data-link-type="dfn" href="#enforced">enforce</a> each <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a> it contains as described in <a href="#fetch-integration">§4.1 Integration with Fetch</a>, <a href="#html-integration">§4.2 Integration with HTML</a>.</p>
    <h3 class="heading settled" data-level="3.2" id="cspro-header"><span class="secno">3.2. </span><span class="content"> The <code>Content-Security-Policy-Report-Only</code> HTTP Response Header Field </span><a class="self-link" href="#cspro-header"></a></h3>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="content-security-policy-report-only"><code>Content-Security-Policy-Report-Only</code><a class="self-link" href="#content-security-policy-report-only"></a></dfn> HTTP response
  header field allows web developers to experiment with policies by monitoring
  (but not enforcing) their effects. The header’s value is represented by the
  following ABNF <a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a>:</p>
<pre>Content-Security-Policy-Report-Only = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy">serialized-policy</a>
</pre>
    <p>This header field allows developers to piece together their security policy in
  an iterative fashion, deploying a report-only policy based on their best
  estimate of how their site behaves, watching for violation reports, and then
  moving to an enforced policy once they’ve gained confidence in that behavior.</p>
    <div class="example" id="example-d1b5cb79">
     <a class="self-link" href="#example-d1b5cb79"></a> 
<pre><a data-link-type="dfn" href="#content-security-policy-report-only">Content-Security-Policy-Report-Only</a>: script-src 'self';
                                     report-to csp-reporting-endpoint
</pre>
    </div>
    <p>A server MAY send different <code>Content-Security-Policy-Report-Only</code> header field values with different <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">representations</a> of the same
  resource.</p>
    <p>A server SHOULD NOT send more than one HTTP response header field named
  "<code>Content-Security-Policy-Report-Only</code>" with a given <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3">resource
  representation</a>.</p>
    <p>When the user agent receives a <code>Content-Security-Policy-Report-Only</code> header
  field, it MUST <a data-link-type="dfn" href="#parse-serialized-policy">parse</a> and <a data-link-type="dfn" href="#monitored">monitor</a> each <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a> it contains as described in <a href="#fetch-integration">§4.1 Integration with Fetch</a> and <a href="#html-integration">§4.2 Integration with HTML</a>.</p>
    <p class="note" role="note">Note: The <a data-link-type="dfn" href="#content-security-policy-report-only"><code>Content-Security-Policy-Report-Only</code></a> header is <strong>not</strong> supported inside a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element.</p>
    <h3 class="heading settled" data-level="3.3" id="meta-element"><span class="secno">3.3. </span><span class="content"> The <code>&lt;meta></code> element </span><a class="self-link" href="#meta-element"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> may deliver a policy via one or more HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> elements
  whose <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code> attributes are an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive
  match</a> for the string "<code>Content-Security-Policy</code>". For example:</p>
    <div class="example" id="example-cff5e786">
     <a class="self-link" href="#example-cff5e786"></a> 
<pre>&lt;meta http-equiv="Content-Security-Policy" content="script-src 'self'">
</pre>
    </div>
    <p>Implementation details can be found in HTML’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy"><code>Content-Security-Policy</code> <code>http-equiv</code> processing instructions</a> <a data-link-type="biblio" href="#biblio-html">[HTML]</a>.</p>
    <p class="note" role="note">Note: The <a data-link-type="dfn" href="#content-security-policy-report-only"><code>Content-Security-Policy-Report-Only</code></a> header is <em>not</em> supported inside a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element. Neither are the <code>report-uri</code>, <code>frame-ancestors</code>, and <code>sandbox</code> directives.</p>
    <p class="issue" id="issue-6521ca1c"><a class="self-link" href="#issue-6521ca1c"></a> Why <code>sandbox</code>? Can we loosen that?</p>
    <p>Authors are <em>strongly encouraged</em> to place <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> elements as early
  in the document as possible, because policies in <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> elements are not
  applied to content which precedes them. In particular, note that resources
  fetched or prefetched using the <code>Link</code> HTTP response header
  field, and resources fetched or prefetched using <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> elements which precede a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code>-delivered policy will not be blocked.</p>
    <p class="note" role="note">Note: A policy specified via a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element will be enforced along with
  any other policies active for the protected resource, regardless
  of where they’re specified. The general impact of enforcing multiple
  policies is described in <a href="#multiple-policies">§8.1 The effect of multiple policies</a>.</p>
    <p class="note" role="note">Note: Modifications to the <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a></code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element
  after the element has been parsed will be ignored.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="integrations"><span class="secno">4. </span><span class="content">Integrations</span><a class="self-link" href="#integrations"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>This document defines a set of algorithms which are used in other
  specifications in order to implement the functionality. These
  integrations are outlined here for clarity, but those external
  documents are the normative references which ought to be consulted for
  detailed information.</p>
    <h3 class="heading settled" data-level="4.1" id="fetch-integration"><span class="secno">4.1. </span><span class="content"> Integration with Fetch </span><a class="self-link" href="#fetch-integration"></a></h3>
    <p>A number of <a data-link-type="dfn" href="#directives">directives</a> control resource loading in one way or
  another. This specification provides algorithms which allow Fetch to make
  decisions about whether or not a particular <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> should be blocked
  or allowed, and about whether a particular <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> should be replaced
  with a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error">network error</a>.</p>
    <ol>
     <li data-md="">
      <p><a href="#should-block-request">§4.1.3 Should request be blocked by Content Security Policy?</a> is called as part of step #4 of its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch">Main
  Fetch</a> algorithm.</p>
     <li data-md="">
      <p><a href="#should-block-response">§4.1.4 Should response to request be blocked by Content
    Security Policy?</a> is called as part of step #12 of its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#main-fetch">Main
  Fetch</a> algorithm.</p>
    </ol>
    <p>A <a data-link-type="dfn" href="#policy">policy</a> is generally enforced upon a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>, but the
  user agent needs to <a data-link-type="dfn" href="#parse-serialized-policy">parse</a> any policy
  delivered via an HTTP response header field before any <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> is created in order to handle directives that require knowledge of a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>’s details. To that end:</p>
    <ol>
     <li data-md="">
      <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> has an associated <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> which
  contains any policy objects delivered in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>.</p>
     <li data-md="">
      <p><a href="#set-response-csp-list">§4.1.1 Set response’s CSP list</a> is called in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-fetch">HTTP fetch</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-network-fetch">HTTP-network fetch</a> algorithms.</p>
      <p class="note" role="note">Note: These two calls should ensure that a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> is set, regardless of how the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> is created. If we hit the network (via <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-network-fetch">HTTP-network
  fetch</a>, then we parse the policy before we handle the <code>Set-Cookie</code> header. If we get a response from a Service Worker (via <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-fetch">HTTP fetch</a>,
  we’ll process its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> before handing the
  response back to our caller.</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Set response’s CSP list" data-level="4.1.1" id="set-response-csp-list"><span class="secno">4.1.1. </span><span class="content"> Set <var>response</var>’s <code>CSP list</code> </span><a class="self-link" href="#set-response-csp-list"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), this algorithm evaluates its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> for <a data-link-type="dfn" href="#serialized-csp">serialized CSP</a> values, and
  populates its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> accordingly:</p>
    <ol>
     <li data-md="">
      <p>Set <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a> to the
  empty list.</p>
     <li data-md="">
      <p>Let <var>policies</var> be the result of executing <a href="#parse-serialized-policy-list">§2.1.2 Parse a serialized CSP list as disposition</a> on the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-parse">parsing</a> <code>Content-Security-Policy</code> in <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>, with a disposition
  of "<code>enforce</code>".</p>
     <li data-md="">
      <p>Append to <var>policies</var> the result of executing <a href="#parse-serialized-policy-list">§2.1.2 Parse a serialized CSP list as disposition</a> on the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-parse">parsing</a> <code>Content-Security-Policy-Report-Only</code> in <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>, with a disposition of "<code>report</code>".</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>policies</var>:</p>
      <ol>
       <li data-md="">
        <p>Insert <var>policy</var> into <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a>.</p>
      </ol>
    </ol>
    <h4 class="heading settled" data-algorithm="Report Content Security Policy violations for request" data-level="4.1.2" id="report-for-request"><span class="secno">4.1.2. </span><span class="content"> Report Content Security Policy violations for <var>request</var> </span><a class="self-link" href="#report-for-request"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), this algorithm reports violations based
  on <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s "report only" policies.</p>
    <ol>
     <li data-md="">
      <p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>.</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>CSP list</var>:</p>
      <ol>
       <li data-md="">
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition">disposition</a> is "<code>enforce</code>",
  then skip to the next <var>policy</var>.</p>
       <li data-md="">
        <p>Let <var>violates</var> be the result of executing <a href="#does-request-violate-policy">§6.1.11.1 Does request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>
       <li data-md="">
        <p>If <var>violates</var> is not "<code>Does Not Violate</code>", then execute <a href="#report-violation">§5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§2.3.2 Create a violation object for request, policy, and directive</a> on <var>request</var>, <var>policy</var>, and <var>violates</var>.</p>
      </ol>
    </ol>
    <h4 class="heading settled" data-algorithm="Should request be blocked by Content Security Policy?" data-level="4.1.3" id="should-block-request"><span class="secno">4.1.3. </span><span class="content"> Should <var>request</var> be blocked by Content Security Policy? </span><a class="self-link" href="#should-block-request"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), this algorithm returns <code>Blocked</code> or <code>Allowed</code> and reports violations based on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s Content Security Policy.</p>
    <ol>
     <li data-md="">
      <p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>.</p>
     <li data-md="">
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>CSP list</var>:</p>
      <ol>
       <li data-md="">
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition">disposition</a> is "<code>report</code>",
  then skip to the next <var>policy</var>.</p>
       <li data-md="">
        <p>Let <var>violates</var> be the result of executing <a href="#does-request-violate-policy">§6.1.11.1 Does request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>
       <li data-md="">
        <p>If <var>violates</var> is not "<code>Does Not Violate</code>", then:</p>
        <ol>
         <li data-md="">
          <p>Execute <a href="#report-violation">§5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§2.3.2 Create a violation object for request, policy, and directive</a> on <var>request</var>, <var>policy</var>, and <var>violates</var>.</p>
         <li data-md="">
          <p>Set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md="">
      <p>Return <var>result</var>.</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Should response to request be blocked by Content
    Security Policy?" data-level="4.1.4" id="should-block-response"><span class="secno">4.1.4. </span><span class="content"> Should <var>response</var> to <var>request</var> be blocked by Content
    Security Policy? </span><a class="self-link" href="#should-block-response"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>) and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), this algorithm returns <code>Blocked</code> or <code>Allowed</code>, and reports violations based on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s Content Security Policy.</p>
    <ol>
     <li data-md="">
      <p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>.</p>
     <li data-md="">
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>CSP list</var>:</p>
      <ol>
       <li data-md="">
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md="">
          <p>If the result of executing <var>directive</var>’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is "<code>Blocked</code>", then:</p>
          <ol>
           <li data-md="">
            <p>Execute <a href="#report-violation">§5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§2.3.2 Create a violation object for request, policy, and directive</a> on <var>request</var>, <var>policy</var>, and <var>directive</var>.</p>
           <li data-md="">
            <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition">disposition</a> is "<code>enforce</code>",
  then set <var>result</var> to "<code>Blocked</code>".</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: This portion of the check verifies that the page can load the
  response. That is, that a Service Worker hasn’t substituted a file which
  would violated the page’s CSP.</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a>:</p>
      <ol>
       <li data-md="">
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md="">
          <p>If the result of executing <var>directive</var>’s <a data-link-type="dfn" href="#directive-response-check">response check</a> on <var>request</var>, <var>response</var>,
  and <var>policy</var> is "<code>Blocked</code>", then:</p>
          <ol>
           <li data-md="">
            <p>Execute <a href="#report-violation">§5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§2.3.2 Create a violation object for request, policy, and directive</a> on <var>request</var>, <var>policy</var>, and <var>directive</var>.</p>
           <li data-md="">
            <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition">disposition</a> is "<code>enforce</code>",
  then set <var>result</var> to "<code>Blocked</code>".</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: This portion of the check allows policies delivered with the
  response to determine whether the response is allowed to be delivered.</p>
     <li data-md="">
      <p>Return <var>result</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="4.2" id="html-integration"><span class="secno">4.2. </span><span class="content"> Integration with HTML </span><a class="self-link" href="#html-integration"></a></h3>
    <ol>
     <li data-md="">
      <p>The <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> and <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a></code> objects have a <dfn data-dfn-for="global object" data-dfn-type="dfn" data-noexport="" id="global-object-csp-list">CSP list<a class="self-link" href="#global-object-csp-list"></a></dfn>,
  which holds all the <a data-link-type="dfn" href="#policy">policy</a> objects which are active for a given
  context. This list is empty unless otherwise specified, and is populated
  via the <a href="#initialize-global-object-csp">§4.2.2 Initialize a global object’s CSP list</a> algorithm.</p>
     <li data-md="">
      <p>A <a data-link-type="dfn" href="#policy">policy</a> is <dfn data-dfn-type="dfn" data-noexport="" id="enforced">enforced<a class="self-link" href="#enforced"></a></dfn> or <dfn data-dfn-type="dfn" data-noexport="" id="monitored">monitored<a class="self-link" href="#monitored"></a></dfn> for an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> by inserting it into the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>.</p>
     <li data-md="">
      <p><a href="#initialize-global-object-csp">§4.2.2 Initialize a global object’s CSP list</a> is called during the <a data-link-type="dfn" href="https://html.spec.whatwg.org/#initialising-a-new-document-object">initialising a
  new <code>Document</code> object</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/#run-a-worker">run a worker</a> algorithms in order to
  bind a set of <a data-link-type="dfn" href="#policy">policy</a> objects associated with a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> to a
  newly created <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>.</p>
      <p class="issue" id="issue-106a0c5c"><a class="self-link" href="#issue-106a0c5c"></a> The algorithm is named "creating a new <code>Document</code> object" in W3C’s
  HTML, and isn’t well-integrated with Fetch.</p>
      <p class="issue" id="issue-7fd49562"><a class="self-link" href="#issue-7fd49562"></a> Need to monkey-patch these in: something like "Set the <code>Window</code> object’s <code>CSP list</code> to the <code>CSP list</code> of the resource used to
  generate the document.</p>
     <li data-md="">
      <p><a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a> is called during the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/scripting-1.html#prepare-a-script">prepare a script</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/#update-a-style-block">update a <code>style</code> block</a> algorithms in order to determine whether or
  not an inline script or style block is allowed to execute/render.</p>
      <p class="issue" id="issue-f40dd242"><a class="self-link" href="#issue-f40dd242"></a> The <a data-link-type="dfn" href="https://html.spec.whatwg.org/#update-a-style-block">update a <code>style</code> block</a> algorithm does not exist in
  W3C’s HTML.</p>
      <p class="issue" id="issue-141323ad"><a class="self-link" href="#issue-141323ad"></a> The <code>nonce</code> attribute for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> were added to
  WHATWG’s HTML in <a href="https://github.com/whatwg/html/commit/882803c4cc8fba2fa5472b76f628d95cc82c421d">whatwg/html@882803c</a>.
  They have not yet been added to W3C’s HTML.</p>
      <p class="issue" id="issue-af0c6074"><a class="self-link" href="#issue-af0c6074"></a> The <a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a> hooks were added to WHATWG’s HTML in <a href="https://github.com/whatwg/html/commit/ee3486eb129bc350b5ca684d0c91dff23453ac1a">whatwg/html@ee3486e</a>.
  They aren’t yet in W3C’s HTML.</p>
     <li data-md="">
      <p><a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a> is called during handling of inline event
  handlers (like <code>onclick</code>) and inline <code>style</code> attributes in order to
  determine whether or not they ought to be allowed to execute/render.</p>
      <p class="issue" id="issue-73064ff2"><a class="self-link" href="#issue-73064ff2"></a> This hook is in-flight for WHATWG’s HTML. <a href="https://github.com/WHATWG/html/issues/384">&lt;https://github.com/WHATWG/html/issues/384></a></p>
     <li data-md="">
      <p><a data-link-type="dfn" href="#policy">Policies</a> are <a data-link-type="dfn" href="#enforced">enforced</a> during processing of the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a></code> element’s <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a></code>.</p>
      <p class="issue" id="issue-389933ec"><a class="self-link" href="#issue-389933ec"></a> This processing was added to WHATWG’s HTML in <a href="https://github.com/whatwg/html/commit/5064a629f22bef29839ab4dc6f1ceef17f010bc5">whatwg/html@5064a62</a>.
  It has not yet been added to W3C’s HTML.</p>
     <li data-md="">
      <p>A <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>'s <dfn data-dfn-type="dfn" data-noexport="" id="embedding-document">embedding document<a class="self-link" href="#embedding-document"></a></dfn> is the <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through">through which</a> the <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>'s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#browsing-context">browsing context</a> is nested.</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Initialize a Document&apos;s CSP list" data-level="4.2.1" id="initialize-document-csp"><span class="secno">4.2.1. </span><span class="content"> Initialize a <code>Document</code>'s <code>CSP list</code> </span><a class="self-link" href="#initialize-document-csp"></a></h4>
    <p>Given a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code> (<var>document</var>), and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), the
  user agent performs the following steps in order to initialize <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a>:</p>
    <ol>
     <li data-md="">
      <p>If <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>documents</var> be an empty list.</p>
       <li data-md="">
        <p>If <var>document</var> has an <a data-link-type="dfn" href="#embedding-document">embedding document</a> (<var>embedding</var>), then add <var>embedding</var> to <var>documents</var>.</p>
       <li data-md="">
        <p>If <var>document</var> has an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#opener-browsing-context">opener browsing context</a>, then add its <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#active-document">active document</a> to <var>documents</var>.</p>
       <li data-md="">
        <p>For each <var>doc</var> in <var>documents</var>:</p>
        <ol>
         <li data-md="">
          <p>For each <var>policy</var> in <var>doc</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a>:</p>
          <ol>
           <li data-md="">
            <p>Insert an alias to <var>policy</var> in <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a>.</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> includes <code>about:</code>, and this algorithm will
  therefore alias the <a data-link-type="dfn" href="#embedding-document">embedding document</a>’s policies for <a data-link-type="dfn" href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe <code>srcdoc</code> <code>Document</code></a>.</p>
      <p class="note" role="note">Note: We do all this to ensure that a page cannot bypass its <a data-link-type="dfn" href="#policy">policy</a> by embedding a frame or popping up a new window containing content it
  controls (<code>blob:</code> resources, or <code>document.write()</code>).</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a>, insert <var>policy</var> into <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a>.</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">CSP list</a>:</p>
      <ol>
       <li data-md="">
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md="">
          <p>Execute <var>directive</var>’s <a data-link-type="dfn" href="#directive-initialization">initialization</a> algorithm on <var>document</var> and <var>response</var>.</p>
        </ol>
      </ol>
    </ol>
    <h4 class="heading settled" data-algorithm="Initialize a global object’s CSP list" data-level="4.2.2" id="initialize-global-object-csp"><span class="secno">4.2.2. </span><span class="content"> Initialize a global object’s <code>CSP list</code> </span><a class="self-link" href="#initialize-global-object-csp"></a></h4>
    <p>Given a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a> (<var>global</var>), and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), the user agent performs the following steps in order
  to initialize <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>:</p>
    <ol>
     <li data-md="">
      <p>If <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>documents</var> be an empty list.</p>
       <li data-md="">
        <p>Add each of <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/#the-workers-documents">document</a>s to <var>documents</var>.</p>
       <li data-md="">
        <p>For each <var>document</var> in <var>documents</var>:</p>
        <ol>
         <li data-md="">
          <p>For each <var>policy</var> in <var>document</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global
  object</a>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>:</p>
          <ol>
           <li data-md="">
            <p>Insert an alias to <var>policy</var> in <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>.</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note">Note: <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a> includes <code>about:</code>, and this algorithm will
  therefore alias the <a data-link-type="dfn" href="#embedding-document">embedding document</a>’s policies for <a data-link-type="dfn" href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe <code>srcdoc</code> <code>Document</code></a>.</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-csp-list">CSP list</a>, insert <var>policy</var> into <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>.</p>
    </ol>
    <h4 class="heading settled" data-algorithm="Should element’s inline type behavior be blocked by Content Security Policy?" data-level="4.2.3" id="should-block-inline"><span class="secno">4.2.3. </span><span class="content"> Should <var>element</var>’s inline <var>type</var> behavior be blocked by Content Security Policy? </span><a class="self-link" href="#should-block-inline"></a></h4>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>), and a string (<var>type</var>) this algorithm returns
  "<code>Allowed</code>" if the element is allowed to have inline definition of a
  particular type of behavior (script execution, style application, event handlers,
  etc.), and "<code>Blocked</code>" otherwise:</p>
    <ol>
     <li data-md="">
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md="">
      <p>For each <var>policy</var> in <var>element</var>’s <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>'s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list">CSP list</a>:</p>
      <ol>
       <li data-md="">
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md="">
          <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-inline-check">inline check</a> returns
  "<code>Allowed</code>" when executed upon <var>element</var> and <var>type</var>, skip to the
  next <var>directive</var>.</p>
         <li data-md="">
          <p>Otherwise, let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§2.3.1 Create a violation object for global, policy, and directive</a> on the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings
  object</a>, <var>policy</var>, and "<code>style-src</code>" if <var>type</var> is "<code>style</code>" or
  "<code>style-attribute</code>", or "<code>script-src</code>" otherwise.</p>
         <li data-md="">
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource">resource</a> to "<code>inline</code>".</p>
         <li data-md="">
          <p>Execute <a href="#report-violation">§5.3 Report a violation</a> on <var>violation</var>.</p>
         <li data-md="">
          <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition">disposition</a> is "<code>enforce</code>", then
  set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md="">
      <p>Return <var>result</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="reporting"><span class="secno">5. </span><span class="content"> Reporting </span><a class="self-link" href="#reporting"></a></h2>
    <p>When one or more of a <a data-link-type="dfn" href="#policy">policy</a>’s directives is violated, a <dfn data-dfn-type="dfn" data-noexport="" id="violation-report">violation
  report<a class="self-link" href="#violation-report"></a></dfn> may be generated and sent out to a reporting endpoint associated
  with the <a data-link-type="dfn" href="#policy">policy</a>.</p>
    <h3 class="heading settled" data-level="5.1" id="violation-events"><span class="secno">5.1. </span><span class="content"> Violation DOM Events </span><a class="self-link" href="#violation-events"></a></h3>
<pre class="idl">[<dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="constructor" data-export="" data-lt="SecurityPolicyViolationEvent(type, eventInitDict)" id="dom-securitypolicyviolationevent-securitypolicyviolationevent">Constructor<a class="self-link" href="#dom-securitypolicyviolationevent-securitypolicyviolationevent"></a></dfn>(DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict)" data-dfn-type="argument" data-export="" id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type">type<a class="self-link" href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"></a></dfn>, optional <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a> <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict)" data-dfn-type="argument" data-export="" id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict">eventInitDict<a class="self-link" href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"></a></dfn>)]
interface <a class="idl-code" data-link-type="interface" href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event">Event</a> {
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-documenturi">documentURI<a class="self-link" href="#dom-securitypolicyviolationevent-documenturi"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-referrer">referrer<a class="self-link" href="#dom-securitypolicyviolationevent-referrer"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-blockeduri">blockedURI<a class="self-link" href="#dom-securitypolicyviolationevent-blockeduri"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-violateddirective">violatedDirective<a class="self-link" href="#dom-securitypolicyviolationevent-violateddirective"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-effectivedirective">effectiveDirective<a class="self-link" href="#dom-securitypolicyviolationevent-effectivedirective"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-originalpolicy">originalPolicy<a class="self-link" href="#dom-securitypolicyviolationevent-originalpolicy"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-sourcefile">sourceFile<a class="self-link" href="#dom-securitypolicyviolationevent-sourcefile"></a></dfn>;
    readonly    attribute DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-securitypolicyviolationevent-statuscode">statusCode<a class="self-link" href="#dom-securitypolicyviolationevent-statuscode"></a></dfn>;
    readonly    attribute long      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="long      " id="dom-securitypolicyviolationevent-linenumber">lineNumber<a class="self-link" href="#dom-securitypolicyviolationevent-linenumber"></a></dfn>;
    readonly    attribute long      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="long      " id="dom-securitypolicyviolationevent-columnnumber">columnNumber<a class="self-link" href="#dom-securitypolicyviolationevent-columnnumber"></a></dfn>;
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit<a class="self-link" href="#dictdef-securitypolicyviolationeventinit"></a></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a> {
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-documenturi">documentURI<a class="self-link" href="#dom-securitypolicyviolationeventinit-documenturi"></a></dfn>;
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-referrer">referrer<a class="self-link" href="#dom-securitypolicyviolationeventinit-referrer"></a></dfn>;
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-blockeduri">blockedURI<a class="self-link" href="#dom-securitypolicyviolationeventinit-blockeduri"></a></dfn>;
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-violateddirective">violatedDirective<a class="self-link" href="#dom-securitypolicyviolationeventinit-violateddirective"></a></dfn>;
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-effectivedirective">effectiveDirective<a class="self-link" href="#dom-securitypolicyviolationeventinit-effectivedirective"></a></dfn>;
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-originalpolicy">originalPolicy<a class="self-link" href="#dom-securitypolicyviolationeventinit-originalpolicy"></a></dfn>;
    DOMString <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-securitypolicyviolationeventinit-sourcefile">sourceFile<a class="self-link" href="#dom-securitypolicyviolationeventinit-sourcefile"></a></dfn>;
    long      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="long      " id="dom-securitypolicyviolationeventinit-linenumber">lineNumber<a class="self-link" href="#dom-securitypolicyviolationeventinit-linenumber"></a></dfn>;
    long      <dfn class="idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export="" data-type="long      " id="dom-securitypolicyviolationeventinit-columnnumber">columnNumber<a class="self-link" href="#dom-securitypolicyviolationeventinit-columnnumber"></a></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="5.2" id="deprecated-serialize-violation"><span class="secno">5.2. </span><span class="content"> Obtain the deprecated serialization of <var>violation</var> </span><a class="self-link" href="#deprecated-serialize-violation"></a></h3>
    <p>Given a <a data-link-type="dfn" href="#violation">violation</a> (<var>violation</var>), this algorithm returns a JSON text
  string representation of the violation, suitable for submission to a reporting
  endpoint associated with the deprecated <a data-link-type="dfn" href="#report-uri"><code>report-uri</code></a> directive.</p>
    <ol>
     <li data-md="">
      <p>Let <var>object</var> be a new JavaScript object with properties initialized as
  follows:</p>
      <dl>
       <dt data-md="">
        <p>"<code>document-uri</code>"</p>
       <dd data-md="">
        <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-url">url</a>, with the <code>exclude fragment</code> flag set.</p>
       <dt data-md="">
        <p>"<code>referrer</code>"</p>
       <dd data-md="">
        <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer">referrer</a>, with the <code>exclude fragment</code> flag set.</p>
       <dt data-md="">
        <p>"<code>blocked-uri</code>"</p>
       <dd data-md="">
        <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource">resource</a>, with the <code>exclude fragment</code> flag set.</p>
       <dt data-md="">
        <p>"<code>effective-directive</code>"</p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive">effective directive</a></p>
       <dt data-md="">
        <p>"<code>violated-directive</code>"</p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive">effective directive</a></p>
       <dt data-md="">
        <p>"<code>original-policy</code>"</p>
       <dd data-md="">
        <p>The <a data-link-type="dfn" href="#serialized-csp">serialization</a> of <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy">policy</a></p>
       <dt data-md="">
        <p>"<code>status-code</code>"</p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-status">status</a></p>
      </dl>
     <li data-md="">
      <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file">source file</a> is not <code>null</code>:</p>
      <ol>
       <li data-md="">
        <p>Set <var>object</var>’s "<code>source-file</code>" property to the result of executing
  the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file">source
  file</a>, with the <code>exclude fragment</code> flag set.</p>
       <li data-md="">
        <p>Set <var>object</var>’s "<code>line-number</code>" property to <var>violation</var>’s <a data-link-type="dfn" href="#violation-line-number">line number</a>.</p>
       <li data-md="">
        <p>Set <var>object</var>’s "<code>column-number</code>" property to <var>violation</var>’s <a data-link-type="dfn" href="#violation-column-number">column number</a>.</p>
      </ol>
     <li data-md="">
      <p>Return the result of executing <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-json.stringify">JSON.stringify()</a></code> on <var>object</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="5.3" id="report-violation"><span class="secno">5.3. </span><span class="content"> Report a <var>violation</var> </span><a class="self-link" href="#report-violation"></a></h3>
    <p>Given a <a data-link-type="dfn" href="#violation">violation</a> (<var>violation</var>), this algorithm reports it to the
  endpoint specified in <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy">policy</a>, and
  fires a <dfn class="idl-code" data-dfn-type="interface" data-export="" id="securitypolicyviolationevent">SecurityPolicyViolationEvent<a class="self-link" href="#securitypolicyviolationevent"></a></dfn> at <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object">global object</a>.</p>
    <ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-fire">Fire</a> a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-trusted">trusted</a> event with the name <code>securitypolicyviolation</code> that uses the <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a></code> interface, with its
  attributes initialized as follows:</p>
      <dl>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-documenturi">documentURI</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-url">url</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-referrer">referrer</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer">referrer</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-blockeduri">blockedURI</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-resource">resource</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive">effective directive</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-violateddirective">violatedDirective</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive">effective directive</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-originalpolicy">originalPolicy</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-policy">policy</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sourcefile">sourceFile</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file">source file</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-statuscode">statusCode</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-status">status</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-linenumber">lineNumber</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-line-number">line number</a></p>
       <dt data-md="">
        <p><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-columnnumber">columnNumber</a></code></p>
       <dd data-md="">
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-column-number">column number</a></p>
      </dl>
      <p class="note" role="note">Note: Both <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-violateddirective">violatedDirective</a></code> are the same value.
  This is intentional to maintain backwards compatibility.</p>
     <li data-md="">
      <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set">directive
  set</a> contains a <a data-link-type="dfn" href="#directives">directive</a> named "<a data-link-type="dfn" href="#report-uri"><code>report-uri</code></a>"
  (<var>directive</var>):</p>
      <ol>
       <li data-md="">
        <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set">directive set</a> contains a <a data-link-type="dfn" href="#directives">directive</a> named
  "<a data-link-type="dfn" href="#report-to"><code>report-to</code></a>", skip the remaining substeps.</p>
       <li data-md="">
        <p>Let <var>endpoint</var> be the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser">URL parser</a> on <var>directive</var>’s <a data-link-type="dfn" href="#directive-value">value</a>.</p>
       <li data-md="">
        <p>If <var>endpoint</var> is not a valid URL, skip the remaining substeps.</p>
       <li data-md="">
        <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a>, initialized as follows:</p>
        <dl>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method">method</a></p>
         <dd data-md="">
          <p>"<code>POST</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a></p>
         <dd data-md="">
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-url">url</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin">origin</a></p>
         <dd data-md="">
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object">global object</a>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window">window</a></p>
         <dd data-md="">
          <p>"<code>no-window</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">client</a></p>
         <dd data-md="">
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object">global object</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant
  settings object</a></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a></p>
         <dd data-md="">
          <p>""</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a></p>
         <dd data-md="">
          <p>""</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a></p>
         <dd data-md="">
          <p>""</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">cache mode</a></p>
         <dd data-md="">
          <p>"<code>no-cache</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode">credentials mode</a></p>
         <dd data-md="">
          <p>"<code>same-origin</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list">header list</a></p>
         <dd data-md="">
          <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list">header list</a> containing a single header whose name is
  "<code>Content-Type</code>", and value is "<code>application/csp-report</code>"</p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body">body</a></p>
         <dd data-md="">
          <p>The result of executing <a href="#deprecated-serialize-violation">§5.2 Obtain the deprecated serialization of violation</a> on <var>violation</var></p>
         <dt data-md="">
          <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode">redirect mode</a></p>
         <dd data-md="">
          <p>"<code>error</code>"</p>
        </dl>
       <li data-md="">
        <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch">Fetch</a> <var>request</var>. The result will be ignored.</p>
      </ol>
      <p class="note" role="note">Note: All of this should be considered deprecated. It sends a single
  request per violation, which simply isn’t scalable. As soon as this
  behavior can be removed from user agents, it will be.</p>
      <p class="note" role="note">Note: <code>report-uri</code> only takes effect if <code>report-to</code> is not present. That'
  is, the latter overrides the former, allowing for backwards compatibility
  with browsers that don’t support the new mechanism.</p>
     <li data-md="">
      <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set">directive
  set</a> contains a <a data-link-type="dfn" href="#directives">directive</a> named "<a data-link-type="dfn" href="#report-to"><code>report-to</code></a>"
  (<var>directive</var>):</p>
      <ol>
       <li data-md="">
        <p>Let <var>group</var> be <var>directive</var>’s <a data-link-type="dfn" href="#directive-value">value</a>.</p>
       <li data-md="">
        <p>Let <var>settings object</var> be <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object">global
  object</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a>.</p>
       <li data-md="">
        <p>Execute <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a>'s <a data-link-type="dfn" href="https://mikewest.github.io/error-reporting/#queue-report">Queue <var>data</var> as <var>type</var> for <var>endpoint group</var> on <var>settings</var></a> algorithm with the
  following arguments:</p>
        <dl>
         <dt data-md="">
          <p><var>data</var></p>
         <dd data-md="">
          <p><var>violation</var></p>
         <dt data-md="">
          <p><var>type</var></p>
         <dd data-md="">
          <p>"CSP"</p>
         <dt data-md="">
          <p><var>endpoint group</var></p>
         <dd data-md="">
          <p><var>group</var></p>
         <dt data-md="">
          <p><var>settings</var></p>
         <dd data-md="">
          <p><var>settings object</var></p>
        </dl>
      </ol>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="csp-directives"><span class="secno">6. </span><span class="content"> Content Security Policy Directives </span><a class="self-link" href="#csp-directives"></a></h2>
    <p>This specification defines a number of types of <a data-link-type="dfn" href="#directives">directives</a> which allow
  developers to control certain aspects of their sites' behavior. This document
  defines directives which govern resource fetching (in <a href="#directives-fetch">§6.1 Fetch Directives</a>)
  and directives which govern reporting (in <a href="#directives-reporting">§6.2 Reporting Directives</a>). These
  form the core of Content Security Policy; other directives are defined in a
  modular fashion in ancillary documents (see <a href="#directives-elsewhere">§6.3 Directives Defined in Other Documents</a> for
  examples).</p>
    <p>To mitigate the risk of cross-site scripting attacks, web developers SHOULD
  include directives that regulate sources of script and plugins. They can do
  so by including:</p>
    <ul>
     <li data-md="">
      <p>Both the <a data-link-type="dfn" href="#script-src">script-src</a> and <a data-link-type="dfn" href="#object-src">object-src</a> directives, or</p>
     <li data-md="">
      <p>a <a data-link-type="dfn" href="#default-src">default-src</a> directive</p>
    </ul>
    <p>In either case, developers SHOULD NOT include either <a data-link-type="grammar" href="#grammardef-unsafe-inline"><code>'unsafe-inline'</code></a>, or <code>data:</code> as valid
  sources in their policies. Both enable XSS attacks by allowing code to be
  included directly in the document itself; they are best avoided completely.</p>
    <h3 class="heading settled" data-level="6.1" id="directives-fetch"><span class="secno">6.1. </span><span class="content"> Fetch Directives </span><a class="self-link" href="#directives-fetch"></a></h3>
    <p><dfn data-dfn-type="dfn" data-noexport="" id="fetch-directives">Fetch directives<a class="self-link" href="#fetch-directives"></a></dfn> control the locations from which certain resource
  types may be loaded. For instance, <a data-link-type="dfn" href="#script-src">script-src</a> allows developers to
  whitelist trusted sources of script to execute on a page, while <a data-link-type="dfn" href="#font-src">font-src</a> controls the sources of web fonts.</p>
    <h4 class="heading settled" data-level="6.1.1" id="directive-child-src"><span class="secno">6.1.1. </span><span class="content"><code>child-src</code></span><a class="self-link" href="#directive-child-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="child-src">child-src<a class="self-link" href="#child-src"></a></dfn> directive governs the creation of <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing
  contexts</a> (e.g. <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#frame">frame</a></code> navigations) and Worker execution
  contexts. The syntax for the directive’s name and value is described by the
  following ABNF:</p>
<pre>directive-name  = "child-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> which will populate a frame or a
  worker. More formally, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> falling into one of the
  following categories:</p>
    <ul>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>document</code>", and whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context">target browsing context</a> is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing
 context</a> (e.g. requests which will populate an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a></code> or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#frame">frame</a></code> element)</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is either "<code>serviceworker</code>",
 "<code>sharedworker</code>", or "<code>worker</code>" (which are fed to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/#run-a-worker">run a worker</a> algorithm for <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/service-workers/#service-worker-interface">ServiceWorker</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker">SharedWorker</a></code>, and <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/workers/#worker">Worker</a></code>,
 respectively).</p>
    </ul>
    <div class="example" id="example-1cff8d33">
     <a class="self-link" href="#example-1cff8d33"></a> Given a page with the following Content Security Policy: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#child-src">child-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will all return network errors, as the URLs
    provided do not match <code>child-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;iframe src="https://not-example.com">&lt;/iframe>
&lt;script>
  var blockedWorker = new Worker("data:application/javascript,...");
&lt;/script>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.1.1" id="child-src-algorithms"><span class="secno">6.1.1.1. </span><span class="content">Algorithms</span><a class="self-link" href="#child-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>):</p>
    <p class="issue" id="issue-95f2d23a"><a class="self-link" href="#issue-95f2d23a"></a> TODO.</p>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p class="issue" id="issue-95f2d23a0"><a class="self-link" href="#issue-95f2d23a0"></a> TODO.</p>
    <h4 class="heading settled" data-level="6.1.2" id="directive-connect-src"><span class="secno">6.1.2. </span><span class="content"><code>connect-src</code></span><a class="self-link" href="#directive-connect-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="connect-src">connect-src<a class="self-link" href="#connect-src"></a></dfn> directive restricts the URLs which can be loaded
  using script interfaces. The syntax for the directive’s name and value is
  described by the following ABNF:</p>
<pre>directive-name  = "connect-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> which transmit or receive data from
  other origins. This includes APIs like <code>fetch()</code>, <a data-link-type="biblio" href="#biblio-xhr">[XHR]</a>, <a data-link-type="biblio" href="#biblio-eventsource">[EVENTSOURCE]</a>, <a data-link-type="biblio" href="#biblio-beacon">[BEACON]</a>, and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/text-level-semantics.html#the-a-element">a</a></code>'s <code><a data-link-type="element-attr" href="https://html.spec.whatwg.org/#ping">ping</a></code>. This directive <em>also</em> controls
  WebSocket <a data-link-type="biblio" href="#biblio-websockets">[WEBSOCKETS]</a> connections, though those aren’t technically part
  of Fetch.</p>
    <div class="example" id="example-ab3c2745">
     <a class="self-link" href="#example-ab3c2745"></a> JavaScript offers a few mechanisms that directly connect to an external
    server to send or receive information. <code>EventSource</code> maintains an open
    HTTP connection to a server in order to receive push notifications, <code>WebSockets</code> open a bidirectional communication channel between your
    browser and a server, and <code>XMLHttpRequest</code> makes arbitrary HTTP requests
    on your behalf. These are powerful APIs that enable useful functionality,
    but also provide tempting avenues for data exfiltration. 
     <p>The <code>connect-src</code> directive allows you to ensure that these and similar
    sorts of connections are only opened to origins you trust. Sending a
    policy that defines a list of source expressions for this directive is
    straightforward. For example, to limit connections to only <code>https://example.com</code>, send the following header:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#connect-src">connect-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will all return network errors, as the URLs
    provided do not match <code>connect-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;a ping="https://not-example.com">...
&lt;script>
  var xhr = new XMLHttpRequest();
  xhr.open('GET', 'https://not-example.com/');
  xhr.send();

  var ws = new WebSocket("https://not-example.com/");
        
  var es = new EventSource("https://not-example.com/");

  navigator.sendBeacon("https://not-example.com/", { ... });
&lt;/script>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.2.1" id="connect-src-algorithms"><span class="secno">6.1.2.1. </span><span class="content">Algorithms</span><a class="self-link" href="#connect-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is "<code>fetch</code>", or its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "" and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is
  "<code>subresource</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is "<code>fetch</code>", or its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "" and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is
  "<code>subresource</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.3" id="directive-default-src"><span class="secno">6.1.3. </span><span class="content"><code>default-src</code></span><a class="self-link" href="#directive-default-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="default-src">default-src<a class="self-link" href="#default-src"></a></dfn> directive serves as a fallback for the other <a data-link-type="dfn" href="#fetch-directives">fetch directives</a>. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "default-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>If a <a data-link-type="dfn" href="#default-src">default-src</a> directive is present in a policy, its value will be
  used as the policy’s default source list. That is, given <code>default-src 'none'; script-src 'self'</code>, script requests will use <code>'self'</code> as the <a data-link-type="dfn" href="#source-lists">source
  list</a> to match against. Other requests will use <code>'none'</code>. This is spelled
  out in more detail in the <a href="#should-block-request">§4.1.3 Should request be blocked by Content Security Policy?</a> and <a href="#should-block-response">§4.1.4 Should response to request be blocked by Content
    Security Policy?</a> algorithms.</p>
    <div class="example" id="example-565ff700">
     <a class="self-link" href="#example-565ff700"></a> The following header: 
<pre><a data-link-type="dfn" href="#content-security-policy">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src">default-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>
</pre>
     <p>will have the same behavior as the following header:</p>
<pre><a data-link-type="dfn" href="#content-security-policy">Content-Security-Policy</a>: <a data-link-type="dfn" href="#child-src">child-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#connect-src">connect-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#font-src">font-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#img-src">img-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#media-src">media-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#object-src">object-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#script-src">script-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#style-src">style-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>
</pre>
     <p>That is, when <code>default-src</code> is set, every <a data-link-type="dfn" href="#fetch-directives">fetch directive</a> that isn’t
    explicitly set will fall back to the value <code>default-src</code> specifies.</p>
    </div>
    <div class="example" id="example-82b3ca5f">
     <a class="self-link" href="#example-82b3ca5f"></a> There is no inheritance. If a <code>script-src</code> directive is explicitly
    specified, for example, then the value of <code>default-src</code> has no influence on
    script requests. That is, the following header: 
<pre><a data-link-type="dfn" href="#content-security-policy">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src">default-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>; <a data-link-type="dfn" href="#script-src">script-src</a> https://example.com
</pre>
     <p>will have the same behavior as the following header:</p>
<pre><a data-link-type="dfn" href="#content-security-policy">Content-Security-Policy</a>: <a data-link-type="dfn" href="#child-src">child-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#connect-src">connect-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#font-src">font-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#img-src">img-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#media-src">media-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#object-src">object-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>;
                         <a data-link-type="dfn" href="#script-src">script-src</a> https://example.com;
                         <a data-link-type="dfn" href="#style-src">style-src</a> <a data-link-type="grammar" href="#grammardef-self">'self'</a>
</pre>
     <p>Given this behavior, one good way to build a policy for a site would be to
    begin with a <code>default-src</code> of <code>'none'</code>, and to build up a policy from there
    which allowed only those resource types which are necessary for the
    particular page the policy will apply to.</p>
    </div>
    <h5 class="heading settled" data-level="6.1.3.1" id="default-src-algorithms"><span class="secno">6.1.3.1. </span><span class="content">Algorithms</span><a class="self-link" href="#default-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§6.1.11.4 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md="">
      <p>If <var>name</var> is <code>null</code>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If <var>policy</var> contains a <a data-link-type="dfn" href="#directives">directive</a> whose <a data-link-type="dfn" href="#directive-name">name</a> is <var>name</var>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§6.1.11.4 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md="">
      <p>If <var>name</var> is <code>null</code>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If <var>policy</var> contains a <a data-link-type="dfn" href="#directives">directive</a> whose <a data-link-type="dfn" href="#directive-name">name</a> is <var>name</var>, return "<code>Allowed</code>".</p>
     <li data-md="">
      <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.4" id="directive-font-src"><span class="secno">6.1.4. </span><span class="content"><code>font-src</code></span><a class="self-link" href="#directive-font-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="font-src">font-src<a class="self-link" href="#font-src"></a></dfn> directive restricts the URLs from which font resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "font-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <div class="example" id="example-38056220">
     <a class="self-link" href="#example-38056220"></a> Given a page with the following Content Security Policy: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#font-src">font-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>font-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;style>
  @font-face {
    font-family: "Example Font";
    src: url("https://not-example.com/font");
  }
  body {
    font-family: "Example Font";
  }
&lt;/style>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.4.1" id="font-src-algorithms"><span class="secno">6.1.4.1. </span><span class="content">Algorithms</span><a class="self-link" href="#font-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>font</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>font</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.5" id="directive-img-src"><span class="secno">6.1.5. </span><span class="content"><code>img-src</code></span><a class="self-link" href="#directive-img-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="img-src">img-src<a class="self-link" href="#img-src"></a></dfn> directive restricts the URLs from which image resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "img-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> which load images. More formally, this
  includes <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>image</code>" <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a>.</p>
    <div class="example" id="example-8e5ffeae">
     <a class="self-link" href="#example-8e5ffeae"></a> Given a page with the following Content Security Policy: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#img-src">img-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>img-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;img src="https://not-example.com/img">
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.5.1" id="img-src-algorithms"><span class="secno">6.1.5.1. </span><span class="content">Algorithms</span><a class="self-link" href="#img-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>image</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>image</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.6" id="directive-manifest-src"><span class="secno">6.1.6. </span><span class="content"><code>manifest-src</code></span><a class="self-link" href="#directive-manifest-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="manifest-src">manifest-src<a class="self-link" href="#manifest-src"></a></dfn> directive restricts the URLs from which application
  manifests may be loaded <a data-link-type="biblio" href="#biblio-appmanifest">[APPMANIFEST]</a>. The syntax for the directive’s name
  and value is described by the following ABNF:</p>
<pre>directive-name  = "manifest-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <div class="example" id="example-165f453d">
     <a class="self-link" href="#example-165f453d"></a> Given a page with the following Content Security Policy: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#manifest-src">manifest-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>manifest-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;link rel="manifest" href="https://not-example.com/manifest">
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.6.1" id="manifest-src-algorithms"><span class="secno">6.1.6.1. </span><span class="content">Algorithms</span><a class="self-link" href="#manifest-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is "<code>manifest</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is "<code>manifest</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.7" id="directive-media-src"><span class="secno">6.1.7. </span><span class="content"><code>media-src</code></span><a class="self-link" href="#directive-media-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="media-src">media-src<a class="self-link" href="#media-src"></a></dfn> directive restricts the URLs from which video, audio,
  and associated text track resources may be loaded. The syntax for the
  directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "media-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <div class="example" id="example-557d9dba">
     <a class="self-link" href="#example-557d9dba"></a> Given a page with the following Content Security Policy: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#media-src">media-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>media-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;audio src="https://not-example.com/audio">&lt;/audio>
&lt;video src="https://not-example.com/video">
    &lt;track kind="subtitles" src="https://not-example.com/subtitles">
&lt;/video>
</pre>
    </div>
    <h5 class="heading settled" data-level="6.1.7.1" id="media-src-algorithms"><span class="secno">6.1.7.1. </span><span class="content">Algorithms</span><a class="self-link" href="#media-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is one of "<code>audio</code>", "<code>video</code>",
  or "<code>track</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is one of "<code>audio</code>", "<code>video</code>",
  or "<code>track</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.8" id="directive-object-src"><span class="secno">6.1.8. </span><span class="content"><code>object-src</code></span><a class="self-link" href="#directive-object-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="object-src">object-src<a class="self-link" href="#object-src"></a></dfn> directive restricts the URLs from which plugin
  content may be loaded. The syntax for the directive’s name and value is
  described by the following ABNF:</p>
<pre>directive-name  = "object-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <div class="example" id="example-3469e20e">
     <a class="self-link" href="#example-3469e20e"></a> Given a page with the following Content Security Policy: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#object-src">object-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>object-src</code>'s <a data-link-type="dfn" href="#source-lists">source list</a>:</p>
<pre>&lt;embed src="https://not-example.com/flash">&lt;/embed>
&lt;object data="https://not-example.com/flash">&lt;/object>
&lt;applet archive="https://not-example.com/flash">&lt;/applet>
</pre>
    </div>
    <p>If plugin content is loaded without an associated URL (perhaps an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a></code> element lacks a <code><a data-link-type="element-attr" href="https://html.spec.whatwg.org/multipage/embedded-content.html#attr-object-data">data</a></code> attribute, but loads some default plugin based
  on the specified <code>type</code>), it MUST be blocked if <code>object-src</code>'s value is <code>'none'</code>, but will otherwise be allowed.</p>
    <p class="note" role="note">Note: The <code>object-src</code> directive acts upon any request made on behalf of
  an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element">embed</a></code>, or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element">applet</a></code> element. This includes requests
  which would populate the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a> generated by the
  former two (also including navigations). This is true even when the data is
  semantically equivalent to content which would otherwise be restricted by
  another directive, such as an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a></code> element with a <code>text/html</code> MIME
  type.</p>
    <h5 class="heading settled" data-level="6.1.8.1" id="object-src-algorithms"><span class="secno">6.1.8.1. </span><span class="content">Algorithms</span><a class="self-link" href="#object-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>unknown</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>unknown</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.9" id="directive-script-src"><span class="secno">6.1.9. </span><span class="content"><code>script-src</code></span><a class="self-link" href="#directive-script-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="script-src">script-src<a class="self-link" href="#script-src"></a></dfn> directive restricts the locations from which scripts
  may be executed. This includes not only URLs loaded directly into <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> elements, but also things like inline script blocks and XSLT stylesheets <a data-link-type="biblio" href="#biblio-xslt">[XSLT]</a> which can trigger script execution. The syntax for the directive’s
  name and value is described by the following ABNF:</p>
<pre>directive-name  = "script-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>The <code>script-src</code> directive governs four things:</p>
    <ol>
     <li data-md="">
      <p>Script <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> MUST pass through <a href="#should-block-request">§4.1.3 Should request be blocked by Content Security Policy?</a>.</p>
     <li data-md="">
      <p>Script <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">responses</a> MUST pass through <a href="#should-block-response">§4.1.4 Should response to request be blocked by Content
    Security Policy?</a>.</p>
     <li data-md="">
      <p>Inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> blocks MUST pass through <a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a>. Their
  behavior will be blocked unless every policy allows inline script, either
  implicitly by not specifying a <code>script-src</code> (or <code>default-src</code>) directive,
  or explicitly, by whitelisting "<code>unsafe-inline</code>", a <a data-link-type="grammar" href="#grammardef-nonce-source">nonce-source</a> or a <a data-link-type="grammar" href="#grammardef-hash-source">hash-source</a> that matches
  the inline block.</p>
     <li data-md="">
      <p>The following JavaScript execution sinks are gated on the "<code>unsafe-eval</code>"
  source expression:</p>
      <ul>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a></code></p>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-function-objects">Function()</a></code></p>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-settimeout">setTimeout()</a></code> with an initial argument which is not callable.</p>
       <li data-md="">
        <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-setinterval">setInterval()</a></code> with an initial argument which is not callable.</p>
      </ul>
      <p class="note" role="note">Note: If a user agent implements non-standard sinks like <code>setImmediate()</code> or <code>execScript()</code>, they SHOULD also be gated on "<code>unsafe-eval</code>".</p>
    </ol>
    <h5 class="heading settled" data-level="6.1.9.1" id="script-src-algorithms"><span class="secno">6.1.9.1. </span><span class="content">Algorithms</span><a class="self-link" href="#script-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>script</code>", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>subresource</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>script</code>", and its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is "<code>subresource</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>) and a string (<var>type</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>type</var> is "<code>script</code>" or "<code>script attribute</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-element-to-source-list">§6.1.12.1 Does element match source list?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value">value</a>, and <var>type</var> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-initialization">initialization</a> algorithm is as follows:</p>
    <p class="issue" id="issue-2b1bf0aa"><a class="self-link" href="#issue-2b1bf0aa"></a> Do something interesting to the execution context in order to lock down <code>eval()</code>, et al. I don’t think ECMA gives us any hooks here, so let’s work
  with them to put something reasonable together.</p>
    <h4 class="heading settled" data-level="6.1.10" id="directive-style-src"><span class="secno">6.1.10. </span><span class="content"><code>style-src</code></span><a class="self-link" href="#directive-style-src"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="style-src">style-src<a class="self-link" href="#style-src"></a></dfn> directive restricts the locations from which style
  may be applied to a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/html5/dom.html#document">Document</a></code>. The syntax for the directive’s name and
  value is described by the following ABNF:</p>
<pre>directive-name  = "style-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>The <code>style-src</code> directive governs several things:</p>
    <ol>
     <li data-md="">
      <p>Style <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> MUST pass through <a href="#should-block-request">§4.1.3 Should request be blocked by Content Security Policy?</a>. This
  includes:</p>
      <ol>
       <li data-md="">
        <p>Stylesheet requests originating from a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a></code> element.</p>
       <li data-md="">
        <p>Stylesheet requests originating from the <a class="css" data-link-type="at-rule" href="https://drafts.csswg.org/css-cascade-4/#at-ruledef-import"><code>@import</code></a> rule.</p>
       <li data-md="">
        <p>Stylesheet requests originating from a <code>Link</code> HTTP response header
  field <a data-link-type="biblio" href="#biblio-rfc5988">[RFC5988]</a>.</p>
      </ol>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">Responses</a> to style requests MUST pass through <a href="#should-block-response">§4.1.4 Should response to request be blocked by Content
    Security Policy?</a>.</p>
     <li data-md="">
      <p>Inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> blocks MUST pass through <a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a>. The
  styles will be blocked unless every policy allows inline style, either
  implicitly by not specifying a <code>script-src</code> (or <code>default-src</code>) directive,
  or explicitly, by whitelisting "<code>unsafe-inline</code>", a <a data-link-type="grammar" href="#grammardef-nonce-source">nonce-source</a> or a <a data-link-type="grammar" href="#grammardef-hash-source">hash-source</a> that matches
  the inline block.</p>
     <li data-md="">
      <p>The following CSS algorithms are gated on the <code>unsafe-eval</code> source
  expression:</p>
      <ol>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#insert-a-css-rule">insert a CSS rule</a></p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#parse-a-css-rule">parse a CSS rule</a>,</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#parse-a-css-declaration-block">parse a CSS declaration block</a></p>
       <li data-md="">
        <p><a data-link-type="dfn" href="http://www.w3.org/TR/cssom/#parse-a-group-of-selectors">parse a group of selectors</a></p>
      </ol>
      <p>This would include, for example, all invocations of CSSOM’s various <code>cssText</code> setters and <code>insertRule</code> methods <a data-link-type="biblio" href="#biblio-cssom">[CSSOM]</a> <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>.</p>
      <p class="issue" id="issue-ba1a0a35"><a class="self-link" href="#issue-ba1a0a35"></a> This needs to be better explained.</p>
    </ol>
    <h5 class="heading settled" data-level="6.1.10.1" id="style-src-algorithms"><span class="secno">6.1.10.1. </span><span class="content">Algorithms</span><a class="self-link" href="#style-src-algorithms"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>style</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a> is "<code>style</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-url-to-source-list">§6.1.11.2 Does url match source list?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">url</a> and this directive’s <a data-link-type="dfn" href="#directive-value">value</a> is "<code>Does Not Match</code>",
  return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>) and a string (<var>type</var>):</p>
    <ol>
     <li data-md="">
      <p>If <var>type</var> is "<code>style</code>" or "<code>style attribute</code>":</p>
      <ol>
       <li data-md="">
        <p>If the result of executing <a href="#match-element-to-source-list">§6.1.12.1 Does element match source list?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value">value</a>, and <var>type</var> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-initialization">initialization</a> algorithm is as follows:</p>
    <p class="issue" id="issue-eba1ebc1"><a class="self-link" href="#issue-eba1ebc1"></a> Do something interesting to the execution context in order to lock down
  interesting CSSOM algorithms. I don’t think CSSOM gives us any hooks here, so
  let’s work with them to put something reasonable together.</p>
    <h4 class="heading settled" data-level="6.1.11" id="fetch-directive-matching-url"><span class="secno">6.1.11. </span><span class="content">URL Matching Algorithms</span><a class="self-link" href="#fetch-directive-matching-url"></a></h4>
    <h5 class="heading settled" data-algorithm="Does request violate policy?" data-level="6.1.11.1" id="does-request-violate-policy"><span class="secno">6.1.11.1. </span><span class="content"> Does <var>request</var> violate <var>policy</var>? </span><a class="self-link" href="#does-request-violate-policy"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#policy">policy</a> (<var>policy</var>), this
  algorithm returns the violated <a data-link-type="dfn" href="#directives">directive</a> if the request violates the
  policy, and "<code>Does Not Violate</code>" otherwise.</p>
    <ol>
     <li data-md="">
      <p>Let <var>violates</var> be "<code>Does Not Violate</code>".</p>
     <li data-md="">
      <p>For each <var>directive</var> in <var>policy</var>:</p>
      <ol>
       <li data-md="">
        <p>Let <var>result</var> be the result of executing <var>directive</var>’s <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a> on <var>request</var> and <var>policy</var>.</p>
       <li data-md="">
        <p>If <var>result</var> is "<code>Blocked</code>", then let <var>violates</var> be <var>directive</var>.</p>
      </ol>
     <li data-md="">
      <p>Return <var>violates</var>.</p>
    </ol>
    <h5 class="heading settled" data-algorithm="Does url match source list?" data-level="6.1.11.2" id="match-url-to-source-list"><span class="secno">6.1.11.2. </span><span class="content"> Does <var>url</var> match <var>source list</var>? </span><a class="self-link" href="#match-url-to-source-list"></a></h5>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> (<var>url</var>), and a <a data-link-type="dfn" href="#source-lists">source list</a> (<var>source list</var>), this
  algorithm returns "<code>Matches</code>" if the URL matches one or more source
  expressions in <var>source list</var>, or "<code>Does Not Match</code>" otherwise:</p>
    <ol>
     <li data-md="">
      <p>If <var>source list</var> is <code>null</code>, return "<code>Matches</code>".</p>
     <li data-md="">
      <p>If <var>source list</var> contains a single item which is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for the string "<code>'none'</code>", return "<code>Does Not Match</code>".</p>
     <li data-md="">
      <p>For each <var>expression</var> in <var>source list</var>:</p>
      <ol>
       <li data-md="">
        <p>If <a href="#match-url-to-source-expression">§6.1.11.3 Does url match expression in origin with redirect count?</a> returns "<code>Matches</code>" when
  executed upon <var>url</var> and <var>expression</var>, return "<code>Matches</code>".</p>
      </ol>
     <li data-md="">
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled" data-algorithm="Does url match expression in origin with redirect count?" data-level="6.1.11.3" id="match-url-to-source-expression"><span class="secno">6.1.11.3. </span><span class="content"> Does <var>url</var> match <var>expression</var> in <var>origin</var> with <var>redirect count</var>? </span><a class="self-link" href="#match-url-to-source-expression"></a></h5>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url">URL</a></code> (<var>url</var>), a <a data-link-type="dfn" href="#source-expression">source expression</a> (<var>expression</var>), an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> (<var>origin</var>), and a number (<var>redirect count</var>), this algorithm
  returns "<code>Matches</code>" if <var>url</var> matches <var>expression</var>, and "<code>Does Not Match</code>"
  otherwise.</p>
    <p class="note" role="note">Note: <var>origin</var> is the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a> of the resource relative to which the <var>expression</var> should be resolved. "<code>'self'</code>", for instance, will have distinct
  meaning depending on that bit of context.</p>
    <ol>
     <li data-md="">
      <p>If <var>expression</var> is the string "*", and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is not a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>, return "<code>Matches</code>".</p>
     <li data-md="">
      <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-scheme-source"><code>scheme-source</code></a> or <a data-link-type="grammar" href="#grammardef-host-source"><code>host-source</code></a> grammar:</p>
      <ol>
       <li data-md="">
        <p>If <var>expression</var> has a <a data-link-type="grammar" href="#grammardef-scheme-part"><code>scheme-part</code></a> that is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code>, then
  return "<code>Does Not Match</code>" unless one of the following conditions is
  met:</p>
        <ol>
         <li data-md="">
          <p><var>expression</var>’s <a data-link-type="grammar" href="#grammardef-scheme-part"><code>scheme-part</code></a> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive match</a> for "<code>http</code>" and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>https</code>"</p>
         <li data-md="">
          <p><var>expression</var>’s <a data-link-type="grammar" href="#grammardef-scheme-part"><code>scheme-part</code></a> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive match</a> for "<code>ws</code>" and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>wss</code>"</p>
        </ol>
       <li data-md="">
        <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-scheme-source"><code>scheme-source</code></a> grammar,
  return "<code>Matches</code>".</p>
      </ol>
      <p class="note" role="note">Note: This logic effectively means that <code>script-src http:</code> is
  equivalent to <code>script-src http: https:</code>, and <code>script-src http://example.com/</code> is equivalent to <code>script-src http://example.com https://example.com</code>. In short, we always allow a
  secure upgrade from an explicitly insecure expression.</p>
     <li data-md="">
      <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-host-source"><code>host-source</code></a> grammar:</p>
      <ol>
       <li data-md="">
        <p>If <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> is <code>null</code>, return "<code>Does Not Match</code>".</p>
       <li data-md="">
        <p>If <var>expression</var> does not have a <a data-link-type="grammar" href="#grammardef-scheme-part"><code>scheme-part</code></a>, then
  return "<code>Does Not Match</code>" unless one of the following conditions is
  met:</p>
        <ol>
         <li data-md="">
          <p><var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code></p>
         <li data-md="">
          <p><var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>http</code>", and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> one of "<code>https</code>", "<code>ws</code>", or "<code>wss</code>".</p>
         <li data-md="">
          <p><var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>https</code>", and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>wss</code>".</p>
        </ol>
        <p class="note" role="note">Note: As with <a data-link-type="grammar" href="#grammardef-scheme-part"><code>scheme-part</code></a> above, we allow schemeless <a data-link-type="grammar" href="#grammardef-host-source"><code>host-source</code></a> expressions to be upgraded from insecure
  schemes to secure schemes.</p>
       <li data-md="">
        <p>If the first character of <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-host-part"><code>host-part</code></a> is an U+002A ASTERISK character (<code>*</code>):</p>
        <ol>
         <li data-md="">
          <p>Let <var>remaining</var> be the result of removing the leading "<code>*</code>" from <var>expression</var>.</p>
         <li data-md="">
          <p>If <var>remaining</var> (including the leading U+002E FULL STOP character
  (<code>.</code>)) is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for the
  rightmost characters of <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code>, then return "<code>Does Not Match</code>".</p>
        </ol>
       <li data-md="">
        <p>If the first character of <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-host-part"><code>host-part</code></a> is not an U+002A ASTERISK character (<code>*</code>), and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-host-part"><code>host-part</code></a>, return "<code>Does Not Match</code>".</p>
       <li data-md="">
        <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-host-part"><code>host-part</code></a> matches the <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.2.2">IPv4address</a> rule from <a data-link-type="biblio" href="#biblio-rfc3986">[RFC3986]</a>, and is not
  "<code>127.0.0.1</code>"; or if <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-host-part"><code>host-part</code></a> is an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-ipv6">IPv6 address</a>, return "<code>Does Not Match</code>".</p>
        <p class="note" role="note">Note: A future version of this specification may allow literal IPv6
  and IPv4 addresses, depending on usage and demand. Given the weak
  security properties of IP addresses in relation to named hosts,
  however, authors are encouraged to prefer the latter whenever
  possible.</p>
       <li data-md="">
        <p>If <var>expression</var> does not contain a <a data-link-type="grammar" href="#grammardef-port-part"><code>port-part</code></a>, and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code> is not the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port">default port</a> for <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code>, return "<code>Does Not Match</code>".</p>
       <li data-md="">
        <p>If <var>expression</var> does contain a <a data-link-type="grammar" href="#grammardef-port-part"><code>port-part</code></a>:</p>
        <ol>
         <li data-md="">
          <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-port-part"><code>port-part</code></a> is not "<code>*</code>", and
  is not the same number as <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code>, return "<code>Does Not Match</code>".</p>
        </ol>
       <li data-md="">
        <p>If <var>expression</var> contains a non-empty <a data-link-type="grammar" href="#grammardef-path-part"><code>path-part</code></a>, and <var>redirect count</var> is 0, then:</p>
        <ol>
         <li data-md="">
          <p>Let <var>exact match</var> be <code>false</code> if the final character of <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-path-part"><code>path-part</code></a> is the U+002F SOLIDUS
  character (<code>/</code>), and <code>true</code> otherwise.</p>
         <li data-md="">
          <p>Let <var>path list</var> be the result of <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">strictly splitting</a> <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-path-part"><code>path-part</code></a> on the U+002F SOLIDUS
  character (<code>/</code>).</p>
         <li data-md="">
          <p>If <var>path list</var> has more items than <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-path">path</a></code>, return
  "<code>Does Not Match</code>".</p>
         <li data-md="">
          <p>If <var>exact match</var> is <code>true</code>, and <var>path list</var> does not have the same
  number of items as <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-path">path</a></code>, return "<code>Does Not Match</code>".</p>
         <li data-md="">
          <p>For each <var>expression piece</var> in <var>path list</var>:</p>
          <ol>
           <li data-md="">
            <p>Let <var>url piece</var> be the next item in <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-path">path</a></code>.</p>
           <li data-md="">
            <p><a data-link-type="dfn" href="https://url.spec.whatwg.org/#percent-decode">Percent decode</a> <var>expression piece</var>.</p>
           <li data-md="">
            <p><a data-link-type="dfn" href="https://url.spec.whatwg.org/#percent-decode">Percent decode</a> <var>url piece</var>.</p>
           <li data-md="">
            <p>If <var>expression piece</var> is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive
  match</a> for <var>url piece</var>, return "<code>Does Not Match</code>".</p>
          </ol>
        </ol>
       <li data-md="">
        <p>Return "<code>Matches</code>".</p>
      </ol>
     <li data-md="">
      <p>If <var>expression</var> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "<code>'self'</code>",
  return "<code>Matches</code>" if one or more of the following conditions is met:</p>
      <ol>
       <li data-md="">
        <p><var>origin</var> is the same as <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-origin">origin</a></code></p>
       <li data-md="">
        <p><var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code> is the same as <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-host">host</a></code>, <var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-port">port</a></code> and <var>url</var>’s {{URL/port} are either the same
  or the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port">default ports</a> for their respective <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code>s, and
  one or more of the following conditions is met:</p>
        <ol>
         <li data-md="">
          <p><var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>https</code>" or "<code>wss</code>"</p>
         <li data-md="">
          <p><var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a></code> is "<code>http</code>"</p>
        </ol>
      </ol>
      <p class="note" role="note">Note: Like the <a data-link-type="grammar" href="#grammardef-scheme-part"><code>scheme-part</code></a> logic above, the "<code>'self'</code>"
  matching algorithm allows upgrades to secure schemes when it is safe to do
  so. We limit these upgrades to endpoints running on the default port for a
  particular scheme or a port that matches the origin of the protected
  resource, as this seems sufficient to deal with upgrades that can be
  reasonably expected to succeed.</p>
     <li data-md="">
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled" data-algorithm="Get the effective directive for request" data-level="6.1.11.4" id="effective-directive-for-a-request"><span class="secno">6.1.11.4. </span><span class="content"> Get the effective directive for <var>request</var> </span><a class="self-link" href="#effective-directive-for-a-request"></a></h5>
    <p>Each <a data-link-type="dfn" href="#fetch-directives">fetch directive</a> controls a specific type of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a>. Given
  a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>), the following algorithm returns either <code>null</code> or the <a data-link-type="dfn" href="#directive-name">name</a> of the request’s <dfn data-dfn-for="request" data-dfn-type="dfn" data-noexport="" id="request-effective-directive">effective directive<a class="self-link" href="#request-effective-directive"></a></dfn>:</p>
    <ol>
     <li data-md="">
      <p>Switch on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-type">type</a>, and execute
  the associated steps:</p>
      <dl>
       <dt data-md="">
        <p>""</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is
  "<code>fetch</code>", return <code>connect-src</code>.</p>
         <li data-md="">
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a> is
  "<code>manifest</code>", return <code>manifest-src</code>.</p>
         <li data-md="">
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is
  "<code>subresource</code>", return <code>connect-src</code>.</p>
         <li data-md="">
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is
  "<code>unknown</code>", return <code>object-src</code>.</p>
         <li data-md="">
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a> is
  "<code>document</code>" <em>and</em> the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context">target browsing context</a> is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing
  context</a>, return <code>child-src</code>.</p>
        </ol>
       <dt data-md="">
        <p>"<code>audio</code>"</p>
       <dt data-md="">
        <p>"<code>track</code>"</p>
       <dt data-md="">
        <p>"<code>video</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>Return <code>media-src</code>.</p>
        </ol>
       <dt data-md="">
        <p>"<code>font</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>Return <code>font-src</code>.</p>
        </ol>
       <dt data-md="">
        <p>"<code>image</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>Return <code>image-src</code>.</p>
        </ol>
       <dt data-md="">
        <p>"<code>style</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>Return <code>style-src</code>.</p>
        </ol>
       <dt data-md="">
        <p>"<code>script</code>"</p>
       <dd data-md="">
        <ol>
         <li data-md="">
          <p>Switch on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a>, and
  execute the associated steps:</p>
          <dl>
           <dt data-md="">
            <p>"<code>subresource</code>"</p>
           <dd data-md="">
            <ol>
             <li data-md="">
              <p>Return <code>script-src</code>.</p>
            </ol>
           <dt data-md="">
            <p>"<code>serviceworker</code>"</p>
           <dt data-md="">
            <p>"<code>sharedworker</code>"</p>
           <dt data-md="">
            <p>"<code>worker</code>"</p>
           <dd data-md="">
            <ol>
             <li data-md="">
              <p>Return <code>child-src</code>.</p>
            </ol>
          </dl>
        </ol>
      </dl>
     <li data-md="">
      <p>Return <code>null</code>.</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.12" id="fetch-directive-matching-element"><span class="secno">6.1.12. </span><span class="content">Element Matching Algorithms</span><a class="self-link" href="#fetch-directive-matching-element"></a></h4>
    <h5 algorthm="" class="heading settled" data-level="6.1.12.1" id="match-element-to-source-list"><span class="secno">6.1.12.1. </span><span class="content"> Does <var>element</var> match source <var>list</var>? </span><a class="self-link" href="#match-element-to-source-list"></a></h5>
    <p>Given an <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-element">Element</a></code> (<var>element</var>), a <a data-link-type="dfn" href="#source-lists">source list</a> (<var>list</var>), and a string
  (<var>type</var>), this algorithm returns "<code>Matches</code>" or "<code>Does Not Match</code>".</p>
    <ol>
     <li data-md="">
      <p>Let <var>contains nonce or hash</var> be <code>false</code>.</p>
     <li data-md="">
      <p>For each <var>expression</var> in <var>list</var>:</p>
      <ol>
       <li data-md="">
        <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source"><code>nonce-source</code></a> or <a data-link-type="grammar" href="#grammardef-hash-source"><code>hash-source</code></a> grammar, set <var>contains nonce or hash</var> to <code>true</code>.</p>
      </ol>
     <li data-md="">
      <p>If <var>contains nonce or hash</var> is <code>false</code>, and <var>list</var> contains a <a data-link-type="dfn" href="#source-expression">source expression</a> which is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for
  the string "<code>unsafe-inline</code>", then return "<code>Matches</code>".</p>
     <li data-md="">
      <p>If <var>type</var> is not "<code>script attribute</code>" or "<code>style attribute</code>":</p>
      <ol>
       <li data-md="">
        <p>Let <var>content</var> be <a data-link-type="dfn" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-block&apos;s-source">the script block’s source</a> if <var>element</var> is a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> element, or the value of <var>element</var>’s <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#dom-node-textcontent">textContent</a></code> IDL attribute for any other element.</p>
       <li data-md="">
        <p>For each <var>expression</var> in <var>list</var>:</p>
        <ol>
         <li data-md="">
          <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source"><code>nonce-source</code></a> grammar,
  and <var>element</var> has a <code><a data-link-type="element-attr" href="https://html.spec.whatwg.org/#attr-script-nonce">nonce</a></code> attribute whose value is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value"><code>base64-value</code></a> part, return "<code>Matches</code>".</p>
         <li data-md="">
          <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-hash-source"><code>hash-source</code></a> grammar:</p>
          <ol>
           <li data-md="">
            <p>Let <var>algorithm</var> be <code>null</code>.</p>
           <li data-md="">
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "sha256", set <var>algorithm</var> to <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-256</a>.</p>
           <li data-md="">
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "sha384", set <var>algorithm</var> to <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-384</a>.</p>
           <li data-md="">
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive match</a> for "sha512", set <var>algorithm</var> to <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">SHA-512</a>.</p>
           <li data-md="">
            <p>If <var>algorithm</var> is not <code>null</code>:</p>
            <ol>
             <li data-md="">
              <p>Let <var>actual</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-4">base64 encoding</a> the
  result of applying <var>algorithm</var> to <var>content</var>.</p>
             <li data-md="">
              <p>If <var>actual</var> is a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a> match for <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value"><code>base64-value</code></a> part, return
  "<code>Matches</code>".</p>
            </ol>
          </ol>
        </ol>
      </ol>
     <li data-md="">
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h3 class="heading settled" data-level="6.2" id="directives-reporting"><span class="secno">6.2. </span><span class="content"> Reporting Directives </span><a class="self-link" href="#directives-reporting"></a></h3>
    <p>Various algorithms in this document hook into the reporting process by
  constructing a <a data-link-type="dfn" href="#violation">violation</a> object via <a href="#create-violation-for-request">§2.3.2 Create a violation object for request, policy, and directive</a> or <a href="#create-violation-for-global">§2.3.1 Create a violation object for global, policy, and directive</a>, and passing that object to <a href="#report-violation">§5.3 Report a violation</a> to deliver the report.</p>
    <h4 class="heading settled" data-level="6.2.1" id="directive-report-uri"><span class="secno">6.2.1. </span><span class="content"><code>report-uri</code></span><a class="self-link" href="#directive-report-uri"></a></h4>
    <div class="note" role="note">
      Note: The <a data-link-type="dfn" href="#report-uri"><code>report-uri</code></a> directive is deprecated. Please use the <a data-link-type="dfn" href="#report-to"><code>report-to</code></a> directive instead. If the latter directive is present,
    this directive will be ignored. To ensure backwards compatibility, we
    suggest specifying both, like this: 
     <div class="example" id="example-9d2ef57e">
      <a class="self-link" href="#example-9d2ef57e"></a> 
<pre><a data-link-type="dfn" href="#content-security-policy">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="#report-uri">report-uri</a> https://endpoint.com; <a data-link-type="dfn" href="#report-to">report-to</a> groupname
</pre>
     </div>
    </div>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="report-uri"><code>report-uri</code><a class="self-link" href="#report-uri"></a></dfn> directive defines a set of endpoints to which <a data-link-type="dfn" href="#violation-report">violation reports</a> will be sent when particular behaviors are prevented.</p>
<pre>directive-name  = "report-uri"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a> *( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3">RWS</a> <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a> )

; The <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a> grammar is defined in Section 4.1 of RFC 3986.
</pre>
    <p>The directive has no effect in and of itself, but only gains meaning in
  combination with other directives.</p>
    <h4 class="heading settled" data-level="6.2.2" id="directive-report-to"><span class="secno">6.2.2. </span><span class="content"><code>report-to</code></span><a class="self-link" href="#directive-report-to"></a></h4>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="report-to"><code>report-to</code><a class="self-link" href="#report-to"></a></dfn> directive defines a <a data-link-type="dfn" href="https://mikewest.github.io/error-reporting/#group">reporting
  group</a> to which violation reports ought to be sent <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a>. The
  directive’s behavior is defined in <a href="#report-violation">§5.3 Report a violation</a>. The directive’s name
  and value are described by the following ABNF:</p>
<pre>directive-name  = "report-to"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6">token</a>
</pre>
    <h3 class="heading settled" data-level="6.3" id="directives-elsewhere"><span class="secno">6.3. </span><span class="content"> Directives Defined in Other Documents </span><a class="self-link" href="#directives-elsewhere"></a></h3>
    <p>This document defines a core set of directives, and sets up a framework for
  modular extension by other specifications. At the time this document was
  produced, the following stable documents extend CSP:</p>
    <ul>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-mix">[MIX]</a> defines <code>block-all-mixed-content</code></p>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]</a> defines <code>upgrade-insecure-requests</code></p>
     <li data-md="">
      <p><a data-link-type="biblio" href="#biblio-csp-document">[CSP-DOCUMENT]</a> defines <code>base-uri</code>, <code>form-action</code>, <code>frame-ancestors</code>, <code>plugin-types</code>, and <code>sandbox</code>.</p>
    </ul>
    <p>Extensions to CSP MUST register themselves via the process outlined in <a href="https://tools.ietf.org/html/draft-west-webappsec-csp-reg">draft-west-webappsec-csp-reg</a>.
  In particular, note the criteria discussed in Section 3.2 of that document.</p>
    <p>New directives SHOULD use the <a data-link-type="dfn" href="#directive-pre-request-check">pre-request check</a>, <a data-link-type="dfn" href="#directive-post-request-check">post-request check</a>, <a data-link-type="dfn" href="#directive-response-check">response
  check</a>, and <a data-link-type="dfn" href="#directive-initialization">initialization</a> hooks in order to
  integrate themselves into Fetch and HTML.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="security-considerations"><span class="secno">7. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    <h3 class="heading settled" data-level="7.1" id="security-nonces"><span class="secno">7.1. </span><span class="content">Nonce Reuse</span><a class="self-link" href="#security-nonces"></a></h3>
    <p>Nonces override the other restrictions present in the directive in which
  they’re delivered. It is critical, then, that they remain unguessable, as
  bypassing a resource’s policy is otherwise trivial.</p>
    <p>If a server delivers a <a data-link-type="grammar" href="#grammardef-nonce-source">nonce-source</a> expression as part of a <a data-link-type="dfn" href="#policy">policy</a>, the server MUST generate a unique value each time it
  transmits a policy. The generated value SHOULD be at least 128 bits long
  (before encoding), and SHOULD be generated via a cryptographically secure
  random number generator in order to ensure that the value is difficult for
  an attacker to predict.</p>
    <p class="note" role="note">Note: Using a nonce to whitelist inline script or style is less secure than
  not using a nonce, as nonces override the restrictions in the directive in
  which they are present. An attacker who can gain access to the nonce can
  execute whatever script they like, whenever they like. That said, nonces
  provide a substantial improvement over <a data-link-type="grammar" href="#grammardef-unsafe-inline">'unsafe-inline'</a> when
  layering a content security policy on top of old code. When considering <a data-link-type="grammar" href="#grammardef-unsafe-inline">'unsafe-inline'</a>, authors are encouraged to consider nonces
  (or hashes) instead.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="authoring-considerations"><span class="secno">8. </span><span class="content">Authoring Considerations</span><a class="self-link" href="#authoring-considerations"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="multiple-policies"><span class="secno">8.1. </span><span class="content"> The effect of multiple policies </span><a class="self-link" href="#multiple-policies"></a></h3>
    <p><em>This section is not normative.</em></p>
    <p>The above sections note that when multiple policies are present, each must be
  enforced or reported, according to its type. An example will help clarify how
  that ought to work in practice. The behavior of an <code>XMLHttpRequest</code> might seem unclear given a site that, for whatever reason, delivered the
  following HTTP headers:</p>
    <div class="example" id="example-ef0bfc7a">
     <a class="self-link" href="#example-ef0bfc7a"></a> 
<pre>Content-Security-Policy: default-src 'self' http://example.com http://example.net;
                         connect-src 'none';
Content-Security-Policy: connect-src http://example.com/;
                         script-src http://example.com/
</pre>
    </div>
    <p>Is a connection to example.com allowed or not? The short answer is that the
  connection is not allowed. Enforcing both policies means that a potential
  connection would have to pass through both unscathed. Even though the second
  policy would allow this connection, the first policy contains <code>connect-src 'none'</code>, so its enforcement blocks the connection. The
  impact is that adding additional policies to the list of policies to enforce
  can <em>only</em> further restrict the capabilities of the protected resource.</p>
    <p>To demonstrate that further, consider a script tag on this page. The first
  policy would lock scripts down to <code>'self'</code>, <code>http://example.com</code> and <code>http://example.net</code> via the <code>default-src</code> directive. The second, however,
  would only allow script from <code>http://example.com/</code>. Script will only load if
  it meets both policy’s criteria: in this case, the only origin that can match
  is <code>http://example.com</code>, as both policies allow it.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="implementation-considerations"><span class="secno">9. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation-considerations"></a></h2>
    <h3 class="heading settled" data-level="9.1" id="extensions"><span class="secno">9.1. </span><span class="content">Vendor-specific Extensions and Addons</span><a class="self-link" href="#extensions"></a></h3>
    <p><a data-link-type="dfn" href="#policy">Policy</a> enforced on a resource SHOULD NOT interfere with the operation
  of user-agent features like addons, extensions, or bookmarklets. These kinds
  of features generally advance the user’s priority over page authors, as
  espoused in <a data-link-type="biblio" href="#biblio-html-design">[HTML-DESIGN]</a>.</p>
    <p>Moreover, applying CSP to these kinds of features produces a substantial
  amount of noise in violation reports, significantly reducing their value to
  developers.</p>
    <p>Chrome, for example, excludes the <code>chrome-extension:</code> scheme from CSP checks,
  and does some work to ensure that extension-driven injections are allowed,
  regardless of a page’s policy.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <p>The permanent message header field registry should be updated
  with the following registration: <a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a></p>
    <h3 class="heading settled" data-level="10.1" id="iana-csp"><span class="secno">10.1. </span><span class="content"> Content-Security-Policy </span><a class="self-link" href="#iana-csp"></a></h3>
    <dl>
     <dt>Header field name
     <dd>Content-Security-Policy
     <dt>Applicable protocol
     <dd>http
     <dt>Status
     <dd>standard
     <dt>Author/Change controller
     <dd>W3C
     <dt>Specification document
     <dd>This specification (See <a href="#csp-header">§3.1 The Content-Security-Policy HTTP Response Header Field</a>)
    </dl>
   </section>
   <section>
    <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>Lots of people are awesome.</p>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li><a href="#grammardef-base64-value">base64-value</a><span>, in §2.2.1</span>
   <li>
    blockedURI
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-blockeduri">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-blockeduri">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#child-src">child-src</a><span>, in §6.1.1</span>
   <li><a href="#violation-column-number">column number</a><span>, in §2.3</span>
   <li>
    columnNumber
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-columnnumber">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-columnnumber">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#connect-src">connect-src</a><span>, in §6.1.2</span>
   <li><a href="#content-security-policy">Content-Security-Policy</a><span>, in §3.1</span>
   <li><a href="#content-security-policy-report-only">Content-Security-Policy-Report-Only</a><span>, in §3.2</span>
   <li><a href="#global-object-csp-list">CSP list</a><span>, in §4.2</span>
   <li><a href="#default-src">default-src</a><span>, in §6.1.3</span>
   <li><a href="#grammardef-directive-name">directive-name</a><span>, in §2.2</span>
   <li><a href="#directives">directives</a><span>, in §2.2</span>
   <li><a href="#policy-directive-set">directive set</a><span>, in §2.1</span>
   <li><a href="#grammardef-directive-value">directive-value</a><span>, in §2.2</span>
   <li><a href="#policy-disposition">disposition</a><span>, in §2.1</span>
   <li>
    documentURI
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-documenturi">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-documenturi">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li>
    effectiveDirective
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-effectivedirective">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-effectivedirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li>
    effective directive
    <ul>
     <li><a href="#violation-effective-directive">dfn for violation</a><span>, in §2.3</span>
     <li><a href="#request-effective-directive">dfn for request</a><span>, in §6.1.11.4</span>
    </ul>
   <li><a href="#embedding-document">embedding document</a><span>, in §4.2</span>
   <li><a href="#enforced">enforced</a><span>, in §4.2</span>
   <li><a href="#fetch-directives">Fetch directives</a><span>, in §6.1</span>
   <li><a href="#font-src">font-src</a><span>, in §6.1.4</span>
   <li><a href="#violation-global-object">global object</a><span>, in §2.3</span>
   <li><a href="#grammardef-hash-algorithm">hash-algorithm</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-hash-source">hash-source</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-host-char">host-char</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-host-part">host-part</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-host-source">host-source</a><span>, in §2.2.1</span>
   <li><a href="#img-src">img-src</a><span>, in §6.1.5</span>
   <li><a href="#directive-initialization">initialization</a><span>, in §2.2</span>
   <li><a href="#directive-inline-check">inline check</a><span>, in §2.2</span>
   <li><a href="#grammardef-keyword-source">keyword-source</a><span>, in §2.2.1</span>
   <li><a href="#violation-line-number">line number</a><span>, in §2.3</span>
   <li>
    lineNumber
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-linenumber">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-linenumber">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#manifest-src">manifest-src</a><span>, in §6.1.6</span>
   <li><a href="#matches-a-source-list">matches a source list</a><span>, in §2.2.1</span>
   <li><a href="#media-src">media-src</a><span>, in §6.1.7</span>
   <li><a href="#monitored">monitored</a><span>, in §4.2</span>
   <li><a href="#directive-name">name</a><span>, in §2.2</span>
   <li><a href="#grammardef-nonce-source">nonce-source</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-none">'none'</a><span>, in §2.2.1</span>
   <li><a href="#object-src">object-src</a><span>, in §6.1.8</span>
   <li>
    originalPolicy
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-originalpolicy">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-originalpolicy">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#parse-serialized-policy">parse a serialized CSP</a><span>, in §2.1</span>
   <li><a href="#grammardef-path-part">path-part</a><span>, in §2.2.1</span>
   <li><a href="#policy">policies</a><span>, in §2.1</span>
   <li>
    policy
    <ul>
     <li><a href="#policy">definition of</a><span>, in §2.1</span>
     <li><a href="#violation-policy">dfn for violation</a><span>, in §2.3</span>
    </ul>
   <li><a href="#grammardef-port-part">port-part</a><span>, in §2.2.1</span>
   <li><a href="#directive-post-request-check">post-request check</a><span>, in §2.2</span>
   <li><a href="#directive-pre-request-check">pre-request check</a><span>, in §2.2</span>
   <li>
    referrer
    <ul>
     <li><a href="#violation-referrer">dfn for violation</a><span>, in §2.3</span>
     <li><a href="#dom-securitypolicyviolationevent-referrer">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-referrer">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#report-to">report-to</a><span>, in §6.2.2</span>
   <li><a href="#report-uri">report-uri</a><span>, in §6.2.1</span>
   <li><a href="#violation-resource">resource</a><span>, in §2.3</span>
   <li><a href="#directive-response-check">response check</a><span>, in §2.2</span>
   <li><a href="#grammardef-scheme-part">scheme-part</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-scheme-source">scheme-source</a><span>, in §2.2.1</span>
   <li><a href="#script-src">script-src</a><span>, in §6.1.9</span>
   <li><a href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a><span>, in §5.3</span>
   <li><a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type, eventInitDict)</a><span>, in §5.1</span>
   <li><a href="#grammardef-self">'self'</a><span>, in §2.2.1</span>
   <li><a href="#serialized-csp">serialized CSP</a><span>, in §2.1</span>
   <li><a href="#grammardef-serialized-directive">serialized-directive</a><span>, in §2.2</span>
   <li><a href="#serialized-directive">serialized directive</a><span>, in §2.2</span>
   <li><a href="#grammardef-serialized-policy">serialized-policy</a><span>, in §2.1</span>
   <li><a href="#serialized-source-list">serialized source list</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-serialized-source-list">serialized-source-list</a><span>, in §2.2.1</span>
   <li><a href="#source-expression">source
  expression</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-source-expression">source-expression</a><span>, in §2.2.1</span>
   <li><a href="#violation-source-file">source file</a><span>, in §2.3</span>
   <li>
    sourceFile
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-sourcefile">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-sourcefile">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#source-lists">source lists</a><span>, in §2.2.1</span>
   <li><a href="#violation-status">status</a><span>, in §2.3</span>
   <li><a href="#dom-securitypolicyviolationevent-statuscode">statusCode</a><span>, in §5.1</span>
   <li><a href="#style-src">style-src</a><span>, in §6.1.10</span>
   <li><a href="#grammardef-unsafe-eval">'unsafe-eval'</a><span>, in §2.2.1</span>
   <li><a href="#grammardef-unsafe-inline">'unsafe-inline'</a><span>, in §2.2.1</span>
   <li><a href="#violation-url">url</a><span>, in §2.3</span>
   <li><a href="#directive-value">value</a><span>, in §2.2</span>
   <li>
    violatedDirective
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-violateddirective">attribute for SecurityPolicyViolationEvent</a><span>, in §5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-violateddirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in §5.1</span>
    </ul>
   <li><a href="#violation">violation</a><span>, in §2.3</span>
   <li><a href="#violation-report">violation
  report</a><span>, in §5</span>
  </ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li>
    <a data-link-type="biblio" href="#biblio-cssom">[cssom]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/cssom/#insert-a-css-rule">insert a css rule</a>
     <li><a href="http://www.w3.org/TR/cssom/#parse-a-css-declaration-block">parse a css declaration block</a>
     <li><a href="http://www.w3.org/TR/cssom/#parse-a-css-rule">parse a css rule</a>
     <li><a href="http://www.w3.org/TR/cssom/#parse-a-group-of-selectors">parse a group of selectors</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-dom">[dom]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/dom/#interface-element">Element</a>
     <li><a href="http://www.w3.org/TR/dom/#dom-node-textcontent">textContent</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a> defines the following terms:
    <ul>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-function-objects">Function()</a>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-json.stringify">JSON.stringify()</a>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-eval-x">eval()</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-body">body</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-cache-mode">cache mode</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-client">client</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode">credentials mode</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-csp-list">csp list</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-current-url">current url</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-destination">destination</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-fetch">fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-global-object">global object</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org/#http-fetch">http fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#http-network-fetch">http-network fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-initiator">initiator</a>
     <li><a href="https://fetch.spec.whatwg.org/#main-fetch">main fetch</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-method">method</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-network-error">network error</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-origin">origin</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header-parse">parse a header value</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode">redirect mode</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context">target browsing context</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-type">type</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-url">url</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-window">window</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy">content-security-policy http-equiv processing instructions</a>
     <li><a href="https://html.spec.whatwg.org/#initialising-a-new-document-object">initialising a new document object</a>
     <li><a href="https://html.spec.whatwg.org/#attr-script-nonce">nonce</a>
     <li><a href="https://html.spec.whatwg.org/#ping">ping</a>
     <li><a href="https://html.spec.whatwg.org/#run-a-worker">run a worker</a>
     <li><a href="https://html.spec.whatwg.org/#the-workers-documents">the worker's documents</a>
     <li><a href="https://html.spec.whatwg.org/#update-a-style-block">update a style block</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html5">[html5]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/html5/dom.html#document">Document</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#dom-window">Window</a>
     <li><a href="http://www.w3.org/TR/html5/text-level-semantics.html#the-a-element">a</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#active-document">active document</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document">an iframe srcdoc document</a>
     <li><a href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element">applet</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ascii case-insensitive match</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#browsing-context">browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#case-sensitive">case-sensitive</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#collect-a-sequence-of-characters">collect a sequence of characters</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content">content</a>
     <li><a href="http://www.w3.org/TR/html5/dom.html#concept-document-csp-list">csp list</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#dom-document-2">document</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element">embed</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-fire">fire</a>
     <li><a href="http://www.w3.org/TR/html5/obsolete.html#frame">frame</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#global-object">global object</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv">http-equiv</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element">iframe</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object">incumbent settings object</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element">link</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element">meta</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context">nested browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through">nested through</a>
     <li><a href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element">object</a>
     <li><a href="http://www.w3.org/TR/html5/browsers.html#opener-browsing-context">opener browsing context</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#prepare-a-script">prepare a script</a>
     <li><a href="http://www.w3.org/TR/html5/dom.html#dom-document-referrer">referrer</a>
     <li><a href="http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-global-object">relevant settings object</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#space-characters">space characters</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-commas">split a string on commas</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#split-a-string-on-spaces">split a string on spaces</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#strictly-split-a-string">strictly split a string</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace">strip leading and trailing whitespace</a>
     <li><a href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a>
     <li><a href="http://www.w3.org/TR/html5/scripting-1.html#the-script-block&apos;s-source">the script block's source</a>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#concept-event-trusted">trusted</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-oob-reporting">[OOB-REPORTING]</a> defines the following terms:
    <ul>
     <li><a href="https://mikewest.github.io/error-reporting/#group">group</a>
     <li><a href="https://mikewest.github.io/error-reporting/#queue-report">queue report</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc3986">[rfc3986]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.2.2">ipv4address</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.3">path</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-3.1">scheme</a>
     <li><a href="https://tools.ietf.org/html/rfc3986#section-4.1">uri-reference</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc4648">[rfc4648]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc4648#section-4">base64 encoding</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc5234">[rfc5234]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">alpha</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">digit</a>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">vchar</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc6454">[rfc6454]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc7230">[rfc7230]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">ows</a>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.3">rws</a>
     <li><a href="https://tools.ietf.org/html/rfc7230#section-3.2.6">token</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-rfc7231">[rfc7231]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc7231#section-3">representation</a>
     <li><a href="https://tools.ietf.org/html/rfc7231#section-3">resource representation</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-service-workers">[service-workers]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/service-workers/#service-worker-interface">ServiceWorker</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-sha2">[SHA2]</a> defines the following terms:
    <ul>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-256</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-384</a>
     <li><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#">sha-512</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-url">[url]</a> defines the following terms:
    <ul>
     <li><a href="https://url.spec.whatwg.org/#url">URL</a>
     <li><a href="https://url.spec.whatwg.org/#default-port">default port</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-host">host</a>
     <li><a href="https://url.spec.whatwg.org/#concept-ipv6">ipv6 address</a>
     <li><a href="https://url.spec.whatwg.org/#local-scheme">local scheme</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-origin">origin</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-path">path</a>
     <li><a href="https://url.spec.whatwg.org/#percent-decode">percent decode</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-port">port</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-scheme">scheme</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-parser">url parser</a>
     <li><a href="https://url.spec.whatwg.org/#concept-url-serializer">url serializer</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-workers">[workers]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/workers/#worker">Worker</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-css-cascade-4">[css-cascade-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-cascade-4/#at-ruledef-import">@import</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-dom-ls">[dom-ls]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#event">Event</a>
     <li><a href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker">SharedWorker</a>
     <li><a href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope">WorkerGlobalScope</a>
     <li><a href="https://html.spec.whatwg.org/multipage/embedded-content.html#attr-object-data">data</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-setinterval">setInterval()</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#dom-windowtimers-settimeout">setTimeout()</a>
    </ul>
  </ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-es2015"><a class="self-link" href="#biblio-es2015"></a>[ES2015]
   <dd>Allen Wirfs-Brock. <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">ECMAScript® 2015 Language Specification</a>. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/index.html">http://www.ecma-international.org/ecma-262/6.0/index.html</a>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-oob-reporting"><a class="self-link" href="#biblio-oob-reporting"></a>[OOB-REPORTING]
   <dd>Ilya Gregorik; Mike West. <a href="https://mikewest.github.io/error-reporting/">Out-of-band Reporting</a>. URL: <a href="https://mikewest.github.io/error-reporting/">https://mikewest.github.io/error-reporting/</a>
   <dt id="biblio-sha2"><a class="self-link" href="#biblio-sha2"></a>[SHA2]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4, Secure Hash Standard</a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-css-cascade-4"><a class="self-link" href="#biblio-css-cascade-4"></a>[CSS-CASCADE-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="http://www.w3.org/TR/css-cascade-4/">CSS Cascading and Inheritance Level 4</a>. 8 September 2015. WD. URL: <a href="http://www.w3.org/TR/css-cascade-4/">http://www.w3.org/TR/css-cascade-4/</a>
   <dt id="biblio-cssom"><a class="self-link" href="#biblio-cssom"></a>[CSSOM]
   <dd>Simon Pieters; Glenn Adams. <a href="http://www.w3.org/TR/cssom/">CSS Object Model (CSSOM)</a>. 5 December 2013. WD. URL: <a href="http://www.w3.org/TR/cssom/">http://www.w3.org/TR/cssom/</a>
   <dt id="biblio-dom"><a class="self-link" href="#biblio-dom"></a>[DOM]
   <dd>Anne van Kesteren; et al. <a href="http://www.w3.org/TR/dom/">W3C DOM4</a>. 19 November 2015. REC. URL: <a href="http://www.w3.org/TR/dom/">http://www.w3.org/TR/dom/</a>
   <dt id="biblio-dom-ls"><a class="self-link" href="#biblio-dom-ls"></a>[DOM-LS]
   <dd>Document Object Model URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html5"><a class="self-link" href="#biblio-html5"></a>[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc3492"><a class="self-link" href="#biblio-rfc3492"></a>[RFC3492]
   <dd>A. Costello. <a href="https://tools.ietf.org/html/rfc3492">Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</a>. March 2003. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc3492">https://tools.ietf.org/html/rfc3492</a>
   <dt id="biblio-rfc3864"><a class="self-link" href="#biblio-rfc3864"></a>[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>. September 2004. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc3864">https://tools.ietf.org/html/rfc3864</a>
   <dt id="biblio-rfc3986"><a class="self-link" href="#biblio-rfc3986"></a>[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>. January 2005. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc3986">https://tools.ietf.org/html/rfc3986</a>
   <dt id="biblio-rfc4648"><a class="self-link" href="#biblio-rfc4648"></a>[RFC4648]
   <dd>S. Josefsson. <a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
   <dt id="biblio-rfc5234"><a class="self-link" href="#biblio-rfc5234"></a>[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="https://tools.ietf.org/html/rfc5234">https://tools.ietf.org/html/rfc5234</a>
   <dt id="biblio-rfc5988"><a class="self-link" href="#biblio-rfc5988"></a>[RFC5988]
   <dd>M. Nottingham. <a href="https://tools.ietf.org/html/rfc5988">Web Linking</a>. October 2010. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5988">https://tools.ietf.org/html/rfc5988</a>
   <dt id="biblio-rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc7230"><a class="self-link" href="#biblio-rfc7230"></a>[RFC7230]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7230">https://tools.ietf.org/html/rfc7230</a>
   <dt id="biblio-rfc7231"><a class="self-link" href="#biblio-rfc7231"></a>[RFC7231]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>. June 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7231">https://tools.ietf.org/html/rfc7231</a>
   <dt id="biblio-service-workers"><a class="self-link" href="#biblio-service-workers"></a>[SERVICE-WORKERS]
   <dd>Alex Russell; Jungkee Song; Jake Archibald. <a href="http://www.w3.org/TR/service-workers/">Service Workers</a>. 25 June 2015. WD. URL: <a href="http://www.w3.org/TR/service-workers/">http://www.w3.org/TR/service-workers/</a>
   <dt id="biblio-url"><a class="self-link" href="#biblio-url"></a>[URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="http://www.w3.org/TR/url-1/">URL</a>. 9 December 2014. WD. URL: <a href="http://www.w3.org/TR/url-1/">http://www.w3.org/TR/url-1/</a>
   <dt id="biblio-workers"><a class="self-link" href="#biblio-workers"></a>[WORKERS]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/workers/">Web Workers</a>. 24 September 2015. WD. URL: <a href="http://www.w3.org/TR/workers/">http://www.w3.org/TR/workers/</a>
  </dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-csp-document"><a class="self-link" href="#biblio-csp-document"></a>[CSP-DOCUMENT]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-csp/document/">Content Security Policy: Document Features</a>. URL: <a href="https://w3c.github.io/webappsec-csp/document/">https://w3c.github.io/webappsec-csp/document/</a>
   <dt id="biblio-csp2"><a class="self-link" href="#biblio-csp2"></a>[CSP2]
   <dd>Mike West; Adam Barth; Daniel Veditz. <a href="http://www.w3.org/TR/CSP2/">Content Security Policy Level 2</a>. 21 July 2015. CR. URL: <a href="http://www.w3.org/TR/CSP2/">http://www.w3.org/TR/CSP2/</a>
   <dt id="biblio-html-design"><a class="self-link" href="#biblio-html-design"></a>[HTML-DESIGN]
   <dd>Anne Van Kesteren; Maciej Stachowiak. <a href="http://www.w3.org/TR/html-design-principles/">HTML Design Principles</a>. URL: <a href="http://www.w3.org/TR/html-design-principles/">http://www.w3.org/TR/html-design-principles/</a>
   <dt id="biblio-mix"><a class="self-link" href="#biblio-mix"></a>[MIX]
   <dd>Mike West. <a href="http://www.w3.org/TR/mixed-content/">Mixed Content</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/mixed-content/">http://www.w3.org/TR/mixed-content/</a>
   <dt id="biblio-timing"><a class="self-link" href="#biblio-timing"></a>[TIMING]
   <dd>Paul Stone. <a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">Pixel Perfect Timing Attacks with HTML5</a>. URL: <a href="http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf">http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf</a>
   <dt id="biblio-xhr"><a class="self-link" href="#biblio-xhr"></a>[XHR]
   <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/">XMLHttpRequest Standard</a>. Living Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
   <dt id="biblio-appmanifest"><a class="self-link" href="#biblio-appmanifest"></a>[APPMANIFEST]
   <dd>Marcos Caceres; et al. <a href="http://www.w3.org/TR/appmanifest/">Web App Manifest</a>. 15 December 2015. WD. URL: <a href="http://www.w3.org/TR/appmanifest/">http://www.w3.org/TR/appmanifest/</a>
   <dt id="biblio-beacon"><a class="self-link" href="#biblio-beacon"></a>[BEACON]
   <dd>Ilya Grigorik; et al. <a href="http://www.w3.org/TR/beacon/">Beacon</a>. 9 December 2015. WD. URL: <a href="http://www.w3.org/TR/beacon/">http://www.w3.org/TR/beacon/</a>
   <dt id="biblio-eventsource"><a class="self-link" href="#biblio-eventsource"></a>[EVENTSOURCE]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/eventsource/">Server-Sent Events</a>. 3 February 2015. REC. URL: <a href="http://www.w3.org/TR/eventsource/">http://www.w3.org/TR/eventsource/</a>
   <dt id="biblio-upgrade-insecure-requests"><a class="self-link" href="#biblio-upgrade-insecure-requests"></a>[UPGRADE-INSECURE-REQUESTS]
   <dd>Mike West. <a href="http://www.w3.org/TR/upgrade-insecure-requests/">Upgrade Insecure Requests</a>. 8 October 2015. CR. URL: <a href="http://www.w3.org/TR/upgrade-insecure-requests/">http://www.w3.org/TR/upgrade-insecure-requests/</a>
   <dt id="biblio-websockets"><a class="self-link" href="#biblio-websockets"></a>[WEBSOCKETS]
   <dd>Ian Hickson. <a href="http://www.w3.org/TR/websockets/">The WebSocket API</a>. 20 September 2012. CR. URL: <a href="http://www.w3.org/TR/websockets/">http://www.w3.org/TR/websockets/</a>
   <dt id="biblio-xslt"><a class="self-link" href="#biblio-xslt"></a>[XSLT]
   <dd>James Clark. <a href="http://www.w3.org/TR/xslt">XSL Transformations (XSLT) Version 1.0</a>. 16 November 1999. REC. URL: <a href="http://www.w3.org/TR/xslt">http://www.w3.org/TR/xslt</a>
  </dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl">[<a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">Constructor</a>(DOMString <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type">type</a>, optional <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a> <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict">eventInitDict</a>)]
interface <a class="idl-code" data-link-type="interface" href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event">Event</a> {
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-documenturi">documentURI</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-referrer">referrer</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-blockeduri">blockedURI</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-violateddirective">violatedDirective</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-originalpolicy">originalPolicy</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-sourcefile">sourceFile</a>;
    readonly    attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-securitypolicyviolationevent-statuscode">statusCode</a>;
    readonly    attribute long      <a data-readonly="" data-type="long      " href="#dom-securitypolicyviolationevent-linenumber">lineNumber</a>;
    readonly    attribute long      <a data-readonly="" data-type="long      " href="#dom-securitypolicyviolationevent-columnnumber">columnNumber</a>;
};

dictionary <a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit">EventInit</a> {
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-documenturi">documentURI</a>;
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-referrer">referrer</a>;
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-blockeduri">blockedURI</a>;
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-violateddirective">violatedDirective</a>;
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-effectivedirective">effectiveDirective</a>;
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-originalpolicy">originalPolicy</a>;
    DOMString <a data-type="DOMString " href="#dom-securitypolicyviolationeventinit-sourcefile">sourceFile</a>;
    long      <a data-type="long      " href="#dom-securitypolicyviolationeventinit-linenumber">lineNumber</a>;
    long      <a data-type="long      " href="#dom-securitypolicyviolationeventinit-columnnumber">columnNumber</a>;
};

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Is this kind of thing specified anywhere? I didn’t see anything
  that looked useful in <a data-link-type="biblio" href="#biblio-es2015">[ES2015]</a>.<a href="#issue-f447ede5"> ↵ </a></div>
   <div class="issue"> How, exactly, do we get the status code? We don’t actually store it
  anywhere.<a href="#issue-99576800"> ↵ </a></div>
   <div class="issue"> Why <code>sandbox</code>? Can we loosen that?<a href="#issue-6521ca1c"> ↵ </a></div>
   <div class="issue"> The algorithm is named "creating a new <code>Document</code> object" in W3C’s
  HTML, and isn’t well-integrated with Fetch.<a href="#issue-106a0c5c"> ↵ </a></div>
   <div class="issue"> Need to monkey-patch these in: something like "Set the <code>Window</code> object’s <code>CSP list</code> to the <code>CSP list</code> of the resource used to
  generate the document.<a href="#issue-7fd49562"> ↵ </a></div>
   <div class="issue"> The <a data-link-type="dfn" href="https://html.spec.whatwg.org/#update-a-style-block">update a <code>style</code> block</a> algorithm does not exist in
  W3C’s HTML.<a href="#issue-f40dd242"> ↵ </a></div>
   <div class="issue"> The <code>nonce</code> attribute for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element">script</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element">style</a></code> were added to
  WHATWG’s HTML in <a href="https://github.com/whatwg/html/commit/882803c4cc8fba2fa5472b76f628d95cc82c421d">whatwg/html@882803c</a>.
  They have not yet been added to W3C’s HTML.<a href="#issue-141323ad"> ↵ </a></div>
   <div class="issue"> The <a href="#should-block-inline">§4.2.3 Should element’s inline type behavior be blocked by Content Security Policy?</a> hooks were added to WHATWG’s HTML in <a href="https://github.com/whatwg/html/commit/ee3486eb129bc350b5ca684d0c91dff23453ac1a">whatwg/html@ee3486e</a>.
  They aren’t yet in W3C’s HTML.<a href="#issue-af0c6074"> ↵ </a></div>
   <div class="issue"> This hook is in-flight for WHATWG’s HTML. <a href="https://github.com/WHATWG/html/issues/384">&lt;https://github.com/WHATWG/html/issues/384></a><a href="#issue-73064ff2"> ↵ </a></div>
   <div class="issue"> This processing was added to WHATWG’s HTML in <a href="https://github.com/whatwg/html/commit/5064a629f22bef29839ab4dc6f1ceef17f010bc5">whatwg/html@5064a62</a>.
  It has not yet been added to W3C’s HTML.<a href="#issue-389933ec"> ↵ </a></div>
   <div class="issue"> TODO.<a href="#issue-95f2d23a"> ↵ </a></div>
   <div class="issue"> TODO.<a href="#issue-95f2d23a0"> ↵ </a></div>
   <div class="issue"> Do something interesting to the execution context in order to lock down <code>eval()</code>, et al. I don’t think ECMA gives us any hooks here, so let’s work
  with them to put something reasonable together.<a href="#issue-2b1bf0aa"> ↵ </a></div>
   <div class="issue"> This needs to be better explained.<a href="#issue-ba1a0a35"> ↵ </a></div>
   <div class="issue"> Do something interesting to the execution context in order to lock down
  interesting CSSOM algorithms. I don’t think CSSOM gives us any hooks here, so
  let’s work with them to put something reasonable together.<a href="#issue-eba1ebc1"> ↵ </a></div>
  </div>
 </body>
</html>