<!DOCTYPE html><html lang=en><head>
  <meta content="text/html; charset=utf-8" http-equiv=Content-Type>
  <title>Mixed Content</title>
  <link href=./default.css rel=stylesheet type=text/css>
  <link href=https://www.w3.org/StyleSheets/TR/W3C-WD rel=stylesheet type=text/css>
</head>
<body class=h-entry>
<div class=head>
  <p data-fill-with=logo><a class=logo href=http://www.w3.org/>
    <img alt=W3C height=48 src=https://www.w3.org/Icons/w3c_home width=72>
</a>
</p>
  <h1 class="p-name no-ref" id=title>Mixed Content</h1>
  <h2 class="no-num no-toc no-ref heading settled" id=subtitle><span class=content>W3C Last Call Working Draft,
    <span class=dt-updated><span class=value-title title=20141113>13 November 2014</span></span></span></h2>
  <div data-fill-with=spec-metadata><dl><dt>This version:<dd><a class=u-url href=http://www.w3.org/TR/2014/WD-mixed-content-20141113/>http://www.w3.org/TR/2014/WD-mixed-content-20141113/</a><dt>Latest version:<dd><a href=http://www.w3c.org/TR/mixed-content/>http://www.w3c.org/TR/mixed-content/</a><dt>Editor's Draft:<dd><a href=https://w3c.github.io/webappsec/specs/mixedcontent/>https://w3c.github.io/webappsec/specs/mixedcontent/</a><dt>Previous Versions:<dd><a href=http://www.w3.org/TR/2014/WD-mixed-content-20140722/ rel=previous>http://www.w3.org/TR/2014/WD-mixed-content-20140722/</a><dt>Version History:<dd><a href=https://github.com/w3c/webappsec/commits/master/specs/mixedcontent/index.src.html>https://github.com/w3c/webappsec/commits/master/specs/mixedcontent/index.src.html</a><dt>Feedback:<dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BMIX%5D%20feedback">public-webappsec@w3.org</a> with subject line “<kbd>[MIX] <var>… message topic …</var></kbd>” (<a href=http://lists.w3.org/Archives/Public/public-webappsec/ rel=discussion>archives</a>)</span><dt class=editor>Editor:<dd class=editor><div class="p-author h-card vcard"><a class="p-name fn u-email email" href=mailto:mkwst@google.com>Mike West</a> (<span class="p-org org">Google Inc.</span>)</div></dl></div>
  <div data-fill-with=warning></div>
  <p class=copyright data-fill-with=copyright><a href=http://www.w3.org/Consortium/Legal/ipr-notice#Copyright>Copyright</a> © 2014
  <a href=http://www.w3.org/><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
  (<a href=http://www.csail.mit.edu/><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
  <a href=http://www.ercim.eu/><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
  <a href=http://www.keio.ac.jp/>Keio</a>, <a href=http://ev.buaa.edu.cn/>Beihang</a>),

  All Rights Reserved.

  <abbr title="World Wide Web Consortium">W3C</abbr> <a href=http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer>liability</a>,
  <a href=http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks>trademark</a> and

  <a href=http://www.w3.org/Consortium/Legal/copyright-documents>document use</a>
  rules apply.
</p>
  <hr title="Separator for header">
</div>

<h2 class="no-num no-toc no-ref heading settled" id=abstract><span class=content>Abstract</span></h2>
<div class=p-summary data-fill-with=abstract><p>This specification describes how user agents should handle rendering and execution of content loaded over unencrypted or unauthenticated connections in the context of an encrypted and authenticated document.</p>

</div>

<h2 class="no-num no-toc no-ref heading settled" id=status><span class=content>Status of this document</span></h2>
<div data-fill-with=status>
  <em>This section describes the status of this document at the time of
  its publication. Other documents may supersede this document. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the <a href=http://www.w3.org/TR/>W3C technical reports
  index at http://www.w3.org/TR/.</a></em>

<p>
  This document was published by the
  <a href=http://www.w3.org/2011/webappsec/>Web Application Security Working Group</a>
  as a Working Draft. This document is intended to become a W3C Recommendation. 

<p>
	The (<a href=http://lists.w3.org/Archives/Public/public-webappsec/>archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BMIX%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href=http://www.w3.org/Mail/Request>instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “MIX” in the subject,
	preferably like this:
	“[MIX] <em>…summary of comment…</em>”
  
<p>
  Publication as a Last Call Working Draft does not imply endorsement by the W3C
  Membership. This is a draft document and may be updated, replaced or
  obsoleted by other documents at any time. It is inappropriate to cite this
  document as other than work in progress.

<p>
	This document was produced by the
  <a href=http://www.w3.org/2011/webappsec/>Web Application Security Working Group</a>.

<p>
	This document was produced by a group operating under
	the <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/>5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href=http://www.w3.org/2004/01/pp-impl/49309/status rel=disclosure>public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential>Essential Claim(s)</a>
	must disclose the information in accordance with <a href=http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure>section 6 of the W3C Patent Policy</a>.

<p>
  This specification is a <strong>Last Call Working Draft</strong>. All
  persons are encouraged to review this document and <strong>send comments
  to the <a href=http://lists.w3.org/Archives/Public/public-webappsec/>public-webappsec</a>
  mailing list</strong> as described above. The <strong>deadline for
  comments</strong> is <strong>11 December 2014</strong>.

<p>
  This document is governed by the <a href=http://www.w3.org/2014/Process-20140801/ id=w3c_process_revision>1 August 2014 W3C Process Document</a>.
</div>
<div data-fill-with=at-risk></div>

<h2 class="no-num no-toc no-ref heading settled" id=contents><span class=content>Table of Contents</span></h2>
<div data-fill-with=table-of-contents role=navigation><ul class=toc role=directory><li><a href=#intro><span class=secno>1</span> <span class=content>Introduction</span></a><li><a href=#terms><span class=secno>2</span> <span class=content>Key Concepts and Terminology</span></a><ul class=toc><li><a href=#terms-defined-here><span class=secno>2.1</span> <span class=content>Terms defined by this specification</span></a><li><a href=#terms-defined-by-reference><span class=secno>2.2</span> <span class=content>Terms defined by reference</span></a></ul><li><a href=#categories><span class=secno>3</span> <span class=content>Content Categories</span></a><ul class=toc><li><a href=#category-optionally-blockable><span class=secno>3.1</span> <span class=content>Optionally-blockable Content</span></a><li><a href=#category-blockable><span class=secno>3.2</span> <span class=content>Blockable Content</span></a><li><a href=#categories-unknown-content><span class=secno>3.3</span> <span class=content>Future Contexts</span></a></ul><li><a href=#requirements><span class=secno>4</span> <span class=content>User Agent Requirements</span></a><ul class=toc><li><a href=#requirements-fetching><span class=secno>4.1</span> <span class=content>Resource Fetching</span></a><li><a href=#requirements-script><span class=secno>4.2</span> <span class=content>Script APIs</span></a><li><a href=#requirements-forms><span class=secno>4.3</span> <span class=content>Form Submission</span></a><li><a href=#requirements-ux><span class=secno>4.4</span> <span class=content>UI Requirements</span></a><li><a href=#requirements-user-controls><span class=secno>4.5</span> <span class=content>User Controls</span></a></ul><li><a href=#algorithms><span class=secno>5</span> <span class=content>Insecure Content in Secure Contexts</span></a><ul class=toc><li><a href=#categorize-settings-object><span class=secno>5.1</span> <span class=content>
      Does <var>settings object</var> restrict mixed content?
    </span></a><li><a href=#should-block-fetch><span class=secno>5.2</span> <span class=content>
      Should fetching <var>request</var> be blocked as mixed content?
    </span></a><li><a href=#should-block-response><span class=secno>5.3</span> <span class=content>
      Should <var>response</var> to <var>request</var> be blocked as mixed
      content?
    </span></a></ul><li><a href=#powerful-features><span class=secno>6</span> <span class=content>
    Secure Contexts for Powerful Features
  </span></a><ul class=toc><li><a href=#may-document-use-powerful-features><span class=secno>6.1</span> <span class=content>
      May <var>Document</var> use powerful features?
    </span></a><li><a href=#settings-powerful-features><span class=secno>6.2</span> <span class=content>
      May <var>environment settings object</var> use powerful features?
    </span></a><li><a href=#is-origin-trusted><span class=secno>6.3</span> <span class=content>
      Is <var>origin</var> potentially trusted?
    </span></a></ul><li><a href=#fetch-integration><span class=secno>7</span> <span class=content>Integration with Fetch</span></a><li><a href=#websockets-integration><span class=secno>8</span> <span class=content>Modifications to WebSockets</span></a><li><a href=#acknowledgements><span class=secno>9</span> <span class=content>Acknowledgements</span></a><li><a href=#conformance><span class=secno></span> <span class=content>Conformance</span></a><ul class=toc><li><a href=#conventions><span class=secno></span> <span class=content>Document conventions</span></a><li><a href=#conformant-algorithms><span class=secno></span> <span class=content>Conformant Algorithms</span></a><li><a href=#conformance-classes><span class=secno></span> <span class=content>Conformance Classes</span></a></ul><li><a href=#references><span class=secno></span> <span class=content>References</span></a><ul class=toc><li><a href=#normative><span class=secno></span> <span class=content>Normative References</span></a><li><a href=#informative><span class=secno></span> <span class=content>Informative References</span></a></ul><li><a href=#index><span class=secno></span> <span class=content>Index</span></a></ul></div>
<main>











<section>
  <h2 class="heading settled" data-level=1 id=intro><span class=secno>1. </span><span class=content>Introduction</span><a class=self-link href=#intro></a></h2>

<p><em>This section is not normative.</em></p>

<p>When a user successfully loads a resource from example.com over a secure
  channel (HTTPS, for example), the user agent is able to make three assertions
  critical to the user’s security and privacy:</p>

  <ul>
    <li>
      The user is communicating with a server that is allowed to claim to be
      <code>example.com</code>, and not one of the many, many servers through
      which her request has hopped. The connection can be
      <strong>authenticated</strong>.
    </li>
    <li>
      The user’s communications with <code>example.com</code> cannot be
      trivially eavesdropped upon by middlemen, because the requests she makes
      and the responses she receives are <strong>encrypted</strong>.
    </li>
    <li>
      The user’s communications with <code>example.com</code> cannot be
      trivially modified by middlemen, the encryption and authentication
      provide a guarantee of <strong>data integrity</strong>.
    </li>
  </ul>

<p>Together, these assertions give the user some assurance that
  <code>example.com</code> is the only entity that can read and respond to her
  requests (caveat: without shocking amounts of work) and that the bits she’s
  receiving are indeed those that <code>example.com</code> actually sent.</p>

<p>The strength of these assertions is substantially weakened, however, when
  the encrypted and authenticated resource requests subresources (scripts,
  images, etc) over an insecure channel. Those resource requests result in a
  resource whose status is mixed, as insecure requests are wide open for
  man-in-the-middle attacks. This scenario is unfortunately quite common.</p>

<p>This specification details how user agents can mitigate these risks to
  security and privacy by limiting a resource’s ability to inadvertently
  communicate in the clear.</p>

<p class=note role=note>Note: Nothing described in this document is really new; everything covered
  here has appeared in one or more user agents over the years: Internet Explorer
  led the way, alerting users to mixed content since at least version 4.</p>
</section>


<section>
  <h2 class="heading settled" data-level=2 id=terms><span class=secno>2. </span><span class=content>Key Concepts and Terminology</span><a class=self-link href=#terms></a></h2>

  <h3 class="heading settled" data-level=2.1 id=terms-defined-here><span class=secno>2.1. </span><span class=content>Terms defined by this specification</span><a class=self-link href=#terms-defined-here></a></h3>
  <dl>
    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=mixed id=mixed-content>mixed content<a class=self-link href=#mixed-content></a></dfn>
    </dt>
    <dd>
      A resource is said to be <strong>mixed content</strong> if the resource’s
      <a data-link-type=dfn href=#origin title=origin>origin</a> is <a data-link-type=dfn href=#insecure-origin title=insecure>insecure</a>, <strong>and</strong> the the context
      responsible for loading it <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts mixed content</a>.

      <div class=example>
        The image <code>http://example.com/image.png</code> is <strong>mixed
        content</strong> when loaded by
        <code>https://not.example.com/</code>.

<p>The image <code>http://127.0.0.1/image.png</code> is <strong>mixed
        content</strong> when loaded by <code>http://example.com/</code>.</p>
      </div>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title="potentially secure" id=potentially-secure-origin>
        potentially secure origin
      <a class=self-link href=#potentially-secure-origin></a></dfn>
    </dt>
    <dt>
      <dfn data-dfn-type=dfn data-export="" id=potentially-secure-url>
        potentially secure URL
      <a class=self-link href=#potentially-secure-url></a></dfn>
    </dt>
    <dd>
      An <a data-link-type=dfn href=#origin title=origin>origin</a> is said to be <strong>potentially secure</strong>
      if the origin’s scheme component is <code>HTTPS</code>, <code>WSS</code>,
      or <code>about</code>.

<p>A URL whose <a data-link-type=dfn href=#origin title=origin>origin</a> is potentially secure is itself considered to
      be potentially secure.</p>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title="a priori insecure" id=a-priori-insecure-origin>
        <em>a priori</em> insecure origin
      <a class=self-link href=#a-priori-insecure-origin></a></dfn>
    </dt>
    <dt>
      <dfn data-dfn-type=dfn data-export="" id=a-priori-insecure-url>
        <em>a priori</em> insecure URL
      <a class=self-link href=#a-priori-insecure-url></a></dfn>
    </dt>
    <dd>
      Any <a data-link-type=dfn href=#origin title=origin>origin</a> which is not <a data-link-type=dfn href=#potentially-secure-origin title="potentially secure">potentially secure</a> is said to
      be <strong><em>a priori</em> insecure</strong>. We know, for example, that
      <code>http://example.com/</code> is insecure just by looking at its scheme
      component.

<p>A URL whose <a data-link-type=dfn href=#origin title=origin>origin</a> is <em>a priori</em> insecure is itself
      considered to be <em>a priori</em> insecure.</p>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=insecure id=insecure-origin>
        insecure origin
      <a class=self-link href=#insecure-origin></a></dfn>
    </dt>
    <dt>
      <dfn data-dfn-type=dfn data-export="" id=insecure-url>
        insecure URL
      <a class=self-link href=#insecure-url></a></dfn>
    </dt>
    <dd>
      An resource’s origin is said to be <strong>insecure</strong> if it is
      either <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure"><em>a priori</em> insecure</a>, or the user agent discovers
      only after performing a TLS-handshake that the TLS-protection offered
      is either <a data-link-type=dfn href=#weakly-tls-protected title=weak>weak</a> or <a data-link-type=dfn href=#deprecated-tls-protection title=deprecated>deprecated</a>.

<p>A URL whose <a data-link-type=dfn href=#origin title=origin>origin</a> is insecure is itself considered to be insecure.</p>
    </dd>

    <dt>
      <dfn data-dfn-type=dfn data-export="" data-local-title=deprecated id=deprecated-tls-protection>
        deprecated TLS-protection
      <a class=self-link href=#deprecated-tls-protection></a></dfn>
    </dt>
    <dd>
      A resource’s TLS-protection is said to be <strong>deprecated</strong>
      if it is not <a data-link-type=dfn href=#weakly-tls-protected title="weakly TLS-protected">weakly TLS-protected</a>, but the user agent chooses to
      refuse it anyway. This determination is vendor-specific.

<p>For example, a user agent may choose to reject resources for which the
      server presented a publicly-trusted certificate for an "Internal
      Name" (e.g. <code>https://intranet/</code>), a certificate with an
      overly-long validity period, a certificate signed with SHA-1, or a
      certificate which otherwise fails to meet the
      <a href=https://cabforum.org/baseline-requirements-documents/>
      CA/Browser Forum’s Baseline Requirements</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-cab title=CAB>[CAB]</a></p>

<p class=note role=note>Note: We recommend that user agents return network errors rather than
      fetching resources whose TLS-protection is deprecated.</p>
    </dd>
  </dl>

  <h3 class="heading settled" data-level=2.2 id=terms-defined-by-reference><span class=secno>2.2. </span><span class=content>Terms defined by reference</span><a class=self-link href=#terms-defined-by-reference></a></h3>
  <dl>
    <dt><dfn data-dfn-type=dfn data-noexport="" id=tls-protected>TLS-protected<a class=self-link href=#tls-protected></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title=weak data-noexport="" id=weakly-tls-protected>weakly TLS-protected<a class=self-link href=#weakly-tls-protected></a></dfn></dt>
    <dd>
      These terms are defined in
      <a href=http://www.w3.org/TR/2010/REC-wsc-ui-20100812/#typesoftls>§5.2
      of "Web Security Context: User Interface Guidelines"</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-wsc-ui title=WSC-UI>[WSC-UI]</a>.
      A resource is <strong>TLS-protected</strong> when it is delivered over an
      encrypted channel. <strong>Weakly TLS-protected</strong> refers to a
      subset of those resources delivered over a channel that doesn’t offer
      strong protection of the content.

<p>For example, resources would be considered weakly TLS-protected when
      delivered by a server presenting a self-signed certificate which does not
      chain to a root certificate in the user agent’s local trust store, as
      such a certificate only weakly authenticates the server. Similarly, a
      server which negotiates down to a weak cipher suite (such as
      <code>TLS_RSA_WITH_NULL_MD5</code>) would only weakly protect resources
      it serves.</p>

<p class=note role=note>Note: We recommend that user agents return network errors rather than
      fetching resources whose TLS-protection is weak.</p>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=origin>origin<a class=self-link href=#origin></a></dfn></dt>
    <dd>
      An origin defines the scope of authority or privilege under which a
      resource operates. It is defined in detail in the Origin specification.
      <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6454 title=RFC6454>[RFC6454]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=globally-unique-identifier>globally unique identifier<a class=self-link href=#globally-unique-identifier></a></dfn></dt>
    <dd>
      This term is defined in
      <a href=http://tools.ietf.org/html/rfc6454#section-4>Section 4 of
      RFC6454</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6454 title=RFC6454>[RFC6454]</a>

<p class=note role=note>Note: URLs that do not use
      <a href=http://tools.ietf.org/html/rfc3986#section-3.2>hierarchical
      elements</a> as naming authorities (for example: <code>blob:</code>, and
      <code>data:</code>) have origins which are globally unique identifiers.
      <a data-biblio-type=informative data-link-type=biblio href=#biblio-uri title=URI>[URI]</a></p>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=fetch>fetch<a class=self-link href=#fetch></a></dfn></dt>
    <dd>
      "fetching" is the process by which a user agent requests resources, and
      delivers responses. It is defined in detail in the Fetch living standard.
      <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=FETCH>[FETCH]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=request>request<a class=self-link href=#request></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title=client data-noexport="" id=request-client>request client<a class=self-link href=#request-client></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title=context data-noexport="" id=request-context>request context<a class=self-link href=#request-context></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title="frame type" data-noexport="" id=request-context-frame-type>request context frame type<a class=self-link href=#request-context-frame-type></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-local-title="tls state" data-noexport="" id=request-client-tls-state>request client TLS state<a class=self-link href=#request-client-tls-state></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-noexport="" id=response-tls-state>response TLS state<a class=self-link href=#response-tls-state></a></dfn></dt>
    <dd>
      These terms are defined in
      <a href=http://fetch.spec.whatwg.org/#requests>Section 2.2</a> of the
      Fetch living standard. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=FETCH>[FETCH]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=response>response<a class=self-link href=#response></a></dfn></dt>
    <dt><dfn data-dfn-type=dfn data-noexport="" id=network-error>network error<a class=self-link href=#network-error></a></dfn></dt>
    <dd>
      These terms are defined in detail in
      <a href=http://fetch.spec.whatwg.org/#responses>Section 2.3</a> of the
      Fetch living standard. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=FETCH>[FETCH]</a>
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=environment-settings-object>environment settings object<a class=self-link href=#environment-settings-object></a></dfn></dt>
    <dd>
      Defined in <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=HTML5>[HTML5]</a>.
    </dd>

    <dt><dfn data-dfn-type=dfn data-noexport="" id=embedding-document>embedding document<a class=self-link href=#embedding-document></a></dfn></dt>
    <dd>
      Given a <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code> <var>A</var>, the <strong>embedding
      document</strong> of <var>A</var> is the <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code>
      <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#browsing-context-nested-through title="nested through">through which</a> <var>A</var>’s <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#browsing-context title="browsing context">browsing
      context</a> is nested.
    </dd>
  </dl>
</section>


<section>
  <h2 class="heading settled" data-level=3 id=categories><span class=secno>3. </span><span class=content>Content Categories</span><a class=self-link href=#categories></a></h2>

<p>In a perfect world, user agents would be required to block all <a data-link-type=dfn href=#mixed-content title="mixed content">mixed
  content</a> without exception. Unfortunately, that is impractical on today’s
  internet. For instance, a survey in 2013 notes that blocking mixed content
  would break around ~43% of secure websites in one way or another
  <a data-biblio-type=informative data-link-type=biblio href=#biblio-dangerous-mix title=DANGEROUS-MIX>[DANGEROUS-MIX]</a>. Draconian blocking policies applied to some types of mixed
  content are (for the moment) infeasible. User agents need to be more nuanced
  in their restrictions.</p>

<p>With that in mind, we here split mixed content into two categories defined in
  the following two sections: <a data-section="" href=#category-blockable>§3.2 Blockable Content</a> and
  <a data-section="" href=#category-optionally-blockable>§3.1 Optionally-blockable Content</a>.</p>

<p>Future versions of this specification will update these categories with
  the intent of moving towards a world where all <a data-link-type=dfn href=#mixed-content title=mixed>mixed</a> content is
  blocked; that is the end goal, but this is the best we can do for now.</p>

  <section>
    <h3 class="heading settled" data-level=3.1 id=category-optionally-blockable><span class=secno>3.1. </span><span class=content>Optionally-blockable Content</span><a class=self-link href=#category-optionally-blockable></a></h3>

<p>A resource is considered
    <dfn data-dfn-type=dfn data-local-title=optionally-blockable data-noexport="" id=optionally-blockable-content>optionally-blockable content<a class=self-link href=#optionally-blockable-content></a></dfn>
    when the risk of allowing its usage as <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> is outweighed by
    the risk of breaking significant portions of the web. This could be because
    mixed usage of the resource type is sufficiently high, or because the resource
    is very clearly low-risk in and of itself. This category of content includes:</p>

    <ul>
      <li>
        Images loaded via <a data-link-type=element href=https://html.spec.whatwg.org/#the-img-element title=img>img</a>

<p class=note role=note>Note: This includes SVG documents loaded as images.</p>
      </li>
      <li>
        Video loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element title=video>video</a> and <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element title=source>source</a>
      </li>
      <li>
        Audio loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-audio-element title=audio>audio</a> and <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element title=source>source</a>
      </li>
      <li>
        <a href=http://www.w3.org/TR/html5/links.html#link-type-prefetch>Prefetched</a>
        content <a data-biblio-type=normative data-link-type=biblio href=#biblio-html5 title=HTML5>[HTML5]</a>
      </li>
    </ul>

<p>These resource types map to the following Fetch <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a>:
    <code>audio</code>, <code>image</code>, <code>prefetch</code>, and
    <code>video</code>. These contexts are <dfn data-dfn-type=dfn data-noexport="" id=optionally-blockable-request-contexts>optionally-blockable request
    contexts<a class=self-link href=#optionally-blockable-request-contexts></a></dfn>.</p>

<p class=note role=note>Note: The fact that these resource types are optionally-blockable does not
    mean that they are <em>safe</em>, simply that they’re less catastrophically
    dangerous than other resource types. For example, images and icons are often
    the central UI elements in an application’s interface. If an attacker
    reversed the "Delete email" and "Reply" icons, there would be real impact on
    users.</p>

<p class=note role=note>Note: We further limit this category in <a data-section="" href=#should-block-fetch>§5.2 
      Should fetching request be blocked as mixed content?
    </a> by
    force-failing any CORS-enabled request. This means that mixed content images
    loaded via <code>&lt;img crossorigin ...&gt;</code> will be blocked. This is
    a good example of the general principle that a category of content falls
    into this category <em>only</em> when it is too widely used to be blocked
    outright. The working group intends to find more blockable subsets of an
    otherwise <a data-link-type=dfn href=#optionally-blockable-request-contexts title="optionally-blockable request context">optionally-blockable request context</a>.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.2 id=category-blockable><span class=secno>3.2. </span><span class=content>Blockable Content</span><a class=self-link href=#category-blockable></a></h3>

<p>Any resource that isn’t <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a> is considered
    <dfn data-dfn-type=dfn data-local-title=blockable data-noexport="" id=blockable-content>blockable content<a class=self-link href=#blockable-content></a></dfn>.
    A non-exhaustive sample of content that falls into this category includes:</p>

    <ul>
      <li>
        Scripts (loaded, for example, via <a data-link-type=element href=http://www.w3.org/TR/html5/scripting-1.html#the-script-element title=script>script</a> elements, as
        well as scripts loaded as Workers and SharedWorkers <a data-biblio-type=informative data-link-type=biblio href=#biblio-workers title=WORKERS>[WORKERS]</a>, or
        ServiceWorkers <a data-biblio-type=informative data-link-type=biblio href=#biblio-serviceworkers title=SERVICEWORKERS>[SERVICEWORKERS]</a>) <a data-biblio-type=informative data-link-type=biblio href=#biblio-ecma-262 title=ECMA-262>[ECMA-262]</a>
      </li>
      <li>Stylesheets <a data-biblio-type=informative data-link-type=biblio href=#biblio-css21 title=CSS21>[CSS21]</a></li>
      <li>
        <a data-link-type=dfn href=http://www.w3.org/TR/html5/infrastructure.html#plugin title=Plugin>Plugin</a> data (loaded, for example, through
        <a data-link-type=element href=https://html.spec.whatwg.org/#the-applet-element title=applet>applet</a>, <a data-link-type=element href=https://html.spec.whatwg.org/#the-embed-element title=embed>embed</a>, or <a data-link-type=element href=https://html.spec.whatwg.org/#the-object-element title=object>object</a>
        elements; or through a <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#plugin-document title="plugin document">plugin document</a> loaded into an
        <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element title=iframe>iframe</a> or <a data-link-type=element href=http://www.w3.org/TR/html5/obsolete.html#frame title=frame>frame</a> element) <a data-biblio-type=informative data-link-type=biblio href=#biblio-html5 title=HTML5>[HTML5]</a>
      </li>
      <li>SVG Documents <a data-biblio-type=informative data-link-type=biblio href=#biblio-svg2 title=SVG2>[SVG2]</a></li>
      <li>XSL Transformations <a data-biblio-type=informative data-link-type=biblio href=#biblio-xslt title=XSLT>[XSLT]</a></li>
      <li>HTML Imports <a data-biblio-type=informative data-link-type=biblio href=#biblio-html-imports title=HTML-IMPORTS>[HTML-IMPORTS]</a></li>
      <li>HTML Manifests <a data-biblio-type=informative data-link-type=biblio href=#biblio-manifest title=MANIFEST>[MANIFEST]</a></li>
      <li>Documents rendered in <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element title=iframe>iframe</a> elements</li>
      <li>Beacon <a data-biblio-type=informative data-link-type=biblio href=#biblio-beacon title=BEACON>[BEACON]</a></li>
      <li>Custom Filters <a data-biblio-type=informative data-link-type=biblio href=#biblio-filter-effects title=FILTER-EFFECTS>[FILTER-EFFECTS]</a></li>
      <li>
        Data (loaded, for example, via XMLHttpRequest <a data-biblio-type=informative data-link-type=biblio href=#biblio-xmlhttprequest title=XMLHTTPREQUEST>[XMLHTTPREQUEST]</a>,
        EventSource <a data-biblio-type=informative data-link-type=biblio href=#biblio-eventsource title=EVENTSOURCE>[EVENTSOURCE]</a>, or WebSockets <a data-biblio-type=informative data-link-type=biblio href=#biblio-websockets title=WEBSOCKETS>[WEBSOCKETS]</a>)
      </li>
      <li>
        <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/semantics.html#hyperlink-auditing>hyperlink auditing pings</a> <a data-biblio-type=informative data-link-type=biblio href=#biblio-html title=HTML>[HTML]</a>
      </li>
      <li>
        Subtitles and captions loaded via <a data-link-type=element href=http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element title=track>track</a> elements
      </li>
      <li>Web Fonts <a data-biblio-type=informative data-link-type=biblio href=#biblio-css3-webfonts title=CSS3-WEBFONTS>[CSS3-WEBFONTS]</a></li>
      <li>Images loaded via <code>&lt;picture&gt;</code></li>
      <li>
        Resources which are not rendered directly in the browser, but
        downloaded to a user’s storage device (either as a result of a
        <a data-link-type=element-attr href=https://html.spec.whatwg.org/#attr-hyperlink-download title=download>download</a> attribute, or
        <code>Content-Disposition</code> headers)
      </li>
    </ul>

<p>These resource types map to the following Fetch <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a>:
    <code>beacon</code>, <code>cspreport</code>, <code>download</code>,
    <code>embed</code>, <code>eventsource</code>, <code>favicon</code>,
    <code>fetch</code>, <code>font</code>, <code>form</code>,
    <code>frame</code>, <code>hyperlink</code>, <code>iframe</code>,
    <code>imageset</code>, <code>location</code>, <code>manifest</code>,
    <code>object</code>, <code>ping</code>, <code>plugin</code>,
    <code>script</code>, <code>serviceworker</code>, <code>sharedworker</code>,
    <code>subresource</code>, <code>style</code>, <code>track</code>,
    <code>worker</code>, <code>xmlhttprequest</code>, and <code>xslt</code>.
    These contexts are the <dfn data-dfn-type=dfn data-noexport="" id=blockable-request-contexts>blockable request contexts<a class=self-link href=#blockable-request-contexts></a></dfn>.</p>

<p class=note role=note>Note: The request contexts <code>form</code>, <code>hyperlink</code>, and
    <code>location</code> might refer to <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing context</a>
    <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#navigate title=navigated>navigations</a>, which are not considered mixed
    content. See the treatment of <a data-link-type=dfn href=#request-context-frame-type title="request context frame type">request context frame type</a> in
    <a data-section="" href=#should-block-fetch>§5.2 
      Should fetching request be blocked as mixed content?
    </a> for details.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=3.3 id=categories-unknown-content><span class=secno>3.3. </span><span class=content>Future Contexts</span><a class=self-link href=#categories-unknown-content></a></h3>

<p>This document exhaustively categorizes the <a data-link-type=dfn href=#request-context title="request contexts">request contexts</a> currently
    defined in the Fetch specification. It is the intention of the Working Group
    that any new content types defined in the future be prevented from loading
    as <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a>. To that end, any <a data-link-type=dfn href=#request-context title="request context">request context</a> which is
    not explicitly listed in the preceeding content categories MUST be
    considered a <a data-link-type=dfn href=#blockable-request-contexts title="blockable request context">blockable request context</a>.</p>
  </section>
</section>


<section>
  <h2 class="heading settled" data-level=4 id=requirements><span class=secno>4. </span><span class=content>User Agent Requirements</span><a class=self-link href=#requirements></a></h2>

  <section>
    <h3 class="heading settled" data-level=4.1 id=requirements-fetching><span class=secno>4.1. </span><span class=content>Resource Fetching</span><a class=self-link href=#requirements-fetching></a></h3>

<p>User agents SHOULD reject <a data-link-type=dfn href=#weakly-tls-protected title="weakly TLS-protected">weakly TLS-protected</a> resources entirely
    by failing the TLS handshake, or by requiring explicit user acceptance
    of the risk (for instance, presenting the user with a confirmation screen
    she must click through).</p>

<p>If a <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code>'s <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object title="incumbent settings object">incumbent settings object</a> <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts
    mixed content</a>, or the <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-script title="relevant settings object for a script">relevant settings object for a script</a>
    <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts mixed content</a>, then <a data-link-type=dfn href=#fetch title=fetching>fetching</a> resource in response
    to requests (including not only requests for a <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code>'s subresources,
    but also requests made from (Workers, SharedWorkers, Service Workers, and
    so on) will exhibit the following behavior:</p>

    <ol>
      <li>
        <a data-link-type=dfn href=#request title=Requests>Requests</a> for <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> resources from an
        <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin"><em>a priori</em> insecure origin</a> will not generate network
        traffic, but will instead return a synthetically generated <a data-link-type=dfn href=#network-error title="network error">network
        error</a> response.
      </li>

      <li>
        <a data-link-type=dfn href=#response title=Responses>Responses</a> to <a data-link-type=dfn href=#request title=requests>requests</a> for <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> resources from
        an <a data-link-type=dfn href=#insecure-origin title="insecure origin">insecure origin</a> will not be delivered to the <a data-link-type=dfn href=#request-client title="request client">request
        client</a>, but instead will return a synthetically generated <a data-link-type=dfn href=#network-error title="network error">network
        error</a> response.
      </li>
    </ol>

<p><a data-section="" href=#fetch-integration>§7 Integration with Fetch</a> and <a data-section="" href=#algorithms>§5 Insecure Content in Secure Contexts</a> detail how these fetching
    requirements could be implemented.</p>

<p>User agents MAY take further action:</p>

    <ol>
      <li>
        <a data-link-type=dfn href=#request title=Requests>Requests</a> for <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a> resources which
        are <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> SHOULD be treated as <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> (and
        therefore returned as a <a data-link-type=dfn href=#network-error title="network error">network error</a> as described above), but
        user agents MAY allow them to load normally.

<p class=note role=note>Note: For instance, a user agent could interpret the presence of a
        <code>Strict-Transport-Security</code> header field as forcing all
        content into the <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> category. <a data-biblio-type=informative data-link-type=biblio href=#biblio-rfc6797 title=RFC6797>[RFC6797]</a></p>
      </li>

      <li>
        <a data-link-type=dfn href=#request title=Requests>Requests</a> for <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a> resources which
        are <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> MAY be modified to reduce the risk to users.
        For example, cookies and other authentication tokens could be stripped
        from the requests, or the user agent could automatically change the
        protocol of the requested URL to <code>HTTPS</code> in certain cases.
      </li>
    </ol>
  </section>

  <section>
    <h3 class="heading settled" data-level=4.2 id=requirements-script><span class=secno>4.2. </span><span class=content>Script APIs</span><a class=self-link href=#requirements-script></a></h3>

<p>If the <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-script title="relevant settings object for a script">relevant settings object for a script</a> <var>script</var>
    <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts mixed content</a>, then user agents will model a mixed content
    failure as a network error. This means that:</p>

    <ol>
      <li>
        An XMLHttpRequest rejected as mixed content will run the steps for a
        network error during execution of the 
        <a href=http://www.w3.org/TR/XMLHttpRequest2/#the-send-method><code>send()</code>
        method</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-xmlhttprequest title=XMLHTTPREQUEST>[XMLHTTPREQUEST]</a>
      </li>

      <li>
        An EventSource connection rejected as mixed content will cause the user agent to
        <a href=http://www.w3.org/TR/eventsource/#fail-the-connection>fail the
        connection</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-eventsource title=EVENTSOURCE>[EVENTSOURCE]</a>
      </li>

      <li>
        When processing WebSocket’s
        <a href=http://www.w3.org/TR/websockets/#the-websocket-interface>constructor</a>,
        for an <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origin">a priori insecure origin</a>, a <code>SecurityError</code> exception will
        be thrown. <a data-biblio-type=normative data-link-type=biblio href=#biblio-websockets title=WEBSOCKETS>[WEBSOCKETS]</a>
      </li>
    </ol>
  </section>

  <section>
    <h3 class="heading settled" data-level=4.3 id=requirements-forms><span class=secno>4.3. </span><span class=content>Form Submission</span><a class=self-link href=#requirements-forms></a></h3>

<p>If a <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code>'s <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object title="incumbent settings object">incumbent settings object</a> <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts mixed
    content</a>, then user agents MAY choose to warn users of the presence of
    one or more <a data-link-type=element href=https://html.spec.whatwg.org/#the-form-element title=form>form</a> elements with <a data-link-type=element-attr href=https://html.spec.whatwg.org/#attr-fs-action title=action>action</a>
    attributes whose values are <a data-link-type=dfn href=#insecure-url title="insecure URLs">insecure URLs</a>.</p>

<p class=note role=note>Note: Chrome, for example, currently gives the same UI treatment to a page
    with an insecure form action as it does for a page that displays an insecure
    image.</p>

<p>Further, user agents MAY <strong>optionally</strong> treat form submissions
    in the <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing context</a> from a <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code> whose
    <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object title="incumbent settings object">incumbent settings object</a> <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts mixed content</a> as a
    request for <a data-link-type=dfn href=#blockable-content title="blockable content">blockable content</a> to protect users from accidental data
    leakage.</p>
  </section>

  </section>

  <section>
    <h3 class="heading settled" data-level=4.4 id=requirements-ux><span class=secno>4.4. </span><span class=content>UI Requirements</span><a class=self-link href=#requirements-ux></a></h3>

<p>If a <a data-link-type=dfn href=#request title=request>request</a> for an <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a> resource which is
    <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> is <strong>not</strong> treated as <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a>,
    then the user agent MUST NOT provide the user with a visible indication that
    the <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing context</a> which loaded that resource is secure
    (for instance, via a green lock icon). The user agent SHOULD instead display
    a visible indication that <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> is present.</p>

<p>This requirement explicitly includes any visible indication of the
    <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing context</a>’s
    <a href=https://cabforum.org/about-ev-ssl/>EV status</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-cab title=CAB>[CAB]</a></p>
  </section>

  <section>
    <h3 class="heading settled" data-level=4.5 id=requirements-user-controls><span class=secno>4.5. </span><span class=content>User Controls</span><a class=self-link href=#requirements-user-controls></a></h3>

<p>User agents MAY offer users the ability to directly decide whether or not to
    treat <strong>all</strong> <a data-link-type=dfn href=#mixed-content title="mixed content">mixed content</a> as <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> (meaning
    that even <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a> would be blocked in a
    mixed context).</p>

<p class=note role=note>Note: It is <em>strongly recommended</em> that users take advantage of such
    an option if provided.</p>

<p>User agents MAY offer users the ability to override its decision to block
    <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> mixed content on a particular page.</p>

<p class=note role=note>Note: Practically, user agents probably can’t get away with not offering
    such a back door. That said, allowing mixed script is in particular a very
    dangerous option, and user agents
    <a href=http://tools.ietf.org/html/rfc6919#section-3>REALLY SHOULD NOT</a>
    <a data-biblio-type=informative data-link-type=biblio href=#biblio-rfc6919 title=RFC6919>[RFC6919]</a> present such a choice to users without careful consideration and
    communication of the risk involved.</p>
  </section>



<section>
  <h2 class="heading settled" data-level=5 id=algorithms><span class=secno>5. </span><span class=content>Insecure Content in Secure Contexts</span><a class=self-link href=#algorithms></a></h2>

  <section>
    <h3 class="heading settled" data-level=5.1 id=categorize-settings-object><span class=secno>5.1. </span><span class=content>
      Does <var>settings object</var> restrict mixed content?
    </span><a class=self-link href=#categorize-settings-object></a></h3>

<p>Both documents and workers have <a data-link-type=dfn href=#environment-settings-object title="environment settings objects">environment settings objects</a> which
    may be examined according to the following algorithm in order to determine
    whether they <dfn data-dfn-type=dfn data-export="" data-local-title="restricts mixed content" id=restrict-mixed-content>restrict
    mixed content<a class=self-link href=#restrict-mixed-content></a></dfn>. This algorithm returns <code>Restricts Mixed
    Content</code> or <code>Does Not Restrict Mixed Content</code>, as
    appropriate.</p>

<p>Given an <a data-link-type=dfn href=#environment-settings-object title="environment settings object">environment settings object</a> <var>settings</var>:</p>

    <ol>
      <li>
        If <var>settings</var>' <a data-link-type=dfn href=#request-client-tls-state title="TLS state">TLS state</a> is not
        <code>unauthenticated</code>, then return <strong>Restricts Mixed
        Content</strong>.
      </li>
      <li>
        If <var>settings</var> has a <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#responsible-document title="responsible document">responsible document</a>
        <var>document</var>, then:

        <ol>
          <li>
            While <var>document</var> has an <a data-link-type=dfn href=#embedding-document title="embedding document">embedding document</a>:

            <ol>
              <li>
                Let <var>document</var> be <var>document</var>’s <a data-link-type=dfn href=#embedding-document title="embedding document">embedding
                document</a>.
              </li>
              <li>
                Let <var>embedder settings</var> be <var>document</var>’s
                <var>incumbent settings object</var>.
              </li>
              <li>
                If <var>embedder settings</var>' <a data-link-type=dfn href=#request-client-tls-state title="TLS state">TLS state</a> is not
                <code>unauthenticated</code>, then return <strong>Restricts
                mixed content</strong>.
              </li>
            </ol>
          </li>
        </ol>
      </li>
      <li>Return <strong>Does Not Restrict Mixed Content</strong>.</li>
    </ol>

    <div class=note role=note>
      If a document has an <a data-link-type=dfn href=#embedding-document title="embedding document">embedding document</a>, user agents need to
      check not only the document itself, but also the <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context title="top-level browsing context">top-level browsing
      context</a> in which the document is nested, as that is the context
      which controls the user’s expectations regarding the security status of
      the resource she’s loaded. For example:

      <div class=example>
        <code>http://a.com</code> loads <code>http://evil.com</code>. The
        insecure request will be allowed, as <code>a.com</code> was not loaded
        over a secure connection.
      </div>

      <div class=example>
        <code>https://a.com</code> loads <code>http://evil.com</code>. The
        insecure request will be blocked, as <code>a.com</code> was loaded over
        a secure connection.
      </div>

      <div class=example>
        <code>http://a.com</code> frames <code>https://b.com</code>, which
        loads <code>http://evil.com</code>. In this case, the insecure request
        to <code>evil.com</code> will be blocked, as <code>b.com</code> was
        loaded over a secure connection, even though <code>a.com</code> was not.
      </div>

      <div class=example>
        <code>https://a.com</code> frames a <code>data:</code> URL, which loads
        <code>http://evil.com</code>. In this case, the insecure request to
        <code>evil.com</code> will be blocked, as <code>a.com</code> was loaded
        over a secure connection, even though the framed data URL was not.
      </div>
    </div>
  </section>

  <section>
    <h3 class="heading settled" data-level=5.2 id=should-block-fetch><span class=secno>5.2. </span><span class=content>
      Should fetching <var>request</var> be blocked as mixed content?
    </span><a class=self-link href=#should-block-fetch></a></h3>

<p class=note role=note>Note: The Fetch specification hooks into this algorithm to determine whether
    a request should be entirely blocked (e.g. because the request is for
    <a data-link-type=dfn href=#blockable-content title=blockable>blockable</a> content, and we can <em>assume</em> that it won’t be
    loaded over a secure connection).</p>

<p>Given a <a data-link-type=dfn href=#request title=request>request</a> <var>request</var>, a user agent determines
    whether the <a data-link-type=dfn href=#request title=Request>Request</a> <var>request</var>  should proceed or not via the
    following algorithm:</p>

    <ol>
      <li>
        Let <var>context</var> be <var>request</var>’s <code>context</code>.
      </li>
      <li>
        Let <var>frame type</var> be <var>request</var>’s <code>context frame
        type</code>.
      </li>
      <li>
        Let <var>origin</var> be the <a data-link-type=dfn href=#origin title=origin>origin</a> of <var>request</var>’s
        <strong>URL</strong>.
      </li>
      <li>
        If <var>request</var>’s <a data-link-type=dfn href=#request-client title=client>client</a> does not <a data-link-type=dfn href=#restrict-mixed-content title="restrict mixed content">restrict mixed
        content</a>, return <strong>allowed</strong>.
      </li>
      <li>
        If <var>request</var>’s <code>context frame type</code> is
        <code>top-level</code>, return <strong>allowed</strong>.
      </li>
      <li>
        If <var>origin</var> is <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure"><em>a priori</em> insecure</a>:

        <ol>
          <li>
            If <var>request</var>’s <code>mode</code> is <code>CORS</code> or
            <code>CORS-with-forced-preflight</code>, return
            <strong>blocked</strong>.
          </li>
          <li>
            If <var>context</var> is a <a data-link-type=dfn href=#blockable-request-contexts title="blockable request context">blockable request context</a>, return
            <strong>blocked</strong>.
          </li>
          <li>
            If the user agent is configured to block <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a>
            mixed content, return <strong>blocked</strong>.
          </li>
        </ol>
      </li>
      <li>
        Otherwise, <var>origin</var> is <a data-link-type=dfn href=#potentially-secure-origin title="potentially secure">potentially secure</a>, so
        return <strong>allowed</strong>.
      </li>
    </ol>
  </section>

  <section>
    <h3 class="heading settled" data-level=5.3 id=should-block-response><span class=secno>5.3. </span><span class=content>
      Should <var>response</var> to <var>request</var> be blocked as mixed
      content?
    </span><a class=self-link href=#should-block-response></a></h3>

<p class=note role=note>Note: <a href=#should-block-fetch>If a request proceeds</a>, we still
    might want to block the response based on the state of the connection
    that generated the response (e.g. because the response is for <a data-link-type=dfn href=#blockable-content title="blockable content">blockable
    content</a>, but the server is <a data-link-type=dfn href=#insecure-origin title=insecure>insecure</a>). This algorithm is used to
    make that determination.</p>

<p>Given a <a data-link-type=dfn href=#request title=request>request</a> <var>request</var> and <a data-link-type=dfn href=#response title=response>response</a>
    <var>response</var>, the user agent determines what response should be
    returned via the following algorithm:</p>

    <ol>
      <li>
        If <var>request</var>’s <a data-link-type=dfn href=#request-client title=client>client</a> does not <a data-link-type=dfn href=#restrict-mixed-content title="restrict mixed content">restrict mixed
        content</a>, return <strong>allowed</strong>.
      </li>
      <li>
        Let <var>context</var> be the <a data-link-type=dfn href=#request-context title="request context">request context</a> of
        <var>request</var>.
      </li>
      <li>
        If <var>context</var> is an <a data-link-type=dfn href=#blockable-request-contexts title="blockable request context">blockable request context</a> or the
        user agent is configured to block <a data-link-type=dfn href=#optionally-blockable-content title=optionally-blockable>optionally-blockable</a> mixed
        content:

        <ol>
          <li>
            If <var>response</var>’s <a data-link-type=dfn href=#request-client-tls-state title="TLS state">TLS state</a> is not
            <code>authenticated</code>, return <strong>blocked</strong>.

<p class=note role=note>Note: This covers both cases in which unauthenticated resources are
            requested, as well as cases in which the TLS handshake succeeds, and
            the resource exceeds the definition of <a data-link-type=dfn href=#weakly-tls-protected title="weakly TLS-protected">weakly TLS-protected</a>,
            but the user agent chooses to hold it to a higher standard. The
            definition of <a data-link-type=dfn href=#deprecated-tls-protection title="deprecated TLS-protection">deprecated TLS-protection</a> has some examples of
            these kinds of scenarios.</p>
          </li>
        </ol>
      </li>
      <li>Return <strong>allowed</strong>.</li>
    </ol>
  </section>
</section>

<section>
  <h2 class="heading settled" data-level=6 id=powerful-features><span class=secno>6. </span><span class=content>
    Secure Contexts for Powerful Features
  </span><a class=self-link href=#powerful-features></a></h2>

<p>Tangentially related to a user agent’s handling of insecure resources in
  secure contexts, certain web platform features that have distinct impact
  on a user’s security or privacy wish to restrict themselves for use only
  in sufficiently secure contexts. Service Workers, for instance, may only
  be registered when the user agent is satisfied that doing so doesn’t put
  the user at risk.</p>

<p>Here, we define algorithms for such determination.</p>

  <section>
    <h3 class="heading settled" data-level=6.1 id=may-document-use-powerful-features><span class=secno>6.1. </span><span class=content>
      May <var>Document</var> use powerful features?
    </span><a class=self-link href=#may-document-use-powerful-features></a></h3>

<p>Given a <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code> <var>document</var>, this algorithm returns
    <code>Allowed</code> or <code>Not Allowed</code> as appropriate.</p>

    <ol>
      <li>
        While <var>document</var> corresponds to <a data-link-type=dfn href=http://www.w3.org/TR/html5/embedded-content-0.html#an-iframe-srcdoc-document title="an iframe srcdoc Document">an iframe srcdoc
        Document</a>, let <var>document</var> be that Document’s <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#browsing-context title="browsing context">browsing
        context</a>’s <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#browsing-context-container title="browsing context container">browsing context container</a>’s <code class=idl><a data-link-type=idl href=http://www.w3.org/TR/html5/dom.html#the-document-object title=Document>Document</a></code>.
      </li>
      <li>
        If <var>document</var>’s active <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#sandboxing-flag-set title="sandboxing flag set">sandboxing flag set</a> has its
        <a data-link-type=dfn href=http://www.w3.org/TR/html5/browsers.html#sandboxed-origin-browsing-context-flag title="sandboxed origin browsing context flag">sandboxed origin browsing context flag</a> set:

        <ol>
          <li>
            Set <var>origin</var> to the <a data-link-type=dfn href=#origin title=origin>origin</a> of
            <var>document</var>’s address.
          </li>
        </ol>
      </li>
      <li>
        If the result of executing the <a data-section="" href=#is-origin-trusted>§6.3 
      Is origin potentially trusted?
    </a> algorithm
        on <var>origin</var> is <code>Potentially Trusted</code>, return
        <code>Allowed</code>.
      </li>
      <li>
        Return the result of executing the <a data-section="" href=#settings-powerful-features>§6.2 
      May environment settings object use powerful features?
    </a>
        algorithm on <var>browsing context</var>’s <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#incumbent-settings-object title="incumbent settings object">incumbent settings
        object</a>.
      </li>
    </ol>

<p class=note role=note>Note: Sandboxed documents will have a unique origin. This algorithm uses the
    location of a sandboxed document to determine whether it should be considered
    authenticated. That is, the document inside
    <code>&lt;iframe src="https://example.com/" sandbox="allow-script"&gt;</code>
    would be considered to allow powerful features.</p>
  </section>

  <section>
    <h3 class="heading settled" data-level=6.2 id=settings-powerful-features><span class=secno>6.2. </span><span class=content>
      May <var>environment settings object</var> use powerful features?
    </span><a class=self-link href=#settings-powerful-features></a></h3>

<p>Given an <a data-link-type=dfn href=#environment-settings-object title="environment settings object">environment settings object</a> <var>settings</var>, this
    algorithm returns <code>Allowed</code> if powerful features may be used
    in the object’s context, and <code>Not Allowed</code> otherwise.</p>

    <ol>
      <li>
        If <var>settings</var>' <a data-link-type=dfn href=#request-client-tls-state title="TLS state">TLS state</a> is
        <code>authenticated</code>, return <code>Allowed</code>.
      </li>
      <li>
        Otherwise:

        <ol>
          <li>
            Let <var>origin</var> be <var>settings</var>' <a data-link-type=dfn href=#origin title=origin>origin</a>.
          </li>
          <li>
            If the result of executing the <a data-section="" href=#is-origin-trusted>§6.3 
      Is origin potentially trusted?
    </a> algorithm
            on <var>origin</var> is <code>Potentially Trusted</code>, return
            <code>Allowed</code>.
          </li>
        </ol>
      </li>
      <li>
        Return <code>Not Allowed</code>.
      </li>
    </ol>
  </section>

  <section>
    <h3 class="heading settled" data-level=6.3 id=is-origin-trusted><span class=secno>6.3. </span><span class=content>
      Is <var>origin</var> potentially trusted?
    </span><a class=self-link href=#is-origin-trusted></a></h3>

<p>Certain origins are impossible for a user agent not to place trust in. In
    particular, <code>file:</code> URLs and the loopback interface both expose
    aspects of the machine on which the user agent is running. The user agent
    has no choice but to trust these origins.</p>

<p>Certain user agents extend this trust to other, vendor-specific URL schemes
    like <code>app:</code> or <code>chrome-extension:</code>.</p>

<p>Given an <a data-link-type=dfn href=#origin title=origin>origin</a> <var>origin</var>, the following algorithm returns
    <code>Potentially Trusted</code> or <code>Not Trusted</code> as appropriate.</p>

    <ol>
      <li>
        If <var>origin</var> is a <a data-link-type=dfn href=#potentially-secure-origin title="potentially secure origin">potentially secure origin</a>,
        return <code>Potentially Trusted</code>.

<p class=note role=note>Note: The origin of <code>blob:</code> and <code>filesystem:</code> URLs
        is the origin of the context in which they were created. Therefore,
        blobs created in an potentially secure origin will themselves be
        potentially secure. The origin of <code>data:</code> and
        <code>javascript:</code> URLs is an opaque identifier, which will not
        be considered potentially secure.</p>
      </li>
      <li>
        If <var>origin</var>’s <code>host</code> component is
        <code>localhost</code>, return <code>Potentially Trusted</code>.
      </li>
      <li>
        If <var>origin</var>’s <code>host</code> component matches one of
        the CIDR notations <code>127.0.0.0/8</code> or <code>::1/128</code>
        <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc4632 title=RFC4632>[RFC4632]</a>, return <code>Potentially Trusted</code>.
      </li>
      <li>
        If <var>origin</var>’s <code>scheme</code> component is
        <code>file</code>, return <code>Potentially Trusted</code>.
      </li>
      <li>
        If <var>origin</var>’s <code>scheme</code> component is one which
        the user agent considers to be authenticated, return
        <code>Potentially Trusted</code>.

<p class=note role=note>Note: This is meant to cover vendor-specific URL schemes whose
        contents are authenticated by the user agent. For example, FirefoxOS
        application resources are referred to with an URL whose
        <code>scheme</code> component is <code>app:</code>. Likewise, Chrome’s
        extensions and apps live on <code>chrome-extension:</code> schemes.
        These could reasonably be considered trusted origins.</p>
      </li>
      <li>
        Return <code>Not Trusted</code>.
      </li>
    </ol>
  </section>
</section>


<section>
  <h2 class="heading settled" data-level=7 id=fetch-integration><span class=secno>7. </span><span class=content>Integration with Fetch</span><a class=self-link href=#fetch-integration></a></h2>

<p>When fetching resources, the mixed content checks described in the algorithms
  above should be inserted at the top of the Fetch algorithm to block network
  traffic to <a data-link-type=dfn href=#a-priori-insecure-origin title="a priori insecure origins"><em>a priori</em> insecure origins</a>, and at the bottom of
  the algorithm, to block responses from <a data-link-type=dfn href=#insecure-origin title="insecure origins">insecure origins</a>.</p>

<p>Fetch calls the algorithm defined in
  <a data-section="" href=#should-block-fetch>§5.2 
      Should fetching request be blocked as mixed content?
    </a> during
  <a href=http://fetch.spec.whatwg.org/#fetching>Step 4 of the Fetching
  algorithm</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=FETCH>[FETCH]</a></p>

<p class=note role=note>Note: Hooking into Fetch here ensures that we catch not only the initial
  request, but all redirects as well. That is certainly the intent.</p>

<p>Further, Fetch calls the algorithm defined in
  <a data-section="" href=#should-block-response>§5.3 
      Should response to request be blocked as mixed
      content?
    </a> during
  <a href=http://fetch.spec.whatwg.org/#fetching>Step 7 of the Fetching
  algorithm</a>. <a data-biblio-type=normative data-link-type=biblio href=#biblio-fetch title=FETCH>[FETCH]</a></p>

<p class=note role=note>Note: This hook is necessary to detect resources modified or
  synthesized by a ServiceWorker, as well as to determine whether a
  resource is <a data-link-type=dfn href=#insecure-origin title=insecure>insecure</a> once the TLS-handshake has finished. See
  steps 4.1 and 4.2 of the algorithm defined in <a data-section="" href=#should-block-response>§5.3 
      Should response to request be blocked as mixed
      content?
    </a> for
  detail.</p>

</section>


<section>
  <h2 class="heading settled" data-level=8 id=websockets-integration><span class=secno>8. </span><span class=content>Modifications to WebSockets</span><a class=self-link href=#websockets-integration></a></h2>

<p>The <a href=http://www.w3.org/TR/2012/CR-websockets-20120920/#the-websocket-interface><code>WebSocket()</code>
  constructor algorithm</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-websockets title=WEBSOCKETS>[WEBSOCKETS]</a> is modified as follows:</p>

  <ul>
    <li>
      Replace Step 2 with the following steps:

      <ol>
        <li>
          If <var>secure</var> is <strong>false</strong>, but <var>entry
          script</var>’s
          <a data-link-type=dfn href=http://www.w3.org/TR/html5/webappapis.html#relevant-settings-object-for-a-script title="relevant settings object for a script">relevant settings
          object</a>’s <a data-link-type=dfn href=#restrict-mixed-content title="restricts mixed content">restricts mixed content</a>, then throw a
          <code>SecurityError</code> exception.
        </li>
      </ol>
    </li>
  </ul>

<p>The <a href=http://tools.ietf.org/html/rfc6455#section-4.1>Establish a
  WebSocket Connection algorithm</a> <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6455 title=RFC6455>[RFC6455]</a> is modified as follows:</p>

  <ul>
    <li>
      After step 5, perform the following step:

      <ol>
        <li>
          If secure is <strong>true</strong>, and the TLS handshake performed
          in step 5 results in a <a data-link-type=dfn href=#weakly-tls-protected title="weakly TLS-protected">weakly TLS-protected</a> connection, or the
          TLS-protection is <a data-link-type=dfn href=#deprecated-tls-protection title=deprecated>deprecated</a>,then the client MUST
          <a href=http://tools.ietf.org/html/rfc6455#section-7.1.7>Fail the
          WebSocket Connection</a> and abort the connection. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc6455 title=RFC6455>[RFC6455]</a>
        </li>
      </ol>
    </li>
  </ul>
</section>


<section>
  <h2 class="heading settled" data-level=9 id=acknowledgements><span class=secno>9. </span><span class=content>Acknowledgements</span><a class=self-link href=#acknowledgements></a></h2>

<p>In addition to the wonderful feedback gathered from the WebAppSec WG, the
  Chrome security team was invaluable in preparing this specification. In
  particular, Chris Palmer, Chris Evans, Ryan Sleevi, Michal Zalewski, Ken
  Buchanan, and Tom Sepez gave lots of early feedback. Anne van Kesteren
  explained Fetch and helped define the interface to this specification.</p>
</section>

</main>
<h2 class="no-ref no-num heading settled" id=conformance><span class=content>Conformance</span><a class=self-link href=#conformance></a></h2>

<h3 class="no-ref no-num heading settled" id=conventions><span class=content>Document conventions</span><a class=self-link href=#conventions></a></h3>

    <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-biblio-type=normative data-link-type=biblio href=#biblio-rfc2119 title=RFC2119>[RFC2119]</a></p>

    <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    <div class=example>
        <p>This is an example of an informative example.</p>
    </div>

    <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    <p class=note role=note>Note, this is an informative note.</p>

<h3 class="no-ref no-num heading settled" id=conformant-algorithms><span class=content>Conformant Algorithms</span><a class=self-link href=#conformant-algorithms></a></h3>

    <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>

<h3 class="no-ref no-num heading settled" id=conformance-classes><span class=content>Conformance Classes</span><a class=self-link href=#conformance-classes></a></h3>

    <p>A <dfn data-dfn-type=dfn data-noexport="" id=conformant-user-agent>conformant user agent<a class=self-link href=#conformant-user-agent></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    <p>A <dfn data-dfn-type=dfn data-noexport="" id=conformant-server>conformant server<a class=self-link href=#conformant-server></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>



<h2 class="no-num heading settled" id=references><span class=content>References</span><a class=self-link href=#references></a></h2><h3 class="no-num heading settled" id=normative><span class=content>Normative References</span><a class=self-link href=#normative></a></h3><dl><dt id=biblio-cab title=CAB><a class=self-link href=#biblio-cab></a>[CAB]<dd>???. <a href=https://cabforum.org/baseline-requirements-documents/>CA/Browser Forum Baseline Requirements v1.1.8</a>. URL: <a href=https://cabforum.org/baseline-requirements-documents/>https://cabforum.org/baseline-requirements-documents/</a><dt id=biblio-fetch title=FETCH><a class=self-link href=#biblio-fetch></a>[FETCH]<dd>Anne van Kesteren. <a href=http://fetch.spec.whatwg.org/>Fetch</a>. Living Standard. URL: <a href=http://fetch.spec.whatwg.org/>http://fetch.spec.whatwg.org/</a><dt id=biblio-rfc4632 title=RFC4632><a class=self-link href=#biblio-rfc4632></a>[RFC4632]<dd>Vince Fuller; Tony Li. <a href=http://www.ietf.org/rfc/rfc4632.txt>Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc4632.txt>http://www.ietf.org/rfc/rfc4632.txt</a><dt id=biblio-rfc6454 title=RFC6454><a class=self-link href=#biblio-rfc6454></a>[RFC6454]<dd>Adam Barth. <a href=http://www.ietf.org/rfc/rfc6454.txt>The Web Origin Concept</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6454.txt>http://www.ietf.org/rfc/rfc6454.txt</a><dt id=biblio-rfc6455 title=RFC6455><a class=self-link href=#biblio-rfc6455></a>[RFC6455]<dd>Ian Fette; Alexey Melnikov. <a href=http://www.ietf.org/rfc/rfc6455.txt>The WebSocket Protocol</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6455.txt>http://www.ietf.org/rfc/rfc6455.txt</a><dt id=biblio-xmlhttprequest title=XMLHttpRequest><a class=self-link href=#biblio-xmlhttprequest></a>[XMLHttpRequest]<dd>Anne van Kesteren; et al. <a href=http://www.w3.org/TR/XMLHttpRequest/>XMLHttpRequest Level 1</a>. 30 January 2014. WD. URL: <a href=http://www.w3.org/TR/XMLHttpRequest/>http://www.w3.org/TR/XMLHttpRequest/</a><dt id=biblio-eventsource title=eventsource><a class=self-link href=#biblio-eventsource></a>[eventsource]<dd>Ian Hickson. <a href=http://www.w3.org/TR/eventsource/>Server-Sent Events</a>. 11 December 2012. CR. URL: <a href=http://www.w3.org/TR/eventsource/>http://www.w3.org/TR/eventsource/</a><dt id=biblio-html5 title=html5><a class=self-link href=#biblio-html5></a>[html5]<dd>Robin Berjon; et al. <a href=http://www.w3.org/TR/html5/>HTML5</a>. 28 October 2014. REC. URL: <a href=http://www.w3.org/TR/html5/>http://www.w3.org/TR/html5/</a><dt id=biblio-rfc2119 title=rfc2119><a class=self-link href=#biblio-rfc2119></a>[rfc2119]<dd>S. Bradner. <a href=http://www.ietf.org/rfc/rfc2119.txt>Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href=http://www.ietf.org/rfc/rfc2119.txt>http://www.ietf.org/rfc/rfc2119.txt</a><dt id=biblio-websockets title=websockets><a class=self-link href=#biblio-websockets></a>[websockets]<dd>Ian Hickson. <a href=http://www.w3.org/TR/websockets/>The WebSocket API</a>. 20 September 2012. CR. URL: <a href=http://www.w3.org/TR/websockets/>http://www.w3.org/TR/websockets/</a><dt id=biblio-wsc-ui title=wsc-ui><a class=self-link href=#biblio-wsc-ui></a>[wsc-ui]<dd>Thomas Roessler; Anil Saldhana. <a href=http://www.w3.org/TR/wsc-ui/>Web Security Context: User Interface Guidelines</a>. 12 August 2010. REC. URL: <a href=http://www.w3.org/TR/wsc-ui/>http://www.w3.org/TR/wsc-ui/</a></dl><h3 class="no-num heading settled" id=informative><span class=content>Informative References</span><a class=self-link href=#informative></a></h3><dl><dt id=biblio-beacon title=BEACON><a class=self-link href=#biblio-beacon></a>[BEACON]<dd>Jatinder Mann; Alois Reitbauer. <a href=http://www.w3.org/TR/beacon/>Beacon</a>. WD. URL: <a href=http://www.w3.org/TR/beacon/>http://www.w3.org/TR/beacon/</a><dt id=biblio-css21 title=CSS21><a class=self-link href=#biblio-css21></a>[CSS21]<dd>Bert Bos; et al. <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. W3C Recommendation. URL: <a href=http://www.w3.org/TR/2011/REC-CSS2-20110607>http://www.w3.org/TR/2011/REC-CSS2-20110607</a><dt id=biblio-css3-webfonts title=CSS3-WEBFONTS><a class=self-link href=#biblio-css3-webfonts></a>[CSS3-WEBFONTS]<dd>Michel Suignard; Chris Lilley. <a href=http://www.w3.org/TR/2002/WD-css3-webfonts-20020802>CSS3 module: Web Fonts</a>. 2 August 2002. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2002/WD-css3-webfonts-20020802>http://www.w3.org/TR/2002/WD-css3-webfonts-20020802</a><dt id=biblio-dangerous-mix title=DANGEROUS-MIX><a class=self-link href=#biblio-dangerous-mix></a>[DANGEROUS-MIX]<dd>Ping Chen; et al. <a href=http://www.securitee.org/files/mixedinc_isc2013.pdf>A Dangerous Mix: Large-scale analysis of mixed-content websites</a>. URL: <a href=http://www.securitee.org/files/mixedinc_isc2013.pdf>http://www.securitee.org/files/mixedinc_isc2013.pdf</a><dt id=biblio-ecma-262 title=ECMA-262><a class=self-link href=#biblio-ecma-262></a>[ECMA-262]<dd>???. <a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>ECMAScript Language Specification, Edition 5.1</a>. June 2011. URL: <a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>http://www.ecma-international.org/publications/standards/Ecma-262.htm</a><dt id=biblio-filter-effects title=FILTER-EFFECTS><a class=self-link href=#biblio-filter-effects></a>[FILTER-EFFECTS]<dd>Dean Jackson; Erik Dahlström; Dirk Schulze. <a href=http://www.w3.org/TR/2013/WD-filter-effects-20130523/>Filter Effects 1.0</a>. 23 May 2013. W3C Working Draft. (Work in progress.) URL: <a href=http://www.w3.org/TR/2013/WD-filter-effects-20130523/>http://www.w3.org/TR/2013/WD-filter-effects-20130523/</a><dt id=biblio-html title=HTML><a class=self-link href=#biblio-html></a>[HTML]<dd>Ian Hickson. <a href=https://html.spec.whatwg.org/>HTML</a>. Living Standard. URL: <a href=https://html.spec.whatwg.org/>https://html.spec.whatwg.org/</a><dt id=biblio-html-imports title=HTML-IMPORTS><a class=self-link href=#biblio-html-imports></a>[HTML-IMPORTS]<dd>Dmitri Glazkov; Hajime Morrita. <a href=http://www.w3.org/TR/html-imports/>HTML Imports</a>. WD. URL: <a href=http://www.w3.org/TR/html-imports/>http://www.w3.org/TR/html-imports/</a><dt id=biblio-manifest title=MANIFEST><a class=self-link href=#biblio-manifest></a>[MANIFEST]<dd>Marcos Caceres; Anssi Kostiainen; Kenneth Rohde Christiansen; et al. <a href=http://w3c.github.io/manifest/>Manifest for web application</a>. WD. URL: <a href=http://w3c.github.io/manifest/>http://w3c.github.io/manifest/</a><dt id=biblio-rfc6797 title=RFC6797><a class=self-link href=#biblio-rfc6797></a>[RFC6797]<dd>Jeff Hodges; Collin Jackson; Adam Barth. <a href=http://www.ietf.org/rfc/rfc6797.txt>HTTP Strict Transport Security (HSTS)</a>. RFC. URL: <a href=http://www.ietf.org/rfc/rfc6797.txt>http://www.ietf.org/rfc/rfc6797.txt</a><dt id=biblio-serviceworkers title=SERVICEWORKERS><a class=self-link href=#biblio-serviceworkers></a>[SERVICEWORKERS]<dd>Alex Russell; Jungkee Song. <a href=http://www.w3.org/TR/service-workers/>Service Workers</a>. WD. URL: <a href=http://www.w3.org/TR/service-workers/>http://www.w3.org/TR/service-workers/</a><dt id=biblio-svg2 title=SVG2><a class=self-link href=#biblio-svg2></a>[SVG2]<dd>Nikos Andronikos; et al. <a href=http://www.w3.org/TR/SVG2/>Scalable Vector Graphics (SVG) 2</a>. 11 February 2014. WD. URL: <a href=http://www.w3.org/TR/SVG2/>http://www.w3.org/TR/SVG2/</a><dt id=biblio-uri title=URI><a class=self-link href=#biblio-uri></a>[URI]<dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href=http://www.ietf.org/rfc/rfc3986.txt>Uniform Resource Identifiers (URI): generic syntax</a>. January 2005. URL: <a href=http://www.ietf.org/rfc/rfc3986.txt>http://www.ietf.org/rfc/rfc3986.txt</a><dt id=biblio-rfc6919 title=rfc6919><a class=self-link href=#biblio-rfc6919></a>[rfc6919]<dd>R. Barnes; S. Kent; E. Rescorla. <a href=http://www.ietf.org/rfc/rfc6919.txt>Further Key Words for Use in RFCs to Indicate Requirement Levels</a>. 1 April 2013. Experimental. URL: <a href=http://www.ietf.org/rfc/rfc6919.txt>http://www.ietf.org/rfc/rfc6919.txt</a><dt id=biblio-workers title=workers><a class=self-link href=#biblio-workers></a>[workers]<dd>Ian Hickson. <a href=http://www.w3.org/TR/workers/>Web Workers</a>. 1 May 2012. CR. URL: <a href=http://www.w3.org/TR/workers/>http://www.w3.org/TR/workers/</a><dt id=biblio-xslt title=xslt><a class=self-link href=#biblio-xslt></a>[xslt]<dd>James Clark. <a href=http://www.w3.org/TR/xslt>XSL Transformations (XSLT) Version 1.0</a>. 16 November 1999. REC. URL: <a href=http://www.w3.org/TR/xslt>http://www.w3.org/TR/xslt</a></dl><h2 class="no-num heading settled" id=index><span class=content>Index</span><a class=self-link href=#index></a></h2><ul class=indexlist><li>a priori insecure, <a href=#a-priori-insecure-origin title="section 2.1">2.1</a><li>a priori insecure origin, <a href=#a-priori-insecure-origin title="section 2.1">2.1</a><li>a priori insecure URL, <a href=#a-priori-insecure-url title="section 2.1">2.1</a><li>blockable, <a href=#blockable-content title="section 3.2">3.2</a><li>blockable content, <a href=#blockable-content title="section 3.2">3.2</a><li>blockable request contexts, <a href=#blockable-request-contexts title="section 3.2">3.2</a><li>client, <a href=#request-client title="section 2.2">2.2</a><li>conformant server, <a href=#conformant-server title="section Unnumbered section">Unnumbered section</a><li>conformant user agent, <a href=#conformant-user-agent title="section Unnumbered section">Unnumbered section</a><li>context, <a href=#request-context title="section 2.2">2.2</a><li>deprecated, <a href=#deprecated-tls-protection title="section 2.1">2.1</a><li>deprecated TLS-protection, <a href=#deprecated-tls-protection title="section 2.1">2.1</a><li>embedding document, <a href=#embedding-document title="section 2.2">2.2</a><li>environment settings object, <a href=#environment-settings-object title="section 2.2">2.2</a><li>fetch, <a href=#fetch title="section 2.2">2.2</a><li>frame type, <a href=#request-context-frame-type title="section 2.2">2.2</a><li>globally unique identifier, <a href=#globally-unique-identifier title="section 2.2">2.2</a><li>insecure, <a href=#insecure-origin title="section 2.1">2.1</a><li>insecure origin, <a href=#insecure-origin title="section 2.1">2.1</a><li>insecure URL, <a href=#insecure-url title="section 2.1">2.1</a><li>mixed, <a href=#mixed-content title="section 2.1">2.1</a><li>mixed content, <a href=#mixed-content title="section 2.1">2.1</a><li>network error, <a href=#network-error title="section 2.2">2.2</a><li>optionally-blockable, <a href=#optionally-blockable-content title="section 3.1">3.1</a><li>optionally-blockable content, <a href=#optionally-blockable-content title="section 3.1">3.1</a><li>optionally-blockable request
    contexts, <a href=#optionally-blockable-request-contexts title="section 3.1">3.1</a><li>origin, <a href=#origin title="section 2.2">2.2</a><li>potentially secure, <a href=#potentially-secure-origin title="section 2.1">2.1</a><li>potentially secure origin, <a href=#potentially-secure-origin title="section 2.1">2.1</a><li>potentially secure URL, <a href=#potentially-secure-url title="section 2.1">2.1</a><li>request, <a href=#request title="section 2.2">2.2</a><li>request client, <a href=#request-client title="section 2.2">2.2</a><li>request client TLS state, <a href=#request-client-tls-state title="section 2.2">2.2</a><li>request context, <a href=#request-context title="section 2.2">2.2</a><li>request context frame type, <a href=#request-context-frame-type title="section 2.2">2.2</a><li>response, <a href=#response title="section 2.2">2.2</a><li>response TLS state, <a href=#response-tls-state title="section 2.2">2.2</a><li>restrict
    mixed content, <a href=#restrict-mixed-content title="section 5.1">5.1</a><li>restricts mixed content, <a href=#restrict-mixed-content title="section 5.1">5.1</a><li>TLS-protected, <a href=#tls-protected title="section 2.2">2.2</a><li>tls state, <a href=#request-client-tls-state title="section 2.2">2.2</a><li>weak, <a href=#weakly-tls-protected title="section 2.2">2.2</a><li>weakly TLS-protected, <a href=#weakly-tls-protected title="section 2.2">2.2</a></ul>
