<p>This is the last example that explain <a href="/en-US/docs/Learn/Forms/How_to_build_custom_form_controls">how to build custom form widgets</a>.</p>
<h2 id="change-states">Change states</h2>
<h3 id="html-content">HTML Content</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">&lt;form</span><span class="ot"> class=</span><span class="st">&quot;no-widget&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="kw">&lt;select</span><span class="ot"> name=</span><span class="st">&quot;myFruit&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-3" title="3">    <span class="kw">&lt;option&gt;</span>Cherry<span class="kw">&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="kw">&lt;option&gt;</span>Lemon<span class="kw">&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb1-5" title="5">    <span class="kw">&lt;option&gt;</span>Banana<span class="kw">&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb1-6" title="6">    <span class="kw">&lt;option&gt;</span>Strawberry<span class="kw">&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="kw">&lt;option&gt;</span>Apple<span class="kw">&lt;/option&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="kw">&lt;/select&gt;</span></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="kw">&lt;div</span><span class="ot"> class=</span><span class="st">&quot;select&quot;</span><span class="ot"> role=</span><span class="st">&quot;listbox&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-11" title="11">    <span class="kw">&lt;span</span><span class="ot"> class=</span><span class="st">&quot;value&quot;</span><span class="kw">&gt;</span>Cherry<span class="kw">&lt;/span&gt;</span></a>
<a class="sourceLine" id="cb1-12" title="12">    <span class="kw">&lt;ul</span><span class="ot"> class=</span><span class="st">&quot;optList hidden&quot;</span><span class="ot"> role=</span><span class="st">&quot;presentation&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb1-13" title="13">      <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;option&quot;</span><span class="ot"> role=</span><span class="st">&quot;option&quot;</span><span class="ot"> aria-selected=</span><span class="st">&quot;true&quot;</span><span class="kw">&gt;</span>Cherry<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb1-14" title="14">      <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;option&quot;</span><span class="ot"> role=</span><span class="st">&quot;option&quot;</span><span class="kw">&gt;</span>Lemon<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb1-15" title="15">      <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;option&quot;</span><span class="ot"> role=</span><span class="st">&quot;option&quot;</span><span class="kw">&gt;</span>Banana<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb1-16" title="16">      <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;option&quot;</span><span class="ot"> role=</span><span class="st">&quot;option&quot;</span><span class="kw">&gt;</span>Strawberry<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb1-17" title="17">      <span class="kw">&lt;li</span><span class="ot"> class=</span><span class="st">&quot;option&quot;</span><span class="ot"> role=</span><span class="st">&quot;option&quot;</span><span class="kw">&gt;</span>Apple<span class="kw">&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb1-18" title="18">    <span class="kw">&lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb1-19" title="19">  <span class="kw">&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="kw">&lt;/form&gt;</span></a></code></pre></div>
<h3 id="css-content">CSS Content</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><a class="sourceLine" id="cb2-1" title="1"><span class="fu">.widget</span> select<span class="op">,</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="fu">.no-widget</span> <span class="fu">.select</span> {</a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="kw">position</span> : <span class="dv">absolute</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="kw">left</span>     : <span class="dv">-5000</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="kw">height</span>   : <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="kw">overflow</span> : <span class="dv">hidden</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7">}</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">/* --------------- */</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">/* Required Styles */</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">/* --------------- */</span></a>
<a class="sourceLine" id="cb2-12" title="12"></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="fu">.select</span> {</a>
<a class="sourceLine" id="cb2-14" title="14">  <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-15" title="15">  <span class="kw">display</span> : <span class="dv">inline-block</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-16" title="16">}</a>
<a class="sourceLine" id="cb2-17" title="17"></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="fu">.select.active</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="fu">.select</span><span class="in">:focus</span> {</a>
<a class="sourceLine" id="cb2-20" title="20">  <span class="kw">box-shadow</span>: <span class="dv">0</span> <span class="dv">0</span> <span class="dv">3</span><span class="dt">px</span> <span class="dv">1</span><span class="dt">px</span> <span class="cn">#227755</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="kw">outline</span>: <span class="dv">none</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-22" title="22">}</a>
<a class="sourceLine" id="cb2-23" title="23"></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="fu">.select</span> <span class="fu">.optList</span> {</a>
<a class="sourceLine" id="cb2-25" title="25">  <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-26" title="26">  <span class="kw">top</span>     : <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-27" title="27">  <span class="kw">left</span>    : <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-28" title="28">}</a>
<a class="sourceLine" id="cb2-29" title="29"></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="fu">.select</span> <span class="fu">.optList.hidden</span> {</a>
<a class="sourceLine" id="cb2-31" title="31">  <span class="kw">max-height</span>: <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-32" title="32">  <span class="kw">visibility</span>: <span class="dv">hidden</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-33" title="33">}</a>
<a class="sourceLine" id="cb2-34" title="34"></a>
<a class="sourceLine" id="cb2-35" title="35"><span class="co">/* ------------ */</span></a>
<a class="sourceLine" id="cb2-36" title="36"><span class="co">/* Fancy Styles */</span></a>
<a class="sourceLine" id="cb2-37" title="37"><span class="co">/* ------------ */</span></a>
<a class="sourceLine" id="cb2-38" title="38"></a>
<a class="sourceLine" id="cb2-39" title="39"><span class="fu">.select</span> {</a>
<a class="sourceLine" id="cb2-40" title="40">  <span class="kw">font-size</span>   : <span class="dv">0.625</span><span class="dt">em</span><span class="op">;</span> <span class="co">/* 10px */</span></a>
<a class="sourceLine" id="cb2-41" title="41">  <span class="kw">font-family</span> : Verdana<span class="op">,</span> Arial<span class="op">,</span> <span class="dv">sans-serif</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-42" title="42"></a>
<a class="sourceLine" id="cb2-43" title="43">  <span class="kw">-moz-box-sizing</span> : <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-44" title="44">  <span class="kw">box-sizing</span> : <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-45" title="45"></a>
<a class="sourceLine" id="cb2-46" title="46">  <span class="kw">padding</span> : <span class="dv">0.1</span><span class="dt">em</span> <span class="dv">2.5</span><span class="dt">em</span> <span class="dv">0.2</span><span class="dt">em</span> <span class="dv">0.5</span><span class="dt">em</span><span class="op">;</span> <span class="co">/* 1px 25px 2px 5px */</span></a>
<a class="sourceLine" id="cb2-47" title="47">  <span class="kw">width</span>   : <span class="dv">10</span><span class="dt">em</span><span class="op">;</span> <span class="co">/* 100px */</span></a>
<a class="sourceLine" id="cb2-48" title="48"></a>
<a class="sourceLine" id="cb2-49" title="49">  <span class="kw">border</span>        : <span class="dv">0.2</span><span class="dt">em</span> <span class="dv">solid</span> <span class="cn">#000</span><span class="op">;</span> <span class="co">/* 2px */</span></a>
<a class="sourceLine" id="cb2-50" title="50">  <span class="kw">border-radius</span> : <span class="dv">0.4</span><span class="dt">em</span><span class="op">;</span> <span class="co">/* 4px */</span></a>
<a class="sourceLine" id="cb2-51" title="51"></a>
<a class="sourceLine" id="cb2-52" title="52">  <span class="kw">box-shadow</span> : <span class="dv">0</span> <span class="dv">0.1</span><span class="dt">em</span> <span class="dv">0.2</span><span class="dt">em</span> <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">.45</span><span class="fu">)</span><span class="op">;</span> <span class="co">/* 0 1px 2px */</span></a>
<a class="sourceLine" id="cb2-53" title="53"></a>
<a class="sourceLine" id="cb2-54" title="54">  <span class="kw">background</span> : <span class="cn">#F0F0F0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-55" title="55">  <span class="kw">background</span> : -webkit-linear-gradient<span class="fu">(</span><span class="dv">90</span><span class="dt">deg</span><span class="op">,</span> <span class="cn">#E3E3E3</span><span class="op">,</span> <span class="cn">#fcfcfc</span> <span class="dv">50</span><span class="dt">%</span><span class="op">,</span> <span class="cn">#f0f0f0</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-56" title="56">  <span class="kw">background</span> : <span class="fu">linear-gradient(</span><span class="dv">0</span><span class="dt">deg</span><span class="op">,</span> <span class="cn">#E3E3E3</span><span class="op">,</span> <span class="cn">#fcfcfc</span> <span class="dv">50</span><span class="dt">%</span><span class="op">,</span> <span class="cn">#f0f0f0</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-57" title="57">}</a>
<a class="sourceLine" id="cb2-58" title="58"></a>
<a class="sourceLine" id="cb2-59" title="59"><span class="fu">.select</span> <span class="fu">.value</span> {</a>
<a class="sourceLine" id="cb2-60" title="60">  <span class="kw">display</span>  : <span class="dv">inline-block</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-61" title="61">  <span class="kw">width</span>    : <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-62" title="62">  <span class="kw">overflow</span> : <span class="dv">hidden</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-63" title="63"></a>
<a class="sourceLine" id="cb2-64" title="64">  <span class="kw">white-space</span>   : <span class="dv">nowrap</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-65" title="65">  <span class="kw">text-overflow</span> : <span class="dv">ellipsis</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-66" title="66">  <span class="kw">vertical-align</span>: <span class="dv">top</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-67" title="67">}</a>
<a class="sourceLine" id="cb2-68" title="68"></a>
<a class="sourceLine" id="cb2-69" title="69"><span class="fu">.select</span><span class="in">:after</span> {</a>
<a class="sourceLine" id="cb2-70" title="70">  <span class="kw">content</span> : <span class="st">&quot;▼&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-71" title="71">  <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-72" title="72">  <span class="kw">z-index</span> : <span class="dv">1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-73" title="73">  <span class="kw">height</span>  : <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-74" title="74">  <span class="kw">width</span>   : <span class="dv">2</span><span class="dt">em</span><span class="op">;</span> <span class="co">/* 20px */</span></a>
<a class="sourceLine" id="cb2-75" title="75">  <span class="kw">top</span>     : <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-76" title="76">  <span class="kw">right</span>   : <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-77" title="77"></a>
<a class="sourceLine" id="cb2-78" title="78">  <span class="kw">padding-top</span> : <span class="dv">.1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-79" title="79"></a>
<a class="sourceLine" id="cb2-80" title="80">  <span class="kw">-moz-box-sizing</span> : <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-81" title="81">  <span class="kw">box-sizing</span> : <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-82" title="82"></a>
<a class="sourceLine" id="cb2-83" title="83">  <span class="kw">text-align</span> : <span class="dv">center</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-84" title="84"></a>
<a class="sourceLine" id="cb2-85" title="85">  <span class="kw">border-left</span>  : <span class="dv">.2</span><span class="dt">em</span> <span class="dv">solid</span> <span class="cn">#000</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-86" title="86">  <span class="kw">border-radius</span>: <span class="dv">0</span> <span class="dv">.1</span><span class="dt">em</span> <span class="dv">.1</span><span class="dt">em</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-87" title="87"></a>
<a class="sourceLine" id="cb2-88" title="88">  <span class="kw">background-color</span> : <span class="cn">#000</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-89" title="89">  <span class="kw">color</span> : <span class="cn">#FFF</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-90" title="90">}</a>
<a class="sourceLine" id="cb2-91" title="91"></a>
<a class="sourceLine" id="cb2-92" title="92"><span class="fu">.select</span> <span class="fu">.optList</span> {</a>
<a class="sourceLine" id="cb2-93" title="93">  <span class="kw">z-index</span> : <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-94" title="94"></a>
<a class="sourceLine" id="cb2-95" title="95">  <span class="kw">list-style</span>: <span class="dv">none</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-96" title="96">  <span class="kw">margin</span> : <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-97" title="97">  <span class="kw">padding</span>: <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-98" title="98"></a>
<a class="sourceLine" id="cb2-99" title="99">  <span class="kw">background</span>: <span class="cn">#f0f0f0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-100" title="100">  <span class="kw">border</span>: <span class="dv">.2</span><span class="dt">em</span> <span class="dv">solid</span> <span class="cn">#000</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-101" title="101">  <span class="kw">border-top-width</span> : <span class="dv">.1</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-102" title="102">  <span class="kw">border-radius</span>: <span class="dv">0</span> <span class="dv">0</span> <span class="dv">.4</span><span class="dt">em</span> <span class="dv">.4</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-103" title="103"></a>
<a class="sourceLine" id="cb2-104" title="104">  <span class="kw">box-shadow</span>: <span class="dv">0</span> <span class="dv">.2</span><span class="dt">em</span> <span class="dv">.4</span><span class="dt">em</span> <span class="fu">rgba(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">.4</span><span class="fu">)</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-105" title="105"></a>
<a class="sourceLine" id="cb2-106" title="106">  <span class="kw">-moz-box-sizing</span> : <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-107" title="107">  <span class="kw">box-sizing</span> : <span class="dv">border-box</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-108" title="108"></a>
<a class="sourceLine" id="cb2-109" title="109">  <span class="kw">min-width</span> : <span class="dv">100</span><span class="dt">%</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-110" title="110">  <span class="kw">max-height</span>: <span class="dv">10</span><span class="dt">em</span><span class="op">;</span> <span class="co">/* 100px */</span></a>
<a class="sourceLine" id="cb2-111" title="111">  <span class="kw">overflow-y</span>: <span class="bu">auto</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-112" title="112">  <span class="kw">overflow-x</span>: <span class="dv">hidden</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-113" title="113">}</a>
<a class="sourceLine" id="cb2-114" title="114"></a>
<a class="sourceLine" id="cb2-115" title="115"><span class="fu">.select</span> <span class="fu">.option</span> {</a>
<a class="sourceLine" id="cb2-116" title="116">  <span class="kw">padding</span>: <span class="dv">.2</span><span class="dt">em</span> <span class="dv">.3</span><span class="dt">em</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-117" title="117">}</a>
<a class="sourceLine" id="cb2-118" title="118"></a>
<a class="sourceLine" id="cb2-119" title="119"><span class="fu">.select</span> <span class="fu">.highlight</span> {</a>
<a class="sourceLine" id="cb2-120" title="120">  <span class="kw">background</span>: <span class="cn">#000</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-121" title="121">  <span class="kw">color</span>: <span class="cn">#FFFFFF</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-122" title="122">}</a></code></pre></div>
<h3 id="javascript-content">JavaScript Content</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// ------- //</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">// HELPERS //</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">// ------- //</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="va">NodeList</span>.<span class="va">prototype</span>.<span class="at">forEach</span> <span class="op">=</span> <span class="kw">function</span> (callback) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="va">Array</span>.<span class="va">prototype</span>.<span class="va">forEach</span>.<span class="at">call</span>(<span class="kw">this</span><span class="op">,</span> callback)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">// -------------------- //</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">// Function definitions //</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">// -------------------- //</span></a>
<a class="sourceLine" id="cb3-12" title="12"></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="kw">function</span> <span class="at">deactivateSelect</span>(select) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="cf">if</span> (<span class="op">!</span><span class="va">select</span>.<span class="va">classList</span>.<span class="at">contains</span>(<span class="st">&#39;active&#39;</span>)) <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16">  <span class="kw">var</span> optList <span class="op">=</span> <span class="va">select</span>.<span class="at">querySelector</span>(<span class="st">&#39;.optList&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-17" title="17"></a>
<a class="sourceLine" id="cb3-18" title="18">  <span class="va">optList</span>.<span class="va">classList</span>.<span class="at">add</span>(<span class="st">&#39;hidden&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-19" title="19">  <span class="va">select</span>.<span class="va">classList</span>.<span class="at">remove</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-21" title="21"></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="kw">function</span> <span class="at">activeSelect</span>(select<span class="op">,</span> selectList) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-23" title="23">  <span class="cf">if</span> (<span class="va">select</span>.<span class="va">classList</span>.<span class="at">contains</span>(<span class="st">&#39;active&#39;</span>)) <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-24" title="24"></a>
<a class="sourceLine" id="cb3-25" title="25">  <span class="va">selectList</span>.<span class="at">forEach</span>(deactivateSelect)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-26" title="26">  <span class="va">select</span>.<span class="va">classList</span>.<span class="at">add</span>(<span class="st">&#39;active&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="op">};</span></a>
<a class="sourceLine" id="cb3-28" title="28"></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="kw">function</span> <span class="at">toggleOptList</span>(select<span class="op">,</span> show) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-30" title="30">  <span class="kw">var</span> optList <span class="op">=</span> <span class="va">select</span>.<span class="at">querySelector</span>(<span class="st">&#39;.optList&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-31" title="31"></a>
<a class="sourceLine" id="cb3-32" title="32">  <span class="va">optList</span>.<span class="va">classList</span>.<span class="at">toggle</span>(<span class="st">&#39;hidden&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-34" title="34"></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="kw">function</span> <span class="at">highlightOption</span>(select<span class="op">,</span> option) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-36" title="36">  <span class="kw">var</span> optionList <span class="op">=</span> <span class="va">select</span>.<span class="at">querySelectorAll</span>(<span class="st">&#39;.option&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-37" title="37"></a>
<a class="sourceLine" id="cb3-38" title="38">  <span class="va">optionList</span>.<span class="at">forEach</span>(<span class="kw">function</span> (other) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-39" title="39">    <span class="va">other</span>.<span class="va">classList</span>.<span class="at">remove</span>(<span class="st">&#39;highlight&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-40" title="40">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-41" title="41"></a>
<a class="sourceLine" id="cb3-42" title="42">  <span class="va">option</span>.<span class="va">classList</span>.<span class="at">add</span>(<span class="st">&#39;highlight&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="op">};</span></a>
<a class="sourceLine" id="cb3-44" title="44"></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="kw">function</span> <span class="at">updateValue</span>(select<span class="op">,</span> index) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-46" title="46">  <span class="kw">var</span> nativeWidget <span class="op">=</span> <span class="va">select</span>.<span class="at">previousElementSibling</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-47" title="47">  <span class="kw">var</span> value <span class="op">=</span> <span class="va">select</span>.<span class="at">querySelector</span>(<span class="st">&#39;.value&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-48" title="48">  <span class="kw">var</span> optionList <span class="op">=</span> <span class="va">select</span>.<span class="at">querySelectorAll</span>(<span class="st">&#39;.option&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-49" title="49"></a>
<a class="sourceLine" id="cb3-50" title="50">  <span class="va">optionList</span>.<span class="at">forEach</span>(<span class="kw">function</span> (other) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-51" title="51">    <span class="va">other</span>.<span class="at">setAttribute</span>(<span class="st">&#39;aria-selected&#39;</span><span class="op">,</span> <span class="st">&#39;false&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-52" title="52">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-53" title="53"></a>
<a class="sourceLine" id="cb3-54" title="54">  optionList[index].<span class="at">setAttribute</span>(<span class="st">&#39;aria-selected&#39;</span><span class="op">,</span> <span class="st">&#39;true&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-55" title="55"></a>
<a class="sourceLine" id="cb3-56" title="56">  <span class="va">nativeWidget</span>.<span class="at">selectedIndex</span> <span class="op">=</span> index<span class="op">;</span></a>
<a class="sourceLine" id="cb3-57" title="57">  <span class="va">value</span>.<span class="at">innerHTML</span> <span class="op">=</span> optionList[index].<span class="at">innerHTML</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-58" title="58">  <span class="at">highlightOption</span>(select<span class="op">,</span> optionList[index])<span class="op">;</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="op">};</span></a>
<a class="sourceLine" id="cb3-60" title="60"></a>
<a class="sourceLine" id="cb3-61" title="61"><span class="kw">function</span> <span class="at">getIndex</span>(select) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-62" title="62">  <span class="kw">var</span> nativeWidget <span class="op">=</span> <span class="va">select</span>.<span class="at">previousElementSibling</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-63" title="63"></a>
<a class="sourceLine" id="cb3-64" title="64">  <span class="cf">return</span> <span class="va">nativeWidget</span>.<span class="at">selectedIndex</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-65" title="65"><span class="op">};</span></a>
<a class="sourceLine" id="cb3-66" title="66"></a>
<a class="sourceLine" id="cb3-67" title="67"><span class="co">// ------------- //</span></a>
<a class="sourceLine" id="cb3-68" title="68"><span class="co">// Event binding //</span></a>
<a class="sourceLine" id="cb3-69" title="69"><span class="co">// ------------- //</span></a>
<a class="sourceLine" id="cb3-70" title="70"></a>
<a class="sourceLine" id="cb3-71" title="71"><span class="va">window</span>.<span class="at">addEventListener</span>(<span class="st">&quot;load&quot;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb3-72" title="72">  <span class="kw">var</span> form <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelector</span>(<span class="st">&#39;form&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-73" title="73"></a>
<a class="sourceLine" id="cb3-74" title="74">  <span class="va">form</span>.<span class="va">classList</span>.<span class="at">remove</span>(<span class="st">&quot;no-widget&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-75" title="75">  <span class="va">form</span>.<span class="va">classList</span>.<span class="at">add</span>(<span class="st">&quot;widget&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-76" title="76"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-77" title="77"></a>
<a class="sourceLine" id="cb3-78" title="78"><span class="va">window</span>.<span class="at">addEventListener</span>(<span class="st">&#39;load&#39;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb3-79" title="79">  <span class="kw">var</span> selectList <span class="op">=</span> <span class="va">document</span>.<span class="at">querySelectorAll</span>(<span class="st">&#39;.select&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-80" title="80"></a>
<a class="sourceLine" id="cb3-81" title="81">  <span class="va">selectList</span>.<span class="at">forEach</span>(<span class="kw">function</span> (select) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-82" title="82">    <span class="kw">var</span> optionList <span class="op">=</span> <span class="va">select</span>.<span class="at">querySelectorAll</span>(<span class="st">&#39;.option&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb3-83" title="83">        selectedIndex <span class="op">=</span> <span class="at">getIndex</span>(select)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-84" title="84"></a>
<a class="sourceLine" id="cb3-85" title="85">    <span class="va">select</span>.<span class="at">tabIndex</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-86" title="86">    <span class="va">select</span>.<span class="va">previousElementSibling</span>.<span class="at">tabIndex</span> <span class="op">=</span> <span class="dv">-1</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-87" title="87"></a>
<a class="sourceLine" id="cb3-88" title="88">    <span class="at">updateValue</span>(select<span class="op">,</span> selectedIndex)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-89" title="89"></a>
<a class="sourceLine" id="cb3-90" title="90">    <span class="va">optionList</span>.<span class="at">forEach</span>(<span class="kw">function</span> (option<span class="op">,</span> index) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-91" title="91">      <span class="va">option</span>.<span class="at">addEventListener</span>(<span class="st">&#39;mouseover&#39;</span><span class="op">,</span> <span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb3-92" title="92">        <span class="at">highlightOption</span>(select<span class="op">,</span> option)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-93" title="93">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-94" title="94"></a>
<a class="sourceLine" id="cb3-95" title="95">      <span class="va">option</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span> (event) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-96" title="96">        <span class="at">updateValue</span>(select<span class="op">,</span> index)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-97" title="97">      <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-98" title="98">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-99" title="99"></a>
<a class="sourceLine" id="cb3-100" title="100">    <span class="va">select</span>.<span class="at">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span> (event) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-101" title="101">      <span class="at">toggleOptList</span>(select)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-102" title="102">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-103" title="103"></a>
<a class="sourceLine" id="cb3-104" title="104">    <span class="va">select</span>.<span class="at">addEventListener</span>(<span class="st">&#39;focus&#39;</span><span class="op">,</span> <span class="kw">function</span> (event) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-105" title="105">      <span class="at">activeSelect</span>(select<span class="op">,</span> selectList)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-106" title="106">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-107" title="107"></a>
<a class="sourceLine" id="cb3-108" title="108">    <span class="va">select</span>.<span class="at">addEventListener</span>(<span class="st">&#39;blur&#39;</span><span class="op">,</span> <span class="kw">function</span> (event) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-109" title="109">      <span class="at">deactivateSelect</span>(select)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-110" title="110">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-111" title="111"></a>
<a class="sourceLine" id="cb3-112" title="112">    <span class="va">select</span>.<span class="at">addEventListener</span>(<span class="st">&#39;keyup&#39;</span><span class="op">,</span> <span class="kw">function</span> (event) <span class="op">{</span></a>
<a class="sourceLine" id="cb3-113" title="113">      <span class="kw">var</span> length <span class="op">=</span> <span class="va">optionList</span>.<span class="at">length</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-114" title="114">          index  <span class="op">=</span> <span class="at">getIndex</span>(select)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-115" title="115"></a>
<a class="sourceLine" id="cb3-116" title="116">      <span class="cf">if</span> (<span class="va">event</span>.<span class="at">keyCode</span> <span class="op">===</span> <span class="dv">27</span>) <span class="op">{</span> <span class="at">deactivateSelect</span>(select)<span class="op">;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb3-117" title="117">      <span class="cf">if</span> (<span class="va">event</span>.<span class="at">keyCode</span> <span class="op">===</span> <span class="dv">40</span> <span class="op">&amp;&amp;</span> index <span class="op">&lt;</span> length <span class="op">-</span> <span class="dv">1</span>) <span class="op">{</span> index<span class="op">++;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb3-118" title="118">      <span class="cf">if</span> (<span class="va">event</span>.<span class="at">keyCode</span> <span class="op">===</span> <span class="dv">38</span> <span class="op">&amp;&amp;</span> index <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">{</span> index<span class="op">--;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb3-119" title="119"></a>
<a class="sourceLine" id="cb3-120" title="120">      <span class="at">updateValue</span>(select<span class="op">,</span> index)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-121" title="121">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-122" title="122">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-123" title="123"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="result">Result</h3>
<p>{{ EmbedLiveSample(‘Change_states’) }}</p>
